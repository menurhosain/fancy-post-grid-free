<?php
if (!defined('ABSPATH')) {
    exit; // Prevent direct access
}
class FPG_Blocks_Free {

    public function __construct() {
        add_filter('block_categories_all', [ $this, 'fancy_post_grid_free_add_custom_block_category' ]);
        add_action('init', [ $this, 'register_blocks' ]);
    }

    public function fancy_post_grid_free_add_custom_block_category($categories) {
        return array_merge(
            $categories,
            array(
                array(
                    'slug'  => 'fancy-post-grid-category',
                    'title' => __('Fancy Post Grid', 'fancy-post-grid'),
                ),
            )
        );
    }

    public function register_blocks() {  
        // Register Swiper CSS & JS
        wp_register_style(
            'fpg-swiper-css',
            plugins_url('blocks/fancy-post-slider/swiper-bundle.min.css', __FILE__),
            array(),
            filemtime(plugin_dir_path(__FILE__) . 'blocks/fancy-post-slider/swiper-bundle.min.css')
        );

        wp_register_script(
            'fpg-swiper',
            plugins_url('blocks/fancy-post-slider/swiper-bundle.min.js', __FILE__),
            array(),
            filemtime(plugin_dir_path(__FILE__) . 'blocks/fancy-post-slider/swiper-bundle.min.js'),
            true
        );
        wp_register_script(
            'fpg-isotope-pkgd',
            plugins_url('blocks/fancy-post-slider/isotope.pkgd.min.js', __FILE__),
            array(),
            filemtime(plugin_dir_path(__FILE__) . 'blocks/fancy-post-slider/isotope.pkgd.min.js'),
            true
        );
        wp_register_script(
            'fpg-gutenberg-main',
            plugins_url('blocks/fancy-post-slider/main.js', __FILE__),
            array('fpg-swiper', 'fpg-isotope-pkgd'),
            filemtime(plugin_dir_path(__FILE__) . 'blocks/fancy-post-slider/main.js'),
            true
        );

        wp_register_script(
            'fancy-post-grid-block',
            plugins_url('blocks/fancy-post-grid/grid-block.js', __FILE__),
            array('wp-blocks', 'wp-element', 'wp-editor', 'wp-data'),
            filemtime(plugin_dir_path(__FILE__) . 'blocks/fancy-post-grid/grid-block.js')
        );

        wp_register_script(
            'fancy-post-slider-block',
            plugins_url('blocks/fancy-post-slider/slider-block.js', __FILE__),
            array('wp-blocks', 'wp-element', 'wp-editor', 'wp-data'),
            filemtime(plugin_dir_path(__FILE__) . 'blocks/fancy-post-slider/slider-block.js')
        );

        wp_register_style(
            'fancy-post-grid-style',
            plugins_url('blocks/fancy-post-grid/grid-style.css', __FILE__),
            array(),
            filemtime(plugin_dir_path(__FILE__) . 'blocks/fancy-post-grid/grid-style.css')
        );

        wp_register_script(
            'fancy-post-list-block',
            plugins_url( 'blocks/fancy-post-list/list-block.js', __FILE__ ),
            array( 'wp-blocks', 'wp-element', 'wp-editor', 'wp-data' ),
            filemtime( plugin_dir_path( __FILE__ ) . 'blocks/fancy-post-list/list-block.js' ),
            true
        );
        wp_register_style(
            'fancy-post-list-style',
            plugins_url('blocks/fancy-post-list/list-style.css', __FILE__),
            array(),
            filemtime(plugin_dir_path(__FILE__) . 'blocks/fancy-post-list/list-style.css')
        );

        register_block_type('fancy-post-grid/block', array(
            'editor_script' => 'fancy-post-grid-block',
            'editor_style'  => 'fancy-post-grid-style',
            'style'         => '',
            'render_callback' => [ $this, 'fancy_post_grid_free_render_callback' ],
        ));

        register_block_type('fancy-post-slider/block', array(
            'editor_script' => 'fancy-post-slider-block',
            'editor_style'  => '',
            'style'         => 'fpg-swiper-css',
            'script'          => 'fpg-gutenberg-main', // loads both main.js & swiper-js
            'render_callback' => [ $this, 'fancy_post_slider_free_render_callback' ], // PHP function to render posts
        ));
        register_block_type('fancy-post-list/block', array(
            'editor_script' => 'fancy-post-list-block',
            'editor_style'  => 'fancy-post-list-style',
            'style'         => 'fancy-post-list-style',
            'render_callback' => [ $this, 'fancy_post_list_render_callback' ], // PHP function to render posts
        ));
    }
    
    public function fancy_post_grid_free_render_callback($attributes) {
        // Content Layout
        
        $gridLayoutStyle = isset($attributes['gridLayoutStyle']) ? $attributes['gridLayoutStyle'] : 'style1';
        $gridColumns = isset($attributes['gridColumns']) ? absint($attributes['gridColumns']) : '';
        //Query Builder
        
        $selectedCategories = isset($attributes['selectedCategories']) && is_array($attributes['selectedCategories'])
        ? array_map('absint', $attributes['selectedCategories'])
        : [];
        $selectedTags = isset($attributes['selectedTags']) && is_array($attributes['selectedTags'])
        ? array_map('absint', $attributes['selectedTags'])
        : [];

        $selectedTag = isset($attributes['selectedTag']) ? sanitize_text_field($attributes['selectedTag']) : '';
        $orderBy = isset($attributes['orderBy']) ? sanitize_text_field($attributes['orderBy']) : 'title';
        $postLimit = isset($attributes['postLimit']) ? absint($attributes['postLimit']) : 3;
          
        // Pagination settings
        $enablePagination = isset($attributes['enablePagination']) ? filter_var($attributes['enablePagination'], FILTER_VALIDATE_BOOLEAN) : true;
        // Links
        $postLinkTarget = isset($attributes['postLinkTarget']) ? sanitize_text_field($attributes['postLinkTarget']) : 'newWindow';
        $thumbnailLink = isset($attributes['thumbnailLink']) ? filter_var($attributes['thumbnailLink'], FILTER_VALIDATE_BOOLEAN) : true;
        $postLinkType = isset($attributes['postLinkType']) ? sanitize_text_field($attributes['postLinkType']) : 'yeslink';

        // Field Selector
        $showPostTitle = isset($attributes['showPostTitle']) ? filter_var($attributes['showPostTitle'], FILTER_VALIDATE_BOOLEAN) : true;
        $showThumbnail = isset($attributes['showThumbnail']) ? filter_var($attributes['showThumbnail'], FILTER_VALIDATE_BOOLEAN) : true;
        $showPostExcerpt = isset($attributes['showPostExcerpt']) ? filter_var($attributes['showPostExcerpt'], FILTER_VALIDATE_BOOLEAN) : true;
        $showReadMoreButton = isset($attributes['showReadMoreButton']) ? filter_var($attributes['showReadMoreButton'], FILTER_VALIDATE_BOOLEAN) : true;
        $showMetaData = isset($attributes['showMetaData']) ? filter_var($attributes['showMetaData'], FILTER_VALIDATE_BOOLEAN) : true;
        $showPostDate = isset($attributes['showPostDate']) ? filter_var($attributes['showPostDate'], FILTER_VALIDATE_BOOLEAN) : true;
        $showPostAuthor = isset($attributes['showPostAuthor']) ? filter_var($attributes['showPostAuthor'], FILTER_VALIDATE_BOOLEAN) : true;
        $showPostCategory = isset($attributes['showPostCategory']) ? filter_var($attributes['showPostCategory'], FILTER_VALIDATE_BOOLEAN) : true;
        $showPostTags = isset($attributes['showPostTags']) ? filter_var($attributes['showPostTags'], FILTER_VALIDATE_BOOLEAN) : false;
        $showPostCommentsCount = isset($attributes['showPostCommentsCount']) ? filter_var($attributes['showPostCommentsCount'], FILTER_VALIDATE_BOOLEAN) : false;
        $showMetaIcon = isset($attributes['showMetaIcon']) ? filter_var($attributes['showMetaIcon'], FILTER_VALIDATE_BOOLEAN) : true;
        $showPostDateIcon = isset($attributes['showPostDateIcon']) ? filter_var($attributes['showPostDateIcon'], FILTER_VALIDATE_BOOLEAN) : true;
        $showPostAuthorIcon = isset($attributes['showPostAuthorIcon']) ? filter_var($attributes['showPostAuthorIcon'], FILTER_VALIDATE_BOOLEAN) : true;
        $showPostCategoryIcon = isset($attributes['showPostCategoryIcon']) ? filter_var($attributes['showPostCategoryIcon'], FILTER_VALIDATE_BOOLEAN) : true;
        $showPostTagsIcon = isset($attributes['showPostTagsIcon']) ? filter_var($attributes['showPostTagsIcon'], FILTER_VALIDATE_BOOLEAN) : false;
        $showPostCommentsCountIcon = isset($attributes['showPostCommentsCountIcon']) ? filter_var($attributes['showPostCommentsCountIcon'], FILTER_VALIDATE_BOOLEAN) : false;

        // Order values
        $metaOrder = isset($attributes['metaOrder']) ? absint($attributes['metaOrder']) : '';
        $titleOrder = isset($attributes['titleOrder']) ? absint($attributes['titleOrder']) : '';
        $excerptOrder = isset($attributes['excerptOrder']) ? absint($attributes['excerptOrder']) : '';
        $buttonOrder = isset($attributes['buttonOrder']) ? absint($attributes['buttonOrder']) : '';

        // Post title settings
        $titleTag               = isset($attributes['titleTag']) ? sanitize_text_field($attributes['titleTag']) : 'h3';
        $titleHoverUnderLine    = isset($attributes['titleHoverUnderLine']) ? sanitize_text_field($attributes['titleHoverUnderLine']) : 'enable';
        $titleCropBy            = isset($attributes['titleCropBy']) ? sanitize_text_field($attributes['titleCropBy']) : 'word';
        $titleLength            = isset($attributes['titleLength']) ? absint($attributes['titleLength']) : 12;
        
        //THUMB sETTINGS
        $thumbnailSize = isset($attributes['thumbnailSize']) ? sanitize_text_field($attributes['thumbnailSize']) : '';
        $hoverAnimation = isset($attributes['hoverAnimation']) ? sanitize_text_field($attributes['hoverAnimation']) : 'hover-zoom_in';

        // Excerpt Settings
        $excerptType = isset($attributes['excerptType']) ? sanitize_text_field($attributes['excerptType']) : 'word';
        $excerptIndicator = isset($attributes['excerptIndicator']) ? sanitize_text_field($attributes['excerptIndicator']) : '...';
        $excerptLimit = isset($attributes['excerptLimit']) ? absint($attributes['excerptLimit']) : 10;
        // Meta data Settings
        $metaAuthorPrefix = isset($attributes['metaAuthorPrefix']) ? sanitize_text_field($attributes['metaAuthorPrefix']) : __('By', 'fancy-post-grid');
        $metaSeperator = isset($attributes['metaSeperator']) ? sanitize_text_field($attributes['metaSeperator']) : '';
        //Button Settings   
        $showButtonIcon = isset($attributes['showButtonIcon']) ? filter_var($attributes['showPostCommentsCountIcon'], FILTER_VALIDATE_BOOLEAN) : true;
        $iconPosition = isset($attributes['iconPosition']) ? sanitize_text_field($attributes['iconPosition']) : 'right';
        $buttonStyle = isset($attributes['buttonStyle']) ? sanitize_text_field($attributes['buttonStyle']) : '';
        $readMoreLabel = isset($attributes['readMoreLabel']) ? sanitize_text_field($attributes['readMoreLabel']) : __('Read More', 'fancy-post-grid');
        // SECTION Area
        $sectionBgColor    = isset($attributes['sectionBgColor']) ? sanitize_text_field($attributes['sectionBgColor']) : '';
        $sectionMargin = isset($attributes['sectionMargin']) ? $attributes['sectionMargin'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $sectionPadding = isset($attributes['sectionPadding']) ? $attributes['sectionPadding'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        // ITEM Box
        $itemPadding = isset($attributes['itemPadding']) ? $attributes['itemPadding'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $itemMargin = isset($attributes['itemMargin']) ? $attributes['itemMargin'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $itemBorderRadius = isset($attributes['itemBorderRadius']) ? $attributes['itemBorderRadius'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $itemBorderWidth = isset($attributes['itemBorderWidth']) ? $attributes['itemBorderWidth'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $itemBoxAlignment   = isset($attributes['itemBoxAlignment']) ? sanitize_text_field($attributes['itemBoxAlignment']) : '';
        $itemBorderType     = isset($attributes['itemBorderType']) ? sanitize_text_field($attributes['itemBorderType']) : '';
        $itemBoxShadow = isset($attributes['itemBoxShadow']) ? $attributes['itemBoxShadow'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $itemBackgroundColor = isset($attributes['itemBackgroundColor']) ? sanitize_text_field($attributes['itemBackgroundColor']) : '';
        $itemBorderColor    = isset($attributes['itemBorderColor']) ? sanitize_text_field($attributes['itemBorderColor']) : '';   
        $itemBoxShadowColor = isset($attributes['itemBoxShadowColor']) ? sanitize_text_field($attributes['itemBoxShadowColor']) : '';
        $itemGap      = isset($attributes['itemGap']) ? absint($attributes['itemGap']) : 30;

        // Content Box
        $contentitemPaddingNew = isset($attributes['contentitemPaddingNew']) ? $attributes['contentitemPaddingNew'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $contentitemMarginNew = isset($attributes['contentitemMarginNew']) ? $attributes['contentitemMarginNew'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $contentBorderWidth = isset($attributes['contentBorderWidth']) ? $attributes['contentBorderWidth'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $contentitemRadius = isset($attributes['contentitemRadius']) ? $attributes['contentitemRadius'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $contentNormalBorderType = isset($attributes['contentnormalBorderType']) ? sanitize_text_field($attributes['contentnormalBorderType']) : '';
        $contentBgColor    = isset($attributes['contentBgColor']) ? sanitize_text_field($attributes['contentBgColor']) : '';   
        $contentHoverBgColor    = isset($attributes['contentHoverBgColor']) ? sanitize_text_field($attributes['contentHoverBgColor']) : '';   
        $contentBorderColor = isset($attributes['contentBorderColor']) ? sanitize_text_field($attributes['contentBorderColor']) : '';
        // Thumbnail
        $thumbnailMargin = isset($attributes['thumbnailMargin']) ? $attributes['thumbnailMargin'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $thumbnailPadding = isset($attributes['thumbnailPadding']) ? $attributes['thumbnailPadding'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $thumbnailBorderRadius = isset($attributes['thumbnailBorderRadius']) ? $attributes['thumbnailBorderRadius'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];

        // Post Title
        $postTitleFontSize      = isset($attributes['postTitleFontSize']) ? absint($attributes['postTitleFontSize']) : '';
        $postTitleLineHeight    = isset($attributes['postTitleLineHeight']) ? floatval($attributes['postTitleLineHeight']) : '';
        $postTitleLetterSpacing = isset($attributes['postTitleLetterSpacing']) ? floatval($attributes['postTitleLetterSpacing']) : '';
        $postTitleFontWeight    = isset($attributes['postTitleFontWeight']) ? sanitize_text_field($attributes['postTitleFontWeight']) : '';
        $postTitleAlignment     = isset($attributes['postTitleAlignment']) ? sanitize_text_field($attributes['postTitleAlignment']) : '';
        $postTitleColor         = isset($attributes['postTitleColor']) ? sanitize_text_field($attributes['postTitleColor']) : '';
        $postTitleBgColor       = isset($attributes['postTitleBgColor']) ? sanitize_text_field($attributes['postTitleBgColor']) : ''; 
        $postTitleHoverColor    = isset($attributes['postTitleHoverColor']) ? sanitize_text_field($attributes['postTitleHoverColor']) : '';
        $postTitleHoverBgColor  = isset($attributes['postTitleHoverBgColor']) ? sanitize_text_field($attributes['postTitleHoverBgColor']) : '';
        $postTitleMargin  = isset($attributes['postTitleMargin']) ? array_map('sanitize_text_field', $attributes['postTitleMargin']) : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $postTitlePadding = isset($attributes['postTitlePadding']) ? array_map('sanitize_text_field', $attributes['postTitlePadding']) : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];

        // Excerpt
        $excerptFontSize = isset($attributes['excerptFontSize']) ? absint($attributes['excerptFontSize']) : '';
        $excerptLineHeight = isset($attributes['excerptLineHeight']) ? floatval($attributes['excerptLineHeight']) : '';
        $excerptLetterSpacing = isset($attributes['excerptLetterSpacing']) ? floatval($attributes['excerptLetterSpacing']) : '';
        $excerptFontWeight = isset($attributes['excerptFontWeight']) ? sanitize_text_field($attributes['excerptFontWeight']) : '';
        $excerptAlignment = isset($attributes['excerptAlignment']) ? sanitize_text_field($attributes['excerptAlignment']) : '';
        $excerptMargin = isset($attributes['excerptMargin']) ? array_map('sanitize_text_field', $attributes['excerptMargin']) : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $excerptPadding = isset($attributes['excerptPadding']) ? array_map('sanitize_text_field', $attributes['excerptPadding']) : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $excerptColor = isset($attributes['excerptColor']) ? sanitize_text_field($attributes['excerptColor']) : '';
        $excerptBgColor = isset($attributes['excerptBgColor']) ? sanitize_text_field($attributes['excerptBgColor']) : '';
        $excerptBorderType = isset($attributes['excerptBorderType']) ? sanitize_text_field($attributes['excerptBorderType']) : '';
        $excerptHoverColor = isset($attributes['excerptHoverColor']) ? sanitize_text_field($attributes['excerptHoverColor']) : '';
        $excerptHoverBgColor = isset($attributes['excerptHoverBgColor']) ? sanitize_text_field($attributes['excerptHoverBgColor']) : '';
        

        // Meta Data Attributes
        $metaAlignment = isset($attributes['metaAlignment']) ? sanitize_text_field($attributes['metaAlignment']) : '';
        $metaMarginNew = isset($attributes['metaMarginNew']) ? $attributes['metaMarginNew'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $metaPadding = isset($attributes['metaPadding']) ? $attributes['metaPadding'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $metaTextColor = isset($attributes['metaTextColor']) ? sanitize_text_field($attributes['metaTextColor']) : '';
        $separatorColor = isset($attributes['separatorColor']) ? sanitize_text_field($attributes['separatorColor']) : '';
        $metaFontSize = isset($attributes['metaFontSize']) ? absint($attributes['metaFontSize']) : '';
        $metaIconColor = isset($attributes['metaIconColor']) ? sanitize_text_field($attributes['metaIconColor']) : '';
        $metaBgColor = isset($attributes['metaBgColor']) ? sanitize_text_field($attributes['metaBgColor']) : '';
        
        // Button Alignment
        $buttonAlignment = isset($attributes['buttonAlignment']) ? sanitize_text_field($attributes['buttonAlignment']) : '';
        $buttonMarginNew = isset($attributes['buttonMarginNew']) ? array_map('sanitize_text_field', $attributes['buttonMarginNew']) : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $buttonPaddingNew = isset($attributes['buttonPaddingNew']) ? array_map('sanitize_text_field', $attributes['buttonPaddingNew']) : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $buttonFontSize = isset($attributes['buttonFontSize']) ? absint($attributes['buttonFontSize']) : '';
        $buttonBorderWidth = isset($attributes['buttonBorderWidth']) ? array_map('sanitize_text_field', $attributes['buttonBorderWidth']) : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $buttonFontWeight = isset($attributes['buttonFontWeight']) ? sanitize_text_field($attributes['buttonFontWeight']) : '';
        $buttonTextColor = isset($attributes['buttonTextColor']) ? sanitize_text_field($attributes['buttonTextColor']) : '';
        $buttonBackgroundColor = isset($attributes['buttonBackgroundColor']) ? sanitize_text_field($attributes['buttonBackgroundColor']) : '';
        $buttonBorderType = isset($attributes['buttonBorderType']) ? sanitize_text_field($attributes['buttonBorderType']) : '';
        $buttonBorderRadius = isset($attributes['buttonBorderRadius']) ? array_map('sanitize_text_field', $attributes['buttonBorderRadius']) : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $buttonHoverTextColor = isset($attributes['buttonHoverTextColor']) ? sanitize_text_field($attributes['buttonHoverTextColor']) : '';
        $buttonHoverBackgroundColor = isset($attributes['buttonHoverBackgroundColor']) ? sanitize_text_field($attributes['buttonHoverBackgroundColor']) : ''; 
        $buttonBorderColor = isset($attributes['buttonBorderColor']) ? sanitize_text_field($attributes['buttonBorderColor']) : '';
        $buttonHoverBorderColor = isset($attributes['buttonHoverBorderColor']) ? sanitize_text_field($attributes['buttonHoverBorderColor']) : '';
        // Pagination Attributes
        $paginationAlignment = isset($attributes['paginationAlignment']) ? sanitize_text_field($attributes['paginationAlignment']) : 'center';

        $paginationMarginNew = isset($attributes['paginationMarginNew']) ? $attributes['paginationMarginNew'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $paginationPaddingNew = isset($attributes['paginationPaddingNew']) ? $attributes['paginationPaddingNew'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        
        $paginationBorderStyle = isset($attributes['paginationBorderStyle']) ? sanitize_text_field($attributes['paginationBorderStyle']) : '';
        $paginationFontSize = isset($attributes['paginationFontSize']) ? absint($attributes['paginationFontSize']) : '';
        $paginationBorderWidthNew = isset($attributes['paginationBorderWidthNew']) ? array_map('sanitize_text_field', $attributes['paginationBorderWidthNew']) : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        
        $paginationBorderRadius = isset($attributes['paginationBorderRadius']) ? array_map('sanitize_text_field', $attributes['paginationBorderRadius']) : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $paginationGap = isset($attributes['paginationGap']) ? absint($attributes['paginationGap']) : '';
        $paginationTextColor = isset($attributes['paginationTextColor']) ? sanitize_text_field($attributes['paginationTextColor']) : '';
        $paginationBackgroundColor = isset($attributes['paginationBackgroundColor']) ? sanitize_text_field($attributes['paginationBackgroundColor']) : '';
        $paginationBorderColor = isset($attributes['paginationBorderColor']) ? sanitize_text_field($attributes['paginationBorderColor']) : '';
        $paginationHoverTextColor = isset($attributes['paginationHoverTextColor']) ? sanitize_text_field($attributes['paginationHoverTextColor']) : '';
        $paginationHoverBackgroundColor = isset($attributes['paginationHoverBackgroundColor']) ? sanitize_text_field($attributes['paginationHoverBackgroundColor']) : '';
        $paginationHoverBorderColor = isset($attributes['paginationHoverBorderColor']) ? sanitize_text_field($attributes['paginationHoverBorderColor']) : '';
        $paginationActiveTextColor = isset($attributes['paginationActiveTextColor']) ? sanitize_text_field($attributes['paginationActiveTextColor']) : '';
        $paginationActiveBackgroundColor = isset($attributes['paginationActiveBackgroundColor']) ? sanitize_text_field($attributes['paginationActiveBackgroundColor']) : '';
        $paginationActiveBorderColor = isset($attributes['paginationActiveBorderColor']) ? sanitize_text_field($attributes['paginationActiveBorderColor']) : '';

        //END ATTRIBUTES
        
        $paged = (get_query_var('paged')) ? get_query_var('paged') : 1;

        $query_args = array(
            'post_type'      => 'post',
            'posts_per_page' => $postLimit, // Adjust as needed
            'paged'          => $paged,
            'orderby'        => $orderBy,
            'order'          => 'DESC', // Ensure ordering
        );

        
        if ( ! empty( $selectedCategories ) ) {
            $query_args['category__in'] = $selectedCategories;
        }
        if ( ! empty( $selectedTags ) ) {
            $query_args['tag__in'] = $selectedTags;
        }
        // Include Posts
        $includePosts = isset($attributes['includePosts']) ? $attributes['includePosts'] : '';
        if ( ! empty($includePosts) ) {
            $ids = array_filter(array_map('absint', explode(',', $includePosts)));
            if ( ! empty($ids) ) {
                $query_args['post__in'] = $ids;
            }
        }

        // Exclude Posts
        $excludePosts = isset($attributes['excludePosts']) ? $attributes['excludePosts'] : '';
        if ( ! empty($excludePosts) ) {
            $ids = array_filter(array_map('absint', explode(',', $excludePosts)));
            if ( ! empty($ids) ) {
                $query_args['post__not_in'] = $ids;
            }
        }

        // GRID COLUMNS
        $gridColumns1 = ($gridLayoutStyle === 'style1' && $gridColumns == null)
                  ? 3 : $gridColumns; 
        $gridColumns2 = ($gridLayoutStyle === 'style2' && $gridColumns == null)
                  ? 3 : $gridColumns; 
        $gridColumns3 = ($gridLayoutStyle === 'style3' && $gridColumns == null)
                  ? 3 : $gridColumns; 
        $gridColumns4 = ($gridLayoutStyle === 'style4' && $gridColumns == null)
                  ? 3 : $gridColumns; 
        $gridColumns5 = ($gridLayoutStyle === 'style5' && $gridColumns == null)
                  ? 3 : $gridColumns; 
        $gridColumns6 = ($gridLayoutStyle === 'style6' && $gridColumns == null)
                  ? 3 : $gridColumns; 
        $gridColumns7 = ($gridLayoutStyle === 'style7' && $gridColumns == null)
                  ? 4 : $gridColumns; 
        $gridColumns8 = ($gridLayoutStyle === 'style8' && $gridColumns == null)
                  ? 3 : $gridColumns; 
        $gridColumns9 = ($gridLayoutStyle === 'style9' && $gridColumns == null)
                  ? 3 : $gridColumns; 
        $gridColumns10 = ($gridLayoutStyle === 'style10' && $gridColumns == null)
                  ? 3 : $gridColumns; 
        $gridColumns11 = ($gridLayoutStyle === 'style11' && $gridColumns == null)
                  ? 3 : $gridColumns; 
        $gridColumns12 = ($gridLayoutStyle === 'style12' && $gridColumns == null)
                  ? 3 : $gridColumns; 

        // thumbnailSize
        $thumbnailSize1 = ($gridLayoutStyle === 'style1' && $thumbnailSize == null)
                  ? 'fancy_post_custom_size' : $thumbnailSize; 
        $thumbnailSize2 = ($gridLayoutStyle === 'style2' && $thumbnailSize == null)
                  ? 'fancy_post_custom_size' : $thumbnailSize; 
        $thumbnailSize3 = ($gridLayoutStyle === 'style3' && $thumbnailSize == null)
                  ? 'fancy_post_custom_size' : $thumbnailSize; 
        $thumbnailSize4 = ($gridLayoutStyle === 'style4' && $thumbnailSize == null)
                  ? 'fancy_post_landscape' : $thumbnailSize; 
        $thumbnailSize5 = ($gridLayoutStyle === 'style5' && $thumbnailSize == null)
                  ? 'fancy_post_square' : $thumbnailSize; 
        $thumbnailSize6 = ($gridLayoutStyle === 'style6' && $thumbnailSize == null)
                  ? 'fancy_post_landscape' : $thumbnailSize; 
        $thumbnailSize7 = ($gridLayoutStyle === 'style7' && $thumbnailSize == null)
                  ? 'fancy_post_square' : $thumbnailSize; 
        $thumbnailSize8 = ($gridLayoutStyle === 'style8' && $thumbnailSize == null)
                  ? 'fancy_post_landscape' : $thumbnailSize; 
        $thumbnailSize9 = ($gridLayoutStyle === 'style9' && $thumbnailSize == null)
                  ? 'fancy_post_landscape' : $thumbnailSize; 
        $thumbnailSize10 = ($gridLayoutStyle === 'style10' && $thumbnailSize == null)
                  ? 'fancy_post_landscape' : $thumbnailSize; 
        $thumbnailSize11 = ($gridLayoutStyle === 'style11' && $thumbnailSize == null)
                  ? 'fancy_post_landscape' : $thumbnailSize; 
        $thumbnailSize12 = ($gridLayoutStyle === 'style12' && $thumbnailSize == null)
                  ? 'fancy_post_square' : $thumbnailSize;

        // thumbnailSize
        $itemBoxAlignment1 = ($gridLayoutStyle === 'style1' && $itemBoxAlignment == null)
                  ? 'start' : $itemBoxAlignment; 
        $itemBoxAlignment2 = ($gridLayoutStyle === 'style2' && $itemBoxAlignment == null)
                  ? 'start' : $itemBoxAlignment; 
        $itemBoxAlignment3 = ($gridLayoutStyle === 'style3' && $itemBoxAlignment == null)
                  ? 'start' : $itemBoxAlignment; 
        $itemBoxAlignment4 = ($gridLayoutStyle === 'style4' && $itemBoxAlignment == null)
                  ? 'center' : $itemBoxAlignment; 
        $itemBoxAlignment5 = ($gridLayoutStyle === 'style5' && $itemBoxAlignment == null)
                  ? 'start' : $itemBoxAlignment; 
        $itemBoxAlignment6 = ($gridLayoutStyle === 'style6' && $itemBoxAlignment == null)
                  ? 'start' : $itemBoxAlignment; 
        $itemBoxAlignment7 = ($gridLayoutStyle === 'style7' && $itemBoxAlignment == null)
                  ? 'start' : $itemBoxAlignment; 
        $itemBoxAlignment8 = ($gridLayoutStyle === 'style8' && $itemBoxAlignment == null)
                  ? 'start' : $itemBoxAlignment; 
        $itemBoxAlignment9 = ($gridLayoutStyle === 'style9' && $itemBoxAlignment == null)
                  ? 'start' : $itemBoxAlignment; 
        $itemBoxAlignment10 = ($gridLayoutStyle === 'style10' && $itemBoxAlignment == null)
                  ? 'start' : $itemBoxAlignment; 
        $itemBoxAlignment11 = ($gridLayoutStyle === 'style11' && $itemBoxAlignment == null)
                  ? 'start' : $itemBoxAlignment; 
        $itemBoxAlignment12 = ($gridLayoutStyle === 'style12' && $itemBoxAlignment == null)
                  ? 'start' : $itemBoxAlignment;
        
        // buttonStyle
        $buttonStyle1 = ($gridLayoutStyle === 'style1' && $buttonStyle == null)
                  ? 'fpg-flat' : $buttonStyle; 
        $buttonStyle2 = ($gridLayoutStyle === 'style2' && $buttonStyle == null)
                  ? 'fpg-border' : $buttonStyle; 
        $buttonStyle3 = ($gridLayoutStyle === 'style3' && $buttonStyle == null)
                  ? 'fpg-filled' : $buttonStyle; 
        $buttonStyle5 = ($gridLayoutStyle === 'style5' && $buttonStyle == null)
                  ? 'fpg-flat' : $buttonStyle; 
        $buttonStyle6 = ($gridLayoutStyle === 'style6' && $buttonStyle == null)
                  ? 'fpg-border' : $buttonStyle; 
        $buttonStyle10 = ($gridLayoutStyle === 'style10' && $buttonStyle == null)
                  ? 'fpg-filled' : $buttonStyle; 
        $buttonStyle11 = ($gridLayoutStyle === 'style11' && $buttonStyle == null)
                  ? 'fpg-border' : $buttonStyle; 
        $buttonStyle12 = ($gridLayoutStyle === 'style12' && $buttonStyle == null)
                  ? 'fpg-filled' : $buttonStyle;  
        $targetAttr = ($postLinkTarget === 'newWindow') ? ' target="_blank"' : ' target="_self"';           
        // Run the query
        $query = new WP_Query($query_args);
        
        if (!$query->have_posts()) {
            return '<p>' . esc_html__('No posts found.', 'fancy-post-grid') . '</p>';
        }
        if ($gridLayoutStyle === 'style1') {
            $output = '<div class="fpg-blog-layout-5 ' . esc_attr($gridLayoutStyle) . '" style="display: grid; grid-template-columns: repeat(' . esc_attr($gridColumns1) . ', 1fr); ';
            
            // Background Color
            if (!empty($sectionBgColor)) {
                $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
            }
            // GAP
            if (!empty($itemGap)) {
                $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
            }
            // Margin
            if (
                isset($sectionMargin['top']) || 
                isset($sectionMargin['right']) || 
                isset($sectionMargin['bottom']) || 
                isset($sectionMargin['left'])
            ) {
                $output .= 'margin: ' .
                    (isset($sectionMargin['top']) ? (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) : '0px') . ' ' .
                    (isset($sectionMargin['right']) ? (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) : '0px') . ' ' .
                    (isset($sectionMargin['bottom']) ? (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) : '0px') . ' ' .
                    (isset($sectionMargin['left']) ? (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) : '0px') . '; ';
            }

            // Padding
            if (
                isset($sectionPadding['top']) ||
                isset($sectionPadding['right']) ||
                isset($sectionPadding['bottom']) ||
                isset($sectionPadding['left'])
            ) {
                $output .= 'padding: ' .
                    (isset($sectionPadding['top']) ? (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) : '0px') . ' ' .
                    (isset($sectionPadding['right']) ? (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) : '0px') . ' ' .
                    (isset($sectionPadding['bottom']) ? (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) : '0px') . ' ' .
                    (isset($sectionPadding['left']) ? (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) : '0px') . '; ';
            }

            $output .= '">';
        }else if ($gridLayoutStyle === 'style2') {
            $output = '<div class="fpg-blog-layout-6 grey ' . esc_attr($gridLayoutStyle) . '" style="display: grid; 
                        grid-template-columns: repeat(' . esc_attr($gridColumns2) . ', 1fr); ';
            
            // Background Color
            if (!empty($sectionBgColor)) {
                $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
            }
            // GAP
            if (!empty($itemGap)) {
                $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
            }    
            
            if (
                isset($sectionMargin['top']) || 
                isset($sectionMargin['right']) || 
                isset($sectionMargin['bottom']) || 
                isset($sectionMargin['left'])
            ) {
                $output .= 'margin: ' .
                    (isset($sectionMargin['top']) ? (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) : '0px') . ' ' .
                    (isset($sectionMargin['right']) ? (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) : '0px') . ' ' .
                    (isset($sectionMargin['bottom']) ? (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) : '0px') . ' ' .
                    (isset($sectionMargin['left']) ? (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) : '0px') . '; ';
            }

            // Padding
            if (
                isset($sectionPadding['top']) ||
                isset($sectionPadding['right']) ||
                isset($sectionPadding['bottom']) ||
                isset($sectionPadding['left'])
            ) {
                $output .= 'padding: ' .
                    (isset($sectionPadding['top']) ? (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) : '0px') . ' ' .
                    (isset($sectionPadding['right']) ? (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) : '0px') . ' ' .
                    (isset($sectionPadding['bottom']) ? (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) : '0px') . ' ' .
                    (isset($sectionPadding['left']) ? (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) : '0px') . '; ';
            }


            $output .= '">';
        }else if ($gridLayoutStyle === 'style3') {
            $output = '<div class="fpg-blog-layout-28  ' . esc_attr($gridLayoutStyle) . '" style="display: grid; 
                        grid-template-columns: repeat(' . esc_attr($gridColumns3) . ', 1fr); ';
            
            // Background Color
            if (!empty($sectionBgColor)) {
                $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
            }
            // GAP
            if (!empty($itemGap)) {
                $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
            }    
            if (
                isset($sectionMargin['top']) || 
                isset($sectionMargin['right']) || 
                isset($sectionMargin['bottom']) || 
                isset($sectionMargin['left'])
            ) {
                $output .= 'margin: ' .
                    (isset($sectionMargin['top']) ? (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) : '0px') . ' ' .
                    (isset($sectionMargin['right']) ? (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) : '0px') . ' ' .
                    (isset($sectionMargin['bottom']) ? (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) : '0px') . ' ' .
                    (isset($sectionMargin['left']) ? (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) : '0px') . '; ';
            }

            // Padding
            if (
                isset($sectionPadding['top']) ||
                isset($sectionPadding['right']) ||
                isset($sectionPadding['bottom']) ||
                isset($sectionPadding['left'])
            ) {
                $output .= 'padding: ' .
                    (isset($sectionPadding['top']) ? (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) : '0px') . ' ' .
                    (isset($sectionPadding['right']) ? (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) : '0px') . ' ' .
                    (isset($sectionPadding['bottom']) ? (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) : '0px') . ' ' .
                    (isset($sectionPadding['left']) ? (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) : '0px') . '; ';
            }

            $output .= '">';
        }else if ($gridLayoutStyle === 'style4') {
            $output = '<div class="fpg-blog-layout-30  ' . esc_attr($gridLayoutStyle) . '" style="display: grid; 
                        grid-template-columns: repeat(' . esc_attr($gridColumns4) . ', 1fr); ';
            
            // Background Color
            if (!empty($sectionBgColor)) {
                $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
            }
            // GAP
            if (!empty($itemGap)) {
                $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
            }    
            if (
                isset($sectionMargin['top']) || 
                isset($sectionMargin['right']) || 
                isset($sectionMargin['bottom']) || 
                isset($sectionMargin['left'])
            ) {
                $output .= 'margin: ' .
                    (isset($sectionMargin['top']) ? (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) : '0px') . ' ' .
                    (isset($sectionMargin['right']) ? (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) : '0px') . ' ' .
                    (isset($sectionMargin['bottom']) ? (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) : '0px') . ' ' .
                    (isset($sectionMargin['left']) ? (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) : '0px') . '; ';
            }

            // Padding
            if (
                isset($sectionPadding['top']) ||
                isset($sectionPadding['right']) ||
                isset($sectionPadding['bottom']) ||
                isset($sectionPadding['left'])
            ) {
                $output .= 'padding: ' .
                    (isset($sectionPadding['top']) ? (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) : '0px') . ' ' .
                    (isset($sectionPadding['right']) ? (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) : '0px') . ' ' .
                    (isset($sectionPadding['bottom']) ? (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) : '0px') . ' ' .
                    (isset($sectionPadding['left']) ? (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) : '0px') . '; ';
            }
            $output .= '">';
        }else if ($gridLayoutStyle === 'style5') {
            $output = '<div class="fpg-blog-layout-12 ' . esc_attr($gridLayoutStyle) . '" style="display: grid; 
                        grid-template-columns: repeat(' . esc_attr($gridColumns5) . ', 1fr); ';
            
            // Background Color
            if (!empty($sectionBgColor)) {
                $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
            }
            // GAP
            if (!empty($itemGap)) {
                $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
            }    
            if (
                isset($sectionMargin['top']) || 
                isset($sectionMargin['right']) || 
                isset($sectionMargin['bottom']) || 
                isset($sectionMargin['left'])
            ) {
                $output .= 'margin: ' .
                    (isset($sectionMargin['top']) ? (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) : '0px') . ' ' .
                    (isset($sectionMargin['right']) ? (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) : '0px') . ' ' .
                    (isset($sectionMargin['bottom']) ? (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) : '0px') . ' ' .
                    (isset($sectionMargin['left']) ? (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) : '0px') . '; ';
            }

            // Padding
            if (
                isset($sectionPadding['top']) ||
                isset($sectionPadding['right']) ||
                isset($sectionPadding['bottom']) ||
                isset($sectionPadding['left'])
            ) {
                $output .= 'padding: ' .
                    (isset($sectionPadding['top']) ? (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) : '0px') . ' ' .
                    (isset($sectionPadding['right']) ? (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) : '0px') . ' ' .
                    (isset($sectionPadding['bottom']) ? (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) : '0px') . ' ' .
                    (isset($sectionPadding['left']) ? (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) : '0px') . '; ';
            }
            $output .= '">';
        }else if ($gridLayoutStyle === 'style6') {
            $output = '<div class="fpg-blog-layout-13 ' . esc_attr($gridLayoutStyle) . '" style="display: grid; 
                        grid-template-columns: repeat(' . esc_attr($gridColumns6) . ', 1fr); ';
            
            // Background Color
            if (!empty($sectionBgColor)) {
                $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
            }
            // GAP
            if (!empty($itemGap)) {
                $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
            }    
            if (
                isset($sectionMargin['top']) || 
                isset($sectionMargin['right']) || 
                isset($sectionMargin['bottom']) || 
                isset($sectionMargin['left'])
            ) {
                $output .= 'margin: ' .
                    (isset($sectionMargin['top']) ? (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) : '0px') . ' ' .
                    (isset($sectionMargin['right']) ? (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) : '0px') . ' ' .
                    (isset($sectionMargin['bottom']) ? (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) : '0px') . ' ' .
                    (isset($sectionMargin['left']) ? (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) : '0px') . '; ';
            }

            // Padding
            if (
                isset($sectionPadding['top']) ||
                isset($sectionPadding['right']) ||
                isset($sectionPadding['bottom']) ||
                isset($sectionPadding['left'])
            ) {
                $output .= 'padding: ' .
                    (isset($sectionPadding['top']) ? (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) : '0px') . ' ' .
                    (isset($sectionPadding['right']) ? (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) : '0px') . ' ' .
                    (isset($sectionPadding['bottom']) ? (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) : '0px') . ' ' .
                    (isset($sectionPadding['left']) ? (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) : '0px') . '; ';
            }

            $output .= '">';
        }else if ($gridLayoutStyle === 'style7') {
            $output = '<div class="fpg-blog-layout-14  ' . esc_attr($gridLayoutStyle) . '" style="display: grid; 
                        grid-template-columns: repeat(' . esc_attr($gridColumns7) . ', 1fr); ';
            
            // Background Color
            if (!empty($sectionBgColor)) {
                $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
            }
            // GAP
            if (!empty($itemGap)) {
                $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
            }    
            if (
                isset($sectionMargin['top']) || 
                isset($sectionMargin['right']) || 
                isset($sectionMargin['bottom']) || 
                isset($sectionMargin['left'])
            ) {
                $output .= 'margin: ' .
                    (isset($sectionMargin['top']) ? (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) : '0px') . ' ' .
                    (isset($sectionMargin['right']) ? (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) : '0px') . ' ' .
                    (isset($sectionMargin['bottom']) ? (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) : '0px') . ' ' .
                    (isset($sectionMargin['left']) ? (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) : '0px') . '; ';
            }

            // Padding
            if (
                isset($sectionPadding['top']) ||
                isset($sectionPadding['right']) ||
                isset($sectionPadding['bottom']) ||
                isset($sectionPadding['left'])
            ) {
                $output .= 'padding: ' .
                    (isset($sectionPadding['top']) ? (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) : '0px') . ' ' .
                    (isset($sectionPadding['right']) ? (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) : '0px') . ' ' .
                    (isset($sectionPadding['bottom']) ? (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) : '0px') . ' ' .
                    (isset($sectionPadding['left']) ? (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) : '0px') . '; ';
            }

            $output .= '">';
        }else if ($gridLayoutStyle === 'style8') {
            $output = '<div class="fpg-blog-layout-15 ' . esc_attr($gridLayoutStyle) . '" style="display: grid; 
                        grid-template-columns: repeat(' . esc_attr($gridColumns8) . ', 1fr); ';
            
            // Background Color
            if (!empty($sectionBgColor)) {
                $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
            }
            // GAP
            if (!empty($itemGap)) {
                $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
            }    
            if (
                isset($sectionMargin['top']) || 
                isset($sectionMargin['right']) || 
                isset($sectionMargin['bottom']) || 
                isset($sectionMargin['left'])
            ) {
                $output .= 'margin: ' .
                    (isset($sectionMargin['top']) ? (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) : '0px') . ' ' .
                    (isset($sectionMargin['right']) ? (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) : '0px') . ' ' .
                    (isset($sectionMargin['bottom']) ? (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) : '0px') . ' ' .
                    (isset($sectionMargin['left']) ? (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) : '0px') . '; ';
            }

            // Padding
            if (
                isset($sectionPadding['top']) ||
                isset($sectionPadding['right']) ||
                isset($sectionPadding['bottom']) ||
                isset($sectionPadding['left'])
            ) {
                $output .= 'padding: ' .
                    (isset($sectionPadding['top']) ? (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) : '0px') . ' ' .
                    (isset($sectionPadding['right']) ? (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) : '0px') . ' ' .
                    (isset($sectionPadding['bottom']) ? (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) : '0px') . ' ' .
                    (isset($sectionPadding['left']) ? (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) : '0px') . '; ';
            }


            $output .= '">';
        }else if ($gridLayoutStyle === 'style9') {
            $output = '<div class="fpg-blog-layout-16 ' . esc_attr($gridLayoutStyle) . '" style="display: grid; 
                        grid-template-columns: repeat(' . esc_attr($gridColumns9) . ', 1fr); ';
            
            // Background Color
            if (!empty($sectionBgColor)) {
                $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
            }
            // GAP
            if (!empty($itemGap)) {
                $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
            }    
            if (
                isset($sectionMargin['top']) || 
                isset($sectionMargin['right']) || 
                isset($sectionMargin['bottom']) || 
                isset($sectionMargin['left'])
            ) {
                $output .= 'margin: ' .
                    (isset($sectionMargin['top']) ? (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) : '0px') . ' ' .
                    (isset($sectionMargin['right']) ? (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) : '0px') . ' ' .
                    (isset($sectionMargin['bottom']) ? (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) : '0px') . ' ' .
                    (isset($sectionMargin['left']) ? (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) : '0px') . '; ';
            }

            // Padding
            if (
                isset($sectionPadding['top']) ||
                isset($sectionPadding['right']) ||
                isset($sectionPadding['bottom']) ||
                isset($sectionPadding['left'])
            ) {
                $output .= 'padding: ' .
                    (isset($sectionPadding['top']) ? (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) : '0px') . ' ' .
                    (isset($sectionPadding['right']) ? (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) : '0px') . ' ' .
                    (isset($sectionPadding['bottom']) ? (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) : '0px') . ' ' .
                    (isset($sectionPadding['left']) ? (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) : '0px') . '; ';
            }
            $output .= '">';
        }else if ($gridLayoutStyle === 'style10') {
            $output = '<div class="fpg-blog-layout-19 ' . esc_attr($gridLayoutStyle) . '" style="display: grid; 
                        grid-template-columns: repeat(' . esc_attr($gridColumns10) . ', 1fr); ';
            
            // Background Color
            if (!empty($sectionBgColor)) {
                $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
            }
            // GAP
            if (!empty($itemGap)) {
                $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
            }    
            if (
                isset($sectionMargin['top']) || 
                isset($sectionMargin['right']) || 
                isset($sectionMargin['bottom']) || 
                isset($sectionMargin['left'])
            ) {
                $output .= 'margin: ' .
                    (isset($sectionMargin['top']) ? (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) : '0px') . ' ' .
                    (isset($sectionMargin['right']) ? (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) : '0px') . ' ' .
                    (isset($sectionMargin['bottom']) ? (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) : '0px') . ' ' .
                    (isset($sectionMargin['left']) ? (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) : '0px') . '; ';
            }

            // Padding
            if (
                isset($sectionPadding['top']) ||
                isset($sectionPadding['right']) ||
                isset($sectionPadding['bottom']) ||
                isset($sectionPadding['left'])
            ) {
                $output .= 'padding: ' .
                    (isset($sectionPadding['top']) ? (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) : '0px') . ' ' .
                    (isset($sectionPadding['right']) ? (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) : '0px') . ' ' .
                    (isset($sectionPadding['bottom']) ? (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) : '0px') . ' ' .
                    (isset($sectionPadding['left']) ? (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) : '0px') . '; ';
            }
            $output .= '">';
        }else if ($gridLayoutStyle === 'style11') {
            $output = '<div class="fpg-blog-layout-21  ' . esc_attr($gridLayoutStyle) . '" style="display: grid; 
                        grid-template-columns: repeat(' . esc_attr($gridColumns11) . ', 1fr); ';
            
            // Background Color
            if (!empty($sectionBgColor)) {
                $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
            }
            // GAP
            if (!empty($itemGap)) {
                $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
            }    
            if (
                isset($sectionMargin['top']) || 
                isset($sectionMargin['right']) || 
                isset($sectionMargin['bottom']) || 
                isset($sectionMargin['left'])
            ) {
                $output .= 'margin: ' .
                    (isset($sectionMargin['top']) ? (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) : '0px') . ' ' .
                    (isset($sectionMargin['right']) ? (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) : '0px') . ' ' .
                    (isset($sectionMargin['bottom']) ? (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) : '0px') . ' ' .
                    (isset($sectionMargin['left']) ? (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) : '0px') . '; ';
            }

            // Padding
            if (
                isset($sectionPadding['top']) ||
                isset($sectionPadding['right']) ||
                isset($sectionPadding['bottom']) ||
                isset($sectionPadding['left'])
            ) {
                $output .= 'padding: ' .
                    (isset($sectionPadding['top']) ? (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) : '0px') . ' ' .
                    (isset($sectionPadding['right']) ? (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) : '0px') . ' ' .
                    (isset($sectionPadding['bottom']) ? (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) : '0px') . ' ' .
                    (isset($sectionPadding['left']) ? (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) : '0px') . '; ';
            }
            $output .= '">';
        }else if ($gridLayoutStyle === 'style12') {
            $output = '<div class="fpg-blog-layout-26  ' . esc_attr($gridLayoutStyle) . '" style="display: grid; 
                        grid-template-columns: repeat(' . esc_attr($gridColumns12) . ', 1fr); ';
            
            // Background Color
            if (!empty($sectionBgColor)) {
                $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
            }
            // GAP
            if (!empty($itemGap)) {
                $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
            }    
            if (
                isset($sectionMargin['top']) || 
                isset($sectionMargin['right']) || 
                isset($sectionMargin['bottom']) || 
                isset($sectionMargin['left'])
            ) {
                $output .= 'margin: ' .
                    (isset($sectionMargin['top']) ? (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) : '0px') . ' ' .
                    (isset($sectionMargin['right']) ? (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) : '0px') . ' ' .
                    (isset($sectionMargin['bottom']) ? (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) : '0px') . ' ' .
                    (isset($sectionMargin['left']) ? (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) : '0px') . '; ';
            }

            // Padding
            if (
                isset($sectionPadding['top']) ||
                isset($sectionPadding['right']) ||
                isset($sectionPadding['bottom']) ||
                isset($sectionPadding['left'])
            ) {
                $output .= 'padding: ' .
                    (isset($sectionPadding['top']) ? (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) : '0px') . ' ' .
                    (isset($sectionPadding['right']) ? (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) : '0px') . ' ' .
                    (isset($sectionPadding['bottom']) ? (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) : '0px') . ' ' .
                    (isset($sectionPadding['left']) ? (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) : '0px') . '; ';
            }
            
            $output .= '">';
        }    
            while ($query->have_posts()) {
                $query->the_post();
                $post_id = get_the_ID();
                $permalink = get_permalink($post_id);
                $title = get_the_title();
                $date = get_the_date();
                $getdate = get_the_date('M j, Y', $post_id);
                $author = get_the_author();
                $categories = get_the_category_list(', ');
                $tags = get_the_tag_list('', ', ');
                $comments_count = get_comments_number();
                if ($gridLayoutStyle === 'style1') {
                $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize1, ['class' => 'fancy-post-thumbnail']);}
                if ($gridLayoutStyle === 'style2') {
                $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize2, ['class' => 'fancy-post-thumbnail']);}
                if ($gridLayoutStyle === 'style3') {
                $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize3, ['class' => 'fancy-post-thumbnail']);}
                if ($gridLayoutStyle === 'style4') {
                $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize4, ['class' => 'fancy-post-thumbnail']);}
                if ($gridLayoutStyle === 'style5') {
                $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize5, ['class' => 'fancy-post-thumbnail']);}
                if ($gridLayoutStyle === 'style6') {
                $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize6, ['class' => 'fancy-post-thumbnail']);}
                if ($gridLayoutStyle === 'style7') {
                $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize7, ['class' => 'fancy-post-thumbnail']);}
                if ($gridLayoutStyle === 'style8') {
                $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize8, ['class' => 'fancy-post-thumbnail']);}
                if ($gridLayoutStyle === 'style9') {
                $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize9, ['class' => 'fancy-post-thumbnail']);}
                if ($gridLayoutStyle === 'style10') {
                $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize10, ['class' => 'fancy-post-thumbnail']);}
                if ($gridLayoutStyle === 'style11') {
                $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize11, ['class' => 'fancy-post-thumbnail']);}
                if ($gridLayoutStyle === 'style12') {
                $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize12, ['class' => 'fancy-post-thumbnail']);}

                // Title Crop
                if ($titleCropBy === 'word') {
                    $titleArray = explode(' ', $title);
                    $croppedTitle = implode(' ', array_slice($titleArray, 0, (int) $titleLength));
                } elseif ($titleCropBy === 'cha') {
                    $croppedTitle = mb_substr($title, 0, $titleLength);
                } else {
                    $croppedTitle = $title; // fallback
                }
                // Fetch full content when 'full_content' is selected
                if ($excerptType === 'full_content') {
                    $excerpt = apply_filters('the_content', get_the_content());
                } elseif ($excerptType === 'word') {
                    $excerpt = wp_trim_words(get_the_excerpt(), $excerptLimit, $excerptIndicator);
                } else { // 'character'
                    $excerpt = mb_substr(get_the_excerpt(), 0, $excerptLimit) . $excerptIndicator;
                }
                
                // Style-based output
                if ($gridLayoutStyle === 'style1') {
                    // Full post layout
                    $borderStyles = '.fpg-blog-layout-5 .fpg-blog__single .fpg-content .fpg-link.fpg-border::before {';
                    
                    $borderStyles .= 'background: ' . (!empty($buttonHoverTextColor) ? esc_attr($buttonHoverTextColor) : '#332FFF') . ';';
                    
                    $borderStyles .= '}';
                    $output .= '<style>' . $borderStyles . '</style>';

                    $output .= '<div class="fpg-blog__single align-' . $itemBoxAlignment1 . ' ' . $hoverAnimation . ' ' . $postLinkType . '" style="';
                        // MARGIN    
                        if (isset($itemMargin['top']) || isset($itemMargin['right']) || isset($itemMargin['bottom']) || isset($itemMargin['left'])) {
                            $output .= 'margin: ' .
                                (isset($itemMargin['top']) ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' .
                                (isset($itemMargin['right']) ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' .
                                (isset($itemMargin['bottom']) ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' .
                                (isset($itemMargin['left']) ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; ';
                        }

                        // PADDING
                        if (isset($itemPadding['top']) || isset($itemPadding['right']) || isset($itemPadding['bottom']) || isset($itemPadding['left'])) {
                            $output .= 'padding: ' .
                                (isset($itemPadding['top']) ? (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) : '0px') . ' ' .
                                (isset($itemPadding['right']) ? (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) : '0px') . ' ' .
                                (isset($itemPadding['bottom']) ? (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) : '0px') . ' ' .
                                (isset($itemPadding['left']) ? (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) : '0px') . '; ';
                        }

                        // BORDER RADIUS
                        if (isset($itemBorderRadius['top']) || isset($itemBorderRadius['right']) || isset($itemBorderRadius['bottom']) || isset($itemBorderRadius['left'])) {
                            $output .= 'border-radius: ' .
                                (isset($itemBorderRadius['top']) ? (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) : '0px') . ' ' .
                                (isset($itemBorderRadius['right']) ? (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) : '0px') . ' ' .
                                (isset($itemBorderRadius['bottom']) ? (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) : '0px') . ' ' .
                                (isset($itemBorderRadius['left']) ? (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) : '0px') . '; ';
                        }

                        // BORDER WIDTH
                        if (isset($itemBorderWidth['top']) || isset($itemBorderWidth['right']) || isset($itemBorderWidth['bottom']) || isset($itemBorderWidth['left'])) {
                            $output .= 'border-width: ' .
                                (isset($itemBorderWidth['top']) ? (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) : '0px') . ' ' .
                                (isset($itemBorderWidth['right']) ? (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) : '0px') . ' ' .
                                (isset($itemBorderWidth['bottom']) ? (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) : '0px') . ' ' .
                                (isset($itemBorderWidth['left']) ? (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) : '0px') . '; ';
                        }
     
                        // Border Style & Color
                        if (isset($itemBorderType)) {
                            $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                        }
                        if (!empty($itemBorderColor)) {
                            $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                        }

                        // Background Color
                        if (!empty($itemBackgroundColor)) {
                            $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                        }

                        // Box Shadow
                        if (
                            isset($itemBoxShadow['left']) ||  // horizontal offset
                            isset($itemBoxShadow['top']) ||  // vertical offset
                            isset($itemBoxShadow['right']) ||  // blur radius
                            isset($itemBoxShadow['bottom']) ||  // spread radius
                            isset($itemBoxShadowColor)
                        ) {
                            $output .= 'box-shadow: ' .
                                (isset($itemBoxShadow['left']) ? (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) : '0px') . ' ' .
                                (isset($itemBoxShadow['top']) ? (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) : '0px') . ' ' .
                                (isset($itemBoxShadow['right']) ? (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) : '0px') . ' ' .
                                (isset($itemBoxShadow['bottom']) ? (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) : '0px') . ' ' .
                                (!empty($itemBoxShadowColor) ? esc_attr($itemBoxShadowColor) : 'rgba(0,0,0,0.1)') . '; ';
                        }

                    $output .= '">';

                    // Thumbnail
                    if ($thumbnail && $showThumbnail) {
                        $output .= '<div class="fpg-thumb" style="';

                        // MARGIN
                        if (
                            isset($thumbnailMargin['top']) ||
                            isset($thumbnailMargin['right']) ||
                            isset($thumbnailMargin['bottom']) ||
                            isset($thumbnailMargin['left'])
                        ) {
                            $output .= 'margin: ' .
                                (isset($thumbnailMargin['top']) ? (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) : '0px') . ' ' .
                                (isset($thumbnailMargin['right']) ? (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) : '0px') . ' ' .
                                (isset($thumbnailMargin['bottom']) ? (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) : '0px') . ' ' .
                                (isset($thumbnailMargin['left']) ? (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) : '0px') . '; ';
                        }

                        // PADDING
                        if (
                            isset($thumbnailPadding['top']) ||
                            isset($thumbnailPadding['right']) ||
                            isset($thumbnailPadding['bottom']) ||
                            isset($thumbnailPadding['left'])
                        ) {
                            $output .= 'padding: ' .
                                (isset($thumbnailPadding['top']) ? (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) : '0px') . ' ' .
                                (isset($thumbnailPadding['right']) ? (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) : '0px') . ' ' .
                                (isset($thumbnailPadding['bottom']) ? (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) : '0px') . ' ' .
                                (isset($thumbnailPadding['left']) ? (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) : '0px') . '; ';
                        }

                        // BORDER RADIUS
                        if (
                            isset($thumbnailBorderRadius['top']) ||
                            isset($thumbnailBorderRadius['right']) ||
                            isset($thumbnailBorderRadius['bottom']) ||
                            isset($thumbnailBorderRadius['left'])
                        ) {
                            $output .= 'border-radius: ' .
                                (isset($thumbnailBorderRadius['top']) ? (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) : '0px') . ' ' .
                                (isset($thumbnailBorderRadius['right']) ? (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) : '0px') . ' ' .
                                (isset($thumbnailBorderRadius['bottom']) ? (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) : '0px') . ' ' .
                                (isset($thumbnailBorderRadius['left']) ? (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) : '0px') . '; ';
                        }

                        $output .= '">';

                        // Anchor with optional border-radius and overflow
                        if ($thumbnailLink) {
                            $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '>';
                            $output .= $thumbnail;
                            $output .= '</a>';
                        } else {
                            $output .= $thumbnail;
                        }
                        $output .= '</div>';
                    }
                    // END Thumbnail

                    // MAIN Content
                    $output .= '<div class="fpg-content" style="';
                        // MARGIN
                        if (
                            isset($contentitemMarginNew['top']) ||
                            isset($contentitemMarginNew['right']) ||
                            isset($contentitemMarginNew['bottom']) ||
                            isset($contentitemMarginNew['left'])
                        ) {
                            $output .= 'margin: ' .
                                (isset($contentitemMarginNew['top']) ? (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) : '0px') . ' ' .
                                (isset($contentitemMarginNew['right']) ? (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) : '0px') . ' ' .
                                (isset($contentitemMarginNew['bottom']) ? (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) : '0px') . ' ' .
                                (isset($contentitemMarginNew['left']) ? (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) : '0px') . '; ';
                        }

                        // PADDING
                        if (
                            isset($contentitemPaddingNew['top']) ||
                            isset($contentitemPaddingNew['right']) ||
                            isset($contentitemPaddingNew['bottom']) ||
                            isset($contentitemPaddingNew['left'])
                        ) {
                            $output .= 'padding: ' .
                                (isset($contentitemPaddingNew['top']) ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' .
                                (isset($contentitemPaddingNew['right']) ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' .
                                (isset($contentitemPaddingNew['bottom']) ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' .
                                (isset($contentitemPaddingNew['left']) ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; ';
                        }

                        // BORDER WIDTH
                        if (
                            isset($contentBorderWidth['top']) ||
                            isset($contentBorderWidth['right']) ||
                            isset($contentBorderWidth['bottom']) ||
                            isset($contentBorderWidth['left'])
                        ) {
                            $output .= 'border-width: ' .
                                (isset($contentBorderWidth['top']) ? (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) : '0px') . ' ' .
                                (isset($contentBorderWidth['right']) ? (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) : '0px') . ' ' .
                                (isset($contentBorderWidth['bottom']) ? (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) : '0px') . ' ' .
                                (isset($contentBorderWidth['left']) ? (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) : '0px') . '; ';
                        }
                        // BORDER radius
                        if (
                            isset($contentitemRadius['top']) ||
                            isset($contentitemRadius['right']) ||
                            isset($contentitemRadius['bottom']) ||
                            isset($contentitemRadius['left'])
                        ) {
                            $output .= 'border-radius: ' .
                                (isset($contentitemRadius['top']) ? (is_numeric($contentitemRadius['top']) ? $contentitemRadius['top'] . 'px' : esc_attr($contentitemRadius['top'])) : '0px') . ' ' .
                                (isset($contentitemRadius['right']) ? (is_numeric($contentitemRadius['right']) ? $contentitemRadius['right'] . 'px' : esc_attr($contentitemRadius['right'])) : '0px') . ' ' .
                                (isset($contentitemRadius['bottom']) ? (is_numeric($contentitemRadius['bottom']) ? $contentitemRadius['bottom'] . 'px' : esc_attr($contentitemRadius['bottom'])) : '0px') . ' ' .
                                (isset($contentitemRadius['left']) ? (is_numeric($contentitemRadius['left']) ? $contentitemRadius['left'] . 'px' : esc_attr($contentitemRadius['left'])) : '0px') . '; ';
                        }

                        // Border Style
                        if (!empty($contentNormalBorderType)) {
                            $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                        }
                        // Background Color
                        if (!empty($contentBgColor)) {
                            $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                        }
                        // Border Color
                        if (!empty($contentBorderColor)) {
                            $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                        }
                    $output .= '">';

                    // Meta Data
                    if ($showMetaData) {
                        $output .= '<ul class="meta-data-list align-' . $metaAlignment . ' " style="';  
                            // MARGIN
                            if (
                                isset($metaMarginNew['top']) ||
                                isset($metaMarginNew['right']) ||
                                isset($metaMarginNew['bottom']) ||
                                isset($metaMarginNew['left'])
                            ) {
                                $output .= 'margin: ' .
                                    (isset($metaMarginNew['top']) ? (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) : '0px') . ' ' .
                                    (isset($metaMarginNew['right']) ? (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) : '0px') . ' ' .
                                    (isset($metaMarginNew['bottom']) ? (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) : '0px') . ' ' .
                                    (isset($metaMarginNew['left']) ? (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) : '0px') . '; ';
                            }

                            // PADDING
                            if (
                                isset($metaPadding['top']) ||
                                isset($metaPadding['right']) ||
                                isset($metaPadding['bottom']) ||
                                isset($metaPadding['left'])
                            ) {
                                $output .= 'padding: ' .
                                    (isset($metaPadding['top']) ? (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) : '0px') . ' ' .
                                    (isset($metaPadding['right']) ? (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) : '0px') . ' ' .
                                    (isset($metaPadding['bottom']) ? (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) : '0px') . ' ' .
                                    (isset($metaPadding['left']) ? (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) : '0px') . '; ';
                            }

                            // Color
                            if (!empty($metaTextColor)) {
                                $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                            }
                            // Order
                            if (!empty($metaOrder)) {
                                $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                            }
                        $output .= '">';

                        $meta_items = [];

                        // Date
                        if ($showPostDate) {
                            $meta = '<li class="meta-date" style="';

                            // Color
                            if (!empty($metaTextColor)) {
                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                            }

                            // Font size
                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '">';

                            // Icon
                            if ($showPostDateIcon && $showMetaIcon) {
                                $meta .= '<i class="fas fa-calendar-alt" style="';

                                if (!empty($metaIconColor)) {
                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                }

                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $meta .= '"></i> ';
                            }

                            $meta .= esc_html($getdate) . '</li>';
                            $meta_items[] = $meta;
                        }
                        // Author
                        if ($showPostAuthor) {
                            $meta = '<li class="meta-author" style="';

                            if (!empty($metaTextColor)) {
                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '">';

                            if ($showPostAuthorIcon && $showMetaIcon) {
                                $meta .= '<i class="fas fa-user" style="';

                                if (!empty($metaIconColor)) {
                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                }

                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $meta .= '"></i> ';
                            }

                            $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                            $meta_items[] = $meta;
                        }
                        // Category
                        if ($showPostCategory) {
                            $meta = '<li class="meta-categories" style="';

                            if (!empty($metaTextColor)) {
                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '">';

                            if ($showPostCategoryIcon && $showMetaIcon) {
                                $meta .= '<i class="fas fa-folder" style="';

                                if (!empty($metaIconColor)) {
                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                }

                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $meta .= '"></i> ';
                            }

                            // Get category names without links
                            $categories_list = get_the_category($post_id);
                            if (!empty($categories_list)) {
                                $category_names = array();
                                foreach ($categories_list as $category) {
                                    $category_names[] = esc_html($category->name);
                                }
                                $meta .= implode(', ', $category_names); // comma-separated plain text categories
                            }

                            $meta .= '</li>';
                            $meta_items[] = $meta;
                        }
                        // Tags
                        if ($showPostTags && !empty($tags)) {
                            $meta = '<li class="meta-tags" style="';

                            if (!empty($metaTextColor)) {
                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '">';

                            if ($showPostTagsIcon && $showMetaIcon) {
                                $meta .= '<i class="fas fa-tags" style="';

                                if (!empty($metaIconColor)) {
                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                }

                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $meta .= '"></i> ';
                            }

                            $meta .= esc_html__('Tags:', 'fancy-post-grid') . ' ' . $tags . '</li>';
                            $meta_items[] = $meta;
                        }
                        // Comment Count
                        if ($showPostCommentsCount) {
                            $meta = '<li class="meta-comment-count" style="';
                            if (!empty($metaTextColor)) {
                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                            }
                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '">';

                            if ($showPostCommentsCountIcon && $showMetaIcon) {
                                $meta .= '<i class="fas fa-comments" style="';
                                if (!empty($metaIconColor)) {
                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                }
                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }
                                $meta .= '"></i> ';
                            }

                            $meta .= esc_html($comments_count) . ' ' . esc_html__('Comments', 'fancy-post-grid') . '</li>';
                            $meta_items[] = $meta;
                        }
                        // Now join meta items with the separator
                        if (!empty($meta_items)) {
                            $separator = '';

                            if ($metaSeperator !== '') {
                                $separator = '';
                                if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                    $separatorStyle = '';
                                    if (!empty($separatorColor)) {
                                        $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                    }
                                    if (!empty($metaFontSize)) {
                                        $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                                }
                            }

                            $output .= implode($separator, $meta_items);
                        }
                        $output .= '</ul>'; // Close meta-data-list               
                    }
                    // End Meta Data

                    // title
                    if ($showPostTitle) {
                        $titleStyles = '';

                        // Order
                        if (!empty($titleOrder)) {
                            $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                        }

                        // Background color
                        if (!empty($postTitleBgColor)) {
                            $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                        }

                        // Margin
                        if (isset($postTitleMargin['top']) || isset($postTitleMargin['right']) || isset($postTitleMargin['bottom']) || isset($postTitleMargin['left'])) {
                            $titleStyles .= 'margin: ' .
                                (isset($postTitleMargin['top']) ? (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) : '0px') . ' ' .
                                (isset($postTitleMargin['right']) ? (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) : '0px') . ' ' .
                                (isset($postTitleMargin['bottom']) ? (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) : '0px') . ' ' .
                                (isset($postTitleMargin['left']) ? (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) : '0px') . '; ';
                        }

                        // Padding
                        if (isset($postTitlePadding['top']) || isset($postTitlePadding['right']) || isset($postTitlePadding['bottom']) || isset($postTitlePadding['left'])) {
                            $titleStyles .= 'padding: ' .
                                (isset($postTitlePadding['top']) ? (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) : '0px') . ' ' .
                                (isset($postTitlePadding['right']) ? (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) : '0px') . ' ' .
                                (isset($postTitlePadding['bottom']) ? (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) : '0px') . ' ' .
                                (isset($postTitlePadding['left']) ? (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) : '0px') . '; ';
                        }

                        // Determine if underline should be shown
                        $showUnderline = $postLinkType === 'yeslink' && $titleHoverUnderLine === 'enable';

                        // Class name
                        $classNames = 'title align-' . esc_attr($postTitleAlignment);
                        if ($showUnderline) {
                            $classNames .= ' underline';
                        }

                        // Hover/Out events for nolink
                        $onmouseover = '';
                        $onmouseout  = '';

                        if (!empty($postTitleHoverBgColor)) {
                            $onmouseover .= 'this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';';
                        }

                        if (!empty($postTitleHoverColor)) {
                            $onmouseover .= ' this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                        }

                        if (!empty($postTitleBgColor)) {
                            $onmouseout .= 'this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';';
                        } else {
                            $onmouseout .= 'this.style.removeProperty(\'background-color\');';
                        }

                        if (!empty($postTitleColor)) {
                            $onmouseout .= ' this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                        } else {
                            $onmouseout .= ' this.style.removeProperty(\'color\');';
                        }

                        // Opening title tag
                        $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"'
                            . (!empty($onmouseover) ? ' onmouseover="' . trim($onmouseover) . '"' : '')
                            . (!empty($onmouseout)  ? ' onmouseout="'  . trim($onmouseout)  . '"' : '') . '>';

                        if ($postLinkType === 'yeslink') {
                            // Anchor styles
                            $style = '';
                            $hoverStyle = '';
                            $mouseoutStyle = '';

                            if (!empty($postTitleFontSize)) {
                                $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                            }

                            if (!empty($postTitleLineHeight)) {
                                $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                            }

                            if (!empty($postTitleLetterSpacing)) {
                                $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                            }

                            if (!empty($postTitleFontWeight)) {
                                $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                            }

                            if (!empty($postTitleColor)) {
                                $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                $mouseoutStyle .= 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                            } else {
                                $mouseoutStyle .= 'this.style.color=\'\';';
                            }

                            if (!empty($postTitleHoverColor)) {
                                $hoverStyle .= 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                            }

                            if ($showUnderline && !empty($postTitleHoverColor)) {
                                $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                                $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                $hoverStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                            }

                            if ($showUnderline && empty($postTitleColor ) && !empty($postTitleColor )) {
                                $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                                $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                $mouseoutStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                            } else {
                                // $mouseoutStyle .= ' this.style.removeProperty(\'background-image\');';
                                $mouseoutStyle .= ' this.style.removeProperty(\'background-position\');';
                                $mouseoutStyle .= ' this.style.removeProperty(\'background-size\');';
                            }

                            $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '
                                style="' . esc_attr(trim($style)) . '"'
                                . (!empty($hoverStyle)   ? ' onmouseover="' . $hoverStyle . '"' : '')
                                . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                . esc_html($croppedTitle) . '</a>';
                        } else {
                            // No link  render span with inline styles
                            $inlineStyle = '';
                            if (!empty($postTitleFontSize)) {
                                $inlineStyle .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                            }
                            if (!empty($postTitleLineHeight)) {
                                $inlineStyle .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                            }
                            if (!empty($postTitleLetterSpacing)) {
                                $inlineStyle .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                            }
                            if (!empty($postTitleFontWeight)) {
                                $inlineStyle .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                            }
                            if (!empty($postTitleColor)) {
                                $inlineStyle .= 'color: ' . esc_attr($postTitleColor) . '; ';
                            }

                            $output .= '<span style="' . esc_attr(trim($inlineStyle)) . '">' . esc_html($croppedTitle) . '</span>';
                        }

                        $output .= '</' . esc_attr($titleTag) . '>';
                    }

                    // Excerpt
                    if ($showPostExcerpt) {
                        $excerptStyles = '';
                        $excerptColorStyles = '';

                        // Order
                        if (!empty($excerptOrder)) {
                            $excerptStyles .= 'order: ' . esc_attr($excerptOrder) . '; ';
                        }

                        // Typography
                        if (!empty($excerptFontSize)) {
                            $excerptStyles .= 'font-size: ' . esc_attr($excerptFontSize) . 'px; ';
                        }

                        if (!empty($excerptLineHeight)) {
                            $excerptStyles .= 'line-height: ' . esc_attr($excerptLineHeight) . '; ';
                        }

                        if (!empty($excerptLetterSpacing)) {
                            $excerptStyles .= 'letter-spacing: ' . esc_attr($excerptLetterSpacing) . 'px; ';
                        }

                        if (!empty($excerptFontWeight)) {
                            $excerptStyles .= 'font-weight: ' . esc_attr($excerptFontWeight) . '; ';
                        }

                        if (!empty($excerptColor)) {
                            $excerptColorStyles .= 'color: ' . esc_attr($excerptColor) . '; ';
                        }

                        if (!empty($excerptBgColor)) {
                            $excerptColorStyles .= 'background-color: ' . esc_attr($excerptBgColor) . '; ';
                        }

                        if (!empty($excerptBorderType)) {
                            $excerptStyles .= 'border-style: ' . esc_attr($excerptBorderType) . '; ';
                        }

                        // Margin
                        if (isset($excerptMargin['top']) || isset($excerptMargin['right']) || isset($excerptMargin['bottom']) || isset($excerptMargin['left'])) {
                            $excerptStyles .= 'margin: ' .
                                (isset($excerptMargin['top']) ? (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) : '0px') . ' ' .
                                (isset($excerptMargin['right']) ? (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) : '0px') . ' ' .
                                (isset($excerptMargin['bottom']) ? (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) : '0px') . ' ' .
                                (isset($excerptMargin['left']) ? (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) : '0px') . '; ';
                        }

                        // Padding
                        if (isset($excerptPadding['top']) || isset($excerptPadding['right']) || isset($excerptPadding['bottom']) || isset($excerptPadding['left'])) {
                            $excerptStyles .= 'padding: ' .
                                (isset($excerptPadding['top']) ? (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) : '0px') . ' ' .
                                (isset($excerptPadding['right']) ? (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) : '0px') . ' ' .
                                (isset($excerptPadding['bottom']) ? (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) : '0px') . ' ' .
                                (isset($excerptPadding['left']) ? (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) : '0px') . '; ';
                        }

                        // Handle hover logic conditionally
                        $hoverIn = '';
                        $hoverOut = '';

                        if (!empty($excerptHoverColor)) {
                            $hoverIn .= 'this.style.color=\'' . esc_attr($excerptHoverColor) . '\';';
                            $hoverOut .= 'this.style.color=\'' . esc_attr($excerptColor) . '\';';
                        }

                        if (!empty($excerptHoverBgColor)) {
                            $hoverIn .= 'this.style.backgroundColor=\'' . esc_attr($excerptHoverBgColor) . '\';';
                            $hoverOut .= 'this.style.backgroundColor=\'' . esc_attr($excerptBgColor) . '\';';
                        }

                        $output .= '<div class="fpg-excerpt' . ' align-' . esc_attr($excerptAlignment) . '" style="' . esc_attr(trim($excerptStyles)) . '"';

                        $output .= '>';
                        $output .= '<p style="' . esc_attr(trim($excerptColorStyles)) . '"';

                            if (!empty($hoverIn) || !empty($hoverOut)) {
                                if (!empty($hoverIn)) {
                                    $output .= ' onmouseover="' . esc_attr($hoverIn) . '"';
                                }
                                if (!empty($hoverOut)) {
                                    $output .= ' onmouseout="' . esc_attr($hoverOut) . '"';
                                }
                            }

                            $output .= '>' . esc_html($excerpt) . '</p>';
                        $output .= '</div>';
                    }
                    // End Excerpt

                    // Button Output                
                    if ($showReadMoreButton) {
                        // Button wrapper styles
                        $buttonWrapperStyle = '';

                        if (
                            isset($buttonMarginNew['top']) || 
                            isset($buttonMarginNew['right']) || 
                            isset($buttonMarginNew['bottom']) || 
                            isset($buttonMarginNew['left'])
                        ) {
                            $buttonWrapperStyle .= 'margin: ' .
                                (isset($buttonMarginNew['top']) ? (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) : '0px') . ' ' .
                                (isset($buttonMarginNew['right']) ? (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) : '0px') . ' ' .
                                (isset($buttonMarginNew['bottom']) ? (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) : '0px') . ' ' .
                                (isset($buttonMarginNew['left']) ? (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) : '0px') . '; ';
                        }

                        // Order
                        if (!empty($buttonOrder)) {
                            $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                        }

                        $output .= '<div class="btn-wrapper align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';

                        // Button inline styles
                        $buttonInlineStyles = '';

                        if (!empty($buttonTextColor)) {
                            $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                        }
                        if (!empty($buttonBackgroundColor)) {
                            $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                        }
                        
                        if (!empty($buttonFontSize)) {
                            $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                        }
                        if (!empty($buttonFontWeight)) {
                            $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                        }
                        if (!empty($buttonBorderColor)) {
                            $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                        }
                        if (!empty($buttonBorderType)) {
                            $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                        }
                        
                        // Border Width
                        if (
                            isset($buttonBorderWidth['top']) || 
                            isset($buttonBorderWidth['right']) || 
                            isset($buttonBorderWidth['bottom']) || 
                            isset($buttonBorderWidth['left'])
                        ) {
                            $buttonInlineStyles .= 'border-width: ' .
                                (isset($buttonBorderWidth['top']) ? (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) : '0px') . ' ' .
                                (isset($buttonBorderWidth['right']) ? (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) : '0px') . ' ' .
                                (isset($buttonBorderWidth['bottom']) ? (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) : '0px') . ' ' .
                                (isset($buttonBorderWidth['left']) ? (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) : '0px') . '; ';
                        }

                        // Border Radius
                        if (
                            isset($buttonBorderRadius['top']) || 
                            isset($buttonBorderRadius['right']) || 
                            isset($buttonBorderRadius['bottom']) || 
                            isset($buttonBorderRadius['left'])
                        ) {
                            $buttonInlineStyles .= 'border-radius: ' .
                                (isset($buttonBorderRadius['top']) ? (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) : '0px') . ' ' .
                                (isset($buttonBorderRadius['right']) ? (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) : '0px') . ' ' .
                                (isset($buttonBorderRadius['bottom']) ? (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) : '0px') . ' ' .
                                (isset($buttonBorderRadius['left']) ? (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) : '0px') . '; ';
                        }

                        // Padding
                        if (
                            isset($buttonPaddingNew['top']) || 
                            isset($buttonPaddingNew['right']) || 
                            isset($buttonPaddingNew['bottom']) || 
                            isset($buttonPaddingNew['left'])
                        ) {
                            $buttonInlineStyles .= 'padding: ' .
                                (isset($buttonPaddingNew['top']) ? (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) : '0px') . ' ' .
                                (isset($buttonPaddingNew['right']) ? (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) : '0px') . ' ' .
                                (isset($buttonPaddingNew['bottom']) ? (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) : '0px') . ' ' .
                                (isset($buttonPaddingNew['left']) ? (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) : '0px') . '; ';
                        }          

                        // Hover styles
                        $buttonHoverInlineStyles = '';
                        $buttonResetStyles = '';

                        if (!empty($buttonHoverTextColor)) {
                            $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                            $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                        }
                        if (!empty($buttonHoverBorderColor)) {
                            $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                            $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                        }
                        if (!empty($buttonHoverBackgroundColor)) {
                            $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                            $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                        }

                        // Button anchor tag
                        $output .= '<a class="fpg-link read-more ' . esc_attr($buttonStyle1) . '" href="' . esc_url(get_permalink()) . '" ' . $targetAttr . ' style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                        if (!empty($buttonHoverInlineStyles)) {
                            $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                        }

                        if (!empty($buttonResetStyles)) {
                            $output .= ' onmouseout="' . $buttonResetStyles . '"';
                        }

                        $output .= '>';

                        // Icon handling
                        $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                        $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                        $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                        if ($iconPosition === 'left' && $showButtonIcon) {
                            $output .= $leftIcon . ' ';
                        }

                        $output .= esc_html($readMoreLabel);

                        if ($iconPosition === 'right' && $showButtonIcon) {
                            $output .= ' ' . $rightIcon;
                        }

                        $output .= '</a></div>';
                    }
                    // End Button

                    $output .= '</div>';
                    // End MAIN Content
                    $output .= '</div>';
                    // End Full post layout
                }
                else if ($gridLayoutStyle === 'style2') {
                    // Full post layout
                    $borderStyles = '.fpg-blog-layout-6 .fpg-blog__single .fpg-content .fpg-link.fpg-border::before {';
                    
                    $borderStyles .= 'background: ' . (!empty($buttonHoverTextColor) ? esc_attr($buttonHoverTextColor) : '#332FFF') . ';';
                    
                    $borderStyles .= '}';
                    $output .= '<style>' . $borderStyles . '</style>';
                    $output .= '<div class="fpg-blog__single align-' . $itemBoxAlignment2 . ' ' . $hoverAnimation . ' ' . $postLinkType . '" style="';
                        // MARGIN    
                        if (isset($itemMargin['top']) || isset($itemMargin['right']) || isset($itemMargin['bottom']) || isset($itemMargin['left'])) {
                            $output .= 'margin: ' .
                                (isset($itemMargin['top']) ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' .
                                (isset($itemMargin['right']) ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' .
                                (isset($itemMargin['bottom']) ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' .
                                (isset($itemMargin['left']) ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; ';
                        }

                        // PADDING
                        if (isset($itemPadding['top']) || isset($itemPadding['right']) || isset($itemPadding['bottom']) || isset($itemPadding['left'])) {
                            $output .= 'padding: ' .
                                (isset($itemPadding['top']) ? (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) : '0px') . ' ' .
                                (isset($itemPadding['right']) ? (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) : '0px') . ' ' .
                                (isset($itemPadding['bottom']) ? (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) : '0px') . ' ' .
                                (isset($itemPadding['left']) ? (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) : '0px') . '; ';
                        }

                        // BORDER RADIUS
                        if (isset($itemBorderRadius['top']) || isset($itemBorderRadius['right']) || isset($itemBorderRadius['bottom']) || isset($itemBorderRadius['left'])) {
                            $output .= 'border-radius: ' .
                                (isset($itemBorderRadius['top']) ? (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) : '0px') . ' ' .
                                (isset($itemBorderRadius['right']) ? (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) : '0px') . ' ' .
                                (isset($itemBorderRadius['bottom']) ? (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) : '0px') . ' ' .
                                (isset($itemBorderRadius['left']) ? (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) : '0px') . '; ';
                        }

                        // BORDER WIDTH
                        if (isset($itemBorderWidth['top']) || isset($itemBorderWidth['right']) || isset($itemBorderWidth['bottom']) || isset($itemBorderWidth['left'])) {
                            $output .= 'border-width: ' .
                                (isset($itemBorderWidth['top']) ? (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) : '0px') . ' ' .
                                (isset($itemBorderWidth['right']) ? (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) : '0px') . ' ' .
                                (isset($itemBorderWidth['bottom']) ? (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) : '0px') . ' ' .
                                (isset($itemBorderWidth['left']) ? (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) : '0px') . '; ';
                        }

                        // Border Style & Color
                        if (isset($itemBorderType)) {
                            $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                        }
                        if (!empty($itemBorderColor)) {
                            $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                        }

                        // Background Color
                        if (!empty($itemBackgroundColor)) {
                            $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                        }

                        // Box Shadow
                        if (
                            isset($itemBoxShadow['left']) ||  // horizontal offset
                            isset($itemBoxShadow['top']) ||  // vertical offset
                            isset($itemBoxShadow['right']) ||  // blur radius
                            isset($itemBoxShadow['bottom']) ||  // spread radius
                            isset($itemBoxShadowColor)
                        ) {
                            $output .= 'box-shadow: ' .
                                (isset($itemBoxShadow['left']) ? (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) : '0px') . ' ' .
                                (isset($itemBoxShadow['top']) ? (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) : '0px') . ' ' .
                                (isset($itemBoxShadow['right']) ? (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) : '0px') . ' ' .
                                (isset($itemBoxShadow['bottom']) ? (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) : '0px') . ' ' .
                                (!empty($itemBoxShadowColor) ? esc_attr($itemBoxShadowColor) : 'rgba(0,0,0,0.1)') . '; ';
                        }

                    $output .= '">';

                    // MAIN Content
                    $output .= '<div class="fpg-content" style="';
                        // MARGIN
                        if (
                            isset($contentitemMarginNew['top']) ||
                            isset($contentitemMarginNew['right']) ||
                            isset($contentitemMarginNew['bottom']) ||
                            isset($contentitemMarginNew['left'])
                        ) {
                            $output .= 'margin: ' .
                                (isset($contentitemMarginNew['top']) ? (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) : '0px') . ' ' .
                                (isset($contentitemMarginNew['right']) ? (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) : '0px') . ' ' .
                                (isset($contentitemMarginNew['bottom']) ? (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) : '0px') . ' ' .
                                (isset($contentitemMarginNew['left']) ? (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) : '0px') . '; ';
                        }

                        // PADDING
                        if (
                            isset($contentitemPaddingNew['top']) ||
                            isset($contentitemPaddingNew['right']) ||
                            isset($contentitemPaddingNew['bottom']) ||
                            isset($contentitemPaddingNew['left'])
                        ) {
                            $output .= 'padding: ' .
                                (isset($contentitemPaddingNew['top']) ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' .
                                (isset($contentitemPaddingNew['right']) ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' .
                                (isset($contentitemPaddingNew['bottom']) ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' .
                                (isset($contentitemPaddingNew['left']) ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; ';
                        }

                        // BORDER WIDTH
                        if (
                            isset($contentBorderWidth['top']) ||
                            isset($contentBorderWidth['right']) ||
                            isset($contentBorderWidth['bottom']) ||
                            isset($contentBorderWidth['left'])
                        ) {
                            $output .= 'border-width: ' .
                                (isset($contentBorderWidth['top']) ? (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) : '0px') . ' ' .
                                (isset($contentBorderWidth['right']) ? (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) : '0px') . ' ' .
                                (isset($contentBorderWidth['bottom']) ? (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) : '0px') . ' ' .
                                (isset($contentBorderWidth['left']) ? (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) : '0px') . '; ';
                        }
                        // BORDER radius
                        if (
                            isset($contentitemRadius['top']) ||
                            isset($contentitemRadius['right']) ||
                            isset($contentitemRadius['bottom']) ||
                            isset($contentitemRadius['left'])
                        ) {
                            $output .= 'border-radius: ' .
                                (isset($contentitemRadius['top']) ? (is_numeric($contentitemRadius['top']) ? $contentitemRadius['top'] . 'px' : esc_attr($contentitemRadius['top'])) : '0px') . ' ' .
                                (isset($contentitemRadius['right']) ? (is_numeric($contentitemRadius['right']) ? $contentitemRadius['right'] . 'px' : esc_attr($contentitemRadius['right'])) : '0px') . ' ' .
                                (isset($contentitemRadius['bottom']) ? (is_numeric($contentitemRadius['bottom']) ? $contentitemRadius['bottom'] . 'px' : esc_attr($contentitemRadius['bottom'])) : '0px') . ' ' .
                                (isset($contentitemRadius['left']) ? (is_numeric($contentitemRadius['left']) ? $contentitemRadius['left'] . 'px' : esc_attr($contentitemRadius['left'])) : '0px') . '; ';
                        }
                        // Border Style
                        if (!empty($contentNormalBorderType)) {
                            $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                        }
                        // Background Color
                        if (!empty($contentBgColor)) {
                            $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                        }
                        // Border Color
                        if (!empty($contentBorderColor)) {
                            $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                        }
                    $output .= '">';

                    // Meta Data
                    if ($showMetaData) {
                        $output .= '<ul class="meta-data-list align-' . $metaAlignment . ' " style="';  
                            // MARGIN
                            if (
                                isset($metaMarginNew['top']) ||
                                isset($metaMarginNew['right']) ||
                                isset($metaMarginNew['bottom']) ||
                                isset($metaMarginNew['left'])
                            ) {
                                $output .= 'margin: ' .
                                    (isset($metaMarginNew['top']) ? (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) : '0px') . ' ' .
                                    (isset($metaMarginNew['right']) ? (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) : '0px') . ' ' .
                                    (isset($metaMarginNew['bottom']) ? (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) : '0px') . ' ' .
                                    (isset($metaMarginNew['left']) ? (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) : '0px') . '; ';
                            }

                            // PADDING
                            if (
                                isset($metaPadding['top']) ||
                                isset($metaPadding['right']) ||
                                isset($metaPadding['bottom']) ||
                                isset($metaPadding['left'])
                            ) {
                                $output .= 'padding: ' .
                                    (isset($metaPadding['top']) ? (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) : '0px') . ' ' .
                                    (isset($metaPadding['right']) ? (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) : '0px') . ' ' .
                                    (isset($metaPadding['bottom']) ? (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) : '0px') . ' ' .
                                    (isset($metaPadding['left']) ? (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) : '0px') . '; ';
                            }
                            
                            // Color
                            if (!empty($metaTextColor)) {
                                $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                            }
                            // Order
                            if (!empty($metaOrder)) {
                                $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                            }
                        $output .= '">';

                        $meta_items = [];

                        // Date
                        if ($showPostDate) {
                            $meta = '<li class="meta-date" style="';

                            // Color
                            if (!empty($metaTextColor)) {
                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                            }

                            // Font size
                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '">';

                            // Icon
                            if ($showPostDateIcon && $showMetaIcon) {
                                $meta .= '<i class="fas fa-calendar-alt" style="';

                                if (!empty($metaIconColor)) {
                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                }

                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $meta .= '"></i> ';
                            }

                            $meta .= esc_html($getdate) . '</li>';
                            $meta_items[] = $meta;
                        }
                        // Author
                        if ($showPostAuthor) {
                            $meta = '<li class="meta-author" style="';

                            if (!empty($metaTextColor)) {
                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '">';

                            if ($showPostAuthorIcon && $showMetaIcon) {
                                $meta .= '<i class="fas fa-user" style="';

                                if (!empty($metaIconColor)) {
                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                }

                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $meta .= '"></i> ';
                            }

                            $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                            $meta_items[] = $meta;
                        }
                        // Category
                        if ($showPostCategory) {
                            $meta = '<li class="meta-categories" style="';

                            if (!empty($metaTextColor)) {
                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '">';

                            if ($showPostCategoryIcon && $showMetaIcon) {
                                $meta .= '<i class="fas fa-folder" style="';

                                if (!empty($metaIconColor)) {
                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                }

                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $meta .= '"></i> ';
                            }

                            // Get category names without links
                            $categories_list = get_the_category($post_id);
                            if (!empty($categories_list)) {
                                $category_names = array();
                                foreach ($categories_list as $category) {
                                    $category_names[] = esc_html($category->name);
                                }
                                $meta .= implode(', ', $category_names); // comma-separated plain text categories
                            }

                            $meta .= '</li>';
                            $meta_items[] = $meta;
                        }
                        // Tags
                        if ($showPostTags && !empty($tags)) {
                            $meta = '<li class="meta-tags" style="';

                            if (!empty($metaTextColor)) {
                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '">';

                            if ($showPostTagsIcon && $showMetaIcon) {
                                $meta .= '<i class="fas fa-tags" style="';

                                if (!empty($metaIconColor)) {
                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                }

                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $meta .= '"></i> ';
                            }

                            $meta .= esc_html__('Tags:', 'fancy-post-grid') . ' ' . $tags . '</li>';
                            $meta_items[] = $meta;
                        }
                        // Comment Count
                        if ($showPostCommentsCount) {
                            $meta = '<li class="meta-comment-count" style="';
                            if (!empty($metaTextColor)) {
                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                            }
                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '">';

                            if ($showPostCommentsCountIcon && $showMetaIcon) {
                                $meta .= '<i class="fas fa-comments" style="';
                                if (!empty($metaIconColor)) {
                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                }
                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }
                                $meta .= '"></i> ';
                            }

                            $meta .= esc_html($comments_count) . ' ' . esc_html__('Comments', 'fancy-post-grid') . '</li>';
                            $meta_items[] = $meta;
                        }
                        // Now join meta items with the separator
                        if (!empty($meta_items)) {
                            $separator = '';

                            if ($metaSeperator !== '') {
                                $separator = '';
                                if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                    $separatorStyle = '';
                                    if (!empty($separatorColor)) {
                                        $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                    }
                                    if (!empty($metaFontSize)) {
                                        $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                                }
                            }

                            $output .= implode($separator, $meta_items);
                        }
                        $output .= '</ul>'; // Close meta-data-list               
                    }
                    // End Meta Data

                    // title
                    if ($showPostTitle) {
                        $titleStyles = '';

                        // Order
                        if (!empty($titleOrder)) {
                            $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                        }

                        // Background color
                        if (!empty($postTitleBgColor)) {
                            $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                        }

                        // Margin
                        if (isset($postTitleMargin['top']) || isset($postTitleMargin['right']) || isset($postTitleMargin['bottom']) || isset($postTitleMargin['left'])) {
                            $titleStyles .= 'margin: ' .
                                (isset($postTitleMargin['top']) ? (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) : '0px') . ' ' .
                                (isset($postTitleMargin['right']) ? (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) : '0px') . ' ' .
                                (isset($postTitleMargin['bottom']) ? (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) : '0px') . ' ' .
                                (isset($postTitleMargin['left']) ? (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) : '0px') . '; ';
                        }

                        // Padding
                        if (isset($postTitlePadding['top']) || isset($postTitlePadding['right']) || isset($postTitlePadding['bottom']) || isset($postTitlePadding['left'])) {
                            $titleStyles .= 'padding: ' .
                                (isset($postTitlePadding['top']) ? (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) : '0px') . ' ' .
                                (isset($postTitlePadding['right']) ? (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) : '0px') . ' ' .
                                (isset($postTitlePadding['bottom']) ? (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) : '0px') . ' ' .
                                (isset($postTitlePadding['left']) ? (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) : '0px') . '; ';
                        }

                        // Determine if underline should be shown
                        $showUnderline = $postLinkType === 'yeslink' && $titleHoverUnderLine === 'enable';

                        // Class name
                        $classNames = 'title align-' . esc_attr($postTitleAlignment);
                        if ($showUnderline) {
                            $classNames .= ' underline';
                        }

                        // Hover/Out events for nolink
                        $onmouseover = '';
                        $onmouseout  = '';

                        if (!empty($postTitleHoverBgColor)) {
                            $onmouseover .= 'this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';';
                        }

                        if (!empty($postTitleHoverColor)) {
                            $onmouseover .= ' this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                        }

                        if (!empty($postTitleBgColor)) {
                            $onmouseout .= 'this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';';
                        } else {
                            $onmouseout .= 'this.style.removeProperty(\'background-color\');';
                        }

                        if (!empty($postTitleColor)) {
                            $onmouseout .= ' this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                        } else {
                            $onmouseout .= ' this.style.removeProperty(\'color\');';
                        }

                        // Opening title tag
                        $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"'
                            . (!empty($onmouseover) ? ' onmouseover="' . trim($onmouseover) . '"' : '')
                            . (!empty($onmouseout)  ? ' onmouseout="'  . trim($onmouseout)  . '"' : '') . '>';

                        if ($postLinkType === 'yeslink') {
                            // Anchor styles
                            $style = '';
                            $hoverStyle = '';
                            $mouseoutStyle = '';

                            if (!empty($postTitleFontSize)) {
                                $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                            }

                            if (!empty($postTitleLineHeight)) {
                                $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                            }

                            if (!empty($postTitleLetterSpacing)) {
                                $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                            }

                            if (!empty($postTitleFontWeight)) {
                                $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                            }

                            if (!empty($postTitleColor)) {
                                $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                $mouseoutStyle .= 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                            } else {
                                $mouseoutStyle .= 'this.style.color=\'\';';
                            }

                            if (!empty($postTitleHoverColor)) {
                                $hoverStyle .= 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                            }

                            if ($showUnderline && !empty($postTitleHoverColor)) {
                                $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                                $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                $hoverStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                            }

                            if ($showUnderline && empty($postTitleColor ) && !empty($postTitleColor )) {
                                $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                                $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                $mouseoutStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                            } else {
                                
                                $mouseoutStyle .= ' this.style.removeProperty(\'background-position\');';
                                $mouseoutStyle .= ' this.style.removeProperty(\'background-size\');';
                            }

                            $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '
                                style="' . esc_attr(trim($style)) . '"'
                                . (!empty($hoverStyle)   ? ' onmouseover="' . $hoverStyle . '"' : '')
                                . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                . esc_html($croppedTitle) . '</a>';
                        } else {
                            // No link  render span with inline styles
                            $inlineStyle = '';
                            if (!empty($postTitleFontSize)) {
                                $inlineStyle .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                            }
                            if (!empty($postTitleLineHeight)) {
                                $inlineStyle .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                            }
                            if (!empty($postTitleLetterSpacing)) {
                                $inlineStyle .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                            }
                            if (!empty($postTitleFontWeight)) {
                                $inlineStyle .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                            }
                            if (!empty($postTitleColor)) {
                                $inlineStyle .= 'color: ' . esc_attr($postTitleColor) . '; ';
                            }

                            $output .= '<span style="' . esc_attr(trim($inlineStyle)) . '">' . esc_html($croppedTitle) . '</span>';
                        }

                        $output .= '</' . esc_attr($titleTag) . '>';
                    }

                    // Excerpt
                    if ($showPostExcerpt) {
                        $excerptStyles = '';

                        // Order
                        if (!empty($excerptOrder)) {
                            $excerptStyles .= 'order: ' . esc_attr($excerptOrder) . '; ';
                        }

                        // Typography
                        if (!empty($excerptFontSize)) {
                            $excerptStyles .= 'font-size: ' . esc_attr($excerptFontSize) . 'px; ';
                        }

                        if (!empty($excerptLineHeight)) {
                            $excerptStyles .= 'line-height: ' . esc_attr($excerptLineHeight) . '; ';
                        }

                        if (!empty($excerptLetterSpacing)) {
                            $excerptStyles .= 'letter-spacing: ' . esc_attr($excerptLetterSpacing) . 'px; ';
                        }

                        if (!empty($excerptFontWeight)) {
                            $excerptStyles .= 'font-weight: ' . esc_attr($excerptFontWeight) . '; ';
                        }

                        if (!empty($excerptColor)) {
                            $excerptStyles .= 'color: ' . esc_attr($excerptColor) . '; ';
                        }

                        if (!empty($excerptBgColor)) {
                            $excerptStyles .= 'background-color: ' . esc_attr($excerptBgColor) . '; ';
                        }

                        if (!empty($excerptBorderType)) {
                            $excerptStyles .= 'border-style: ' . esc_attr($excerptBorderType) . '; ';
                        }

                        // Margin
                        if (isset($excerptMargin['top']) || isset($excerptMargin['right']) || isset($excerptMargin['bottom']) || isset($excerptMargin['left'])) {
                            $excerptStyles .= 'margin: ' .
                                (isset($excerptMargin['top']) ? (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) : '0px') . ' ' .
                                (isset($excerptMargin['right']) ? (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) : '0px') . ' ' .
                                (isset($excerptMargin['bottom']) ? (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) : '0px') . ' ' .
                                (isset($excerptMargin['left']) ? (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) : '0px') . '; ';
                        }

                        // Padding
                        if (isset($excerptPadding['top']) || isset($excerptPadding['right']) || isset($excerptPadding['bottom']) || isset($excerptPadding['left'])) {
                            $excerptStyles .= 'padding: ' .
                                (isset($excerptPadding['top']) ? (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) : '0px') . ' ' .
                                (isset($excerptPadding['right']) ? (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) : '0px') . ' ' .
                                (isset($excerptPadding['bottom']) ? (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) : '0px') . ' ' .
                                (isset($excerptPadding['left']) ? (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) : '0px') . '; ';
                        }

                        // Handle hover logic conditionally
                        $hoverIn = '';
                        $hoverOut = '';

                        if (!empty($excerptHoverColor)) {
                            $hoverIn .= 'this.style.color=\'' . esc_attr($excerptHoverColor) . '\';';
                            $hoverOut .= 'this.style.color=\'' . esc_attr($excerptColor) . '\';';
                        }

                        if (!empty($excerptHoverBgColor)) {
                            $hoverIn .= 'this.style.backgroundColor=\'' . esc_attr($excerptHoverBgColor) . '\';';
                            $hoverOut .= 'this.style.backgroundColor=\'' . esc_attr($excerptBgColor) . '\';';
                        }

                        $output .= '<div class="fpg-excerpt' . ' align-' . esc_attr($excerptAlignment) . '" style="' . esc_attr(trim($excerptStyles)) . '"';

                        if (!empty($hoverIn) || !empty($hoverOut)) {
                            $output .= ' onmouseover="' . esc_attr($hoverIn) . '"';
                            $output .= ' onmouseout="' . esc_attr($hoverOut) . '"';
                        }

                        $output .= '>';
                        $output .= '<p>' . esc_html($excerpt) . '</p>';
                        $output .= '</div>';
                    }
                    // End Excerpt

                    // Button Output                
                    if ($showReadMoreButton) {
                        // Button wrapper styles
                        $buttonWrapperStyle = '';

                        // Margin
                        if (
                            isset($buttonMarginNew['top']) || 
                            isset($buttonMarginNew['right']) || 
                            isset($buttonMarginNew['bottom']) || 
                            isset($buttonMarginNew['left'])
                        ) {
                            $buttonWrapperStyle .= 'margin: ' .
                                (isset($buttonMarginNew['top']) ? (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) : '0px') . ' ' .
                                (isset($buttonMarginNew['right']) ? (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) : '0px') . ' ' .
                                (isset($buttonMarginNew['bottom']) ? (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) : '0px') . ' ' .
                                (isset($buttonMarginNew['left']) ? (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) : '0px') . '; ';
                        }

                        // Order
                        if (!empty($buttonOrder)) {
                            $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                        }

                        $output .= '<div class="btn-wrapper align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';

                        // Button inline styles
                        $buttonInlineStyles = '';

                        if (!empty($buttonTextColor)) {
                            $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                        }
                        if (!empty($buttonBackgroundColor)) {
                            $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                        }
                        if (!empty($buttonFontSize)) {
                            $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                        }
                        if (!empty($buttonFontWeight)) {
                            $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                        }
                        if (!empty($buttonBorderColor)) {
                            $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                        }
                        if (!empty($buttonBorderType)) {
                            $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                        }

                        // Border Width
                        if (
                            isset($buttonBorderWidth['top']) || 
                            isset($buttonBorderWidth['right']) || 
                            isset($buttonBorderWidth['bottom']) || 
                            isset($buttonBorderWidth['left'])
                        ) {
                            $buttonInlineStyles .= 'border-width: ' .
                                (isset($buttonBorderWidth['top']) ? (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) : '0px') . ' ' .
                                (isset($buttonBorderWidth['right']) ? (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) : '0px') . ' ' .
                                (isset($buttonBorderWidth['bottom']) ? (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) : '0px') . ' ' .
                                (isset($buttonBorderWidth['left']) ? (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) : '0px') . '; ';
                        }

                        // Border Radius
                        if (
                            isset($buttonBorderRadius['top']) || 
                            isset($buttonBorderRadius['right']) || 
                            isset($buttonBorderRadius['bottom']) || 
                            isset($buttonBorderRadius['left'])
                        ) {
                            $buttonInlineStyles .= 'border-radius: ' .
                                (isset($buttonBorderRadius['top']) ? (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) : '0px') . ' ' .
                                (isset($buttonBorderRadius['right']) ? (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) : '0px') . ' ' .
                                (isset($buttonBorderRadius['bottom']) ? (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) : '0px') . ' ' .
                                (isset($buttonBorderRadius['left']) ? (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) : '0px') . '; ';
                        }

                        // Padding
                        if (
                            isset($buttonPaddingNew['top']) || 
                            isset($buttonPaddingNew['right']) || 
                            isset($buttonPaddingNew['bottom']) || 
                            isset($buttonPaddingNew['left'])
                        ) {
                            $buttonInlineStyles .= 'padding: ' .
                                (isset($buttonPaddingNew['top']) ? (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) : '0px') . ' ' .
                                (isset($buttonPaddingNew['right']) ? (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) : '0px') . ' ' .
                                (isset($buttonPaddingNew['bottom']) ? (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) : '0px') . ' ' .
                                (isset($buttonPaddingNew['left']) ? (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) : '0px') . '; ';
                        } 

                        // Hover styles
                        $buttonHoverInlineStyles = '';
                        $buttonResetStyles = '';

                        if (!empty($buttonHoverTextColor)) {
                            $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                            $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                        }
                        if (!empty($buttonHoverBorderColor)) {
                            $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                            $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                        }
                        if (!empty($buttonHoverBackgroundColor)) {
                            $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                            $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                        }

                        // Button anchor tag
                        $output .= '<a class="fpg-link read-more ' . esc_attr($buttonStyle2) . '" href="' . esc_url(get_permalink()) . '" ' . $targetAttr . ' style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                        if (!empty($buttonHoverInlineStyles)) {
                            $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                        }

                        if (!empty($buttonResetStyles)) {
                            $output .= ' onmouseout="' . $buttonResetStyles . '"';
                        }

                        $output .= '>';

                        // Icon handling
                        $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                        $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                        $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                        if ($iconPosition === 'left' && $showButtonIcon) {
                            $output .= $leftIcon . ' ';
                        }

                        $output .= esc_html($readMoreLabel);

                        if ($iconPosition === 'right' && $showButtonIcon) {
                            $output .= ' ' . $rightIcon;
                        }

                        $output .= '</a></div>';
                    }
                    // End Button

                    $output .= '</div>';
                    // Thumbnail
                    if ($thumbnail && $showThumbnail) {
                        $output .= '<div class="fpg-thumb" style="';

                        // MARGIN
                        if (
                            isset($thumbnailMargin['top']) ||
                            isset($thumbnailMargin['right']) ||
                            isset($thumbnailMargin['bottom']) ||
                            isset($thumbnailMargin['left'])
                        ) {
                            $output .= 'margin: ' .
                                (isset($thumbnailMargin['top']) ? (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) : '0px') . ' ' .
                                (isset($thumbnailMargin['right']) ? (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) : '0px') . ' ' .
                                (isset($thumbnailMargin['bottom']) ? (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) : '0px') . ' ' .
                                (isset($thumbnailMargin['left']) ? (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) : '0px') . '; ';
                        }

                        // PADDING
                        if (
                            isset($thumbnailPadding['top']) ||
                            isset($thumbnailPadding['right']) ||
                            isset($thumbnailPadding['bottom']) ||
                            isset($thumbnailPadding['left'])
                        ) {
                            $output .= 'padding: ' .
                                (isset($thumbnailPadding['top']) ? (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) : '0px') . ' ' .
                                (isset($thumbnailPadding['right']) ? (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) : '0px') . ' ' .
                                (isset($thumbnailPadding['bottom']) ? (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) : '0px') . ' ' .
                                (isset($thumbnailPadding['left']) ? (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) : '0px') . '; ';
                        }

                        // BORDER RADIUS
                        if (
                            isset($thumbnailBorderRadius['top']) ||
                            isset($thumbnailBorderRadius['right']) ||
                            isset($thumbnailBorderRadius['bottom']) ||
                            isset($thumbnailBorderRadius['left'])
                        ) {
                            $output .= 'border-radius: ' .
                                (isset($thumbnailBorderRadius['top']) ? (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) : '0px') . ' ' .
                                (isset($thumbnailBorderRadius['right']) ? (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) : '0px') . ' ' .
                                (isset($thumbnailBorderRadius['bottom']) ? (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) : '0px') . ' ' .
                                (isset($thumbnailBorderRadius['left']) ? (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) : '0px') . '; ';
                        }

                        $output .= '">';

                        // Anchor with optional border-radius and overflow
                        if ($thumbnailLink) {
                            $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '>';
                            $output .= $thumbnail;
                            $output .= '</a>';
                        } else {
                            $output .= $thumbnail;
                        }
                        $output .= '</div>';
                    }
                    // END Thumbnail
                    // End MAIN Content
                    $output .= '</div>';
                    // End Full post layout
                }
                else if ($gridLayoutStyle === 'style3') {
                    // Full post layout
                    $borderStyles = '.fpg-blog-layout-28-item .fpg-content .fpg-btn.fpg-border::before {';
                    
                    $borderStyles .= 'background: ' . (!empty($buttonHoverTextColor) ? esc_attr($buttonHoverTextColor) : '#332FFF') . ';';
                    
                    $borderStyles .= '}';
                    $output .= '<style>' . $borderStyles . '</style>';    
                    $output .= '<div class="fpg-blog-layout-28-item align-' . $itemBoxAlignment3 . ' ' . $hoverAnimation . ' ' . $postLinkType . '" style="';
                        // MARGIN    
                        if (isset($itemMargin['top']) || isset($itemMargin['right']) || isset($itemMargin['bottom']) || isset($itemMargin['left'])) {
                            $output .= 'margin: ' .
                                (isset($itemMargin['top']) ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' .
                                (isset($itemMargin['right']) ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' .
                                (isset($itemMargin['bottom']) ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' .
                                (isset($itemMargin['left']) ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; ';
                        }

                        // PADDING
                        if (isset($itemPadding['top']) || isset($itemPadding['right']) || isset($itemPadding['bottom']) || isset($itemPadding['left'])) {
                            $output .= 'padding: ' .
                                (isset($itemPadding['top']) ? (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) : '0px') . ' ' .
                                (isset($itemPadding['right']) ? (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) : '0px') . ' ' .
                                (isset($itemPadding['bottom']) ? (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) : '0px') . ' ' .
                                (isset($itemPadding['left']) ? (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) : '0px') . '; ';
                        }

                        // BORDER RADIUS
                        if (isset($itemBorderRadius['top']) || isset($itemBorderRadius['right']) || isset($itemBorderRadius['bottom']) || isset($itemBorderRadius['left'])) {
                            $output .= 'border-radius: ' .
                                (isset($itemBorderRadius['top']) ? (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) : '0px') . ' ' .
                                (isset($itemBorderRadius['right']) ? (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) : '0px') . ' ' .
                                (isset($itemBorderRadius['bottom']) ? (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) : '0px') . ' ' .
                                (isset($itemBorderRadius['left']) ? (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) : '0px') . '; ';
                        }

                        // BORDER WIDTH
                        if (isset($itemBorderWidth['top']) || isset($itemBorderWidth['right']) || isset($itemBorderWidth['bottom']) || isset($itemBorderWidth['left'])) {
                            $output .= 'border-width: ' .
                                (isset($itemBorderWidth['top']) ? (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) : '0px') . ' ' .
                                (isset($itemBorderWidth['right']) ? (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) : '0px') . ' ' .
                                (isset($itemBorderWidth['bottom']) ? (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) : '0px') . ' ' .
                                (isset($itemBorderWidth['left']) ? (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) : '0px') . '; ';
                        }

                        // Border Style & Color
                        if (!empty($itemBorderType)) {
                            $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                        }
                        if (!empty($itemBorderColor)) {
                            $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                        }

                        // Background Color
                        if (!empty($itemBackgroundColor)) {
                            $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                        }

                        // Box Shadow
                        if (
                            isset($itemBoxShadow['left']) ||  // horizontal offset
                            isset($itemBoxShadow['top']) ||  // vertical offset
                            isset($itemBoxShadow['right']) ||  // blur radius
                            isset($itemBoxShadow['bottom']) ||  // spread radius
                            isset($itemBoxShadowColor)
                        ) {
                            $output .= 'box-shadow: ' .
                                (isset($itemBoxShadow['left']) ? (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) : '0px') . ' ' .
                                (isset($itemBoxShadow['top']) ? (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) : '0px') . ' ' .
                                (isset($itemBoxShadow['right']) ? (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) : '0px') . ' ' .
                                (isset($itemBoxShadow['bottom']) ? (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) : '0px') . ' ' .
                                (!empty($itemBoxShadowColor) ? esc_attr($itemBoxShadowColor) : 'rgba(0,0,0,0.1)') . '; ';
                        }

                    $output .= '">';

                        // Thumbnail
                        if ($thumbnail && $showThumbnail) {

                            $output .= '<div class="fpg-thumb" style="';
                                // MARGIN
                                if (
                                    isset($thumbnailMargin['top']) ||
                                    isset($thumbnailMargin['right']) ||
                                    isset($thumbnailMargin['bottom']) ||
                                    isset($thumbnailMargin['left'])
                                ) {
                                    $output .= 'margin: ' .
                                        (isset($thumbnailMargin['top']) ? (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) : '0px') . ' ' .
                                        (isset($thumbnailMargin['right']) ? (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) : '0px') . ' ' .
                                        (isset($thumbnailMargin['bottom']) ? (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) : '0px') . ' ' .
                                        (isset($thumbnailMargin['left']) ? (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) : '0px') . '; ';
                                }

                                // PADDING
                                if (
                                    isset($thumbnailPadding['top']) ||
                                    isset($thumbnailPadding['right']) ||
                                    isset($thumbnailPadding['bottom']) ||
                                    isset($thumbnailPadding['left'])
                                ) {
                                    $output .= 'padding: ' .
                                        (isset($thumbnailPadding['top']) ? (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) : '0px') . ' ' .
                                        (isset($thumbnailPadding['right']) ? (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) : '0px') . ' ' .
                                        (isset($thumbnailPadding['bottom']) ? (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) : '0px') . ' ' .
                                        (isset($thumbnailPadding['left']) ? (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) : '0px') . '; ';
                                }

                                // BORDER RADIUS
                                if (
                                    isset($thumbnailBorderRadius['top']) ||
                                    isset($thumbnailBorderRadius['right']) ||
                                    isset($thumbnailBorderRadius['bottom']) ||
                                    isset($thumbnailBorderRadius['left'])
                                ) {
                                    $output .= 'border-radius: ' .
                                        (isset($thumbnailBorderRadius['top']) ? (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) : '0px') . ' ' .
                                        (isset($thumbnailBorderRadius['right']) ? (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) : '0px') . ' ' .
                                        (isset($thumbnailBorderRadius['bottom']) ? (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) : '0px') . ' ' .
                                        (isset($thumbnailBorderRadius['left']) ? (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) : '0px') . '; ';
                                }

                            $output .= '">';
                            

                            // Anchor with optional border-radius and overflow
                            if ($thumbnailLink) {
                                $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '>';
                                $output .= $thumbnail;
                                $output .= '</a>';
                            } else {
                                $output .= $thumbnail;
                            }
                        

                            // Now Insert Meta Data inside the Thumbnail
                            if ($showMetaData) {
                                
                                $output .= '<div class="fpg-meta align-' . esc_attr($metaAlignment) . '"';

                                $metaStyle = '';
                                if (!empty($metaBgColor)) {
                                    $metaStyle .= 'background-color: ' . esc_attr($metaBgColor) . '; ';
                                }

                                if (!empty($metaStyle)) {
                                    $output .= ' style="' . trim($metaStyle) . '"';
                                }

                                $output .= '>';
                                    $output .= '<ul class="meta-data-list " style="';  
                                        // MARGIN
                                        if (
                                            isset($metaMarginNew['top']) ||
                                            isset($metaMarginNew['right']) ||
                                            isset($metaMarginNew['bottom']) ||
                                            isset($metaMarginNew['left'])
                                        ) {
                                            $output .= 'margin: ' .
                                                (isset($metaMarginNew['top']) ? (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) : '0px') . ' ' .
                                                (isset($metaMarginNew['right']) ? (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) : '0px') . ' ' .
                                                (isset($metaMarginNew['bottom']) ? (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) : '0px') . ' ' .
                                                (isset($metaMarginNew['left']) ? (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) : '0px') . '; ';
                                        }

                                        // PADDING
                                        if (
                                            isset($metaPadding['top']) ||
                                            isset($metaPadding['right']) ||
                                            isset($metaPadding['bottom']) ||
                                            isset($metaPadding['left'])
                                        ) {
                                            $output .= 'padding: ' .
                                                (isset($metaPadding['top']) ? (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) : '0px') . ' ' .
                                                (isset($metaPadding['right']) ? (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) : '0px') . ' ' .
                                                (isset($metaPadding['bottom']) ? (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) : '0px') . ' ' .
                                                (isset($metaPadding['left']) ? (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) : '0px') . '; ';
                                        }  
                                        
                                        // Color
                                        if (!empty($metaTextColor)) {
                                            $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                                        }
                                        // Order
                                        if (!empty($metaOrder)) {
                                            $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                                        }
                                    $output .= '">';

                                        $meta_items = [];

                                        // Date
                                        if ($showPostDate) {
                                            $meta = '<li class="meta-date" style="';

                                            // Color
                                            if (!empty($metaTextColor)) {
                                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                            }

                                            // Font size
                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '">';

                                            // Icon
                                            if ($showPostDateIcon && $showMetaIcon) {
                                                $meta .= '<i class="fas fa-calendar-alt" style="';

                                                if (!empty($metaIconColor)) {
                                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                                }

                                                if (!empty($metaFontSize)) {
                                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                                }

                                                $meta .= '"></i> ';
                                            }

                                            $meta .= esc_html($getdate) . '</li>';
                                            $meta_items[] = $meta;
                                        }
                                        // Author
                                        if ($showPostAuthor) {
                                            $meta = '<li class="meta-author" style="';

                                            if (!empty($metaTextColor)) {
                                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                            }

                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '">';

                                            if ($showPostAuthorIcon && $showMetaIcon) {
                                                $meta .= '<i class="fas fa-user" style="';

                                                if (!empty($metaIconColor)) {
                                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                                }

                                                if (!empty($metaFontSize)) {
                                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                                }

                                                $meta .= '"></i> ';
                                            }

                                            $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                                            $meta_items[] = $meta;
                                        }
                                        // Category
                                        if ($showPostCategory) {
                                            $meta = '<li class="meta-categories" style="';

                                            if (!empty($metaTextColor)) {
                                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                            }

                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '">';

                                            if ($showPostCategoryIcon && $showMetaIcon) {
                                                $meta .= '<i class="fas fa-folder" style="';

                                                if (!empty($metaIconColor)) {
                                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                                }

                                                if (!empty($metaFontSize)) {
                                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                                }

                                                $meta .= '"></i> ';
                                            }

                                            // Get category names without links
                                            $categories_list = get_the_category($post_id);
                                            if (!empty($categories_list)) {
                                                $category_names = array();
                                                foreach ($categories_list as $category) {
                                                    $category_names[] = esc_html($category->name);
                                                }
                                                $meta .= implode(', ', $category_names); // comma-separated plain text categories
                                            }

                                            $meta .= '</li>';
                                            $meta_items[] = $meta;
                                        }
                                        // Tags
                                        if ($showPostTags && !empty($tags)) {
                                            $meta = '<li class="meta-tags" style="';

                                            if (!empty($metaTextColor)) {
                                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                            }

                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '">';

                                            if ($showPostTagsIcon && $showMetaIcon) {
                                                $meta .= '<i class="fas fa-tags" style="';

                                                if (!empty($metaIconColor)) {
                                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                                }

                                                if (!empty($metaFontSize)) {
                                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                                }

                                                $meta .= '"></i> ';
                                            }

                                            $meta .= esc_html__('Tags:', 'fancy-post-grid') . ' ' . $tags . '</li>';
                                            $meta_items[] = $meta;
                                        }
                                        // Comment Count
                                        if ($showPostCommentsCount) {
                                            $meta = '<li class="meta-comment-count" style="';
                                            if (!empty($metaTextColor)) {
                                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                            }
                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '">';

                                            if ($showPostCommentsCountIcon && $showMetaIcon) {
                                                $meta .= '<i class="fas fa-comments" style="';
                                                if (!empty($metaIconColor)) {
                                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                                }
                                                if (!empty($metaFontSize)) {
                                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                                }
                                                $meta .= '"></i> ';
                                            }

                                            $meta .= esc_html($comments_count) . ' ' . esc_html__('Comments', 'fancy-post-grid') . '</li>';
                                            $meta_items[] = $meta;
                                        }
                                        // Now join meta items with the separator
                                        if (!empty($meta_items)) {
                                            $separator = '';

                                            if ($metaSeperator !== '') {
                                                $separator = '';
                                                if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                                    $separatorStyle = '';
                                                    if (!empty($separatorColor)) {
                                                        $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                                    }
                                                    if (!empty($metaFontSize)) {
                                                        $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                                    }

                                                    $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                                                }
                                            }

                                            $output .= implode($separator, $meta_items);
                                        }
                                    $output .= '</ul>'; // ul Close 
                                $output .= '</div>'; // Close meta-data-list
                            }

                            $output .= '</div>'; // Close fancy-post-image fpg-thumb
                        }

                    // MAIN Content
                    $output .= '<div class="fpg-content" style="';
                        // MARGIN
                        if (
                            isset($contentitemMarginNew['top']) ||
                            isset($contentitemMarginNew['right']) ||
                            isset($contentitemMarginNew['bottom']) ||
                            isset($contentitemMarginNew['left'])
                        ) {
                            $output .= 'margin: ' .
                                (isset($contentitemMarginNew['top']) ? (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) : '0px') . ' ' .
                                (isset($contentitemMarginNew['right']) ? (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) : '0px') . ' ' .
                                (isset($contentitemMarginNew['bottom']) ? (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) : '0px') . ' ' .
                                (isset($contentitemMarginNew['left']) ? (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) : '0px') . '; ';
                        }

                        // PADDING
                        if (
                            isset($contentitemPaddingNew['top']) ||
                            isset($contentitemPaddingNew['right']) ||
                            isset($contentitemPaddingNew['bottom']) ||
                            isset($contentitemPaddingNew['left'])
                        ) {
                            $output .= 'padding: ' .
                                (isset($contentitemPaddingNew['top']) ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' .
                                (isset($contentitemPaddingNew['right']) ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' .
                                (isset($contentitemPaddingNew['bottom']) ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' .
                                (isset($contentitemPaddingNew['left']) ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; ';
                        }

                        // BORDER WIDTH
                        if (
                            isset($contentBorderWidth['top']) ||
                            isset($contentBorderWidth['right']) ||
                            isset($contentBorderWidth['bottom']) ||
                            isset($contentBorderWidth['left'])
                        ) {
                            $output .= 'border-width: ' .
                                (isset($contentBorderWidth['top']) ? (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) : '0px') . ' ' .
                                (isset($contentBorderWidth['right']) ? (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) : '0px') . ' ' .
                                (isset($contentBorderWidth['bottom']) ? (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) : '0px') . ' ' .
                                (isset($contentBorderWidth['left']) ? (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) : '0px') . '; ';
                        }
                        // BORDER radius
                        if (
                            isset($contentitemRadius['top']) ||
                            isset($contentitemRadius['right']) ||
                            isset($contentitemRadius['bottom']) ||
                            isset($contentitemRadius['left'])
                        ) {
                            $output .= 'border-radius: ' .
                                (isset($contentitemRadius['top']) ? (is_numeric($contentitemRadius['top']) ? $contentitemRadius['top'] . 'px' : esc_attr($contentitemRadius['top'])) : '0px') . ' ' .
                                (isset($contentitemRadius['right']) ? (is_numeric($contentitemRadius['right']) ? $contentitemRadius['right'] . 'px' : esc_attr($contentitemRadius['right'])) : '0px') . ' ' .
                                (isset($contentitemRadius['bottom']) ? (is_numeric($contentitemRadius['bottom']) ? $contentitemRadius['bottom'] . 'px' : esc_attr($contentitemRadius['bottom'])) : '0px') . ' ' .
                                (isset($contentitemRadius['left']) ? (is_numeric($contentitemRadius['left']) ? $contentitemRadius['left'] . 'px' : esc_attr($contentitemRadius['left'])) : '0px') . '; ';
                        }
                        // Border Style
                        if (!empty($contentNormalBorderType)) {
                            $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                        }
                        // Background Color
                        if (!empty($contentBgColor)) {
                            $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                        }
                        // Border Color
                        if (!empty($contentBorderColor)) {
                            $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                        }
                    $output .= '">';
                    // title
                    if ($showPostTitle) {
                        $titleStyles = '';

                        // Order
                        if (!empty($titleOrder)) {
                            $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                        }

                        // Background color
                        if (!empty($postTitleBgColor)) {
                            $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                        }

                        // Margin
                        if (isset($postTitleMargin['top']) || isset($postTitleMargin['right']) || isset($postTitleMargin['bottom']) || isset($postTitleMargin['left'])) {
                            $titleStyles .= 'margin: ' .
                                (isset($postTitleMargin['top']) ? (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) : '0px') . ' ' .
                                (isset($postTitleMargin['right']) ? (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) : '0px') . ' ' .
                                (isset($postTitleMargin['bottom']) ? (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) : '0px') . ' ' .
                                (isset($postTitleMargin['left']) ? (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) : '0px') . '; ';
                        }

                        // Padding
                        if (isset($postTitlePadding['top']) || isset($postTitlePadding['right']) || isset($postTitlePadding['bottom']) || isset($postTitlePadding['left'])) {
                            $titleStyles .= 'padding: ' .
                                (isset($postTitlePadding['top']) ? (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) : '0px') . ' ' .
                                (isset($postTitlePadding['right']) ? (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) : '0px') . ' ' .
                                (isset($postTitlePadding['bottom']) ? (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) : '0px') . ' ' .
                                (isset($postTitlePadding['left']) ? (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) : '0px') . '; ';
                        }

                        // Determine if underline should be shown
                        $showUnderline = $postLinkType === 'yeslink' && $titleHoverUnderLine === 'enable';

                        // Class name
                        $classNames = 'title align-' . esc_attr($postTitleAlignment);
                        if ($showUnderline) {
                            $classNames .= ' underline';
                        }

                        // Hover/Out events for nolink
                        $onmouseover = '';
                        $onmouseout  = '';

                        if (!empty($postTitleHoverBgColor)) {
                            $onmouseover .= 'this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';';
                        }

                        if (!empty($postTitleHoverColor)) {
                            $onmouseover .= ' this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                        }

                        if (!empty($postTitleBgColor)) {
                            $onmouseout .= 'this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';';
                        } else {
                            $onmouseout .= 'this.style.removeProperty(\'background-color\');';
                        }

                        if (!empty($postTitleColor)) {
                            $onmouseout .= ' this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                        } else {
                            $onmouseout .= ' this.style.removeProperty(\'color\');';
                        }

                        // Opening title tag
                        $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"'
                            . (!empty($onmouseover) ? ' onmouseover="' . trim($onmouseover) . '"' : '')
                            . (!empty($onmouseout)  ? ' onmouseout="'  . trim($onmouseout)  . '"' : '') . '>';

                        if ($postLinkType === 'yeslink') {
                            // Anchor styles
                            $style = '';
                            $hoverStyle = '';
                            $mouseoutStyle = '';

                            if (!empty($postTitleFontSize)) {
                                $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                            }

                            if (!empty($postTitleLineHeight)) {
                                $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                            }

                            if (!empty($postTitleLetterSpacing)) {
                                $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                            }

                            if (!empty($postTitleFontWeight)) {
                                $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                            }

                            if (!empty($postTitleColor)) {
                                $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                $mouseoutStyle .= 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                            } else {
                                $mouseoutStyle .= 'this.style.color=\'\';';
                            }

                            if (!empty($postTitleHoverColor)) {
                                $hoverStyle .= 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                            }

                            if ($showUnderline && !empty($postTitleHoverColor)) {
                                $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                                $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                $hoverStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                            }

                            if ($showUnderline && empty($postTitleColor ) && !empty($postTitleColor )) {
                                $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                                $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                $mouseoutStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                            } else {
                                
                                $mouseoutStyle .= ' this.style.removeProperty(\'background-position\');';
                                $mouseoutStyle .= ' this.style.removeProperty(\'background-size\');';
                            }

                            $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '
                                style="' . esc_attr(trim($style)) . '"'
                                . (!empty($hoverStyle)   ? ' onmouseover="' . $hoverStyle . '"' : '')
                                . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                . esc_html($croppedTitle) . '</a>';
                        } else {
                            // No link  render span with inline styles
                            $inlineStyle = '';
                            if (!empty($postTitleFontSize)) {
                                $inlineStyle .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                            }
                            if (!empty($postTitleLineHeight)) {
                                $inlineStyle .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                            }
                            if (!empty($postTitleLetterSpacing)) {
                                $inlineStyle .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                            }
                            if (!empty($postTitleFontWeight)) {
                                $inlineStyle .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                            }
                            if (!empty($postTitleColor)) {
                                $inlineStyle .= 'color: ' . esc_attr($postTitleColor) . '; ';
                            }

                            $output .= '<span style="' . esc_attr(trim($inlineStyle)) . '">' . esc_html($croppedTitle) . '</span>';
                        }

                        $output .= '</' . esc_attr($titleTag) . '>';
                    }

                    // Excerpt
                    if ($showPostExcerpt) {
                        $excerptStyles = '';

                        // Order
                        if (!empty($excerptOrder)) {
                            $excerptStyles .= 'order: ' . esc_attr($excerptOrder) . '; ';
                        }

                        // Typography
                        if (!empty($excerptFontSize)) {
                            $excerptStyles .= 'font-size: ' . esc_attr($excerptFontSize) . 'px; ';
                        }

                        if (!empty($excerptLineHeight)) {
                            $excerptStyles .= 'line-height: ' . esc_attr($excerptLineHeight) . '; ';
                        }

                        if (!empty($excerptLetterSpacing)) {
                            $excerptStyles .= 'letter-spacing: ' . esc_attr($excerptLetterSpacing) . 'px; ';
                        }

                        if (!empty($excerptFontWeight)) {
                            $excerptStyles .= 'font-weight: ' . esc_attr($excerptFontWeight) . '; ';
                        }

                        if (!empty($excerptColor)) {
                            $excerptStyles .= 'color: ' . esc_attr($excerptColor) . '; ';
                        }

                        if (!empty($excerptBgColor)) {
                            $excerptStyles .= 'background-color: ' . esc_attr($excerptBgColor) . '; ';
                        }

                        if (!empty($excerptBorderType)) {
                            $excerptStyles .= 'border-style: ' . esc_attr($excerptBorderType) . '; ';
                        }

                        // Margin
                        if (isset($excerptMargin['top']) || isset($excerptMargin['right']) || isset($excerptMargin['bottom']) || isset($excerptMargin['left'])) {
                            $excerptStyles .= 'margin: ' .
                                (isset($excerptMargin['top']) ? (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) : '0px') . ' ' .
                                (isset($excerptMargin['right']) ? (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) : '0px') . ' ' .
                                (isset($excerptMargin['bottom']) ? (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) : '0px') . ' ' .
                                (isset($excerptMargin['left']) ? (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) : '0px') . '; ';
                        }

                        // Padding
                        if (isset($excerptPadding['top']) || isset($excerptPadding['right']) || isset($excerptPadding['bottom']) || isset($excerptPadding['left'])) {
                            $excerptStyles .= 'padding: ' .
                                (isset($excerptPadding['top']) ? (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) : '0px') . ' ' .
                                (isset($excerptPadding['right']) ? (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) : '0px') . ' ' .
                                (isset($excerptPadding['bottom']) ? (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) : '0px') . ' ' .
                                (isset($excerptPadding['left']) ? (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) : '0px') . '; ';
                        }

                        // Handle hover logic conditionally
                        $hoverIn = '';
                        $hoverOut = '';

                        if (!empty($excerptHoverColor)) {
                            $hoverIn .= 'this.style.color=\'' . esc_attr($excerptHoverColor) . '\';';
                            $hoverOut .= 'this.style.color=\'' . esc_attr($excerptColor) . '\';';
                        }

                        if (!empty($excerptHoverBgColor)) {
                            $hoverIn .= 'this.style.backgroundColor=\'' . esc_attr($excerptHoverBgColor) . '\';';
                            $hoverOut .= 'this.style.backgroundColor=\'' . esc_attr($excerptBgColor) . '\';';
                        }

                        $output .= '<div class="fpg-excerpt' . ' align-' . esc_attr($excerptAlignment) . '" style="' . esc_attr(trim($excerptStyles)) . '"';

                        if (!empty($hoverIn) || !empty($hoverOut)) {
                            $output .= ' onmouseover="' . esc_attr($hoverIn) . '"';
                            $output .= ' onmouseout="' . esc_attr($hoverOut) . '"';
                        }

                        $output .= '>';
                        $output .= '<p>' . esc_html($excerpt) . '</p>';
                        $output .= '</div>';
                    }
                    // End Excerpt
                    
                    // Button Output                
                    if ($showReadMoreButton) {
                        // Button wrapper styles
                        $buttonWrapperStyle = '';

                        // Margin
                        if (
                            isset($buttonMarginNew['top']) || 
                            isset($buttonMarginNew['right']) || 
                            isset($buttonMarginNew['bottom']) || 
                            isset($buttonMarginNew['left'])
                        ) {
                            $buttonWrapperStyle .= 'margin: ' .
                                (isset($buttonMarginNew['top']) ? (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) : '0px') . ' ' .
                                (isset($buttonMarginNew['right']) ? (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) : '0px') . ' ' .
                                (isset($buttonMarginNew['bottom']) ? (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) : '0px') . ' ' .
                                (isset($buttonMarginNew['left']) ? (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) : '0px') . '; ';
                        }

                        // Order
                        if (!empty($buttonOrder)) {
                            $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                        }

                        $output .= '<div class="btn-wrapper align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';

                        // Button inline styles
                        $buttonInlineStyles = '';

                        if (!empty($buttonTextColor)) {
                            $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                        }
                        if (!empty($buttonBackgroundColor)) {
                            $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                        }
                        if (!empty($buttonFontSize)) {
                            $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                        }
                        if (!empty($buttonFontWeight)) {
                            $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                        }
                        if (!empty($buttonBorderColor)) {
                            $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                        }
                        if (!empty($buttonBorderType)) {
                            $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                        }

                        // Border Width
                        if (
                            isset($buttonBorderWidth['top']) || 
                            isset($buttonBorderWidth['right']) || 
                            isset($buttonBorderWidth['bottom']) || 
                            isset($buttonBorderWidth['left'])
                        ) {
                            $buttonInlineStyles .= 'border-width: ' .
                                (isset($buttonBorderWidth['top']) ? (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) : '0px') . ' ' .
                                (isset($buttonBorderWidth['right']) ? (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) : '0px') . ' ' .
                                (isset($buttonBorderWidth['bottom']) ? (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) : '0px') . ' ' .
                                (isset($buttonBorderWidth['left']) ? (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) : '0px') . '; ';
                        }

                        // Border Radius
                        if (
                            isset($buttonBorderRadius['top']) || 
                            isset($buttonBorderRadius['right']) || 
                            isset($buttonBorderRadius['bottom']) || 
                            isset($buttonBorderRadius['left'])
                        ) {
                            $buttonInlineStyles .= 'border-radius: ' .
                                (isset($buttonBorderRadius['top']) ? (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) : '0px') . ' ' .
                                (isset($buttonBorderRadius['right']) ? (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) : '0px') . ' ' .
                                (isset($buttonBorderRadius['bottom']) ? (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) : '0px') . ' ' .
                                (isset($buttonBorderRadius['left']) ? (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) : '0px') . '; ';
                        }

                        // Padding
                        if (
                            isset($buttonPaddingNew['top']) || 
                            isset($buttonPaddingNew['right']) || 
                            isset($buttonPaddingNew['bottom']) || 
                            isset($buttonPaddingNew['left'])
                        ) {
                            $buttonInlineStyles .= 'padding: ' .
                                (isset($buttonPaddingNew['top']) ? (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) : '0px') . ' ' .
                                (isset($buttonPaddingNew['right']) ? (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) : '0px') . ' ' .
                                (isset($buttonPaddingNew['bottom']) ? (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) : '0px') . ' ' .
                                (isset($buttonPaddingNew['left']) ? (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) : '0px') . '; ';
                        }
                        

                        // Hover styles
                        $buttonHoverInlineStyles = '';
                        $buttonResetStyles = '';

                        if (!empty($buttonHoverTextColor)) {
                            $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                            $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                        }
                        if (!empty($buttonHoverBorderColor)) {
                            $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                            $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                        }
                        if (!empty($buttonHoverBackgroundColor)) {
                            $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                            $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                        }

                        // Button anchor tag
                        $output .= '<a class="fpg-btn read-more ' . esc_attr($buttonStyle3) . '" href="' . esc_url(get_permalink()) . '" ' . $targetAttr . ' style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                        if (!empty($buttonHoverInlineStyles)) {
                            $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                        }

                        if (!empty($buttonResetStyles)) {
                            $output .= ' onmouseout="' . $buttonResetStyles . '"';
                        }

                        $output .= '>';

                        // Icon handling
                        $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                        $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                        $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                        if ($iconPosition === 'left' && $showButtonIcon) {
                            $output .= $leftIcon . ' ';
                        }

                        $output .= esc_html($readMoreLabel);

                        if ($iconPosition === 'right' && $showButtonIcon) {
                            $output .= ' ' . $rightIcon;
                        }

                        $output .= '</a></div>';
                    }
                    // End Button

                    $output .= '</div>';
                    // End MAIN Content
                    $output .= '</div>';
                    // End Full post layout
                }
                else if ($gridLayoutStyle === 'style4') {
                    // Full post layout
                    $output .= '<div class="fpg-blog-layout-30-item align-' . $itemBoxAlignment4 . ' ' . $hoverAnimation . ' ' . $postLinkType . '" style="';
                        // MARGIN    
                        if (isset($itemMargin['top']) || isset($itemMargin['right']) || isset($itemMargin['bottom']) || isset($itemMargin['left'])) {
                            $output .= 'margin: ' .
                                (isset($itemMargin['top']) ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' .
                                (isset($itemMargin['right']) ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' .
                                (isset($itemMargin['bottom']) ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' .
                                (isset($itemMargin['left']) ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; ';
                        }

                        // PADDING
                        if (isset($itemPadding['top']) || isset($itemPadding['right']) || isset($itemPadding['bottom']) || isset($itemPadding['left'])) {
                            $output .= 'padding: ' .
                                (isset($itemPadding['top']) ? (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) : '0px') . ' ' .
                                (isset($itemPadding['right']) ? (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) : '0px') . ' ' .
                                (isset($itemPadding['bottom']) ? (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) : '0px') . ' ' .
                                (isset($itemPadding['left']) ? (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) : '0px') . '; ';
                        }

                        // BORDER RADIUS
                        if (isset($itemBorderRadius['top']) || isset($itemBorderRadius['right']) || isset($itemBorderRadius['bottom']) || isset($itemBorderRadius['left'])) {
                            $output .= 'border-radius: ' .
                                (isset($itemBorderRadius['top']) ? (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) : '0px') . ' ' .
                                (isset($itemBorderRadius['right']) ? (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) : '0px') . ' ' .
                                (isset($itemBorderRadius['bottom']) ? (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) : '0px') . ' ' .
                                (isset($itemBorderRadius['left']) ? (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) : '0px') . '; ';
                        }

                        // BORDER WIDTH
                        if (isset($itemBorderWidth['top']) || isset($itemBorderWidth['right']) || isset($itemBorderWidth['bottom']) || isset($itemBorderWidth['left'])) {
                            $output .= 'border-width: ' .
                                (isset($itemBorderWidth['top']) ? (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) : '0px') . ' ' .
                                (isset($itemBorderWidth['right']) ? (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) : '0px') . ' ' .
                                (isset($itemBorderWidth['bottom']) ? (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) : '0px') . ' ' .
                                (isset($itemBorderWidth['left']) ? (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) : '0px') . '; ';
                        }

                        // Border Style & Color
                        if (!empty($itemBorderType)) {
                            $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                        }
                        if (!empty($itemBorderColor)) {
                            $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                        }

                        // Background Color
                        if (!empty($itemBackgroundColor)) {
                            $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                        }

                        // Box Shadow
                        if (
                            isset($itemBoxShadow['left']) ||  // horizontal offset
                            isset($itemBoxShadow['top']) ||  // vertical offset
                            isset($itemBoxShadow['right']) ||  // blur radius
                            isset($itemBoxShadow['bottom']) ||  // spread radius
                            isset($itemBoxShadowColor)
                        ) {
                            $output .= 'box-shadow: ' .
                                (isset($itemBoxShadow['left']) ? (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) : '0px') . ' ' .
                                (isset($itemBoxShadow['top']) ? (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) : '0px') . ' ' .
                                (isset($itemBoxShadow['right']) ? (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) : '0px') . ' ' .
                                (isset($itemBoxShadow['bottom']) ? (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) : '0px') . ' ' .
                                (!empty($itemBoxShadowColor) ? esc_attr($itemBoxShadowColor) : 'rgba(0,0,0,0.1)') . '; ';
                        }

                    $output .= '">';
                    
                    // Thumbnail
                    if ($thumbnail && $showThumbnail) {
                        $output .= '<div class="fpg-thumb" style="';

                            // MARGIN
                            if (
                                isset($thumbnailMargin['top']) ||
                                isset($thumbnailMargin['right']) ||
                                isset($thumbnailMargin['bottom']) ||
                                isset($thumbnailMargin['left'])
                            ) {
                                $output .= 'margin: ' .
                                    (isset($thumbnailMargin['top']) ? (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) : '0px') . ' ' .
                                    (isset($thumbnailMargin['right']) ? (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) : '0px') . ' ' .
                                    (isset($thumbnailMargin['bottom']) ? (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) : '0px') . ' ' .
                                    (isset($thumbnailMargin['left']) ? (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) : '0px') . '; ';
                            }

                            // PADDING
                            if (
                                isset($thumbnailPadding['top']) ||
                                isset($thumbnailPadding['right']) ||
                                isset($thumbnailPadding['bottom']) ||
                                isset($thumbnailPadding['left'])
                            ) {
                                $output .= 'padding: ' .
                                    (isset($thumbnailPadding['top']) ? (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) : '0px') . ' ' .
                                    (isset($thumbnailPadding['right']) ? (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) : '0px') . ' ' .
                                    (isset($thumbnailPadding['bottom']) ? (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) : '0px') . ' ' .
                                    (isset($thumbnailPadding['left']) ? (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) : '0px') . '; ';
                            }

                            // BORDER RADIUS
                            if (
                                isset($thumbnailBorderRadius['top']) ||
                                isset($thumbnailBorderRadius['right']) ||
                                isset($thumbnailBorderRadius['bottom']) ||
                                isset($thumbnailBorderRadius['left'])
                            ) {
                                $output .= 'border-radius: ' .
                                    (isset($thumbnailBorderRadius['top']) ? (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) : '0px') . ' ' .
                                    (isset($thumbnailBorderRadius['right']) ? (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) : '0px') . ' ' .
                                    (isset($thumbnailBorderRadius['bottom']) ? (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) : '0px') . ' ' .
                                    (isset($thumbnailBorderRadius['left']) ? (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) : '0px') . '; ';
                            }

                            $output .= '">';

                            // Anchor with optional border-radius and overflow
                            if ($thumbnailLink) {
                                $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '>';
                                $output .= $thumbnail;
                                $output .= '</a>';
                            } else {
                                $output .= $thumbnail;
                            }
                        
                            // Date
                            if ($showPostDate) {
                                // Build dynamic style for the container
                                $style = '';
                                if (!empty($metaTextColor)) {
                                    $style .= 'color:' . esc_attr($metaTextColor) . ';';
                                }
                                if (!empty($metaFontSize)) {
                                    $style .= 'font-size:' . esc_attr($metaFontSize) . 'px;';
                                }
                                if (!empty($metaBgColor)) {
                                    $style .= 'background-color: ' . esc_attr($metaBgColor) . '; ';
                                }

                                $output .= '<div class="meta-date" >';
                                $output .= '<span style="' . $style . '">';

                                // Build dynamic style for the icon
                                $iconStyle = '';
                                if (!empty($metaIconColor)) {
                                    $iconStyle .= 'color:' . esc_attr($metaIconColor) . ';';
                                }
                                if (!empty($metaFontSize)) {
                                    $iconStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px;';
                                }

                                if ($showPostDateIcon && $showMetaIcon) {
                                    $output .= '<i class="fas fa-calendar-alt" style="' . $iconStyle . '"></i> ';
                                }

                                $output .= esc_html($getdate);
                                $output .= '</span>';
                                $output .= '</div>';
                            }

                            $output .= '</div>'; // Close fancy-post-image fpg-thumb
                        }

                    // MAIN Content
                    $output .= '<div class="fpg-content" style="';
                        // MARGIN
                        if (
                            isset($contentitemMarginNew['top']) ||
                            isset($contentitemMarginNew['right']) ||
                            isset($contentitemMarginNew['bottom']) ||
                            isset($contentitemMarginNew['left'])
                        ) {
                            $output .= 'margin: ' .
                                (isset($contentitemMarginNew['top']) ? (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) : '0px') . ' ' .
                                (isset($contentitemMarginNew['right']) ? (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) : '0px') . ' ' .
                                (isset($contentitemMarginNew['bottom']) ? (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) : '0px') . ' ' .
                                (isset($contentitemMarginNew['left']) ? (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) : '0px') . '; ';
                        }

                        // PADDING
                        if (
                            isset($contentitemPaddingNew['top']) ||
                            isset($contentitemPaddingNew['right']) ||
                            isset($contentitemPaddingNew['bottom']) ||
                            isset($contentitemPaddingNew['left'])
                        ) {
                            $output .= 'padding: ' .
                                (isset($contentitemPaddingNew['top']) ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' .
                                (isset($contentitemPaddingNew['right']) ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' .
                                (isset($contentitemPaddingNew['bottom']) ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' .
                                (isset($contentitemPaddingNew['left']) ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; ';
                        }

                        // BORDER WIDTH
                        if (
                            isset($contentBorderWidth['top']) ||
                            isset($contentBorderWidth['right']) ||
                            isset($contentBorderWidth['bottom']) ||
                            isset($contentBorderWidth['left'])
                        ) {
                            $output .= 'border-width: ' .
                                (isset($contentBorderWidth['top']) ? (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) : '0px') . ' ' .
                                (isset($contentBorderWidth['right']) ? (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) : '0px') . ' ' .
                                (isset($contentBorderWidth['bottom']) ? (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) : '0px') . ' ' .
                                (isset($contentBorderWidth['left']) ? (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) : '0px') . '; ';
                        }
                        // BORDER radius
                        if (
                            isset($contentitemRadius['top']) ||
                            isset($contentitemRadius['right']) ||
                            isset($contentitemRadius['bottom']) ||
                            isset($contentitemRadius['left'])
                        ) {
                            $output .= 'border-radius: ' .
                                (isset($contentitemRadius['top']) ? (is_numeric($contentitemRadius['top']) ? $contentitemRadius['top'] . 'px' : esc_attr($contentitemRadius['top'])) : '0px') . ' ' .
                                (isset($contentitemRadius['right']) ? (is_numeric($contentitemRadius['right']) ? $contentitemRadius['right'] . 'px' : esc_attr($contentitemRadius['right'])) : '0px') . ' ' .
                                (isset($contentitemRadius['bottom']) ? (is_numeric($contentitemRadius['bottom']) ? $contentitemRadius['bottom'] . 'px' : esc_attr($contentitemRadius['bottom'])) : '0px') . ' ' .
                                (isset($contentitemRadius['left']) ? (is_numeric($contentitemRadius['left']) ? $contentitemRadius['left'] . 'px' : esc_attr($contentitemRadius['left'])) : '0px') . '; ';
                        }
                        // Border Style
                        if (!empty($contentNormalBorderType)) {
                            $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                        }
                        // Background Color
                        if (!empty($contentBgColor)) {
                            $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                        }
                        // Border Color
                        if (!empty($contentBorderColor)) {
                            $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                        }
                    $output .= '">';

                    // title
                    if ($showPostTitle) {
                        $titleStyles = '';

                        // Order
                        if (!empty($titleOrder)) {
                            $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                        }

                        // Background color
                        if (!empty($postTitleBgColor)) {
                            $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                        }

                        // Margin
                        if (isset($postTitleMargin['top']) || isset($postTitleMargin['right']) || isset($postTitleMargin['bottom']) || isset($postTitleMargin['left'])) {
                            $titleStyles .= 'margin: ' .
                                (isset($postTitleMargin['top']) ? (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) : '0px') . ' ' .
                                (isset($postTitleMargin['right']) ? (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) : '0px') . ' ' .
                                (isset($postTitleMargin['bottom']) ? (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) : '0px') . ' ' .
                                (isset($postTitleMargin['left']) ? (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) : '0px') . '; ';
                        }

                        // Padding
                        if (isset($postTitlePadding['top']) || isset($postTitlePadding['right']) || isset($postTitlePadding['bottom']) || isset($postTitlePadding['left'])) {
                            $titleStyles .= 'padding: ' .
                                (isset($postTitlePadding['top']) ? (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) : '0px') . ' ' .
                                (isset($postTitlePadding['right']) ? (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) : '0px') . ' ' .
                                (isset($postTitlePadding['bottom']) ? (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) : '0px') . ' ' .
                                (isset($postTitlePadding['left']) ? (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) : '0px') . '; ';
                        }

                        // Determine if underline should be shown
                        $showUnderline = $postLinkType === 'yeslink' && $titleHoverUnderLine === 'enable';

                        // Class name
                        $classNames = 'title align-' . esc_attr($postTitleAlignment);
                        if ($showUnderline) {
                            $classNames .= ' underline';
                        }

                        // Hover/Out events for nolink
                        $onmouseover = '';
                        $onmouseout  = '';

                        if (!empty($postTitleHoverBgColor)) {
                            $onmouseover .= 'this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';';
                        }

                        if (!empty($postTitleHoverColor)) {
                            $onmouseover .= ' this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                        }

                        if (!empty($postTitleBgColor)) {
                            $onmouseout .= 'this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';';
                        } else {
                            $onmouseout .= 'this.style.removeProperty(\'background-color\');';
                        }

                        if (!empty($postTitleColor)) {
                            $onmouseout .= ' this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                        } else {
                            $onmouseout .= ' this.style.removeProperty(\'color\');';
                        }

                        // Opening title tag
                        $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"'
                            . (!empty($onmouseover) ? ' onmouseover="' . trim($onmouseover) . '"' : '')
                            . (!empty($onmouseout)  ? ' onmouseout="'  . trim($onmouseout)  . '"' : '') . '>';

                        if ($postLinkType === 'yeslink') {
                            // Anchor styles
                            $style = '';
                            $hoverStyle = '';
                            $mouseoutStyle = '';

                            if (!empty($postTitleFontSize)) {
                                $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                            }

                            if (!empty($postTitleLineHeight)) {
                                $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                            }

                            if (!empty($postTitleLetterSpacing)) {
                                $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                            }

                            if (!empty($postTitleFontWeight)) {
                                $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                            }

                            if (!empty($postTitleColor)) {
                                $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                $mouseoutStyle .= 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                            } else {
                                $mouseoutStyle .= 'this.style.color=\'\';';
                            }

                            if (!empty($postTitleHoverColor)) {
                                $hoverStyle .= 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                            }

                            if ($showUnderline && !empty($postTitleHoverColor)) {
                                $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                                $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                $hoverStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                            }

                            if ($showUnderline && empty($postTitleColor ) && !empty($postTitleColor )) {
                                $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                                $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                $mouseoutStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                            } else {
                                
                                $mouseoutStyle .= ' this.style.removeProperty(\'background-position\');';
                                $mouseoutStyle .= ' this.style.removeProperty(\'background-size\');';
                            }

                            $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '
                                style="' . esc_attr(trim($style)) . '"'
                                . (!empty($hoverStyle)   ? ' onmouseover="' . $hoverStyle . '"' : '')
                                . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                . esc_html($croppedTitle) . '</a>';
                        } else {
                            // No link  render span with inline styles
                            $inlineStyle = '';
                            if (!empty($postTitleFontSize)) {
                                $inlineStyle .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                            }
                            if (!empty($postTitleLineHeight)) {
                                $inlineStyle .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                            }
                            if (!empty($postTitleLetterSpacing)) {
                                $inlineStyle .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                            }
                            if (!empty($postTitleFontWeight)) {
                                $inlineStyle .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                            }
                            if (!empty($postTitleColor)) {
                                $inlineStyle .= 'color: ' . esc_attr($postTitleColor) . '; ';
                            }

                            $output .= '<span style="' . esc_attr(trim($inlineStyle)) . '">' . esc_html($croppedTitle) . '</span>';
                        }

                        $output .= '</' . esc_attr($titleTag) . '>';
                    }
                    // Now Insert Meta Data inside the Thumbnail
                    if ($showMetaData) {
                        $output .= '<div class="fpg-meta align-' . $metaAlignment . '">';
                        $output .= '<ul class="meta-data-list" style="';  
                            // MARGIN
                            if (
                                isset($metaMarginNew['top']) ||
                                isset($metaMarginNew['right']) ||
                                isset($metaMarginNew['bottom']) ||
                                isset($metaMarginNew['left'])
                            ) {
                                $output .= 'margin: ' .
                                    (isset($metaMarginNew['top']) ? (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) : '0px') . ' ' .
                                    (isset($metaMarginNew['right']) ? (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) : '0px') . ' ' .
                                    (isset($metaMarginNew['bottom']) ? (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) : '0px') . ' ' .
                                    (isset($metaMarginNew['left']) ? (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) : '0px') . '; ';
                            }

                            // PADDING
                            if (
                                isset($metaPadding['top']) ||
                                isset($metaPadding['right']) ||
                                isset($metaPadding['bottom']) ||
                                isset($metaPadding['left'])
                            ) {
                                $output .= 'padding: ' .
                                    (isset($metaPadding['top']) ? (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) : '0px') . ' ' .
                                    (isset($metaPadding['right']) ? (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) : '0px') . ' ' .
                                    (isset($metaPadding['bottom']) ? (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) : '0px') . ' ' .
                                    (isset($metaPadding['left']) ? (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) : '0px') . '; ';
                            } 
                            
                            // Color
                            if (!empty($metaTextColor)) {
                                $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                            }
                            // Order
                            if (!empty($metaOrder)) {
                                $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                            }
                        $output .= '">';

                        $meta_items = [];

                        // Author
                        if ($showPostAuthor) {
                            $meta = '<li class="meta-author" style="';

                            if (!empty($metaTextColor)) {
                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '">';

                            if ($showPostAuthorIcon && $showMetaIcon) {
                                $meta .= '<i class="fas fa-user" style="';

                                if (!empty($metaIconColor)) {
                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                }

                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $meta .= '"></i> ';
                            }

                            $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                            $meta_items[] = $meta;
                        }
                        // Category
                        if ($showPostCategory) {
                            $meta = '<li class="meta-categories" style="';

                            if (!empty($metaTextColor)) {
                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '">';

                            if ($showPostCategoryIcon && $showMetaIcon) {
                                $meta .= '<i class="fas fa-folder" style="';

                                if (!empty($metaIconColor)) {
                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                }

                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $meta .= '"></i> ';
                            }

                            // Get category names without links
                            $categories_list = get_the_category($post_id);
                            if (!empty($categories_list)) {
                                $category_names = array();
                                foreach ($categories_list as $category) {
                                    $category_names[] = esc_html($category->name);
                                }
                                $meta .= implode(', ', $category_names); // comma-separated plain text categories
                            }

                            $meta .= '</li>';
                            $meta_items[] = $meta;
                        }
                        // Tags
                        if ($showPostTags && !empty($tags)) {
                            $meta = '<li class="meta-tags" style="';

                            if (!empty($metaTextColor)) {
                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '">';

                            if ($showPostTagsIcon && $showMetaIcon) {
                                $meta .= '<i class="fas fa-tags" style="';

                                if (!empty($metaIconColor)) {
                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                }

                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $meta .= '"></i> ';
                            }

                            $meta .= esc_html__('Tags:', 'fancy-post-grid') . ' ' . $tags . '</li>';
                            $meta_items[] = $meta;
                        }
                        // Comment Count
                        if ($showPostCommentsCount) {
                            $meta = '<li class="meta-comment-count" style="';
                            if (!empty($metaTextColor)) {
                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                            }
                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '">';

                            if ($showPostCommentsCountIcon && $showMetaIcon) {
                                $meta .= '<i class="fas fa-comments" style="';
                                if (!empty($metaIconColor)) {
                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                }
                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }
                                $meta .= '"></i> ';
                            }

                            $meta .= esc_html($comments_count) . ' ' . esc_html__('Comments', 'fancy-post-grid') . '</li>';
                            $meta_items[] = $meta;
                        }
                        // Now join meta items with the separator
                        if (!empty($meta_items)) {
                            $separator = '';

                            if ($metaSeperator !== '') {
                                $separator = '';
                                if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                    $separatorStyle = '';
                                    if (!empty($separatorColor)) {
                                        $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                    }
                                    if (!empty($metaFontSize)) {
                                        $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                                }
                            }

                            $output .= implode($separator, $meta_items);
                        }
                        $output .= '</ul>'; // Close meta-data-list
                        $output .= '</div>'; // Close meta-data-list
                    }
                    // Excerpt
                    if ($showPostExcerpt) {
                        $excerptStyles = '';
                        $excerptColorStyles = '';

                        // Order
                        if (!empty($excerptOrder)) {
                            $excerptStyles .= 'order: ' . esc_attr($excerptOrder) . '; ';
                        }

                        // Typography
                        if (!empty($excerptFontSize)) {
                            $excerptStyles .= 'font-size: ' . esc_attr($excerptFontSize) . 'px; ';
                        }

                        if (!empty($excerptLineHeight)) {
                            $excerptStyles .= 'line-height: ' . esc_attr($excerptLineHeight) . '; ';
                        }

                        if (!empty($excerptLetterSpacing)) {
                            $excerptStyles .= 'letter-spacing: ' . esc_attr($excerptLetterSpacing) . 'px; ';
                        }

                        if (!empty($excerptFontWeight)) {
                            $excerptStyles .= 'font-weight: ' . esc_attr($excerptFontWeight) . '; ';
                        }

                        if (!empty($excerptColor)) {
                            $excerptColorStyles .= 'color: ' . esc_attr($excerptColor) . '; ';
                        }

                        if (!empty($excerptBgColor)) {
                            $excerptColorStyles .= 'background-color: ' . esc_attr($excerptBgColor) . '; ';
                        }

                        if (!empty($excerptBorderType)) {
                            $excerptStyles .= 'border-style: ' . esc_attr($excerptBorderType) . '; ';
                        }

                        // Margin
                        if (isset($excerptMargin['top']) || isset($excerptMargin['right']) || isset($excerptMargin['bottom']) || isset($excerptMargin['left'])) {
                            $excerptStyles .= 'margin: ' .
                                (isset($excerptMargin['top']) ? (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) : '0px') . ' ' .
                                (isset($excerptMargin['right']) ? (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) : '0px') . ' ' .
                                (isset($excerptMargin['bottom']) ? (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) : '0px') . ' ' .
                                (isset($excerptMargin['left']) ? (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) : '0px') . '; ';
                        }

                        // Padding
                        if (isset($excerptPadding['top']) || isset($excerptPadding['right']) || isset($excerptPadding['bottom']) || isset($excerptPadding['left'])) {
                            $excerptStyles .= 'padding: ' .
                                (isset($excerptPadding['top']) ? (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) : '0px') . ' ' .
                                (isset($excerptPadding['right']) ? (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) : '0px') . ' ' .
                                (isset($excerptPadding['bottom']) ? (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) : '0px') . ' ' .
                                (isset($excerptPadding['left']) ? (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) : '0px') . '; ';
                        }

                        // Handle hover logic conditionally
                        $hoverIn = '';
                        $hoverOut = '';

                        if (!empty($excerptHoverColor)) {
                            $hoverIn .= 'this.style.color=\'' . esc_attr($excerptHoverColor) . '\';';
                            $hoverOut .= 'this.style.color=\'' . esc_attr($excerptColor) . '\';';
                        }

                        if (!empty($excerptHoverBgColor)) {
                            $hoverIn .= 'this.style.backgroundColor=\'' . esc_attr($excerptHoverBgColor) . '\';';
                            $hoverOut .= 'this.style.backgroundColor=\'' . esc_attr($excerptBgColor) . '\';';
                        }

                        $output .= '<div class="fpg-excerpt' . ' align-' . esc_attr($excerptAlignment) . '" style="' . esc_attr(trim($excerptStyles)) . '"';

                        $output .= '>';
                        $output .= '<p style="' . esc_attr(trim($excerptColorStyles)) . '"';

                            if (!empty($hoverIn) || !empty($hoverOut)) {
                                if (!empty($hoverIn)) {
                                    $output .= ' onmouseover="' . esc_attr($hoverIn) . '"';
                                }
                                if (!empty($hoverOut)) {
                                    $output .= ' onmouseout="' . esc_attr($hoverOut) . '"';
                                }
                            }

                            $output .= '>' . esc_html($excerpt) . '</p>';
                        $output .= '</div>';
                    }
                    // End Excerpt

                    $output .= '</div>';
                    // End MAIN Content
                    $output .= '</div>';
                    // End Full post layout
                }
                elseif ($gridLayoutStyle === 'style5') {
                    $afterStyles = '.pre-blog-item.style_12:after {';
                    $afterStyles .= 'content: "";';
                    $afterStyles .= 'display: block;';
                    $afterStyles .= 'border-color: ' . (!empty($itemBorderColor) ? esc_attr($itemBorderColor) : '#332FFF') . ';';
                    $afterStyles .= 'border-style: ' . (!empty($itemBorderType) ? esc_attr($itemBorderType) : 'solid') . ';';
                    $afterStyles .= 'border-width: ' .
                                (isset($itemBorderWidth['top']) && $itemBorderWidth['top'] !== '' ? (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) : '1px') . ' ' .
                                (isset($itemBorderWidth['right']) && $itemBorderWidth['right'] !== '' ? (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) : '1px') . ' ' .
                                (isset($itemBorderWidth['bottom']) && $itemBorderWidth['bottom'] !== '' ? (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) : '1px') . ' ' .
                                (isset($itemBorderWidth['left']) && $itemBorderWidth['left'] !== '' ? (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) : '1px') . '; ';
                    $afterStyles .= 'border-radius: ' .
                                (isset($itemBorderRadius['top']) && $itemBorderRadius['top'] !== '' ? (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) : '0px') . ' ' .
                                (isset($itemBorderRadius['right']) && $itemBorderRadius['right'] !== '' ? (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) : '0px') . ' ' .
                                (isset($itemBorderRadius['bottom']) && $itemBorderRadius['bottom'] !== '' ? (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) : '0px') . ' ' .
                                (isset($itemBorderRadius['left']) && $itemBorderRadius['left'] !== '' ? (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) : '0px') . '; ';
                    $afterStyles .= '}';
                    $output .= '<style>' . $afterStyles . '</style>';

                    $afterMetaStyles = '.pre-blog-item.style_12 .blog-inner-wrap .pre-image-wrap .pre-blog-meta::after {';
                    
                    $afterMetaStyles .= 'border-color: ' . (!empty($metaBgColor) ? esc_attr($metaBgColor) : '#fff') . ';';
                    $afterMetaStyles .= 'border-style: solid ;';
                    $afterMetaStyles .= 'border-width: 1px; ';
                    
                    $afterMetaStyles .= '}';
                    $output .= '<style>' . $afterMetaStyles . '</style>';

                    $afterContentStyles = '.pre-blog-item.style_12:hover .blog-inner-wrap .pre-blog-content {';
                    $afterContentStyles .= 'background: ' . (!empty($contentHoverBgColor) ? esc_attr($contentHoverBgColor) : '#332FFF') . ';';
                    $afterContentStyles .= '}';
                    $output .= '<style>' . $afterContentStyles . '</style>';

                    $borderStyles = '.pre-blog-item.style_12 .blog-inner-wrap .pre-blog-content .blog-btn-part .blog-btn.fpg-border::before {';
                    
                    $borderStyles .= 'background: ' . (!empty($buttonHoverTextColor) ? esc_attr($buttonHoverTextColor) : '#332FFF') . ';';
                    
                    $borderStyles .= '}';
                    $output .= '<style>' . $borderStyles . '</style>';

                    // Full post layout
                    $output .= '<div class="pre-blog-item style_12 pre-blog-meta-style2 default">';
                    
                    $output .= '<div class="blog-inner-wrap pre-thum-default pre-meta-blocks top align-' . $itemBoxAlignment5 . ' ' . $hoverAnimation . '' . $postLinkType . '" style="';
                        // MARGIN    
                        if (isset($itemMargin['top']) || isset($itemMargin['right']) || isset($itemMargin['bottom']) || isset($itemMargin['left'])) {
                            $output .= 'margin: ' .
                                (isset($itemMargin['top']) ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' .
                                (isset($itemMargin['right']) ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' .
                                (isset($itemMargin['bottom']) ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' .
                                (isset($itemMargin['left']) ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; ';
                        }

                        // PADDING
                        if (isset($itemPadding['top']) || isset($itemPadding['right']) || isset($itemPadding['bottom']) || isset($itemPadding['left'])) {
                            $output .= 'padding: ' .
                                (isset($itemPadding['top']) ? (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) : '0px') . ' ' .
                                (isset($itemPadding['right']) ? (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) : '0px') . ' ' .
                                (isset($itemPadding['bottom']) ? (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) : '0px') . ' ' .
                                (isset($itemPadding['left']) ? (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) : '0px') . '; ';
                        }

                        // Background Color
                        if (!empty($itemBackgroundColor)) {
                            $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                        }

                        // Box Shadow
                        if (
                            isset($itemBoxShadow['left']) ||  // horizontal offset
                            isset($itemBoxShadow['top']) ||  // vertical offset
                            isset($itemBoxShadow['right']) ||  // blur radius
                            isset($itemBoxShadow['bottom']) ||  // spread radius
                            isset($itemBoxShadowColor)
                        ) {
                            $output .= 'box-shadow: ' .
                                (isset($itemBoxShadow['left']) ? (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) : '0px') . ' ' .
                                (isset($itemBoxShadow['top']) ? (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) : '0px') . ' ' .
                                (isset($itemBoxShadow['right']) ? (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) : '0px') . ' ' .
                                (isset($itemBoxShadow['bottom']) ? (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) : '0px') . ' ' .
                                (!empty($itemBoxShadowColor) ? esc_attr($itemBoxShadowColor) : 'rgba(0,0,0,0.1)') . '; ';
                        }

                    $output .= '">';    
                    // Thumbnail
                    if ($thumbnail && $showThumbnail) {
                        $output .= '<div class="pre-image-wrap" style="';

                        // MARGIN
                        if (
                            isset($thumbnailMargin['top']) ||
                            isset($thumbnailMargin['right']) ||
                            isset($thumbnailMargin['bottom']) ||
                            isset($thumbnailMargin['left'])
                        ) {
                            $output .= 'margin: ' .
                                (isset($thumbnailMargin['top']) ? (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) : '0px') . ' ' .
                                (isset($thumbnailMargin['right']) ? (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) : '0px') . ' ' .
                                (isset($thumbnailMargin['bottom']) ? (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) : '0px') . ' ' .
                                (isset($thumbnailMargin['left']) ? (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) : '0px') . '; ';
                        }

                        // PADDING
                        if (
                            isset($thumbnailPadding['top']) ||
                            isset($thumbnailPadding['right']) ||
                            isset($thumbnailPadding['bottom']) ||
                            isset($thumbnailPadding['left'])
                        ) {
                            $output .= 'padding: ' .
                                (isset($thumbnailPadding['top']) ? (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) : '0px') . ' ' .
                                (isset($thumbnailPadding['right']) ? (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) : '0px') . ' ' .
                                (isset($thumbnailPadding['bottom']) ? (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) : '0px') . ' ' .
                                (isset($thumbnailPadding['left']) ? (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) : '0px') . '; ';
                        }

                        // BORDER RADIUS
                        if (
                            isset($thumbnailBorderRadius['top']) ||
                            isset($thumbnailBorderRadius['right']) ||
                            isset($thumbnailBorderRadius['bottom']) ||
                            isset($thumbnailBorderRadius['left'])
                        ) {
                            $output .= 'border-radius: ' .
                                (isset($thumbnailBorderRadius['top']) ? (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) : '0px') . ' ' .
                                (isset($thumbnailBorderRadius['right']) ? (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) : '0px') . ' ' .
                                (isset($thumbnailBorderRadius['bottom']) ? (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) : '0px') . ' ' .
                                (isset($thumbnailBorderRadius['left']) ? (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) : '0px') . '; ';
                        }

                        $output .= '">';

                        // Anchor with optional border-radius and overflow
                        if ($thumbnailLink) {
                            $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '>';
                            $output .= $thumbnail;
                            $output .= '</a>';
                        } else {
                            $output .= $thumbnail;
                        }
                        
                        if ($showPostDate) {
                            $output .= '<div class="pre-blog-meta" style="background:' . esc_attr($metaBgColor) . '; ">';
                            
                            $output .= '<span class="pre-date" style="color:' . esc_attr($metaTextColor) . '; " >' . esc_html(get_the_date('d')) . '</span>';
                            $output .= '<span class="pre-month" style="color:' . esc_attr($metaTextColor) . '; " > ' . esc_html(get_the_date('F')) . '</span>'; 
                            $output .= '</div>';
                        }
                        $output .= '</div>';
                    }
                    
                    // MAIN Content
                    $output .= '<div class="pre-blog-content" style="';
                        // MARGIN
                        if (
                            isset($contentitemMarginNew['top']) ||
                            isset($contentitemMarginNew['right']) ||
                            isset($contentitemMarginNew['bottom']) ||
                            isset($contentitemMarginNew['left'])
                        ) {
                            $output .= 'margin: ' .
                                (isset($contentitemMarginNew['top']) ? (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) : '0px') . ' ' .
                                (isset($contentitemMarginNew['right']) ? (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) : '0px') . ' ' .
                                (isset($contentitemMarginNew['bottom']) ? (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) : '0px') . ' ' .
                                (isset($contentitemMarginNew['left']) ? (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) : '0px') . '; ';
                        }

                        // PADDING
                        if (
                            isset($contentitemPaddingNew['top']) ||
                            isset($contentitemPaddingNew['right']) ||
                            isset($contentitemPaddingNew['bottom']) ||
                            isset($contentitemPaddingNew['left'])
                        ) {
                            $output .= 'padding: ' .
                                (isset($contentitemPaddingNew['top']) ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' .
                                (isset($contentitemPaddingNew['right']) ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' .
                                (isset($contentitemPaddingNew['bottom']) ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' .
                                (isset($contentitemPaddingNew['left']) ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; ';
                        }

                        // BORDER WIDTH
                        if (
                            isset($contentBorderWidth['top']) ||
                            isset($contentBorderWidth['right']) ||
                            isset($contentBorderWidth['bottom']) ||
                            isset($contentBorderWidth['left'])
                        ) {
                            $output .= 'border-width: ' .
                                (isset($contentBorderWidth['top']) ? (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) : '0px') . ' ' .
                                (isset($contentBorderWidth['right']) ? (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) : '0px') . ' ' .
                                (isset($contentBorderWidth['bottom']) ? (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) : '0px') . ' ' .
                                (isset($contentBorderWidth['left']) ? (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) : '0px') . '; ';
                        }
                        // BORDER radius
                        if (
                            isset($contentitemRadius['top']) ||
                            isset($contentitemRadius['right']) ||
                            isset($contentitemRadius['bottom']) ||
                            isset($contentitemRadius['left'])
                        ) {
                            $output .= 'border-radius: ' .
                                (isset($contentitemRadius['top']) ? (is_numeric($contentitemRadius['top']) ? $contentitemRadius['top'] . 'px' : esc_attr($contentitemRadius['top'])) : '0px') . ' ' .
                                (isset($contentitemRadius['right']) ? (is_numeric($contentitemRadius['right']) ? $contentitemRadius['right'] . 'px' : esc_attr($contentitemRadius['right'])) : '0px') . ' ' .
                                (isset($contentitemRadius['bottom']) ? (is_numeric($contentitemRadius['bottom']) ? $contentitemRadius['bottom'] . 'px' : esc_attr($contentitemRadius['bottom'])) : '0px') . ' ' .
                                (isset($contentitemRadius['left']) ? (is_numeric($contentitemRadius['left']) ? $contentitemRadius['left'] . 'px' : esc_attr($contentitemRadius['left'])) : '0px') . '; ';
                        }
                        // Border Style
                        if (!empty($contentNormalBorderType)) {
                            $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                        }
                        
                        // Border Color
                        if (!empty($contentBorderColor)) {
                            $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                        }
                    $output .= '">';

                    // Meta Data
                    if ($showMetaData) {
                        $output .= '<ul class="meta-data-list align-' . $metaAlignment . ' " style="';  
                            // MARGIN
                            if (
                                isset($metaMarginNew['top']) ||
                                isset($metaMarginNew['right']) ||
                                isset($metaMarginNew['bottom']) ||
                                isset($metaMarginNew['left'])
                            ) {
                                $output .= 'margin: ' .
                                    (isset($metaMarginNew['top']) ? (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) : '0px') . ' ' .
                                    (isset($metaMarginNew['right']) ? (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) : '0px') . ' ' .
                                    (isset($metaMarginNew['bottom']) ? (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) : '0px') . ' ' .
                                    (isset($metaMarginNew['left']) ? (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) : '0px') . '; ';
                            }

                            // PADDING
                            if (
                                isset($metaPadding['top']) ||
                                isset($metaPadding['right']) ||
                                isset($metaPadding['bottom']) ||
                                isset($metaPadding['left'])
                            ) {
                                $output .= 'padding: ' .
                                    (isset($metaPadding['top']) ? (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) : '0px') . ' ' .
                                    (isset($metaPadding['right']) ? (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) : '0px') . ' ' .
                                    (isset($metaPadding['bottom']) ? (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) : '0px') . ' ' .
                                    (isset($metaPadding['left']) ? (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) : '0px') . '; ';
                            }
                            
                            // Color
                            if (!empty($metaTextColor)) {
                                $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                            }
                            // Order
                            if (!empty($metaOrder)) {
                                $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                            }
                        $output .= '">';

                        $meta_items = [];

                        // Author
                        if ($showPostAuthor) {
                            $meta = '<li class="meta-author" style="';

                            if (!empty($metaTextColor)) {
                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '">';

                            if ($showPostAuthorIcon && $showMetaIcon) {
                                $meta .= '<i class="fas fa-user" style="';

                                if (!empty($metaIconColor)) {
                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                }

                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $meta .= '"></i> ';
                            }

                            $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                            $meta_items[] = $meta;
                        }
                        // Category
                        if ($showPostCategory) {
                            $meta = '<li class="meta-categories" style="';

                            if (!empty($metaTextColor)) {
                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '">';

                            if ($showPostCategoryIcon && $showMetaIcon) {
                                $meta .= '<i class="fas fa-folder" style="';

                                if (!empty($metaIconColor)) {
                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                }

                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $meta .= '"></i> ';
                            }

                            // Get category names without links
                            $categories_list = get_the_category($post_id);
                            if (!empty($categories_list)) {
                                $category_names = array();
                                foreach ($categories_list as $category) {
                                    $category_names[] = esc_html($category->name);
                                }
                                $meta .= implode(', ', $category_names); // comma-separated plain text categories
                            }

                            $meta .= '</li>';
                            $meta_items[] = $meta;
                        }
                        // Tags
                        if ($showPostTags && !empty($tags)) {
                            $meta = '<li class="meta-tags" style="';

                            if (!empty($metaTextColor)) {
                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '">';

                            if ($showPostTagsIcon && $showMetaIcon) {
                                $meta .= '<i class="fas fa-tags" style="';

                                if (!empty($metaIconColor)) {
                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                }

                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $meta .= '"></i> ';
                            }

                            $meta .= esc_html__('Tags:', 'fancy-post-grid') . ' ' . $tags . '</li>';
                            $meta_items[] = $meta;
                        }
                        // Comment Count
                        if ($showPostCommentsCount) {
                            $meta = '<li class="meta-comment-count" style="';
                            if (!empty($metaTextColor)) {
                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                            }
                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '">';

                            if ($showPostCommentsCountIcon && $showMetaIcon) {
                                $meta .= '<i class="fas fa-comments" style="';
                                if (!empty($metaIconColor)) {
                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                }
                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }
                                $meta .= '"></i> ';
                            }

                            $meta .= esc_html($comments_count) . ' ' . esc_html__('Comments', 'fancy-post-grid') . '</li>';
                            $meta_items[] = $meta;
                        }
                        // Now join meta items with the separator
                        if (!empty($meta_items)) {
                            $separator = '';

                            if ($metaSeperator !== '') {
                                $separator = '';
                                if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                    $separatorStyle = '';
                                    if (!empty($separatorColor)) {
                                        $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                    }
                                    if (!empty($metaFontSize)) {
                                        $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                                }
                            }

                            $output .= implode($separator, $meta_items);
                        }
                        $output .= '</ul>'; // Close meta-data-list               
                    }
                    // End Meta Data

                    // title
                    if ($showPostTitle) {
                        $titleStyles = '';

                        // Order
                        if (!empty($titleOrder)) {
                            $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                        }

                        // Background color
                        if (!empty($postTitleBgColor)) {
                            $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                        }

                        // Margin
                        if (isset($postTitleMargin['top']) || isset($postTitleMargin['right']) || isset($postTitleMargin['bottom']) || isset($postTitleMargin['left'])) {
                            $titleStyles .= 'margin: ' .
                                (isset($postTitleMargin['top']) ? (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) : '0px') . ' ' .
                                (isset($postTitleMargin['right']) ? (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) : '0px') . ' ' .
                                (isset($postTitleMargin['bottom']) ? (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) : '0px') . ' ' .
                                (isset($postTitleMargin['left']) ? (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) : '0px') . '; ';
                        }

                        // Padding
                        if (isset($postTitlePadding['top']) || isset($postTitlePadding['right']) || isset($postTitlePadding['bottom']) || isset($postTitlePadding['left'])) {
                            $titleStyles .= 'padding: ' .
                                (isset($postTitlePadding['top']) ? (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) : '0px') . ' ' .
                                (isset($postTitlePadding['right']) ? (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) : '0px') . ' ' .
                                (isset($postTitlePadding['bottom']) ? (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) : '0px') . ' ' .
                                (isset($postTitlePadding['left']) ? (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) : '0px') . '; ';
                        }

                        // Determine if underline should be shown
                        $showUnderline = $postLinkType === 'yeslink' && $titleHoverUnderLine === 'enable';

                        // Class name
                        $classNames = 'pre-post-title align-' . esc_attr($postTitleAlignment);
                        if ($showUnderline) {
                            $classNames .= ' underline';
                        }

                        // Hover/Out events for nolink
                        $onmouseover = '';
                        $onmouseout  = '';

                        if (!empty($postTitleHoverBgColor)) {
                            $onmouseover .= 'this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';';
                        }

                        if (!empty($postTitleHoverColor)) {
                            $onmouseover .= ' this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                        }

                        if (!empty($postTitleBgColor)) {
                            $onmouseout .= 'this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';';
                        } else {
                            $onmouseout .= 'this.style.removeProperty(\'background-color\');';
                        }

                        if (!empty($postTitleColor)) {
                            $onmouseout .= ' this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                        } else {
                            $onmouseout .= ' this.style.removeProperty(\'color\');';
                        }

                        // Opening title tag
                        $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"'
                            . (!empty($onmouseover) ? ' onmouseover="' . trim($onmouseover) . '"' : '')
                            . (!empty($onmouseout)  ? ' onmouseout="'  . trim($onmouseout)  . '"' : '') . '>';

                        if ($postLinkType === 'yeslink') {
                            // Anchor styles
                            $style = '';
                            $hoverStyle = '';
                            $mouseoutStyle = '';

                            if (!empty($postTitleFontSize)) {
                                $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                            }

                            if (!empty($postTitleLineHeight)) {
                                $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                            }

                            if (!empty($postTitleLetterSpacing)) {
                                $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                            }

                            if (!empty($postTitleFontWeight)) {
                                $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                            }

                            if (!empty($postTitleColor)) {
                                $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                $mouseoutStyle .= 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                            } else {
                                $mouseoutStyle .= 'this.style.color=\'\';';
                            }

                            if (!empty($postTitleHoverColor)) {
                                $hoverStyle .= 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                            }

                            if ($showUnderline && !empty($postTitleHoverColor)) {
                                $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                                $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                $hoverStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                            }

                            if ($showUnderline && empty($postTitleColor ) && !empty($postTitleColor )) {
                                $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                                $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                $mouseoutStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                            } else {
                                
                                $mouseoutStyle .= ' this.style.removeProperty(\'background-position\');';
                                $mouseoutStyle .= ' this.style.removeProperty(\'background-size\');';
                            }

                            $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '
                                style="' . esc_attr(trim($style)) . '"'
                                . (!empty($hoverStyle)   ? ' onmouseover="' . $hoverStyle . '"' : '')
                                . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                . esc_html($croppedTitle) . '</a>';
                        } else {
                            // No link  render span with inline styles
                            $inlineStyle = '';
                            if (!empty($postTitleFontSize)) {
                                $inlineStyle .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                            }
                            if (!empty($postTitleLineHeight)) {
                                $inlineStyle .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                            }
                            if (!empty($postTitleLetterSpacing)) {
                                $inlineStyle .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                            }
                            if (!empty($postTitleFontWeight)) {
                                $inlineStyle .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                            }
                            if (!empty($postTitleColor)) {
                                $inlineStyle .= 'color: ' . esc_attr($postTitleColor) . '; ';
                            }

                            $output .= '<span style="' . esc_attr(trim($inlineStyle)) . '">' . esc_html($croppedTitle) . '</span>';
                        }

                        $output .= '</' . esc_attr($titleTag) . '>';
                    }

                    // Excerpt
                    if ($showPostExcerpt) {
                        $excerptStyles = '';

                        // Order
                        if (!empty($excerptOrder)) {
                            $excerptStyles .= 'order: ' . esc_attr($excerptOrder) . '; ';
                        }

                        // Typography
                        if (!empty($excerptFontSize)) {
                            $excerptStyles .= 'font-size: ' . esc_attr($excerptFontSize) . 'px; ';
                        }

                        if (!empty($excerptLineHeight)) {
                            $excerptStyles .= 'line-height: ' . esc_attr($excerptLineHeight) . '; ';
                        }

                        if (!empty($excerptLetterSpacing)) {
                            $excerptStyles .= 'letter-spacing: ' . esc_attr($excerptLetterSpacing) . 'px; ';
                        }

                        if (!empty($excerptFontWeight)) {
                            $excerptStyles .= 'font-weight: ' . esc_attr($excerptFontWeight) . '; ';
                        }

                        if (!empty($excerptColor)) {
                            $excerptStyles .= 'color: ' . esc_attr($excerptColor) . '; ';
                        }

                        if (!empty($excerptBgColor)) {
                            $excerptStyles .= 'background-color: ' . esc_attr($excerptBgColor) . '; ';
                        }

                        if (!empty($excerptBorderType)) {
                            $excerptStyles .= 'border-style: ' . esc_attr($excerptBorderType) . '; ';
                        }

                        // Margin
                        if (isset($excerptMargin['top']) || isset($excerptMargin['right']) || isset($excerptMargin['bottom']) || isset($excerptMargin['left'])) {
                            $excerptStyles .= 'margin: ' .
                                (isset($excerptMargin['top']) ? (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) : '0px') . ' ' .
                                (isset($excerptMargin['right']) ? (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) : '0px') . ' ' .
                                (isset($excerptMargin['bottom']) ? (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) : '0px') . ' ' .
                                (isset($excerptMargin['left']) ? (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) : '0px') . '; ';
                        }

                        // Padding
                        if (isset($excerptPadding['top']) || isset($excerptPadding['right']) || isset($excerptPadding['bottom']) || isset($excerptPadding['left'])) {
                            $excerptStyles .= 'padding: ' .
                                (isset($excerptPadding['top']) ? (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) : '0px') . ' ' .
                                (isset($excerptPadding['right']) ? (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) : '0px') . ' ' .
                                (isset($excerptPadding['bottom']) ? (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) : '0px') . ' ' .
                                (isset($excerptPadding['left']) ? (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) : '0px') . '; ';
                        }

                        // Handle hover logic conditionally
                        $hoverIn = '';
                        $hoverOut = '';

                        if (!empty($excerptHoverColor)) {
                            $hoverIn .= 'this.style.color=\'' . esc_attr($excerptHoverColor) . '\';';
                            $hoverOut .= 'this.style.color=\'' . esc_attr($excerptColor) . '\';';
                        }

                        if (!empty($excerptHoverBgColor)) {
                            $hoverIn .= 'this.style.backgroundColor=\'' . esc_attr($excerptHoverBgColor) . '\';';
                            $hoverOut .= 'this.style.backgroundColor=\'' . esc_attr($excerptBgColor) . '\';';
                        }

                        $output .= '<div class="pre-content' . ' align-' . esc_attr($excerptAlignment) . '" style="' . esc_attr(trim($excerptStyles)) . '"';

                        if (!empty($hoverIn) || !empty($hoverOut)) {
                            $output .= ' onmouseover="' . esc_attr($hoverIn) . '"';
                            $output .= ' onmouseout="' . esc_attr($hoverOut) . '"';
                        }

                        $output .= '>';
                        $output .= '<p>' . esc_html($excerpt) . '</p>';
                        $output .= '</div>';
                    }
                    // End Excerpt
                   
                    // Button Output                
                    if ($showReadMoreButton) {
                        // Button wrapper styles
                        $buttonWrapperStyle = '';

                        if (
                            isset($buttonMarginNew['top']) || 
                            isset($buttonMarginNew['right']) || 
                            isset($buttonMarginNew['bottom']) || 
                            isset($buttonMarginNew['left'])
                        ) {
                            $buttonWrapperStyle .= 'margin: ' .
                                (isset($buttonMarginNew['top']) ? (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) : '0px') . ' ' .
                                (isset($buttonMarginNew['right']) ? (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) : '0px') . ' ' .
                                (isset($buttonMarginNew['bottom']) ? (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) : '0px') . ' ' .
                                (isset($buttonMarginNew['left']) ? (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) : '0px') . '; ';
                        }

                        // Order
                        if (!empty($buttonOrder)) {
                            $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                        }

                        $output .= '<div class="blog-btn-part align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';

                        // Button inline styles
                        $buttonInlineStyles = '';

                        if (!empty($buttonTextColor)) {
                            $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                        }
                        if (!empty($buttonBackgroundColor)) {
                            $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                        }
                        if (!empty($buttonFontSize)) {
                            $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                        }
                        if (!empty($buttonFontWeight)) {
                            $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                        }
                        if (!empty($buttonBorderColor)) {
                            $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                        }
                        if (!empty($buttonBorderType)) {
                            $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                        }

                        // Border Width
                        if (
                            isset($buttonBorderWidth['top']) || 
                            isset($buttonBorderWidth['right']) || 
                            isset($buttonBorderWidth['bottom']) || 
                            isset($buttonBorderWidth['left'])
                        ) {
                            $buttonInlineStyles .= 'border-width: ' .
                                (isset($buttonBorderWidth['top']) ? (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) : '0px') . ' ' .
                                (isset($buttonBorderWidth['right']) ? (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) : '0px') . ' ' .
                                (isset($buttonBorderWidth['bottom']) ? (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) : '0px') . ' ' .
                                (isset($buttonBorderWidth['left']) ? (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) : '0px') . '; ';
                        }

                        // Border Radius
                        if (
                            isset($buttonBorderRadius['top']) || 
                            isset($buttonBorderRadius['right']) || 
                            isset($buttonBorderRadius['bottom']) || 
                            isset($buttonBorderRadius['left'])
                        ) {
                            $buttonInlineStyles .= 'border-radius: ' .
                                (isset($buttonBorderRadius['top']) ? (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) : '0px') . ' ' .
                                (isset($buttonBorderRadius['right']) ? (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) : '0px') . ' ' .
                                (isset($buttonBorderRadius['bottom']) ? (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) : '0px') . ' ' .
                                (isset($buttonBorderRadius['left']) ? (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) : '0px') . '; ';
                        }

                        // Padding
                        if (
                            isset($buttonPaddingNew['top']) || 
                            isset($buttonPaddingNew['right']) || 
                            isset($buttonPaddingNew['bottom']) || 
                            isset($buttonPaddingNew['left'])
                        ) {
                            $buttonInlineStyles .= 'padding: ' .
                                (isset($buttonPaddingNew['top']) ? (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) : '0px') . ' ' .
                                (isset($buttonPaddingNew['right']) ? (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) : '0px') . ' ' .
                                (isset($buttonPaddingNew['bottom']) ? (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) : '0px') . ' ' .
                                (isset($buttonPaddingNew['left']) ? (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) : '0px') . '; ';
                        } 

                        // Hover styles
                        $buttonHoverInlineStyles = '';
                        $buttonResetStyles = '';

                        if (!empty($buttonHoverTextColor)) {
                            $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                            $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                        }
                        if (!empty($buttonHoverBorderColor)) {
                            $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                            $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                        }
                        if (!empty($buttonHoverBackgroundColor)) {
                            $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                            $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                        }

                        // Button anchor tag
                        $output .= '<a class="blog-btn icon-after read-more ' . esc_attr($buttonStyle5) . '" href="' . esc_url(get_permalink()) . '" ' . $targetAttr . ' style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                        if (!empty($buttonHoverInlineStyles)) {
                            $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                        }

                        if (!empty($buttonResetStyles)) {
                            $output .= ' onmouseout="' . $buttonResetStyles . '"';
                        }

                        $output .= '>';

                        $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                        $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                        $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                        if ($iconPosition === 'left' && $showButtonIcon) {
                            $output .= $leftIcon . ' ';
                        }

                        $output .= esc_html($readMoreLabel);

                        if ($iconPosition === 'right' && $showButtonIcon) {
                            $output .= ' ' . $rightIcon;
                        }

                        $output .= '</a></div>';
                    }
                    // End Button

                    $output .= '</div>';
                    // End MAIN Content
                    $output .= '</div>';
                    $output .= '</div>';
                    // End Full post layout
                } 
                elseif ($gridLayoutStyle === 'style6') {
                    // Full post layout
                    $afterMetaStyles = '.fpg-blog-layout-13-item .fpg-thumb .pre-blog-meta::after {';
                    
                    $afterMetaStyles .= 'border-color: ' . (!empty($metaBgColor) ? esc_attr($metaBgColor) : '#fff') . ';';
                    $afterMetaStyles .= 'border-style: solid ;';
                    $afterMetaStyles .= 'border-width: 1px; ';
                    
                    $afterMetaStyles .= '}';
                    $output .= '<style>' . $afterMetaStyles . '</style>';

                    $borderStyles = '.fpg-blog-layout-13-item .fpg-content .blog-btn.fpg-border::before {';
                    
                    $borderStyles .= 'background: ' . (!empty($buttonHoverTextColor) ? esc_attr($buttonHoverTextColor) : '#332FFF') . ';';
                    
                    $borderStyles .= '}';
                    $output .= '<style>' . $borderStyles . '</style>';

                    $output .= '<div class="fpg-blog-layout-13-item align-' . $itemBoxAlignment6 . ' ' . $hoverAnimation . ' ' . $postLinkType . '" style="';
                        // MARGIN    
                        if (isset($itemMargin['top']) || isset($itemMargin['right']) || isset($itemMargin['bottom']) || isset($itemMargin['left'])) {
                            $output .= 'margin: ' .
                                (isset($itemMargin['top']) ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' .
                                (isset($itemMargin['right']) ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' .
                                (isset($itemMargin['bottom']) ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' .
                                (isset($itemMargin['left']) ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; ';
                        }

                        // PADDING
                        if (isset($itemPadding['top']) || isset($itemPadding['right']) || isset($itemPadding['bottom']) || isset($itemPadding['left'])) {
                            $output .= 'padding: ' .
                                (isset($itemPadding['top']) ? (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) : '0px') . ' ' .
                                (isset($itemPadding['right']) ? (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) : '0px') . ' ' .
                                (isset($itemPadding['bottom']) ? (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) : '0px') . ' ' .
                                (isset($itemPadding['left']) ? (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) : '0px') . '; ';
                        }

                        // BORDER RADIUS
                        if (isset($itemBorderRadius['top']) || isset($itemBorderRadius['right']) || isset($itemBorderRadius['bottom']) || isset($itemBorderRadius['left'])) {
                            $output .= 'border-radius: ' .
                                (isset($itemBorderRadius['top']) ? (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) : '0px') . ' ' .
                                (isset($itemBorderRadius['right']) ? (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) : '0px') . ' ' .
                                (isset($itemBorderRadius['bottom']) ? (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) : '0px') . ' ' .
                                (isset($itemBorderRadius['left']) ? (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) : '0px') . '; ';
                        }

                        // BORDER WIDTH
                        if (isset($itemBorderWidth['top']) || isset($itemBorderWidth['right']) || isset($itemBorderWidth['bottom']) || isset($itemBorderWidth['left'])) {
                            $output .= 'border-width: ' .
                                (isset($itemBorderWidth['top']) ? (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) : '0px') . ' ' .
                                (isset($itemBorderWidth['right']) ? (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) : '0px') . ' ' .
                                (isset($itemBorderWidth['bottom']) ? (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) : '0px') . ' ' .
                                (isset($itemBorderWidth['left']) ? (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) : '0px') . '; ';
                        }

                        // Border Style & Color
                        if (!empty($itemBorderType)) {
                            $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                        }
                        if (!empty($itemBorderColor)) {
                            $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                        }

                        // Background Color
                        if (!empty($itemBackgroundColor)) {
                            $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                        }

                        // Box Shadow
                        if (
                            isset($itemBoxShadow['left']) ||  // horizontal offset
                            isset($itemBoxShadow['top']) ||  // vertical offset
                            isset($itemBoxShadow['right']) ||  // blur radius
                            isset($itemBoxShadow['bottom']) ||  // spread radius
                            isset($itemBoxShadowColor)
                        ) {
                            $output .= 'box-shadow: ' .
                                (isset($itemBoxShadow['left']) ? (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) : '0px') . ' ' .
                                (isset($itemBoxShadow['top']) ? (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) : '0px') . ' ' .
                                (isset($itemBoxShadow['right']) ? (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) : '0px') . ' ' .
                                (isset($itemBoxShadow['bottom']) ? (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) : '0px') . ' ' .
                                (!empty($itemBoxShadowColor) ? esc_attr($itemBoxShadowColor) : 'rgba(0,0,0,0.1)') . '; ';
                        }

                    $output .= '">';
                        // Thumbnail
                    if ($thumbnail && $showThumbnail) {
                        $output .= '<div class="fpg-thumb" style="';

                        // MARGIN
                        if (
                            isset($thumbnailMargin['top']) ||
                            isset($thumbnailMargin['right']) ||
                            isset($thumbnailMargin['bottom']) ||
                            isset($thumbnailMargin['left'])
                        ) {
                            $output .= 'margin: ' .
                                (isset($thumbnailMargin['top']) ? (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) : '0px') . ' ' .
                                (isset($thumbnailMargin['right']) ? (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) : '0px') . ' ' .
                                (isset($thumbnailMargin['bottom']) ? (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) : '0px') . ' ' .
                                (isset($thumbnailMargin['left']) ? (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) : '0px') . '; ';
                        }

                        // PADDING
                        if (
                            isset($thumbnailPadding['top']) ||
                            isset($thumbnailPadding['right']) ||
                            isset($thumbnailPadding['bottom']) ||
                            isset($thumbnailPadding['left'])
                        ) {
                            $output .= 'padding: ' .
                                (isset($thumbnailPadding['top']) ? (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) : '0px') . ' ' .
                                (isset($thumbnailPadding['right']) ? (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) : '0px') . ' ' .
                                (isset($thumbnailPadding['bottom']) ? (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) : '0px') . ' ' .
                                (isset($thumbnailPadding['left']) ? (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) : '0px') . '; ';
                        }

                        // BORDER RADIUS
                        if (
                            isset($thumbnailBorderRadius['top']) ||
                            isset($thumbnailBorderRadius['right']) ||
                            isset($thumbnailBorderRadius['bottom']) ||
                            isset($thumbnailBorderRadius['left'])
                        ) {
                            $output .= 'border-radius: ' .
                                (isset($thumbnailBorderRadius['top']) ? (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) : '0px') . ' ' .
                                (isset($thumbnailBorderRadius['right']) ? (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) : '0px') . ' ' .
                                (isset($thumbnailBorderRadius['bottom']) ? (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) : '0px') . ' ' .
                                (isset($thumbnailBorderRadius['left']) ? (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) : '0px') . '; ';
                        }

                        $output .= '">';

                        // Anchor with optional border-radius and overflow
                        if ($thumbnailLink) {
                            $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '>';
                            $output .= $thumbnail;
                            $output .= '</a>';
                        } else {
                            $output .= $thumbnail;
                        }
                        
                        if ($showPostDate) {
                            $output .= '<div class="pre-blog-meta" style="background:' . esc_attr($metaBgColor) . '; ">';
                            
                            $output .= '<span class="pre-date" style="color:' . esc_attr($metaTextColor) . '; ">' . esc_html(get_the_date('d')) . '</span>';
                            $output .= '<span class="pre-month" style="color:' . esc_attr($metaTextColor) . '; "> ' . esc_html(get_the_date('F')) . '</span>'; 
                            $output .= '</div>';
                        }
                        $output .= '</div>';
                    }
                    
                    // MAIN Content
                    $output .= '<div class="fpg-content" style="';
                        // MARGIN
                        if (
                            isset($contentitemMarginNew['top']) ||
                            isset($contentitemMarginNew['right']) ||
                            isset($contentitemMarginNew['bottom']) ||
                            isset($contentitemMarginNew['left'])
                        ) {
                            $output .= 'margin: ' .
                                (isset($contentitemMarginNew['top']) ? (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) : '0px') . ' ' .
                                (isset($contentitemMarginNew['right']) ? (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) : '0px') . ' ' .
                                (isset($contentitemMarginNew['bottom']) ? (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) : '0px') . ' ' .
                                (isset($contentitemMarginNew['left']) ? (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) : '0px') . '; ';
                        }

                        // PADDING
                        if (
                            isset($contentitemPaddingNew['top']) ||
                            isset($contentitemPaddingNew['right']) ||
                            isset($contentitemPaddingNew['bottom']) ||
                            isset($contentitemPaddingNew['left'])
                        ) {
                            $output .= 'padding: ' .
                                (isset($contentitemPaddingNew['top']) ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' .
                                (isset($contentitemPaddingNew['right']) ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' .
                                (isset($contentitemPaddingNew['bottom']) ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' .
                                (isset($contentitemPaddingNew['left']) ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; ';
                        }

                        // BORDER WIDTH
                        if (
                            isset($contentBorderWidth['top']) ||
                            isset($contentBorderWidth['right']) ||
                            isset($contentBorderWidth['bottom']) ||
                            isset($contentBorderWidth['left'])
                        ) {
                            $output .= 'border-width: ' .
                                (isset($contentBorderWidth['top']) ? (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) : '0px') . ' ' .
                                (isset($contentBorderWidth['right']) ? (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) : '0px') . ' ' .
                                (isset($contentBorderWidth['bottom']) ? (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) : '0px') . ' ' .
                                (isset($contentBorderWidth['left']) ? (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) : '0px') . '; ';
                        }
                        // BORDER radius
                        if (
                            isset($contentitemRadius['top']) ||
                            isset($contentitemRadius['right']) ||
                            isset($contentitemRadius['bottom']) ||
                            isset($contentitemRadius['left'])
                        ) {
                            $output .= 'border-radius: ' .
                                (isset($contentitemRadius['top']) ? (is_numeric($contentitemRadius['top']) ? $contentitemRadius['top'] . 'px' : esc_attr($contentitemRadius['top'])) : '0px') . ' ' .
                                (isset($contentitemRadius['right']) ? (is_numeric($contentitemRadius['right']) ? $contentitemRadius['right'] . 'px' : esc_attr($contentitemRadius['right'])) : '0px') . ' ' .
                                (isset($contentitemRadius['bottom']) ? (is_numeric($contentitemRadius['bottom']) ? $contentitemRadius['bottom'] . 'px' : esc_attr($contentitemRadius['bottom'])) : '0px') . ' ' .
                                (isset($contentitemRadius['left']) ? (is_numeric($contentitemRadius['left']) ? $contentitemRadius['left'] . 'px' : esc_attr($contentitemRadius['left'])) : '0px') . '; ';
                        }
                        // Border Style
                        if (!empty($contentNormalBorderType)) {
                            $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                        }
                        // Background Color
                        if (!empty($contentBgColor)) {
                            $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                        }
                        // Border Color
                        if (!empty($contentBorderColor)) {
                            $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                        }
                    $output .= '">';

                    // Meta Data
                    if ($showMetaData) {
                        $output .= '<div class="fpg-meta">'; 
                        $output .= '<ul class="meta-data-list align-' . $metaAlignment . ' " style="';  
                            // MARGIN
                            if (
                                isset($metaMarginNew['top']) ||
                                isset($metaMarginNew['right']) ||
                                isset($metaMarginNew['bottom']) ||
                                isset($metaMarginNew['left'])
                            ) {
                                $output .= 'margin: ' .
                                    (isset($metaMarginNew['top']) ? (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) : '0px') . ' ' .
                                    (isset($metaMarginNew['right']) ? (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) : '0px') . ' ' .
                                    (isset($metaMarginNew['bottom']) ? (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) : '0px') . ' ' .
                                    (isset($metaMarginNew['left']) ? (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) : '0px') . '; ';
                            }

                            // PADDING
                            if (
                                isset($metaPadding['top']) ||
                                isset($metaPadding['right']) ||
                                isset($metaPadding['bottom']) ||
                                isset($metaPadding['left'])
                            ) {
                                $output .= 'padding: ' .
                                    (isset($metaPadding['top']) ? (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) : '0px') . ' ' .
                                    (isset($metaPadding['right']) ? (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) : '0px') . ' ' .
                                    (isset($metaPadding['bottom']) ? (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) : '0px') . ' ' .
                                    (isset($metaPadding['left']) ? (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) : '0px') . '; ';
                            } 
                            
                            // Color
                            if (!empty($metaTextColor)) {
                                $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                            }
                            // Order
                            if (!empty($metaOrder)) {
                                $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                            }
                        $output .= '">';

                        $meta_items = [];

                        // Author
                        
                        if ($showPostAuthor) {
                            $meta = '<li class="meta-author">';

                            // Author Avatar
                            if ($showPostAuthorIcon && $showMetaIcon) {
                                $author_id = get_the_author_meta('ID');
                                $avatar_size = !empty($metaFontSize) ? intval($metaFontSize) * 2 : 24; // Double the font size for avatar
                                $avatar = get_avatar($author_id, $avatar_size, '', '', [
                                    'class' => 'author-avatar',
                                    'style' => !empty($metaIconColor) ? 'vertical-align:middle; margin-right:8px; border-radius:50%; color:' . esc_attr($metaIconColor) . ';' : 'vertical-align:middle; margin-right:8px; border-radius:50%;',
                                ]);
                                $meta .= $avatar;
                            }

                            // Author Name
                            $meta .= '<span style="';

                            if (!empty($metaTextColor)) {
                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '">';

                            $meta .= '<a href="' . esc_url(get_author_posts_url(get_the_author_meta('ID'))) . '" style="text-decoration:none; color:inherit;">';
                            $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author);
                            $meta .= '</a>';

                            $meta .= '</span></li>';

                            $meta_items[] = $meta;
                        }
                        if ($showPostDate) {
                            $meta = '<li class="meta-date" style="';

                            // Text color
                            if (!empty($metaTextColor)) {
                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                            }

                            // Font size
                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '">';

                            // Only year
                            $year = get_the_date('Y', $post_id); // Make sure $post_id is defined
                            $meta .= 'News in ' . esc_html($year);

                            $meta .= '</li>';
                            $meta_items[] = $meta;
                        }

                        // Now join meta items with the separator
                        if (!empty($meta_items)) {
                            $separator = '';

                            if ($metaSeperator !== '') {
                                $separator = '';
                                if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                    $separatorStyle = '';
                                    if (!empty($separatorColor)) {
                                        $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                    }
                                    if (!empty($metaFontSize)) {
                                        $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                                }
                            }

                            $output .= implode($separator, $meta_items);
                        }
                        $output .= '</ul>'; 
                        $output .= '</div>';               
                    }
                    // End Meta Data

                    // title
                    if ($showPostTitle) {
                        $titleStyles = '';

                        // Order
                        if (!empty($titleOrder)) {
                            $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                        }

                        // Background color
                        if (!empty($postTitleBgColor)) {
                            $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                        }

                        // Margin
                        if (isset($postTitleMargin['top']) || isset($postTitleMargin['right']) || isset($postTitleMargin['bottom']) || isset($postTitleMargin['left'])) {
                            $titleStyles .= 'margin: ' .
                                (isset($postTitleMargin['top']) ? (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) : '0px') . ' ' .
                                (isset($postTitleMargin['right']) ? (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) : '0px') . ' ' .
                                (isset($postTitleMargin['bottom']) ? (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) : '0px') . ' ' .
                                (isset($postTitleMargin['left']) ? (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) : '0px') . '; ';
                        }

                        // Padding
                        if (isset($postTitlePadding['top']) || isset($postTitlePadding['right']) || isset($postTitlePadding['bottom']) || isset($postTitlePadding['left'])) {
                            $titleStyles .= 'padding: ' .
                                (isset($postTitlePadding['top']) ? (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) : '0px') . ' ' .
                                (isset($postTitlePadding['right']) ? (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) : '0px') . ' ' .
                                (isset($postTitlePadding['bottom']) ? (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) : '0px') . ' ' .
                                (isset($postTitlePadding['left']) ? (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) : '0px') . '; ';
                        }

                        // Determine if underline should be shown
                        $showUnderline = $postLinkType === 'yeslink' && $titleHoverUnderLine === 'enable';

                        // Class name
                        $classNames = 'title align-' . esc_attr($postTitleAlignment);
                        if ($showUnderline) {
                            $classNames .= ' underline';
                        }

                        // Hover/Out events for nolink
                        $onmouseover = '';
                        $onmouseout  = '';

                        if (!empty($postTitleHoverBgColor)) {
                            $onmouseover .= 'this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';';
                        }

                        if (!empty($postTitleHoverColor)) {
                            $onmouseover .= ' this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                        }

                        if (!empty($postTitleBgColor)) {
                            $onmouseout .= 'this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';';
                        } else {
                            $onmouseout .= 'this.style.removeProperty(\'background-color\');';
                        }

                        if (!empty($postTitleColor)) {
                            $onmouseout .= ' this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                        } else {
                            $onmouseout .= ' this.style.removeProperty(\'color\');';
                        }

                        // Opening title tag
                        $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"'
                            . (!empty($onmouseover) ? ' onmouseover="' . trim($onmouseover) . '"' : '')
                            . (!empty($onmouseout)  ? ' onmouseout="'  . trim($onmouseout)  . '"' : '') . '>';

                        if ($postLinkType === 'yeslink') {
                            // Anchor styles
                            $style = '';
                            $hoverStyle = '';
                            $mouseoutStyle = '';

                            if (!empty($postTitleFontSize)) {
                                $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                            }

                            if (!empty($postTitleLineHeight)) {
                                $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                            }

                            if (!empty($postTitleLetterSpacing)) {
                                $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                            }

                            if (!empty($postTitleFontWeight)) {
                                $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                            }

                            if (!empty($postTitleColor)) {
                                $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                $mouseoutStyle .= 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                            } else {
                                $mouseoutStyle .= 'this.style.color=\'\';';
                            }

                            if (!empty($postTitleHoverColor)) {
                                $hoverStyle .= 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                            }

                            if ($showUnderline && !empty($postTitleHoverColor)) {
                                $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                                $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                $hoverStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                            }

                            if ($showUnderline && empty($postTitleColor ) && !empty($postTitleColor )) {
                                $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                                $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                $mouseoutStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                            } else {
                                
                                $mouseoutStyle .= ' this.style.removeProperty(\'background-position\');';
                                $mouseoutStyle .= ' this.style.removeProperty(\'background-size\');';
                            }

                            $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '
                                style="' . esc_attr(trim($style)) . '"'
                                . (!empty($hoverStyle)   ? ' onmouseover="' . $hoverStyle . '"' : '')
                                . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                . esc_html($croppedTitle) . '</a>';
                        } else {
                            // No link  render span with inline styles
                            $inlineStyle = '';
                            if (!empty($postTitleFontSize)) {
                                $inlineStyle .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                            }
                            if (!empty($postTitleLineHeight)) {
                                $inlineStyle .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                            }
                            if (!empty($postTitleLetterSpacing)) {
                                $inlineStyle .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                            }
                            if (!empty($postTitleFontWeight)) {
                                $inlineStyle .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                            }
                            if (!empty($postTitleColor)) {
                                $inlineStyle .= 'color: ' . esc_attr($postTitleColor) . '; ';
                            }

                            $output .= '<span style="' . esc_attr(trim($inlineStyle)) . '">' . esc_html($croppedTitle) . '</span>';
                        }

                        $output .= '</' . esc_attr($titleTag) . '>';
                    }
                    
                    // Button Output                
                    if ($showReadMoreButton) {
                        // Button wrapper styles
                        $buttonWrapperStyle = '';

                        if (
                            isset($buttonMarginNew['top']) || 
                            isset($buttonMarginNew['right']) || 
                            isset($buttonMarginNew['bottom']) || 
                            isset($buttonMarginNew['left'])
                        ) {
                            $buttonWrapperStyle .= 'margin: ' .
                                (isset($buttonMarginNew['top']) ? (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) : '0px') . ' ' .
                                (isset($buttonMarginNew['right']) ? (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) : '0px') . ' ' .
                                (isset($buttonMarginNew['bottom']) ? (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) : '0px') . ' ' .
                                (isset($buttonMarginNew['left']) ? (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) : '0px') . '; ';
                        }

                        // Order
                        if (!empty($buttonOrder)) {
                            $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                        }
                       
                        $output .= '<div class="btn-wrapper align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';

                        // Button inline styles
                        $buttonInlineStyles = '';

                        if (!empty($buttonTextColor)) {
                            $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                        }
                        if (!empty($buttonBackgroundColor)) {
                            $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                        }
                        if (!empty($buttonFontSize)) {
                            $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                        }
                        if (!empty($buttonFontWeight)) {
                            $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                        }
                        if (!empty($buttonBorderColor)) {
                            $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                        }
                        if (!empty($buttonBorderType)) {
                            $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                        }

                        // Border Width
                        if (
                            isset($buttonBorderWidth['top']) || 
                            isset($buttonBorderWidth['right']) || 
                            isset($buttonBorderWidth['bottom']) || 
                            isset($buttonBorderWidth['left'])
                        ) {
                            $buttonInlineStyles .= 'border-width: ' .
                                (isset($buttonBorderWidth['top']) ? (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) : '0px') . ' ' .
                                (isset($buttonBorderWidth['right']) ? (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) : '0px') . ' ' .
                                (isset($buttonBorderWidth['bottom']) ? (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) : '0px') . ' ' .
                                (isset($buttonBorderWidth['left']) ? (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) : '0px') . '; ';
                        }

                        // Border Radius
                        if (
                            isset($buttonBorderRadius['top']) || 
                            isset($buttonBorderRadius['right']) || 
                            isset($buttonBorderRadius['bottom']) || 
                            isset($buttonBorderRadius['left'])
                        ) {
                            $buttonInlineStyles .= 'border-radius: ' .
                                (isset($buttonBorderRadius['top']) ? (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) : '0px') . ' ' .
                                (isset($buttonBorderRadius['right']) ? (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) : '0px') . ' ' .
                                (isset($buttonBorderRadius['bottom']) ? (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) : '0px') . ' ' .
                                (isset($buttonBorderRadius['left']) ? (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) : '0px') . '; ';
                        }

                        // Padding
                        if (
                            isset($buttonPaddingNew['top']) || 
                            isset($buttonPaddingNew['right']) || 
                            isset($buttonPaddingNew['bottom']) || 
                            isset($buttonPaddingNew['left'])
                        ) {
                            $buttonInlineStyles .= 'padding: ' .
                                (isset($buttonPaddingNew['top']) ? (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) : '0px') . ' ' .
                                (isset($buttonPaddingNew['right']) ? (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) : '0px') . ' ' .
                                (isset($buttonPaddingNew['bottom']) ? (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) : '0px') . ' ' .
                                (isset($buttonPaddingNew['left']) ? (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) : '0px') . '; ';
                        } 

                        // Hover styles
                        $buttonHoverInlineStyles = '';
                        $buttonResetStyles = '';

                        if (!empty($buttonHoverTextColor)) {
                            $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                            $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                        }
                        if (!empty($buttonHoverBorderColor)) {
                            $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                            $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                        }
                        if (!empty($buttonHoverBackgroundColor)) {
                            $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                            $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                        }

                        // Button anchor tag
                        $output .= '<a class="blog-btn icon-after read-more ' . esc_attr($buttonStyle6) . '" href="' . esc_url(get_permalink()) . '" ' . $targetAttr . ' style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                        if (!empty($buttonHoverInlineStyles)) {
                            $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                        }

                        if (!empty($buttonResetStyles)) {
                            $output .= ' onmouseout="' . $buttonResetStyles . '"';
                        }

                        $output .= '>';

                        // Icon handling
                        $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                        $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                        $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                        if ($iconPosition === 'left' && $showButtonIcon) {
                            $output .= $leftIcon . ' ';
                        }

                        $output .= esc_html($readMoreLabel);

                        if ($iconPosition === 'right' && $showButtonIcon) {
                            $output .= ' ' . $rightIcon;
                        }

                        $output .= '</a></div>';
                    }
                    // End Button

                    $output .= '</div>';
                    // End MAIN Content
                    $output .= '</div>';
                    
                    // End Full post layout
                }
                else if ($gridLayoutStyle === 'style7') {
                    // Full post layout
                    $output .= '<div class="fpg-blog-layout-14-item grey align-' . $itemBoxAlignment7 . ' ' . $hoverAnimation . ' ' . $postLinkType . '" style="';
                        // MARGIN    
                        if (isset($itemMargin['top']) || isset($itemMargin['right']) || isset($itemMargin['bottom']) || isset($itemMargin['left'])) {
                            $output .= 'margin: ' .
                                (isset($itemMargin['top']) ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' .
                                (isset($itemMargin['right']) ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' .
                                (isset($itemMargin['bottom']) ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' .
                                (isset($itemMargin['left']) ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; ';
                        }

                        // PADDING
                        if (isset($itemPadding['top']) || isset($itemPadding['right']) || isset($itemPadding['bottom']) || isset($itemPadding['left'])) {
                            $output .= 'padding: ' .
                                (isset($itemPadding['top']) ? (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) : '0px') . ' ' .
                                (isset($itemPadding['right']) ? (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) : '0px') . ' ' .
                                (isset($itemPadding['bottom']) ? (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) : '0px') . ' ' .
                                (isset($itemPadding['left']) ? (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) : '0px') . '; ';
                        }

                        // BORDER RADIUS
                        if (isset($itemBorderRadius['top']) || isset($itemBorderRadius['right']) || isset($itemBorderRadius['bottom']) || isset($itemBorderRadius['left'])) {
                            $output .= 'border-radius: ' .
                                (isset($itemBorderRadius['top']) ? (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) : '0px') . ' ' .
                                (isset($itemBorderRadius['right']) ? (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) : '0px') . ' ' .
                                (isset($itemBorderRadius['bottom']) ? (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) : '0px') . ' ' .
                                (isset($itemBorderRadius['left']) ? (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) : '0px') . '; ';
                        }

                        // BORDER WIDTH
                        if (isset($itemBorderWidth['top']) || isset($itemBorderWidth['right']) || isset($itemBorderWidth['bottom']) || isset($itemBorderWidth['left'])) {
                            $output .= 'border-width: ' .
                                (isset($itemBorderWidth['top']) ? (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) : '0px') . ' ' .
                                (isset($itemBorderWidth['right']) ? (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) : '0px') . ' ' .
                                (isset($itemBorderWidth['bottom']) ? (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) : '0px') . ' ' .
                                (isset($itemBorderWidth['left']) ? (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) : '0px') . '; ';
                        }

                        // Border Style & Color
                        if (!empty($itemBorderType)) {
                            $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                        }
                        if (!empty($itemBorderColor)) {
                            $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                        }

                        // Background Color
                        if (!empty($itemBackgroundColor)) {
                            $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                        }

                        // Box Shadow
                        if (
                            isset($itemBoxShadow['left']) ||  // horizontal offset
                            isset($itemBoxShadow['top']) ||  // vertical offset
                            isset($itemBoxShadow['right']) ||  // blur radius
                            isset($itemBoxShadow['bottom']) ||  // spread radius
                            isset($itemBoxShadowColor)
                        ) {
                            $output .= 'box-shadow: ' .
                                (isset($itemBoxShadow['left']) ? (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) : '0px') . ' ' .
                                (isset($itemBoxShadow['top']) ? (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) : '0px') . ' ' .
                                (isset($itemBoxShadow['right']) ? (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) : '0px') . ' ' .
                                (isset($itemBoxShadow['bottom']) ? (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) : '0px') . ' ' .
                                (!empty($itemBoxShadowColor) ? esc_attr($itemBoxShadowColor) : 'rgba(0,0,0,0.1)') . '; ';
                        }

                    $output .= '">';
                    // Thumbnail
                    if ($thumbnail && $showThumbnail) {
                        $output .= '<div class="fpg-thumb" style="';

                        // MARGIN
                        if (
                            isset($thumbnailMargin['top']) ||
                            isset($thumbnailMargin['right']) ||
                            isset($thumbnailMargin['bottom']) ||
                            isset($thumbnailMargin['left'])
                        ) {
                            $output .= 'margin: ' .
                                (isset($thumbnailMargin['top']) ? (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) : '0px') . ' ' .
                                (isset($thumbnailMargin['right']) ? (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) : '0px') . ' ' .
                                (isset($thumbnailMargin['bottom']) ? (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) : '0px') . ' ' .
                                (isset($thumbnailMargin['left']) ? (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) : '0px') . '; ';
                        }

                        // PADDING
                        if (
                            isset($thumbnailPadding['top']) ||
                            isset($thumbnailPadding['right']) ||
                            isset($thumbnailPadding['bottom']) ||
                            isset($thumbnailPadding['left'])
                        ) {
                            $output .= 'padding: ' .
                                (isset($thumbnailPadding['top']) ? (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) : '0px') . ' ' .
                                (isset($thumbnailPadding['right']) ? (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) : '0px') . ' ' .
                                (isset($thumbnailPadding['bottom']) ? (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) : '0px') . ' ' .
                                (isset($thumbnailPadding['left']) ? (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) : '0px') . '; ';
                        }

                        // BORDER RADIUS
                        if (
                            isset($thumbnailBorderRadius['top']) ||
                            isset($thumbnailBorderRadius['right']) ||
                            isset($thumbnailBorderRadius['bottom']) ||
                            isset($thumbnailBorderRadius['left'])
                        ) {
                            $output .= 'border-radius: ' .
                                (isset($thumbnailBorderRadius['top']) ? (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) : '0px') . ' ' .
                                (isset($thumbnailBorderRadius['right']) ? (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) : '0px') . ' ' .
                                (isset($thumbnailBorderRadius['bottom']) ? (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) : '0px') . ' ' .
                                (isset($thumbnailBorderRadius['left']) ? (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) : '0px') . '; ';
                        }

                        $output .= '">';

                        // Anchor with optional border-radius and overflow
                        if ($thumbnailLink) {
                            $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '>';
                            $output .= $thumbnail;
                            $output .= '</a>';
                        } else {
                            $output .= $thumbnail;
                        }
                        $output .= '</div>';
                    }
                    // END Thumbnail
                    
                    // MAIN Content
                    $output .= '<div class="fpg-content" style="';
                        // MARGIN
                        if (
                            isset($contentitemMarginNew['top']) ||
                            isset($contentitemMarginNew['right']) ||
                            isset($contentitemMarginNew['bottom']) ||
                            isset($contentitemMarginNew['left'])
                        ) {
                            $output .= 'margin: ' .
                                (isset($contentitemMarginNew['top']) ? (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) : '0px') . ' ' .
                                (isset($contentitemMarginNew['right']) ? (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) : '0px') . ' ' .
                                (isset($contentitemMarginNew['bottom']) ? (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) : '0px') . ' ' .
                                (isset($contentitemMarginNew['left']) ? (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) : '0px') . '; ';
                        }

                        // PADDING
                        if (
                            isset($contentitemPaddingNew['top']) ||
                            isset($contentitemPaddingNew['right']) ||
                            isset($contentitemPaddingNew['bottom']) ||
                            isset($contentitemPaddingNew['left'])
                        ) {
                            $output .= 'padding: ' .
                                (isset($contentitemPaddingNew['top']) ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' .
                                (isset($contentitemPaddingNew['right']) ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' .
                                (isset($contentitemPaddingNew['bottom']) ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' .
                                (isset($contentitemPaddingNew['left']) ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; ';
                        }

                        // BORDER WIDTH
                        if (
                            isset($contentBorderWidth['top']) ||
                            isset($contentBorderWidth['right']) ||
                            isset($contentBorderWidth['bottom']) ||
                            isset($contentBorderWidth['left'])
                        ) {
                            $output .= 'border-width: ' .
                                (isset($contentBorderWidth['top']) ? (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) : '0px') . ' ' .
                                (isset($contentBorderWidth['right']) ? (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) : '0px') . ' ' .
                                (isset($contentBorderWidth['bottom']) ? (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) : '0px') . ' ' .
                                (isset($contentBorderWidth['left']) ? (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) : '0px') . '; ';
                        }
                        // BORDER radius
                        if (
                            isset($contentitemRadius['top']) ||
                            isset($contentitemRadius['right']) ||
                            isset($contentitemRadius['bottom']) ||
                            isset($contentitemRadius['left'])
                        ) {
                            $output .= 'border-radius: ' .
                                (isset($contentitemRadius['top']) ? (is_numeric($contentitemRadius['top']) ? $contentitemRadius['top'] . 'px' : esc_attr($contentitemRadius['top'])) : '0px') . ' ' .
                                (isset($contentitemRadius['right']) ? (is_numeric($contentitemRadius['right']) ? $contentitemRadius['right'] . 'px' : esc_attr($contentitemRadius['right'])) : '0px') . ' ' .
                                (isset($contentitemRadius['bottom']) ? (is_numeric($contentitemRadius['bottom']) ? $contentitemRadius['bottom'] . 'px' : esc_attr($contentitemRadius['bottom'])) : '0px') . ' ' .
                                (isset($contentitemRadius['left']) ? (is_numeric($contentitemRadius['left']) ? $contentitemRadius['left'] . 'px' : esc_attr($contentitemRadius['left'])) : '0px') . '; ';
                        }
                        // Border Style
                        if (!empty($contentNormalBorderType)) {
                            $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                        }
                        // Background Color
                        if (!empty($contentBgColor)) {
                            $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                        }
                        // Border Color
                        if (!empty($contentBorderColor)) {
                            $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                        }
                    $output .= '">';

                    // title
                    if ($showPostTitle) {
                        $titleStyles = '';

                        // Order
                        if (!empty($titleOrder)) {
                            $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                        }

                        // Background color
                        if (!empty($postTitleBgColor)) {
                            $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                        }

                        // Margin
                        if (isset($postTitleMargin['top']) || isset($postTitleMargin['right']) || isset($postTitleMargin['bottom']) || isset($postTitleMargin['left'])) {
                            $titleStyles .= 'margin: ' .
                                (isset($postTitleMargin['top']) ? (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) : '0px') . ' ' .
                                (isset($postTitleMargin['right']) ? (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) : '0px') . ' ' .
                                (isset($postTitleMargin['bottom']) ? (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) : '0px') . ' ' .
                                (isset($postTitleMargin['left']) ? (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) : '0px') . '; ';
                        }

                        // Padding
                        if (isset($postTitlePadding['top']) || isset($postTitlePadding['right']) || isset($postTitlePadding['bottom']) || isset($postTitlePadding['left'])) {
                            $titleStyles .= 'padding: ' .
                                (isset($postTitlePadding['top']) ? (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) : '0px') . ' ' .
                                (isset($postTitlePadding['right']) ? (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) : '0px') . ' ' .
                                (isset($postTitlePadding['bottom']) ? (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) : '0px') . ' ' .
                                (isset($postTitlePadding['left']) ? (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) : '0px') . '; ';
                        }

                        // Determine if underline should be shown
                        $showUnderline = $postLinkType === 'yeslink' && $titleHoverUnderLine === 'enable';

                        // Class name
                        $classNames = 'title align-' . esc_attr($postTitleAlignment);
                        if ($showUnderline) {
                            $classNames .= ' underline';
                        }

                        // Hover/Out events for nolink
                        $onmouseover = '';
                        $onmouseout  = '';

                        if (!empty($postTitleHoverBgColor)) {
                            $onmouseover .= 'this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';';
                        }

                        if (!empty($postTitleHoverColor)) {
                            $onmouseover .= ' this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                        }

                        if (!empty($postTitleBgColor)) {
                            $onmouseout .= 'this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';';
                        } else {
                            $onmouseout .= 'this.style.removeProperty(\'background-color\');';
                        }

                        if (!empty($postTitleColor)) {
                            $onmouseout .= ' this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                        } else {
                            $onmouseout .= ' this.style.removeProperty(\'color\');';
                        }

                        // Opening title tag
                        $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"'
                            . (!empty($onmouseover) ? ' onmouseover="' . trim($onmouseover) . '"' : '')
                            . (!empty($onmouseout)  ? ' onmouseout="'  . trim($onmouseout)  . '"' : '') . '>';

                        if ($postLinkType === 'yeslink') {
                            // Anchor styles
                            $style = '';
                            $hoverStyle = '';
                            $mouseoutStyle = '';

                            if (!empty($postTitleFontSize)) {
                                $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                            }

                            if (!empty($postTitleLineHeight)) {
                                $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                            }

                            if (!empty($postTitleLetterSpacing)) {
                                $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                            }

                            if (!empty($postTitleFontWeight)) {
                                $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                            }

                            if (!empty($postTitleColor)) {
                                $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                $mouseoutStyle .= 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                            } else {
                                $mouseoutStyle .= 'this.style.color=\'\';';
                            }

                            if (!empty($postTitleHoverColor)) {
                                $hoverStyle .= 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                            }

                            if ($showUnderline && !empty($postTitleHoverColor)) {
                                $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                                $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                $hoverStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                            }

                            if ($showUnderline && empty($postTitleColor ) && !empty($postTitleColor )) {
                                $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                                $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                $mouseoutStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                            } else {
                                
                                $mouseoutStyle .= ' this.style.removeProperty(\'background-position\');';
                                $mouseoutStyle .= ' this.style.removeProperty(\'background-size\');';
                            }

                            $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '
                                style="' . esc_attr(trim($style)) . '"'
                                . (!empty($hoverStyle)   ? ' onmouseover="' . $hoverStyle . '"' : '')
                                . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                . esc_html($croppedTitle) . '</a>';
                        } else {
                            // No link  render span with inline styles
                            $inlineStyle = '';
                            if (!empty($postTitleFontSize)) {
                                $inlineStyle .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                            }
                            if (!empty($postTitleLineHeight)) {
                                $inlineStyle .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                            }
                            if (!empty($postTitleLetterSpacing)) {
                                $inlineStyle .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                            }
                            if (!empty($postTitleFontWeight)) {
                                $inlineStyle .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                            }
                            if (!empty($postTitleColor)) {
                                $inlineStyle .= 'color: ' . esc_attr($postTitleColor) . '; ';
                            }

                            $output .= '<span style="' . esc_attr(trim($inlineStyle)) . '">' . esc_html($croppedTitle) . '</span>';
                        }

                        $output .= '</' . esc_attr($titleTag) . '>';
                    }
                    // Meta Data
                    if ($showMetaData) {
                                
                        $output .= '<div class="fpg-meta align-' . $metaAlignment . ' " style="';  
                            // MARGIN
                            if (
                                isset($metaMarginNew['top']) ||
                                isset($metaMarginNew['right']) ||
                                isset($metaMarginNew['bottom']) ||
                                isset($metaMarginNew['left'])
                            ) {
                                $output .= 'margin: ' .
                                    (isset($metaMarginNew['top']) ? (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) : '0px') . ' ' .
                                    (isset($metaMarginNew['right']) ? (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) : '0px') . ' ' .
                                    (isset($metaMarginNew['bottom']) ? (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) : '0px') . ' ' .
                                    (isset($metaMarginNew['left']) ? (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) : '0px') . '; ';
                            }

                            // PADDING
                            if (
                                isset($metaPadding['top']) ||
                                isset($metaPadding['right']) ||
                                isset($metaPadding['bottom']) ||
                                isset($metaPadding['left'])
                            ) {
                                $output .= 'padding: ' .
                                    (isset($metaPadding['top']) ? (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) : '0px') . ' ' .
                                    (isset($metaPadding['right']) ? (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) : '0px') . ' ' .
                                    (isset($metaPadding['bottom']) ? (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) : '0px') . ' ' .
                                    (isset($metaPadding['left']) ? (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) : '0px') . '; ';
                            }
                            
                            // Color
                            if (!empty($metaTextColor)) {
                                $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                            }
                            // Order
                            if (!empty($metaOrder)) {
                                $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                            }
                        $output .= '">';

                        $meta_items = [];

                        // Date
                        if ($showPostDate) {
                            $meta = '<span class="meta-date" style="';

                            // Color
                            if (!empty($metaTextColor)) {
                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                            }

                            // Font size
                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '">';

                            // Icon
                            if ($showPostDateIcon && $showMetaIcon) {
                                $meta .= '<i class="fas fa-calendar-alt" style="';

                                if (!empty($metaIconColor)) {
                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                }

                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $meta .= '"></i> ';
                            }

                            $meta .= esc_html($getdate) . '</span>';
                            $meta_items[] = $meta;
                        }
                        if ($showPostCategory) {
                            $meta = '';

                            $categories_list = get_the_category($post_id);
                            if (!empty($categories_list)) {
                                $first_category = $categories_list[0];
                                $category_url = get_category_link($first_category->term_id);

                                $meta .= '<a href="' . esc_url($category_url) . '" style="';

                                if (!empty($metaTextColor)) {
                                    $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                }
                                if (!empty($metaBgColor)) {
                                    $meta .= 'background-color:' . esc_attr($metaBgColor) . '; ';
                                }

                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $meta .= '">';

                                if ($showPostCategoryIcon && $showMetaIcon) {
                                    $meta .= '<i class="fas fa-folder" style="';
                                    if (!empty($metaIconColor)) {
                                        $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                    }
                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }
                                    $meta .= '"></i> ';
                                }

                                $meta .= esc_html($first_category->name);
                                $meta .= '</a>';
                            }

                            $meta_items[] = $meta;
                        }

                        
                        // Now join meta items with the separator
                        if (!empty($meta_items)) {
                            $separator = '';

                            if ($metaSeperator !== '') {
                                $separator = '';
                                if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                    $separatorStyle = '';
                                    if (!empty($separatorColor)) {
                                        $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                    }
                                    if (!empty($metaFontSize)) {
                                        $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                                }
                            }

                            $output .= implode($separator, $meta_items);
                        }

                        $output .= '</div>'; // Close meta-data-list
                        
                    }
                    // End Meta Data

                    $output .= '</div>';
                    // End MAIN Content
                    $output .= '</div>';
                    // End Full post layout
                }
                else if ($gridLayoutStyle === 'style8') {
                    // Full post layout
                    $output .= '<div class="fpg-blog-layout-15-item align-' . $itemBoxAlignment8 . ' ' . $hoverAnimation . ' ' . $postLinkType . '" style="';
                        // MARGIN    
                        if (isset($itemMargin['top']) || isset($itemMargin['right']) || isset($itemMargin['bottom']) || isset($itemMargin['left'])) {
                            $output .= 'margin: ' .
                                (isset($itemMargin['top']) ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' .
                                (isset($itemMargin['right']) ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' .
                                (isset($itemMargin['bottom']) ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' .
                                (isset($itemMargin['left']) ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; ';
                        }

                        // PADDING
                        if (isset($itemPadding['top']) || isset($itemPadding['right']) || isset($itemPadding['bottom']) || isset($itemPadding['left'])) {
                            $output .= 'padding: ' .
                                (isset($itemPadding['top']) ? (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) : '0px') . ' ' .
                                (isset($itemPadding['right']) ? (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) : '0px') . ' ' .
                                (isset($itemPadding['bottom']) ? (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) : '0px') . ' ' .
                                (isset($itemPadding['left']) ? (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) : '0px') . '; ';
                        }

                        // BORDER RADIUS
                        if (isset($itemBorderRadius['top']) || isset($itemBorderRadius['right']) || isset($itemBorderRadius['bottom']) || isset($itemBorderRadius['left'])) {
                            $output .= 'border-radius: ' .
                                (isset($itemBorderRadius['top']) ? (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) : '0px') . ' ' .
                                (isset($itemBorderRadius['right']) ? (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) : '0px') . ' ' .
                                (isset($itemBorderRadius['bottom']) ? (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) : '0px') . ' ' .
                                (isset($itemBorderRadius['left']) ? (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) : '0px') . '; ';
                        }

                        // BORDER WIDTH
                        if (isset($itemBorderWidth['top']) || isset($itemBorderWidth['right']) || isset($itemBorderWidth['bottom']) || isset($itemBorderWidth['left'])) {
                            $output .= 'border-width: ' .
                                (isset($itemBorderWidth['top']) ? (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) : '0px') . ' ' .
                                (isset($itemBorderWidth['right']) ? (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) : '0px') . ' ' .
                                (isset($itemBorderWidth['bottom']) ? (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) : '0px') . ' ' .
                                (isset($itemBorderWidth['left']) ? (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) : '0px') . '; ';
                        }

                        // Border Style & Color
                        if (!empty($itemBorderType)) {
                            $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                        }
                        if (!empty($itemBorderColor)) {
                            $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                        }

                        // Background Color
                        if (!empty($itemBackgroundColor)) {
                            $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                        }

                        // Box Shadow
                        if (
                            isset($itemBoxShadow['left']) ||  // horizontal offset
                            isset($itemBoxShadow['top']) ||  // vertical offset
                            isset($itemBoxShadow['right']) ||  // blur radius
                            isset($itemBoxShadow['bottom']) ||  // spread radius
                            isset($itemBoxShadowColor)
                        ) {
                            $output .= 'box-shadow: ' .
                                (isset($itemBoxShadow['left']) ? (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) : '0px') . ' ' .
                                (isset($itemBoxShadow['top']) ? (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) : '0px') . ' ' .
                                (isset($itemBoxShadow['right']) ? (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) : '0px') . ' ' .
                                (isset($itemBoxShadow['bottom']) ? (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) : '0px') . ' ' .
                                (!empty($itemBoxShadowColor) ? esc_attr($itemBoxShadowColor) : 'rgba(0,0,0,0.1)') . '; ';
                        }

                    $output .= '">';
                    
                    // MAIN Content
                    $output .= '<div class="fpg-content" style="';
                        // MARGIN
                        if (
                            isset($contentitemMarginNew['top']) ||
                            isset($contentitemMarginNew['right']) ||
                            isset($contentitemMarginNew['bottom']) ||
                            isset($contentitemMarginNew['left'])
                        ) {
                            $output .= 'margin: ' .
                                (isset($contentitemMarginNew['top']) ? (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) : '0px') . ' ' .
                                (isset($contentitemMarginNew['right']) ? (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) : '0px') . ' ' .
                                (isset($contentitemMarginNew['bottom']) ? (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) : '0px') . ' ' .
                                (isset($contentitemMarginNew['left']) ? (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) : '0px') . '; ';
                        }

                        // PADDING
                        if (
                            isset($contentitemPaddingNew['top']) ||
                            isset($contentitemPaddingNew['right']) ||
                            isset($contentitemPaddingNew['bottom']) ||
                            isset($contentitemPaddingNew['left'])
                        ) {
                            $output .= 'padding: ' .
                                (isset($contentitemPaddingNew['top']) ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' .
                                (isset($contentitemPaddingNew['right']) ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' .
                                (isset($contentitemPaddingNew['bottom']) ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' .
                                (isset($contentitemPaddingNew['left']) ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; ';
                        }

                        // BORDER WIDTH
                        if (
                            isset($contentBorderWidth['top']) ||
                            isset($contentBorderWidth['right']) ||
                            isset($contentBorderWidth['bottom']) ||
                            isset($contentBorderWidth['left'])
                        ) {
                            $output .= 'border-width: ' .
                                (isset($contentBorderWidth['top']) ? (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) : '0px') . ' ' .
                                (isset($contentBorderWidth['right']) ? (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) : '0px') . ' ' .
                                (isset($contentBorderWidth['bottom']) ? (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) : '0px') . ' ' .
                                (isset($contentBorderWidth['left']) ? (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) : '0px') . '; ';
                        }
                        // BORDER radius
                        if (
                            isset($contentitemRadius['top']) ||
                            isset($contentitemRadius['right']) ||
                            isset($contentitemRadius['bottom']) ||
                            isset($contentitemRadius['left'])
                        ) {
                            $output .= 'border-radius: ' .
                                (isset($contentitemRadius['top']) ? (is_numeric($contentitemRadius['top']) ? $contentitemRadius['top'] . 'px' : esc_attr($contentitemRadius['top'])) : '0px') . ' ' .
                                (isset($contentitemRadius['right']) ? (is_numeric($contentitemRadius['right']) ? $contentitemRadius['right'] . 'px' : esc_attr($contentitemRadius['right'])) : '0px') . ' ' .
                                (isset($contentitemRadius['bottom']) ? (is_numeric($contentitemRadius['bottom']) ? $contentitemRadius['bottom'] . 'px' : esc_attr($contentitemRadius['bottom'])) : '0px') . ' ' .
                                (isset($contentitemRadius['left']) ? (is_numeric($contentitemRadius['left']) ? $contentitemRadius['left'] . 'px' : esc_attr($contentitemRadius['left'])) : '0px') . '; ';
                        }
                        // Border Style
                        if (!empty($contentNormalBorderType)) {
                            $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                        }
                        // Background Color
                        if (!empty($contentBgColor)) {
                            $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                        }
                        // Border Color
                        if (!empty($contentBorderColor)) {
                            $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                        }
                    $output .= '">';               

                    // title
                    if ($showPostTitle) {
                        $titleStyles = '';

                        // Order
                        if (!empty($titleOrder)) {
                            $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                        }

                        // Background color
                        if (!empty($postTitleBgColor)) {
                            $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                        }

                        // Margin
                        if (isset($postTitleMargin['top']) || isset($postTitleMargin['right']) || isset($postTitleMargin['bottom']) || isset($postTitleMargin['left'])) {
                            $titleStyles .= 'margin: ' .
                                (isset($postTitleMargin['top']) ? (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) : '0px') . ' ' .
                                (isset($postTitleMargin['right']) ? (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) : '0px') . ' ' .
                                (isset($postTitleMargin['bottom']) ? (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) : '0px') . ' ' .
                                (isset($postTitleMargin['left']) ? (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) : '0px') . '; ';
                        }

                        // Padding
                        if (isset($postTitlePadding['top']) || isset($postTitlePadding['right']) || isset($postTitlePadding['bottom']) || isset($postTitlePadding['left'])) {
                            $titleStyles .= 'padding: ' .
                                (isset($postTitlePadding['top']) ? (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) : '0px') . ' ' .
                                (isset($postTitlePadding['right']) ? (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) : '0px') . ' ' .
                                (isset($postTitlePadding['bottom']) ? (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) : '0px') . ' ' .
                                (isset($postTitlePadding['left']) ? (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) : '0px') . '; ';
                        }

                        // Determine if underline should be shown
                        $showUnderline = $postLinkType === 'yeslink' && $titleHoverUnderLine === 'enable';

                        // Class name
                        $classNames = 'title align-' . esc_attr($postTitleAlignment);
                        if ($showUnderline) {
                            $classNames .= ' underline';
                        }

                        // Hover/Out events for nolink
                        $onmouseover = '';
                        $onmouseout  = '';

                        if (!empty($postTitleHoverBgColor)) {
                            $onmouseover .= 'this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';';
                        }

                        if (!empty($postTitleHoverColor)) {
                            $onmouseover .= ' this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                        }

                        if (!empty($postTitleBgColor)) {
                            $onmouseout .= 'this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';';
                        } else {
                            $onmouseout .= 'this.style.removeProperty(\'background-color\');';
                        }

                        if (!empty($postTitleColor)) {
                            $onmouseout .= ' this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                        } else {
                            $onmouseout .= ' this.style.removeProperty(\'color\');';
                        }

                        // Opening title tag
                        $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"'
                            . (!empty($onmouseover) ? ' onmouseover="' . trim($onmouseover) . '"' : '')
                            . (!empty($onmouseout)  ? ' onmouseout="'  . trim($onmouseout)  . '"' : '') . '>';

                        if ($postLinkType === 'yeslink') {
                            // Anchor styles
                            $style = '';
                            $hoverStyle = '';
                            $mouseoutStyle = '';

                            if (!empty($postTitleFontSize)) {
                                $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                            }

                            if (!empty($postTitleLineHeight)) {
                                $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                            }

                            if (!empty($postTitleLetterSpacing)) {
                                $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                            }

                            if (!empty($postTitleFontWeight)) {
                                $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                            }

                            if (!empty($postTitleColor)) {
                                $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                $mouseoutStyle .= 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                            } else {
                                $mouseoutStyle .= 'this.style.color=\'\';';
                            }

                            if (!empty($postTitleHoverColor)) {
                                $hoverStyle .= 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                            }

                            if ($showUnderline && !empty($postTitleHoverColor)) {
                                $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                                $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                $hoverStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                            }

                            if ($showUnderline && empty($postTitleColor ) && !empty($postTitleColor )) {
                                $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                                $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                $mouseoutStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                            } else {
                               
                                $mouseoutStyle .= ' this.style.removeProperty(\'background-position\');';
                                $mouseoutStyle .= ' this.style.removeProperty(\'background-size\');';
                            }

                            $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '
                                style="' . esc_attr(trim($style)) . '"'
                                . (!empty($hoverStyle)   ? ' onmouseover="' . $hoverStyle . '"' : '')
                                . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                . esc_html($croppedTitle) . '</a>';
                        } else {
                            // No link  render span with inline styles
                            $inlineStyle = '';
                            if (!empty($postTitleFontSize)) {
                                $inlineStyle .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                            }
                            if (!empty($postTitleLineHeight)) {
                                $inlineStyle .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                            }
                            if (!empty($postTitleLetterSpacing)) {
                                $inlineStyle .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                            }
                            if (!empty($postTitleFontWeight)) {
                                $inlineStyle .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                            }
                            if (!empty($postTitleColor)) {
                                $inlineStyle .= 'color: ' . esc_attr($postTitleColor) . '; ';
                            }

                            $output .= '<span style="' . esc_attr(trim($inlineStyle)) . '">' . esc_html($croppedTitle) . '</span>';
                        }

                        $output .= '</' . esc_attr($titleTag) . '>';
                    }
                    // Meta Data
                    if ($showMetaData) {
                                
                        $output .= '<div class="fpg-meta align-' . $metaAlignment . ' " style="';  
                            // MARGIN
                            if (
                                isset($metaMarginNew['top']) ||
                                isset($metaMarginNew['right']) ||
                                isset($metaMarginNew['bottom']) ||
                                isset($metaMarginNew['left'])
                            ) {
                                $output .= 'margin: ' .
                                    (isset($metaMarginNew['top']) ? (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) : '0px') . ' ' .
                                    (isset($metaMarginNew['right']) ? (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) : '0px') . ' ' .
                                    (isset($metaMarginNew['bottom']) ? (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) : '0px') . ' ' .
                                    (isset($metaMarginNew['left']) ? (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) : '0px') . '; ';
                            }

                            // PADDING
                            if (
                                isset($metaPadding['top']) ||
                                isset($metaPadding['right']) ||
                                isset($metaPadding['bottom']) ||
                                isset($metaPadding['left'])
                            ) {
                                $output .= 'padding: ' .
                                    (isset($metaPadding['top']) ? (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) : '0px') . ' ' .
                                    (isset($metaPadding['right']) ? (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) : '0px') . ' ' .
                                    (isset($metaPadding['bottom']) ? (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) : '0px') . ' ' .
                                    (isset($metaPadding['left']) ? (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) : '0px') . '; ';
                            } 
                            
                            // Color
                            if (!empty($metaTextColor)) {
                                $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                            }
                            // Order
                            if (!empty($metaOrder)) {
                                $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                            }
                        $output .= '">';

                        $meta_items = [];

                        // Date
                        if ($showPostDate) {
                            // Format the date as "Oct 14, 2024"
                            $formatted_date = get_the_date('M j, Y', $post_id); // 'M' = short month, 'j' = day (no leading 0), 'Y' = full year

                            $meta = '<span class="meta-date" style="';

                            // Color
                            if (!empty($metaTextColor)) {
                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                            }

                            // Font size
                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '">';

                            // Icon
                            if ($showPostDateIcon && $showMetaIcon) {
                                $meta .= '<i class="fas fa-calendar-alt" style="';

                                if (!empty($metaIconColor)) {
                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                }

                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $meta .= '"></i> ';
                            }

                            $meta .= esc_html($formatted_date) . '</span>';
                            $meta_items[] = $meta;
                        }

                        // Author
                        if ($showPostAuthor) {
                            $meta = '<a class="meta-author" style="';

                            if (!empty($metaTextColor)) {
                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '">';

                            if ($showPostAuthorIcon && $showMetaIcon) {
                                $meta .= '<i class="fas fa-user" style="';

                                if (!empty($metaIconColor)) {
                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                }

                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $meta .= '"></i> ';
                            }

                            $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</a>';
                            $meta_items[] = $meta;
                        }

                        // Now join meta items with the separator
                        if (!empty($meta_items)) {
                            $separator = '';

                            if ($metaSeperator !== '') {
                                $separator = '';
                                if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                    $separatorStyle = '';
                                    if (!empty($separatorColor)) {
                                        $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                    }
                                    if (!empty($metaFontSize)) {
                                        $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                                }
                            }

                            $output .= implode($separator, $meta_items);
                        }

                        $output .= '</div>'; // Close meta-data-list
                    }
                    // End Meta Data

                    $output .= '</div>';

                    // Thumbnail
                    if ($thumbnail && $showThumbnail) {
                        $output .= '<div class="fpg-thumb" style="';

                        // MARGIN
                        if (
                            isset($thumbnailMargin['top']) ||
                            isset($thumbnailMargin['right']) ||
                            isset($thumbnailMargin['bottom']) ||
                            isset($thumbnailMargin['left'])
                        ) {
                            $output .= 'margin: ' .
                                (isset($thumbnailMargin['top']) ? (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) : '0px') . ' ' .
                                (isset($thumbnailMargin['right']) ? (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) : '0px') . ' ' .
                                (isset($thumbnailMargin['bottom']) ? (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) : '0px') . ' ' .
                                (isset($thumbnailMargin['left']) ? (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) : '0px') . '; ';
                        }

                        // PADDING
                        if (
                            isset($thumbnailPadding['top']) ||
                            isset($thumbnailPadding['right']) ||
                            isset($thumbnailPadding['bottom']) ||
                            isset($thumbnailPadding['left'])
                        ) {
                            $output .= 'padding: ' .
                                (isset($thumbnailPadding['top']) ? (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) : '0px') . ' ' .
                                (isset($thumbnailPadding['right']) ? (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) : '0px') . ' ' .
                                (isset($thumbnailPadding['bottom']) ? (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) : '0px') . ' ' .
                                (isset($thumbnailPadding['left']) ? (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) : '0px') . '; ';
                        }

                        // BORDER RADIUS
                        if (
                            isset($thumbnailBorderRadius['top']) ||
                            isset($thumbnailBorderRadius['right']) ||
                            isset($thumbnailBorderRadius['bottom']) ||
                            isset($thumbnailBorderRadius['left'])
                        ) {
                            $output .= 'border-radius: ' .
                                (isset($thumbnailBorderRadius['top']) ? (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) : '0px') . ' ' .
                                (isset($thumbnailBorderRadius['right']) ? (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) : '0px') . ' ' .
                                (isset($thumbnailBorderRadius['bottom']) ? (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) : '0px') . ' ' .
                                (isset($thumbnailBorderRadius['left']) ? (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) : '0px') . '; ';
                        }

                        $output .= '">';

                        // Anchor with optional border-radius and overflow
                        if ($thumbnailLink) {
                            $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '>';
                            $output .= $thumbnail;
                            $output .= '</a>';
                        } else {
                            $output .= $thumbnail;
                        }
                        // Category
                        if ($showPostCategory) {
                            $meta = '<div class="fpg-category" style="';

                            // Add color and font-size styles if provided
                            if (!empty($metaTextColor)) {
                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                            }
                            if (!empty($metaBgColor)) {
                                $meta .= 'background-color:' . esc_attr($metaBgColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '">';

                            // Add icon if enabled
                            if ($showPostCategoryIcon && $showMetaIcon) {
                                $meta .= '<i class="fas fa-folder" style="';

                                if (!empty($metaIconColor)) {
                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                }

                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $meta .= '"></i> ';
                            }

                            // Get and display category names
                            $categories_list = get_the_category($post_id);
                            if (!empty($categories_list)) {
                                $category_names = array();
                                foreach ($categories_list as $category) {
                                    $category_names[] = esc_html($category->name);
                                }
                                $meta .= implode(', ', $category_names); // comma-separated plain text
                            }

                            $meta .= '</div>';
                            $output .= $meta;
                        }

                        $output .= '</div>'; // Close fancy-post-image fpg-thumb
                    }
                    // END Thumbnail

                    // End MAIN Content
                    $output .= '</div>';
                    // End Full post layout
                }
                else if ($gridLayoutStyle === 'style9') {
                    // Full post layout
                    $output .= '<div class="fpg-blog-layout-16-item align-' . $itemBoxAlignment9 . ' ' . $hoverAnimation . ' ' . $postLinkType . '" style="';
                        // MARGIN    
                        if (isset($itemMargin['top']) || isset($itemMargin['right']) || isset($itemMargin['bottom']) || isset($itemMargin['left'])) {
                            $output .= 'margin: ' .
                                (isset($itemMargin['top']) ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' .
                                (isset($itemMargin['right']) ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' .
                                (isset($itemMargin['bottom']) ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' .
                                (isset($itemMargin['left']) ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; ';
                        }

                        // PADDING
                        if (isset($itemPadding['top']) || isset($itemPadding['right']) || isset($itemPadding['bottom']) || isset($itemPadding['left'])) {
                            $output .= 'padding: ' .
                                (isset($itemPadding['top']) ? (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) : '0px') . ' ' .
                                (isset($itemPadding['right']) ? (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) : '0px') . ' ' .
                                (isset($itemPadding['bottom']) ? (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) : '0px') . ' ' .
                                (isset($itemPadding['left']) ? (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) : '0px') . '; ';
                        }

                        // BORDER RADIUS
                        if (isset($itemBorderRadius['top']) || isset($itemBorderRadius['right']) || isset($itemBorderRadius['bottom']) || isset($itemBorderRadius['left'])) {
                            $output .= 'border-radius: ' .
                                (isset($itemBorderRadius['top']) ? (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) : '0px') . ' ' .
                                (isset($itemBorderRadius['right']) ? (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) : '0px') . ' ' .
                                (isset($itemBorderRadius['bottom']) ? (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) : '0px') . ' ' .
                                (isset($itemBorderRadius['left']) ? (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) : '0px') . '; ';
                        }

                        // BORDER WIDTH
                        if (isset($itemBorderWidth['top']) || isset($itemBorderWidth['right']) || isset($itemBorderWidth['bottom']) || isset($itemBorderWidth['left'])) {
                            $output .= 'border-width: ' .
                                (isset($itemBorderWidth['top']) ? (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) : '0px') . ' ' .
                                (isset($itemBorderWidth['right']) ? (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) : '0px') . ' ' .
                                (isset($itemBorderWidth['bottom']) ? (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) : '0px') . ' ' .
                                (isset($itemBorderWidth['left']) ? (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) : '0px') . '; ';
                        }

                        // Border Style & Color
                        if (!empty($itemBorderType)) {
                            $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                        }
                        if (!empty($itemBorderColor)) {
                            $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                        }

                        // Background Color
                        if (!empty($itemBackgroundColor)) {
                            $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                        }

                        // Box Shadow
                        if (
                            isset($itemBoxShadow['left']) ||  // horizontal offset
                            isset($itemBoxShadow['top']) ||  // vertical offset
                            isset($itemBoxShadow['right']) ||  // blur radius
                            isset($itemBoxShadow['bottom']) ||  // spread radius
                            isset($itemBoxShadowColor)
                        ) {
                            $output .= 'box-shadow: ' .
                                (isset($itemBoxShadow['left']) ? (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) : '0px') . ' ' .
                                (isset($itemBoxShadow['top']) ? (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) : '0px') . ' ' .
                                (isset($itemBoxShadow['right']) ? (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) : '0px') . ' ' .
                                (isset($itemBoxShadow['bottom']) ? (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) : '0px') . ' ' .
                                (!empty($itemBoxShadowColor) ? esc_attr($itemBoxShadowColor) : 'rgba(0,0,0,0.1)') . '; ';
                        }

                    $output .= '">';
                    // Thumbnail
                    if ($thumbnail && $showThumbnail) {
                        $output .= '<div class="fpg-thumb" style="';

                        // MARGIN
                        if (
                            isset($thumbnailMargin['top']) ||
                            isset($thumbnailMargin['right']) ||
                            isset($thumbnailMargin['bottom']) ||
                            isset($thumbnailMargin['left'])
                        ) {
                            $output .= 'margin: ' .
                                (isset($thumbnailMargin['top']) ? (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) : '0px') . ' ' .
                                (isset($thumbnailMargin['right']) ? (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) : '0px') . ' ' .
                                (isset($thumbnailMargin['bottom']) ? (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) : '0px') . ' ' .
                                (isset($thumbnailMargin['left']) ? (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) : '0px') . '; ';
                        }

                        // PADDING
                        if (
                            isset($thumbnailPadding['top']) ||
                            isset($thumbnailPadding['right']) ||
                            isset($thumbnailPadding['bottom']) ||
                            isset($thumbnailPadding['left'])
                        ) {
                            $output .= 'padding: ' .
                                (isset($thumbnailPadding['top']) ? (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) : '0px') . ' ' .
                                (isset($thumbnailPadding['right']) ? (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) : '0px') . ' ' .
                                (isset($thumbnailPadding['bottom']) ? (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) : '0px') . ' ' .
                                (isset($thumbnailPadding['left']) ? (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) : '0px') . '; ';
                        }

                        // BORDER RADIUS
                        if (
                            isset($thumbnailBorderRadius['top']) ||
                            isset($thumbnailBorderRadius['right']) ||
                            isset($thumbnailBorderRadius['bottom']) ||
                            isset($thumbnailBorderRadius['left'])
                        ) {
                            $output .= 'border-radius: ' .
                                (isset($thumbnailBorderRadius['top']) ? (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) : '0px') . ' ' .
                                (isset($thumbnailBorderRadius['right']) ? (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) : '0px') . ' ' .
                                (isset($thumbnailBorderRadius['bottom']) ? (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) : '0px') . ' ' .
                                (isset($thumbnailBorderRadius['left']) ? (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) : '0px') . '; ';
                        }

                        $output .= '">';

                        // Anchor with optional border-radius and overflow
                        if ($thumbnailLink) {
                            $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '>';
                            $output .= $thumbnail;
                            $output .= '</a>';
                        } else {
                            $output .= $thumbnail;
                        }
                        $output .= '</div>';
                    }
                    // END Thumbnail
                    

                    // MAIN Content
                    $output .= '<div class="fpg-content" style="';
                        // MARGIN
                        if (
                            isset($contentitemMarginNew['top']) ||
                            isset($contentitemMarginNew['right']) ||
                            isset($contentitemMarginNew['bottom']) ||
                            isset($contentitemMarginNew['left'])
                        ) {
                            $output .= 'margin: ' .
                                (isset($contentitemMarginNew['top']) ? (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) : '0px') . ' ' .
                                (isset($contentitemMarginNew['right']) ? (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) : '0px') . ' ' .
                                (isset($contentitemMarginNew['bottom']) ? (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) : '0px') . ' ' .
                                (isset($contentitemMarginNew['left']) ? (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) : '0px') . '; ';
                        }

                        // PADDING
                        if (
                            isset($contentitemPaddingNew['top']) ||
                            isset($contentitemPaddingNew['right']) ||
                            isset($contentitemPaddingNew['bottom']) ||
                            isset($contentitemPaddingNew['left'])
                        ) {
                            $output .= 'padding: ' .
                                (isset($contentitemPaddingNew['top']) ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' .
                                (isset($contentitemPaddingNew['right']) ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' .
                                (isset($contentitemPaddingNew['bottom']) ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' .
                                (isset($contentitemPaddingNew['left']) ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; ';
                        }

                        // BORDER WIDTH
                        if (
                            isset($contentBorderWidth['top']) ||
                            isset($contentBorderWidth['right']) ||
                            isset($contentBorderWidth['bottom']) ||
                            isset($contentBorderWidth['left'])
                        ) {
                            $output .= 'border-width: ' .
                                (isset($contentBorderWidth['top']) ? (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) : '0px') . ' ' .
                                (isset($contentBorderWidth['right']) ? (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) : '0px') . ' ' .
                                (isset($contentBorderWidth['bottom']) ? (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) : '0px') . ' ' .
                                (isset($contentBorderWidth['left']) ? (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) : '0px') . '; ';
                        }
                        // BORDER radius
                        if (
                            isset($contentitemRadius['top']) ||
                            isset($contentitemRadius['right']) ||
                            isset($contentitemRadius['bottom']) ||
                            isset($contentitemRadius['left'])
                        ) {
                            $output .= 'border-radius: ' .
                                (isset($contentitemRadius['top']) ? (is_numeric($contentitemRadius['top']) ? $contentitemRadius['top'] . 'px' : esc_attr($contentitemRadius['top'])) : '0px') . ' ' .
                                (isset($contentitemRadius['right']) ? (is_numeric($contentitemRadius['right']) ? $contentitemRadius['right'] . 'px' : esc_attr($contentitemRadius['right'])) : '0px') . ' ' .
                                (isset($contentitemRadius['bottom']) ? (is_numeric($contentitemRadius['bottom']) ? $contentitemRadius['bottom'] . 'px' : esc_attr($contentitemRadius['bottom'])) : '0px') . ' ' .
                                (isset($contentitemRadius['left']) ? (is_numeric($contentitemRadius['left']) ? $contentitemRadius['left'] . 'px' : esc_attr($contentitemRadius['left'])) : '0px') . '; ';
                        }
                        // Border Style
                        if (!empty($contentNormalBorderType)) {
                            $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                        }
                        // Background Color
                        if (!empty($contentBgColor)) {
                            $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                        }
                        // Border Color
                        if (!empty($contentBorderColor)) {
                            $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                        }
                    $output .= '">';

                    // title
                    if ($showPostTitle) {
                        $titleStyles = '';

                        // Order
                        if (!empty($titleOrder)) {
                            $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                        }

                        // Background color
                        if (!empty($postTitleBgColor)) {
                            $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                        }

                        // Margin
                        if (isset($postTitleMargin['top']) || isset($postTitleMargin['right']) || isset($postTitleMargin['bottom']) || isset($postTitleMargin['left'])) {
                            $titleStyles .= 'margin: ' .
                                (isset($postTitleMargin['top']) ? (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) : '0px') . ' ' .
                                (isset($postTitleMargin['right']) ? (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) : '0px') . ' ' .
                                (isset($postTitleMargin['bottom']) ? (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) : '0px') . ' ' .
                                (isset($postTitleMargin['left']) ? (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) : '0px') . '; ';
                        }

                        // Padding
                        if (isset($postTitlePadding['top']) || isset($postTitlePadding['right']) || isset($postTitlePadding['bottom']) || isset($postTitlePadding['left'])) {
                            $titleStyles .= 'padding: ' .
                                (isset($postTitlePadding['top']) ? (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) : '0px') . ' ' .
                                (isset($postTitlePadding['right']) ? (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) : '0px') . ' ' .
                                (isset($postTitlePadding['bottom']) ? (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) : '0px') . ' ' .
                                (isset($postTitlePadding['left']) ? (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) : '0px') . '; ';
                        }

                        // Determine if underline should be shown
                        $showUnderline = $postLinkType === 'yeslink' && $titleHoverUnderLine === 'enable';

                        // Class name
                        $classNames = 'title align-' . esc_attr($postTitleAlignment);
                        if ($showUnderline) {
                            $classNames .= ' underline';
                        }

                        // Hover/Out events for nolink
                        $onmouseover = '';
                        $onmouseout  = '';

                        if (!empty($postTitleHoverBgColor)) {
                            $onmouseover .= 'this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';';
                        }

                        if (!empty($postTitleHoverColor)) {
                            $onmouseover .= ' this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                        }

                        if (!empty($postTitleBgColor)) {
                            $onmouseout .= 'this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';';
                        } else {
                            $onmouseout .= 'this.style.removeProperty(\'background-color\');';
                        }

                        if (!empty($postTitleColor)) {
                            $onmouseout .= ' this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                        } else {
                            $onmouseout .= ' this.style.removeProperty(\'color\');';
                        }

                        // Opening title tag
                        $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"'
                            . (!empty($onmouseover) ? ' onmouseover="' . trim($onmouseover) . '"' : '')
                            . (!empty($onmouseout)  ? ' onmouseout="'  . trim($onmouseout)  . '"' : '') . '>';

                        if ($postLinkType === 'yeslink') {
                            // Anchor styles
                            $style = '';
                            $hoverStyle = '';
                            $mouseoutStyle = '';

                            if (!empty($postTitleFontSize)) {
                                $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                            }

                            if (!empty($postTitleLineHeight)) {
                                $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                            }

                            if (!empty($postTitleLetterSpacing)) {
                                $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                            }

                            if (!empty($postTitleFontWeight)) {
                                $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                            }

                            if (!empty($postTitleColor)) {
                                $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                $mouseoutStyle .= 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                            } else {
                                $mouseoutStyle .= 'this.style.color=\'\';';
                            }

                            if (!empty($postTitleHoverColor)) {
                                $hoverStyle .= 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                            }

                            if ($showUnderline && !empty($postTitleHoverColor)) {
                                $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                                $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                $hoverStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                            }

                            if ($showUnderline && empty($postTitleColor ) && !empty($postTitleColor )) {
                                $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                                $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                $mouseoutStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                            } else {
                                
                                $mouseoutStyle .= ' this.style.removeProperty(\'background-position\');';
                                $mouseoutStyle .= ' this.style.removeProperty(\'background-size\');';
                            }

                            $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '
                                style="' . esc_attr(trim($style)) . '"'
                                . (!empty($hoverStyle)   ? ' onmouseover="' . $hoverStyle . '"' : '')
                                . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                . esc_html($croppedTitle) . '</a>';
                        } else {
                            // No link  render span with inline styles
                            $inlineStyle = '';
                            if (!empty($postTitleFontSize)) {
                                $inlineStyle .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                            }
                            if (!empty($postTitleLineHeight)) {
                                $inlineStyle .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                            }
                            if (!empty($postTitleLetterSpacing)) {
                                $inlineStyle .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                            }
                            if (!empty($postTitleFontWeight)) {
                                $inlineStyle .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                            }
                            if (!empty($postTitleColor)) {
                                $inlineStyle .= 'color: ' . esc_attr($postTitleColor) . '; ';
                            }

                            $output .= '<span style="' . esc_attr(trim($inlineStyle)) . '">' . esc_html($croppedTitle) . '</span>';
                        }

                        $output .= '</' . esc_attr($titleTag) . '>';
                    }

                    // Meta Data
                    if ($showMetaData) {
                        $output .= '<div class="fpg-meta align-' . esc_attr($metaAlignment) . '" style="';

                        // MARGIN
                        if (
                            isset($metaMarginNew['top']) ||
                            isset($metaMarginNew['right']) ||
                            isset($metaMarginNew['bottom']) ||
                            isset($metaMarginNew['left'])
                        ) {
                            $output .= 'margin: ' .
                                (isset($metaMarginNew['top']) ? (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) : '0px') . ' ' .
                                (isset($metaMarginNew['right']) ? (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) : '0px') . ' ' .
                                (isset($metaMarginNew['bottom']) ? (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) : '0px') . ' ' .
                                (isset($metaMarginNew['left']) ? (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) : '0px') . '; ';
                        }

                        // PADDING
                        if (
                            isset($metaPadding['top']) ||
                            isset($metaPadding['right']) ||
                            isset($metaPadding['bottom']) ||
                            isset($metaPadding['left'])
                        ) {
                            $output .= 'padding: ' .
                                (isset($metaPadding['top']) ? (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) : '0px') . ' ' .
                                (isset($metaPadding['right']) ? (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) : '0px') . ' ' .
                                (isset($metaPadding['bottom']) ? (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) : '0px') . ' ' .
                                (isset($metaPadding['left']) ? (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) : '0px') . '; ';
                        }

                        // Color
                        if (!empty($metaTextColor)) {
                            $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                        }

                        // Order
                        if (!empty($metaOrder)) {
                            $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                        }

                        $output .= '">';

                        $meta_items = [];

                        // Author
                        if ($showPostAuthor) {
                            $meta = '<div class="meta-author">';

                            // Author Avatar
                            if ($showPostAuthorIcon && $showMetaIcon) {
                                $author_id = get_the_author_meta('ID');
                                $avatar_size = !empty($metaFontSize) ? intval($metaFontSize) * 2 : 24; // Double the font size for avatar
                                $avatar = get_avatar($author_id, $avatar_size, '', '', [
                                    'class' => 'author-avatar',
                                    'style' => !empty($metaIconColor) ? 'vertical-align:middle; margin-right:8px; border-radius:50%; color:' . esc_attr($metaIconColor) . ';' : 'vertical-align:middle; margin-right:8px; border-radius:50%;',
                                ]);
                                $meta .= $avatar;
                            }

                            // Author Name
                            $meta .= '<span style="';

                            if (!empty($metaTextColor)) {
                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '">';

                            $meta .= '<a href="' . esc_url(get_author_posts_url(get_the_author_meta('ID'))) . '" style="text-decoration:none; color:inherit;">';
                            $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author);
                            $meta .= '</a>';

                            $meta .= '</span></div>';

                            $meta_items[] = $meta;
                        }

                        // Date
                        if ($showPostDate) {
                            $meta = '<div class="meta-date"><span style="';

                            if (!empty($metaTextColor)) {
                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '">';

                            if ($showPostDateIcon && $showMetaIcon) {
                                $meta .= '<i class="fa-regular fa-clock" style="';

                                if (!empty($metaIconColor)) {
                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                }

                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $meta .= '"></i> ';
                            }

                            // Format date as "26 Aug 2024"
                            $formatted_date = get_the_date('d M Y', $post_id); // use $post_id if needed
                            $meta .= esc_html($formatted_date) . '</span></div>';

                            $meta_items[] = $meta;
                        }



                        // Output all metadata without separators
                        $output .= implode('', $meta_items);

                        $output .= '</div>'; // Close .fpg-meta
                    }

                    // End Meta Data

                    $output .= '</div>';
                    // End MAIN Content
                    $output .= '</div>';
                    // End Full post layout
                }
                else if ($gridLayoutStyle === 'style10') {
                    // Full post layout
                    $borderStyles = '.fpg-blog-layout-19-item .fpg-content a.fpg-btn.fpg-border::before {';
                    
                    $borderStyles .= 'background: ' . (!empty($buttonHoverTextColor) ? esc_attr($buttonHoverTextColor) : '#332FFF') . ';';
                    
                    $borderStyles .= '}';
                    $output .= '<style>' . $borderStyles . '</style>';
                    $output .= '<div class="fpg-blog-layout-19-item align-' . $itemBoxAlignment10 . ' ' . $hoverAnimation . ' ' . $postLinkType . '" style="';
                        // MARGIN    
                        if (isset($itemMargin['top']) || isset($itemMargin['right']) || isset($itemMargin['bottom']) || isset($itemMargin['left'])) {
                            $output .= 'margin: ' .
                                (isset($itemMargin['top']) ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' .
                                (isset($itemMargin['right']) ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' .
                                (isset($itemMargin['bottom']) ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' .
                                (isset($itemMargin['left']) ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; ';
                        }

                        // PADDING
                        if (isset($itemPadding['top']) || isset($itemPadding['right']) || isset($itemPadding['bottom']) || isset($itemPadding['left'])) {
                            $output .= 'padding: ' .
                                (isset($itemPadding['top']) ? (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) : '0px') . ' ' .
                                (isset($itemPadding['right']) ? (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) : '0px') . ' ' .
                                (isset($itemPadding['bottom']) ? (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) : '0px') . ' ' .
                                (isset($itemPadding['left']) ? (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) : '0px') . '; ';
                        }

                        // BORDER RADIUS
                        if (isset($itemBorderRadius['top']) || isset($itemBorderRadius['right']) || isset($itemBorderRadius['bottom']) || isset($itemBorderRadius['left'])) {
                            $output .= 'border-radius: ' .
                                (isset($itemBorderRadius['top']) ? (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) : '0px') . ' ' .
                                (isset($itemBorderRadius['right']) ? (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) : '0px') . ' ' .
                                (isset($itemBorderRadius['bottom']) ? (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) : '0px') . ' ' .
                                (isset($itemBorderRadius['left']) ? (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) : '0px') . '; ';
                        }

                        // BORDER WIDTH
                        if (isset($itemBorderWidth['top']) || isset($itemBorderWidth['right']) || isset($itemBorderWidth['bottom']) || isset($itemBorderWidth['left'])) {
                            $output .= 'border-width: ' .
                                (isset($itemBorderWidth['top']) ? (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) : '0px') . ' ' .
                                (isset($itemBorderWidth['right']) ? (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) : '0px') . ' ' .
                                (isset($itemBorderWidth['bottom']) ? (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) : '0px') . ' ' .
                                (isset($itemBorderWidth['left']) ? (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) : '0px') . '; ';
                        }

                        // Border Style & Color
                        if (!empty($itemBorderType)) {
                            $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                        }
                        if (!empty($itemBorderColor)) {
                            $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                        }

                        // Background Color
                        if (!empty($itemBackgroundColor)) {
                            $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                        }

                        // Box Shadow
                        if (
                            isset($itemBoxShadow['left']) ||  // horizontal offset
                            isset($itemBoxShadow['top']) ||  // vertical offset
                            isset($itemBoxShadow['right']) ||  // blur radius
                            isset($itemBoxShadow['bottom']) ||  // spread radius
                            isset($itemBoxShadowColor)
                        ) {
                            $output .= 'box-shadow: ' .
                                (isset($itemBoxShadow['left']) ? (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) : '0px') . ' ' .
                                (isset($itemBoxShadow['top']) ? (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) : '0px') . ' ' .
                                (isset($itemBoxShadow['right']) ? (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) : '0px') . ' ' .
                                (isset($itemBoxShadow['bottom']) ? (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) : '0px') . ' ' .
                                (!empty($itemBoxShadowColor) ? esc_attr($itemBoxShadowColor) : 'rgba(0,0,0,0.1)') . '; ';
                        }

                    $output .= '">';
                    // Thumbnail
                    if ($thumbnail && $showThumbnail) {
                        $output .= '<div class="fpg-thumb" style="';

                        // MARGIN
                        if (
                            isset($thumbnailMargin['top']) ||
                            isset($thumbnailMargin['right']) ||
                            isset($thumbnailMargin['bottom']) ||
                            isset($thumbnailMargin['left'])
                        ) {
                            $output .= 'margin: ' .
                                (isset($thumbnailMargin['top']) ? (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) : '0px') . ' ' .
                                (isset($thumbnailMargin['right']) ? (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) : '0px') . ' ' .
                                (isset($thumbnailMargin['bottom']) ? (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) : '0px') . ' ' .
                                (isset($thumbnailMargin['left']) ? (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) : '0px') . '; ';
                        }

                        // PADDING
                        if (
                            isset($thumbnailPadding['top']) ||
                            isset($thumbnailPadding['right']) ||
                            isset($thumbnailPadding['bottom']) ||
                            isset($thumbnailPadding['left'])
                        ) {
                            $output .= 'padding: ' .
                                (isset($thumbnailPadding['top']) ? (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) : '0px') . ' ' .
                                (isset($thumbnailPadding['right']) ? (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) : '0px') . ' ' .
                                (isset($thumbnailPadding['bottom']) ? (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) : '0px') . ' ' .
                                (isset($thumbnailPadding['left']) ? (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) : '0px') . '; ';
                        }

                        // BORDER RADIUS
                        if (
                            isset($thumbnailBorderRadius['top']) ||
                            isset($thumbnailBorderRadius['right']) ||
                            isset($thumbnailBorderRadius['bottom']) ||
                            isset($thumbnailBorderRadius['left'])
                        ) {
                            $output .= 'border-radius: ' .
                                (isset($thumbnailBorderRadius['top']) ? (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) : '0px') . ' ' .
                                (isset($thumbnailBorderRadius['right']) ? (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) : '0px') . ' ' .
                                (isset($thumbnailBorderRadius['bottom']) ? (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) : '0px') . ' ' .
                                (isset($thumbnailBorderRadius['left']) ? (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) : '0px') . '; ';
                        }

                        $output .= '">';

                        // Anchor with optional border-radius and overflow
                        if ($thumbnailLink) {
                            $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '>';
                            $output .= $thumbnail;
                            $output .= '</a>';
                        } else {
                            $output .= $thumbnail;
                        }
                        $output .= '</div>';
                    }
                    // END Thumbnail
                    
                    // MAIN Content
                    $output .= '<div class="fpg-content" style="';
                        // MARGIN
                        if (
                            isset($contentitemMarginNew['top']) ||
                            isset($contentitemMarginNew['right']) ||
                            isset($contentitemMarginNew['bottom']) ||
                            isset($contentitemMarginNew['left'])
                        ) {
                            $output .= 'margin: ' .
                                (isset($contentitemMarginNew['top']) ? (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) : '0px') . ' ' .
                                (isset($contentitemMarginNew['right']) ? (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) : '0px') . ' ' .
                                (isset($contentitemMarginNew['bottom']) ? (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) : '0px') . ' ' .
                                (isset($contentitemMarginNew['left']) ? (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) : '0px') . '; ';
                        }

                        // PADDING
                        if (
                            isset($contentitemPaddingNew['top']) ||
                            isset($contentitemPaddingNew['right']) ||
                            isset($contentitemPaddingNew['bottom']) ||
                            isset($contentitemPaddingNew['left'])
                        ) {
                            $output .= 'padding: ' .
                                (isset($contentitemPaddingNew['top']) ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' .
                                (isset($contentitemPaddingNew['right']) ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' .
                                (isset($contentitemPaddingNew['bottom']) ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' .
                                (isset($contentitemPaddingNew['left']) ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; ';
                        }

                        // BORDER WIDTH
                        if (
                            isset($contentBorderWidth['top']) ||
                            isset($contentBorderWidth['right']) ||
                            isset($contentBorderWidth['bottom']) ||
                            isset($contentBorderWidth['left'])
                        ) {
                            $output .= 'border-width: ' .
                                (isset($contentBorderWidth['top']) ? (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) : '0px') . ' ' .
                                (isset($contentBorderWidth['right']) ? (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) : '0px') . ' ' .
                                (isset($contentBorderWidth['bottom']) ? (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) : '0px') . ' ' .
                                (isset($contentBorderWidth['left']) ? (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) : '0px') . '; ';
                        }
                        // BORDER radius
                        if (
                            isset($contentitemRadius['top']) ||
                            isset($contentitemRadius['right']) ||
                            isset($contentitemRadius['bottom']) ||
                            isset($contentitemRadius['left'])
                        ) {
                            $output .= 'border-radius: ' .
                                (isset($contentitemRadius['top']) ? (is_numeric($contentitemRadius['top']) ? $contentitemRadius['top'] . 'px' : esc_attr($contentitemRadius['top'])) : '0px') . ' ' .
                                (isset($contentitemRadius['right']) ? (is_numeric($contentitemRadius['right']) ? $contentitemRadius['right'] . 'px' : esc_attr($contentitemRadius['right'])) : '0px') . ' ' .
                                (isset($contentitemRadius['bottom']) ? (is_numeric($contentitemRadius['bottom']) ? $contentitemRadius['bottom'] . 'px' : esc_attr($contentitemRadius['bottom'])) : '0px') . ' ' .
                                (isset($contentitemRadius['left']) ? (is_numeric($contentitemRadius['left']) ? $contentitemRadius['left'] . 'px' : esc_attr($contentitemRadius['left'])) : '0px') . '; ';
                        }
                        // Border Style
                        if (!empty($contentNormalBorderType)) {
                            $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                        }
                        // Background Color
                        if (!empty($contentBgColor)) {
                            $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                        }
                        // Border Color
                        if (!empty($contentBorderColor)) {
                            $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                        }
                    $output .= '">';

                    // Meta Data
                    if ($showMetaData) {
                        $output .= '<div class="fpg-meta">'; 
                        $output .= '<ul class="meta-data-list align-' . $metaAlignment . ' " style="';  
                            // MARGIN
                            if (
                                isset($metaMarginNew['top']) ||
                                isset($metaMarginNew['right']) ||
                                isset($metaMarginNew['bottom']) ||
                                isset($metaMarginNew['left'])
                            ) {
                                $output .= 'margin: ' .
                                    (isset($metaMarginNew['top']) ? (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) : '0px') . ' ' .
                                    (isset($metaMarginNew['right']) ? (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) : '0px') . ' ' .
                                    (isset($metaMarginNew['bottom']) ? (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) : '0px') . ' ' .
                                    (isset($metaMarginNew['left']) ? (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) : '0px') . '; ';
                            }

                            // PADDING
                            if (
                                isset($metaPadding['top']) ||
                                isset($metaPadding['right']) ||
                                isset($metaPadding['bottom']) ||
                                isset($metaPadding['left'])
                            ) {
                                $output .= 'padding: ' .
                                    (isset($metaPadding['top']) ? (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) : '0px') . ' ' .
                                    (isset($metaPadding['right']) ? (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) : '0px') . ' ' .
                                    (isset($metaPadding['bottom']) ? (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) : '0px') . ' ' .
                                    (isset($metaPadding['left']) ? (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) : '0px') . '; ';
                            }  
                            
                            // Color
                            if (!empty($metaTextColor)) {
                                $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                            }
                            // Order
                            if (!empty($metaOrder)) {
                                $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                            }
                        $output .= '">';

                        $meta_items = [];

                        // Date
                        if ($showPostDate) {
                            $meta = '<li class="meta-date" style="';

                            // Color
                            if (!empty($metaTextColor)) {
                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                            }

                            // Font size
                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '">';

                            // Icon
                            if ($showPostDateIcon && $showMetaIcon) {
                                $meta .= '<i class="fas fa-calendar-alt" style="';

                                if (!empty($metaIconColor)) {
                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                }

                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $meta .= '"></i> ';
                            }

                            $meta .= esc_html($getdate) . '</li>';
                            $meta_items[] = $meta;
                        }
                        // Author
                        if ($showPostAuthor) {
                            $meta = '<li class="meta-author" style="';

                            if (!empty($metaTextColor)) {
                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '">';

                            if ($showPostAuthorIcon && $showMetaIcon) {
                                $meta .= '<i class="fas fa-user" style="';

                                if (!empty($metaIconColor)) {
                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                }

                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $meta .= '"></i> ';
                            }

                            $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                            $meta_items[] = $meta;
                        }
                        // Category
                        if ($showPostCategory) {
                            $meta = '<li class="meta-categories" style="';

                            if (!empty($metaTextColor)) {
                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '">';

                            if ($showPostCategoryIcon && $showMetaIcon) {
                                $meta .= '<i class="fas fa-folder" style="';

                                if (!empty($metaIconColor)) {
                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                }

                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $meta .= '"></i> ';
                            }

                            // Get category names without links
                            $categories_list = get_the_category($post_id);
                            if (!empty($categories_list)) {
                                $category_names = array();
                                foreach ($categories_list as $category) {
                                    $category_names[] = esc_html($category->name);
                                }
                                $meta .= implode(', ', $category_names); // comma-separated plain text categories
                            }

                            $meta .= '</li>';
                            $meta_items[] = $meta;
                        }
                        // Tags
                        if ($showPostTags && !empty($tags)) {
                            $meta = '<li class="meta-tags" style="';

                            if (!empty($metaTextColor)) {
                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '">';

                            if ($showPostTagsIcon && $showMetaIcon) {
                                $meta .= '<i class="fas fa-tags" style="';

                                if (!empty($metaIconColor)) {
                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                }

                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $meta .= '"></i> ';
                            }

                            $meta .= esc_html__('Tags:', 'fancy-post-grid') . ' ' . $tags . '</li>';
                            $meta_items[] = $meta;
                        }
                        // Comment Count
                        if ($showPostCommentsCount) {
                            $meta = '<li class="meta-comment-count" style="';
                            if (!empty($metaTextColor)) {
                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                            }
                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '">';

                            if ($showPostCommentsCountIcon && $showMetaIcon) {
                                $meta .= '<i class="fas fa-comments" style="';
                                if (!empty($metaIconColor)) {
                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                }
                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }
                                $meta .= '"></i> ';
                            }

                            $meta .= esc_html($comments_count) . ' ' . esc_html__('Comments', 'fancy-post-grid') . '</li>';
                            $meta_items[] = $meta;
                        }
                        // Now join meta items with the separator
                        if (!empty($meta_items)) {
                            $separator = '';

                            if ($metaSeperator !== '') {
                                $separator = '';
                                if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                    $separatorStyle = '';
                                    if (!empty($separatorColor)) {
                                        $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                    }
                                    if (!empty($metaFontSize)) {
                                        $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                                }
                            }

                            $output .= implode($separator, $meta_items);
                        }
                        $output .= '</ul>'; 
                        $output .= '</div>'; // Close meta-data-list               
                    }
                    // End Meta Data

                    // title
                    if ($showPostTitle) {
                        $titleStyles = '';

                        // Order
                        if (!empty($titleOrder)) {
                            $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                        }

                        // Background color
                        if (!empty($postTitleBgColor)) {
                            $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                        }

                        // Margin
                        if (isset($postTitleMargin['top']) || isset($postTitleMargin['right']) || isset($postTitleMargin['bottom']) || isset($postTitleMargin['left'])) {
                            $titleStyles .= 'margin: ' .
                                (isset($postTitleMargin['top']) ? (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) : '0px') . ' ' .
                                (isset($postTitleMargin['right']) ? (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) : '0px') . ' ' .
                                (isset($postTitleMargin['bottom']) ? (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) : '0px') . ' ' .
                                (isset($postTitleMargin['left']) ? (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) : '0px') . '; ';
                        }

                        // Padding
                        if (isset($postTitlePadding['top']) || isset($postTitlePadding['right']) || isset($postTitlePadding['bottom']) || isset($postTitlePadding['left'])) {
                            $titleStyles .= 'padding: ' .
                                (isset($postTitlePadding['top']) ? (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) : '0px') . ' ' .
                                (isset($postTitlePadding['right']) ? (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) : '0px') . ' ' .
                                (isset($postTitlePadding['bottom']) ? (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) : '0px') . ' ' .
                                (isset($postTitlePadding['left']) ? (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) : '0px') . '; ';
                        }

                        // Determine if underline should be shown
                        $showUnderline = $postLinkType === 'yeslink' && $titleHoverUnderLine === 'enable';

                        // Class name
                        $classNames = 'title align-' . esc_attr($postTitleAlignment);
                        if ($showUnderline) {
                            $classNames .= ' underline';
                        }

                        // Hover/Out events for nolink
                        $onmouseover = '';
                        $onmouseout  = '';

                        if (!empty($postTitleHoverBgColor)) {
                            $onmouseover .= 'this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';';
                        }

                        if (!empty($postTitleHoverColor)) {
                            $onmouseover .= ' this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                        }

                        if (!empty($postTitleBgColor)) {
                            $onmouseout .= 'this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';';
                        } else {
                            $onmouseout .= 'this.style.removeProperty(\'background-color\');';
                        }

                        if (!empty($postTitleColor)) {
                            $onmouseout .= ' this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                        } else {
                            $onmouseout .= ' this.style.removeProperty(\'color\');';
                        }

                        // Opening title tag
                        $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"'
                            . (!empty($onmouseover) ? ' onmouseover="' . trim($onmouseover) . '"' : '')
                            . (!empty($onmouseout)  ? ' onmouseout="'  . trim($onmouseout)  . '"' : '') . '>';

                        if ($postLinkType === 'yeslink') {
                            // Anchor styles
                            $style = '';
                            $hoverStyle = '';
                            $mouseoutStyle = '';

                            if (!empty($postTitleFontSize)) {
                                $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                            }

                            if (!empty($postTitleLineHeight)) {
                                $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                            }

                            if (!empty($postTitleLetterSpacing)) {
                                $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                            }

                            if (!empty($postTitleFontWeight)) {
                                $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                            }

                            if (!empty($postTitleColor)) {
                                $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                $mouseoutStyle .= 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                            } else {
                                $mouseoutStyle .= 'this.style.color=\'\';';
                            }

                            if (!empty($postTitleHoverColor)) {
                                $hoverStyle .= 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                            }

                            if ($showUnderline && !empty($postTitleHoverColor)) {
                                $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                                $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                $hoverStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                            }

                            if ($showUnderline && empty($postTitleColor ) && !empty($postTitleColor )) {
                                $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                                $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                $mouseoutStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                            } else {
                                
                                $mouseoutStyle .= ' this.style.removeProperty(\'background-position\');';
                                $mouseoutStyle .= ' this.style.removeProperty(\'background-size\');';
                            }

                            $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '
                                style="' . esc_attr(trim($style)) . '"'
                                . (!empty($hoverStyle)   ? ' onmouseover="' . $hoverStyle . '"' : '')
                                . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                . esc_html($croppedTitle) . '</a>';
                        } else {
                            // No link  render span with inline styles
                            $inlineStyle = '';
                            if (!empty($postTitleFontSize)) {
                                $inlineStyle .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                            }
                            if (!empty($postTitleLineHeight)) {
                                $inlineStyle .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                            }
                            if (!empty($postTitleLetterSpacing)) {
                                $inlineStyle .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                            }
                            if (!empty($postTitleFontWeight)) {
                                $inlineStyle .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                            }
                            if (!empty($postTitleColor)) {
                                $inlineStyle .= 'color: ' . esc_attr($postTitleColor) . '; ';
                            }

                            $output .= '<span style="' . esc_attr(trim($inlineStyle)) . '">' . esc_html($croppedTitle) . '</span>';
                        }

                        $output .= '</' . esc_attr($titleTag) . '>';
                    }

                    // Button Output                
                    if ($showReadMoreButton) {
                        // Button wrapper styles
                        $buttonWrapperStyle = '';

                        if (
                            isset($buttonMarginNew['top']) || 
                            isset($buttonMarginNew['right']) || 
                            isset($buttonMarginNew['bottom']) || 
                            isset($buttonMarginNew['left'])
                        ) {
                            $buttonWrapperStyle .= 'margin: ' .
                                (isset($buttonMarginNew['top']) ? (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) : '0px') . ' ' .
                                (isset($buttonMarginNew['right']) ? (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) : '0px') . ' ' .
                                (isset($buttonMarginNew['bottom']) ? (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) : '0px') . ' ' .
                                (isset($buttonMarginNew['left']) ? (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) : '0px') . '; ';
                        }

                        // Order
                        if (!empty($buttonOrder)) {
                            $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                        }

                        $output .= '<div class="btn-wrapper align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';


                        // Button inline styles
                        $buttonInlineStyles = '';

                        if (!empty($buttonTextColor)) {
                            $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                        }
                        if (!empty($buttonBackgroundColor)) {
                            $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                        }
                        if (!empty($buttonFontSize)) {
                            $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                        }
                        if (!empty($buttonFontWeight)) {
                            $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                        }
                        if (!empty($buttonBorderColor)) {
                            $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                        }
                        if (!empty($buttonBorderType)) {
                            $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                        }

                        // Border Width
                        if (
                            isset($buttonBorderWidth['top']) || 
                            isset($buttonBorderWidth['right']) || 
                            isset($buttonBorderWidth['bottom']) || 
                            isset($buttonBorderWidth['left'])
                        ) {
                            $buttonInlineStyles .= 'border-width: ' .
                                (isset($buttonBorderWidth['top']) ? (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) : '0px') . ' ' .
                                (isset($buttonBorderWidth['right']) ? (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) : '0px') . ' ' .
                                (isset($buttonBorderWidth['bottom']) ? (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) : '0px') . ' ' .
                                (isset($buttonBorderWidth['left']) ? (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) : '0px') . '; ';
                        }

                        // Border Radius
                        if (
                            isset($buttonBorderRadius['top']) || 
                            isset($buttonBorderRadius['right']) || 
                            isset($buttonBorderRadius['bottom']) || 
                            isset($buttonBorderRadius['left'])
                        ) {
                            $buttonInlineStyles .= 'border-radius: ' .
                                (isset($buttonBorderRadius['top']) ? (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) : '0px') . ' ' .
                                (isset($buttonBorderRadius['right']) ? (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) : '0px') . ' ' .
                                (isset($buttonBorderRadius['bottom']) ? (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) : '0px') . ' ' .
                                (isset($buttonBorderRadius['left']) ? (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) : '0px') . '; ';
                        }

                        // Padding
                        if (
                            isset($buttonPaddingNew['top']) || 
                            isset($buttonPaddingNew['right']) || 
                            isset($buttonPaddingNew['bottom']) || 
                            isset($buttonPaddingNew['left'])
                        ) {
                            $buttonInlineStyles .= 'padding: ' .
                                (isset($buttonPaddingNew['top']) ? (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) : '0px') . ' ' .
                                (isset($buttonPaddingNew['right']) ? (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) : '0px') . ' ' .
                                (isset($buttonPaddingNew['bottom']) ? (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) : '0px') . ' ' .
                                (isset($buttonPaddingNew['left']) ? (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) : '0px') . '; ';
                        } 

                        // Hover styles
                        $buttonHoverInlineStyles = '';
                        $buttonResetStyles = '';

                        if (!empty($buttonHoverTextColor)) {
                            $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                            $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                        }
                        if (!empty($buttonHoverBorderColor)) {
                            $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                            $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                        }
                        if (!empty($buttonHoverBackgroundColor)) {
                            $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                            $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                        }

                        // Button anchor tag
                        $output .= '<a class="fpg-btn read-more ' . esc_attr($buttonStyle10) . '" href="' . esc_url(get_permalink()) . '" ' . $targetAttr . ' style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                        if (!empty($buttonHoverInlineStyles)) {
                            $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                        }

                        if (!empty($buttonResetStyles)) {
                            $output .= ' onmouseout="' . $buttonResetStyles . '"';
                        }

                        $output .= '>';

                        // Icon handling
                        $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                        $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                        $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                        if ($iconPosition === 'left' && $showButtonIcon) {
                            $output .= $leftIcon . ' ';
                        }

                        $output .= esc_html($readMoreLabel);

                        if ($iconPosition === 'right' && $showButtonIcon) {
                            $output .= ' ' . $rightIcon;
                        }

                        $output .= '</a></div>';
                    }
                    // End Button

                    $output .= '</div>';
                    // End MAIN Content
                    $output .= '</div>';
                    // End Full post layout
                }
                else if ($gridLayoutStyle === 'style11') {
                    // Full post layout
                    $borderStyles = '.fpg-blog-layout-21-item .fpg-content .fpg-btn.fpg-border::before {';
                    
                    $borderStyles .= 'background: ' . (!empty($buttonHoverTextColor) ? esc_attr($buttonHoverTextColor) : '#332FFF') . ';';
                    
                    $borderStyles .= '}';
                    $output .= '<style>' . $borderStyles . '</style>';
                    $output .= '<div class="fpg-blog-layout-21-item align-' . $itemBoxAlignment11 . ' ' . $hoverAnimation . ' ' . $postLinkType . '" style="';
                        // MARGIN    
                        if (isset($itemMargin['top']) || isset($itemMargin['right']) || isset($itemMargin['bottom']) || isset($itemMargin['left'])) {
                            $output .= 'margin: ' .
                                (isset($itemMargin['top']) ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' .
                                (isset($itemMargin['right']) ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' .
                                (isset($itemMargin['bottom']) ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' .
                                (isset($itemMargin['left']) ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; ';
                        }

                        // PADDING
                        if (isset($itemPadding['top']) || isset($itemPadding['right']) || isset($itemPadding['bottom']) || isset($itemPadding['left'])) {
                            $output .= 'padding: ' .
                                (isset($itemPadding['top']) ? (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) : '0px') . ' ' .
                                (isset($itemPadding['right']) ? (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) : '0px') . ' ' .
                                (isset($itemPadding['bottom']) ? (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) : '0px') . ' ' .
                                (isset($itemPadding['left']) ? (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) : '0px') . '; ';
                        }

                        // BORDER RADIUS
                        if (isset($itemBorderRadius['top']) || isset($itemBorderRadius['right']) || isset($itemBorderRadius['bottom']) || isset($itemBorderRadius['left'])) {
                            $output .= 'border-radius: ' .
                                (isset($itemBorderRadius['top']) ? (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) : '0px') . ' ' .
                                (isset($itemBorderRadius['right']) ? (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) : '0px') . ' ' .
                                (isset($itemBorderRadius['bottom']) ? (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) : '0px') . ' ' .
                                (isset($itemBorderRadius['left']) ? (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) : '0px') . '; ';
                        }

                        // BORDER WIDTH
                        if (isset($itemBorderWidth['top']) || isset($itemBorderWidth['right']) || isset($itemBorderWidth['bottom']) || isset($itemBorderWidth['left'])) {
                            $output .= 'border-width: ' .
                                (isset($itemBorderWidth['top']) ? (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) : '0px') . ' ' .
                                (isset($itemBorderWidth['right']) ? (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) : '0px') . ' ' .
                                (isset($itemBorderWidth['bottom']) ? (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) : '0px') . ' ' .
                                (isset($itemBorderWidth['left']) ? (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) : '0px') . '; ';
                        }

                        // Border Style & Color
                        if (!empty($itemBorderType)) {
                            $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                        }
                        if (!empty($itemBorderColor)) {
                            $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                        }

                        // Background Color
                        if (!empty($itemBackgroundColor)) {
                            $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                        }

                        // Box Shadow
                        if (
                            isset($itemBoxShadow['left']) ||  // horizontal offset
                            isset($itemBoxShadow['top']) ||  // vertical offset
                            isset($itemBoxShadow['right']) ||  // blur radius
                            isset($itemBoxShadow['bottom']) ||  // spread radius
                            isset($itemBoxShadowColor)
                        ) {
                            $output .= 'box-shadow: ' .
                                (isset($itemBoxShadow['left']) ? (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) : '0px') . ' ' .
                                (isset($itemBoxShadow['top']) ? (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) : '0px') . ' ' .
                                (isset($itemBoxShadow['right']) ? (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) : '0px') . ' ' .
                                (isset($itemBoxShadow['bottom']) ? (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) : '0px') . ' ' .
                                (!empty($itemBoxShadowColor) ? esc_attr($itemBoxShadowColor) : 'rgba(0,0,0,0.1)') . '; ';
                        }

                    $output .= '">';

                    if ($thumbnail && $showThumbnail) {
                        $output .= '<div class="fpg-thumb" style="';

                        // MARGIN
                        if (
                            isset($thumbnailMargin['top']) ||
                            isset($thumbnailMargin['right']) ||
                            isset($thumbnailMargin['bottom']) ||
                            isset($thumbnailMargin['left'])
                        ) {
                            $output .= 'margin: ' .
                                (isset($thumbnailMargin['top']) ? (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) : '0px') . ' ' .
                                (isset($thumbnailMargin['right']) ? (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) : '0px') . ' ' .
                                (isset($thumbnailMargin['bottom']) ? (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) : '0px') . ' ' .
                                (isset($thumbnailMargin['left']) ? (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) : '0px') . '; ';
                        }

                        // PADDING
                        if (
                            isset($thumbnailPadding['top']) ||
                            isset($thumbnailPadding['right']) ||
                            isset($thumbnailPadding['bottom']) ||
                            isset($thumbnailPadding['left'])
                        ) {
                            $output .= 'padding: ' .
                                (isset($thumbnailPadding['top']) ? (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) : '0px') . ' ' .
                                (isset($thumbnailPadding['right']) ? (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) : '0px') . ' ' .
                                (isset($thumbnailPadding['bottom']) ? (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) : '0px') . ' ' .
                                (isset($thumbnailPadding['left']) ? (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) : '0px') . '; ';
                        }

                        // BORDER RADIUS
                        if (
                            isset($thumbnailBorderRadius['top']) ||
                            isset($thumbnailBorderRadius['right']) ||
                            isset($thumbnailBorderRadius['bottom']) ||
                            isset($thumbnailBorderRadius['left'])
                        ) {
                            $output .= 'border-radius: ' .
                                (isset($thumbnailBorderRadius['top']) ? (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) : '0px') . ' ' .
                                (isset($thumbnailBorderRadius['right']) ? (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) : '0px') . ' ' .
                                (isset($thumbnailBorderRadius['bottom']) ? (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) : '0px') . ' ' .
                                (isset($thumbnailBorderRadius['left']) ? (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) : '0px') . '; ';
                        }

                        $output .= '">';

                        // Anchor with optional border-radius and overflow
                        if ($thumbnailLink) {
                            $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '>';
                            $output .= $thumbnail;
                            $output .= '</a>';
                        } else {
                            $output .= $thumbnail;
                        }
                        
                        $output .= '
                        <svg viewBox="0 0 410 32" fill="none" xmlns="http://www.w3.org/2000/svg" class="shape__fpg_course">
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M346.69 23.5159C371.59 23.3769 398.013 17.3185 410 4.85404V32H0V9.75773C2.99658 0.284217 26.1914 -2.12936 41.5898 1.81449C49.0762 3.72855 55.7041 6.53361 62.3281 9.33695C69.3286 12.2997 76.3247 15.2605 84.3242 17.1654C111.49 25.8323 134.405 18.6565 157.427 11.4472C171.419 7.06559 185.451 2.67167 200.5 1.81449C217.549 0.842933 234.721 5.15653 251.493 9.36967C259.098 11.2798 266.62 13.1693 274.011 14.5363C278.288 15.3272 282.339 16.1309 286.297 16.9161C304.269 20.4812 320.31 23.6632 346.69 23.5159Z" fill="#ffffff"></path>
                        </svg>';
                        $output .= '</div>';
                    }

                    // MAIN Content
                    $output .= '<div class="fpg-content" style="';
                        // MARGIN
                        if (
                            isset($contentitemMarginNew['top']) ||
                            isset($contentitemMarginNew['right']) ||
                            isset($contentitemMarginNew['bottom']) ||
                            isset($contentitemMarginNew['left'])
                        ) {
                            $output .= 'margin: ' .
                                (isset($contentitemMarginNew['top']) ? (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) : '0px') . ' ' .
                                (isset($contentitemMarginNew['right']) ? (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) : '0px') . ' ' .
                                (isset($contentitemMarginNew['bottom']) ? (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) : '0px') . ' ' .
                                (isset($contentitemMarginNew['left']) ? (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) : '0px') . '; ';
                        }

                        // PADDING
                        if (
                            isset($contentitemPaddingNew['top']) ||
                            isset($contentitemPaddingNew['right']) ||
                            isset($contentitemPaddingNew['bottom']) ||
                            isset($contentitemPaddingNew['left'])
                        ) {
                            $output .= 'padding: ' .
                                (isset($contentitemPaddingNew['top']) ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' .
                                (isset($contentitemPaddingNew['right']) ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' .
                                (isset($contentitemPaddingNew['bottom']) ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' .
                                (isset($contentitemPaddingNew['left']) ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; ';
                        }

                        // BORDER WIDTH
                        if (
                            isset($contentBorderWidth['top']) ||
                            isset($contentBorderWidth['right']) ||
                            isset($contentBorderWidth['bottom']) ||
                            isset($contentBorderWidth['left'])
                        ) {
                            $output .= 'border-width: ' .
                                (isset($contentBorderWidth['top']) ? (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) : '0px') . ' ' .
                                (isset($contentBorderWidth['right']) ? (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) : '0px') . ' ' .
                                (isset($contentBorderWidth['bottom']) ? (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) : '0px') . ' ' .
                                (isset($contentBorderWidth['left']) ? (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) : '0px') . '; ';
                        }
                        // BORDER radius
                        if (
                            isset($contentitemRadius['top']) ||
                            isset($contentitemRadius['right']) ||
                            isset($contentitemRadius['bottom']) ||
                            isset($contentitemRadius['left'])
                        ) {
                            $output .= 'border-radius: ' .
                                (isset($contentitemRadius['top']) ? (is_numeric($contentitemRadius['top']) ? $contentitemRadius['top'] . 'px' : esc_attr($contentitemRadius['top'])) : '0px') . ' ' .
                                (isset($contentitemRadius['right']) ? (is_numeric($contentitemRadius['right']) ? $contentitemRadius['right'] . 'px' : esc_attr($contentitemRadius['right'])) : '0px') . ' ' .
                                (isset($contentitemRadius['bottom']) ? (is_numeric($contentitemRadius['bottom']) ? $contentitemRadius['bottom'] . 'px' : esc_attr($contentitemRadius['bottom'])) : '0px') . ' ' .
                                (isset($contentitemRadius['left']) ? (is_numeric($contentitemRadius['left']) ? $contentitemRadius['left'] . 'px' : esc_attr($contentitemRadius['left'])) : '0px') . '; ';
                        }
                        // Border Style
                        if (!empty($contentNormalBorderType)) {
                            $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                        }
                        // Background Color
                        if (!empty($contentBgColor)) {
                            $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                        }
                        // Border Color
                        if (!empty($contentBorderColor)) {
                            $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                        }
                    $output .= '">';

                    // Meta Data
                    if ($showMetaData) {
                        $output .= '<div class="fpg-meta">'; 
                        $output .= '<ul class="meta-data-list align-' . $metaAlignment . ' " style="';  
                            // MARGIN
                            if (
                                isset($metaMarginNew['top']) ||
                                isset($metaMarginNew['right']) ||
                                isset($metaMarginNew['bottom']) ||
                                isset($metaMarginNew['left'])
                            ) {
                                $output .= 'margin: ' .
                                    (isset($metaMarginNew['top']) ? (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) : '0px') . ' ' .
                                    (isset($metaMarginNew['right']) ? (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) : '0px') . ' ' .
                                    (isset($metaMarginNew['bottom']) ? (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) : '0px') . ' ' .
                                    (isset($metaMarginNew['left']) ? (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) : '0px') . '; ';
                            }

                            // PADDING
                            if (
                                isset($metaPadding['top']) ||
                                isset($metaPadding['right']) ||
                                isset($metaPadding['bottom']) ||
                                isset($metaPadding['left'])
                            ) {
                                $output .= 'padding: ' .
                                    (isset($metaPadding['top']) ? (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) : '0px') . ' ' .
                                    (isset($metaPadding['right']) ? (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) : '0px') . ' ' .
                                    (isset($metaPadding['bottom']) ? (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) : '0px') . ' ' .
                                    (isset($metaPadding['left']) ? (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) : '0px') . '; ';
                            }  
                            
                            // Color
                            if (!empty($metaTextColor)) {
                                $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                            }
                            // Order
                            if (!empty($metaOrder)) {
                                $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                            }
                        $output .= '">';

                        $meta_items = [];

                        // Date
                        if ($showPostDate) {
                            $meta = '<li class="meta-date" style="';

                            // Color
                            if (!empty($metaTextColor)) {
                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                            }

                            // Font size
                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '">';

                            // Icon
                            if ($showPostDateIcon && $showMetaIcon) {
                                $meta .= '<i class="fas fa-calendar-alt" style="';

                                if (!empty($metaIconColor)) {
                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                }

                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $meta .= '"></i> ';
                            }

                            $meta .= esc_html($getdate) . '</li>';
                            $meta_items[] = $meta;
                        }
                        // Author
                        if ($showPostAuthor) {
                            $meta = '<li class="meta-author" style="';

                            if (!empty($metaTextColor)) {
                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '">';

                            if ($showPostAuthorIcon && $showMetaIcon) {
                                $meta .= '<i class="fas fa-user" style="';

                                if (!empty($metaIconColor)) {
                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                }

                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $meta .= '"></i> ';
                            }

                            $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                            $meta_items[] = $meta;
                        }
                        // Category
                        if ($showPostCategory) {
                            $meta = '<li class="meta-categories" style="';

                            if (!empty($metaTextColor)) {
                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '">';

                            if ($showPostCategoryIcon && $showMetaIcon) {
                                $meta .= '<i class="fas fa-folder" style="';

                                if (!empty($metaIconColor)) {
                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                }

                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $meta .= '"></i> ';
                            }

                            // Get category names without links
                            $categories_list = get_the_category($post_id);
                            if (!empty($categories_list)) {
                                $category_names = array();
                                foreach ($categories_list as $category) {
                                    $category_names[] = esc_html($category->name);
                                }
                                $meta .= implode(', ', $category_names); // comma-separated plain text categories
                            }

                            $meta .= '</li>';
                            $meta_items[] = $meta;
                        }
                        // Tags
                        if ($showPostTags && !empty($tags)) {
                            $meta = '<li class="meta-tags" style="';

                            if (!empty($metaTextColor)) {
                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '">';

                            if ($showPostTagsIcon && $showMetaIcon) {
                                $meta .= '<i class="fas fa-tags" style="';

                                if (!empty($metaIconColor)) {
                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                }

                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $meta .= '"></i> ';
                            }

                            $meta .= esc_html__('Tags:', 'fancy-post-grid') . ' ' . $tags . '</li>';
                            $meta_items[] = $meta;
                        }
                        // Comment Count
                        if ($showPostCommentsCount) {
                            $meta = '<li class="meta-comment-count" style="';
                            if (!empty($metaTextColor)) {
                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                            }
                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '">';

                            if ($showPostCommentsCountIcon && $showMetaIcon) {
                                $meta .= '<i class="fas fa-comments" style="';
                                if (!empty($metaIconColor)) {
                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                }
                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }
                                $meta .= '"></i> ';
                            }

                            $meta .= esc_html($comments_count) . ' ' . esc_html__('Comments', 'fancy-post-grid') . '</li>';
                            $meta_items[] = $meta;
                        }
                        // Now join meta items with the separator
                        if (!empty($meta_items)) {
                            $separator = '';

                            if ($metaSeperator !== '') {
                                $separator = '';
                                if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                    $separatorStyle = '';
                                    if (!empty($separatorColor)) {
                                        $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                    }
                                    if (!empty($metaFontSize)) {
                                        $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                                }
                            }

                            $output .= implode($separator, $meta_items);
                        }
                        $output .= '</ul>'; 
                        $output .= '</div>'; // Close meta-data-list                 
                    }
                    // End Meta Data

                    // title
                    if ($showPostTitle) {
                        $titleStyles = '';

                        // Order
                        if (!empty($titleOrder)) {
                            $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                        }

                        // Background color
                        if (!empty($postTitleBgColor)) {
                            $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                        }

                        // Margin
                        if (isset($postTitleMargin['top']) || isset($postTitleMargin['right']) || isset($postTitleMargin['bottom']) || isset($postTitleMargin['left'])) {
                            $titleStyles .= 'margin: ' .
                                (isset($postTitleMargin['top']) ? (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) : '0px') . ' ' .
                                (isset($postTitleMargin['right']) ? (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) : '0px') . ' ' .
                                (isset($postTitleMargin['bottom']) ? (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) : '0px') . ' ' .
                                (isset($postTitleMargin['left']) ? (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) : '0px') . '; ';
                        }

                        // Padding
                        if (isset($postTitlePadding['top']) || isset($postTitlePadding['right']) || isset($postTitlePadding['bottom']) || isset($postTitlePadding['left'])) {
                            $titleStyles .= 'padding: ' .
                                (isset($postTitlePadding['top']) ? (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) : '0px') . ' ' .
                                (isset($postTitlePadding['right']) ? (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) : '0px') . ' ' .
                                (isset($postTitlePadding['bottom']) ? (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) : '0px') . ' ' .
                                (isset($postTitlePadding['left']) ? (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) : '0px') . '; ';
                        }

                        // Determine if underline should be shown
                        $showUnderline = $postLinkType === 'yeslink' && $titleHoverUnderLine === 'enable';

                        // Class name
                        $classNames = 'title align-' . esc_attr($postTitleAlignment);
                        if ($showUnderline) {
                            $classNames .= ' underline';
                        }

                        // Hover/Out events for nolink
                        $onmouseover = '';
                        $onmouseout  = '';

                        if (!empty($postTitleHoverBgColor)) {
                            $onmouseover .= 'this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';';
                        }

                        if (!empty($postTitleHoverColor)) {
                            $onmouseover .= ' this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                        }

                        if (!empty($postTitleBgColor)) {
                            $onmouseout .= 'this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';';
                        } else {
                            $onmouseout .= 'this.style.removeProperty(\'background-color\');';
                        }

                        if (!empty($postTitleColor)) {
                            $onmouseout .= ' this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                        } else {
                            $onmouseout .= ' this.style.removeProperty(\'color\');';
                        }

                        // Opening title tag
                        $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"'
                            . (!empty($onmouseover) ? ' onmouseover="' . trim($onmouseover) . '"' : '')
                            . (!empty($onmouseout)  ? ' onmouseout="'  . trim($onmouseout)  . '"' : '') . '>';

                        if ($postLinkType === 'yeslink') {
                            // Anchor styles
                            $style = '';
                            $hoverStyle = '';
                            $mouseoutStyle = '';

                            if (!empty($postTitleFontSize)) {
                                $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                            }

                            if (!empty($postTitleLineHeight)) {
                                $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                            }

                            if (!empty($postTitleLetterSpacing)) {
                                $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                            }

                            if (!empty($postTitleFontWeight)) {
                                $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                            }

                            if (!empty($postTitleColor)) {
                                $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                $mouseoutStyle .= 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                            } else {
                                $mouseoutStyle .= 'this.style.color=\'\';';
                            }

                            if (!empty($postTitleHoverColor)) {
                                $hoverStyle .= 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                            }

                            if ($showUnderline && !empty($postTitleHoverColor)) {
                                $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                                $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                $hoverStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                            }

                            if ($showUnderline && empty($postTitleColor ) && !empty($postTitleColor )) {
                                $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                                $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                $mouseoutStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                            } else {
                                
                                $mouseoutStyle .= ' this.style.removeProperty(\'background-position\');';
                                $mouseoutStyle .= ' this.style.removeProperty(\'background-size\');';
                            }

                            $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '
                                style="' . esc_attr(trim($style)) . '"'
                                . (!empty($hoverStyle)   ? ' onmouseover="' . $hoverStyle . '"' : '')
                                . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                . esc_html($croppedTitle) . '</a>';
                        } else {
                            // No link  render span with inline styles
                            $inlineStyle = '';
                            if (!empty($postTitleFontSize)) {
                                $inlineStyle .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                            }
                            if (!empty($postTitleLineHeight)) {
                                $inlineStyle .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                            }
                            if (!empty($postTitleLetterSpacing)) {
                                $inlineStyle .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                            }
                            if (!empty($postTitleFontWeight)) {
                                $inlineStyle .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                            }
                            if (!empty($postTitleColor)) {
                                $inlineStyle .= 'color: ' . esc_attr($postTitleColor) . '; ';
                            }

                            $output .= '<span style="' . esc_attr(trim($inlineStyle)) . '">' . esc_html($croppedTitle) . '</span>';
                        }

                        $output .= '</' . esc_attr($titleTag) . '>';
                    }

                    // Button Output                
                    if ($showReadMoreButton) {
                        // Button wrapper styles
                        $buttonWrapperStyle = '';

                        if (
                            isset($buttonMarginNew['top']) || 
                            isset($buttonMarginNew['right']) || 
                            isset($buttonMarginNew['bottom']) || 
                            isset($buttonMarginNew['left'])
                        ) {
                            $buttonWrapperStyle .= 'margin: ' .
                                (isset($buttonMarginNew['top']) ? (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) : '0px') . ' ' .
                                (isset($buttonMarginNew['right']) ? (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) : '0px') . ' ' .
                                (isset($buttonMarginNew['bottom']) ? (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) : '0px') . ' ' .
                                (isset($buttonMarginNew['left']) ? (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) : '0px') . '; ';
                        }

                        // Order
                        if (!empty($buttonOrder)) {
                            $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                        }

                        $output .= '<div class="btn-wrapper align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';

                        // Button inline styles
                        $buttonInlineStyles = '';

                        if (!empty($buttonTextColor)) {
                            $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                        }
                        if (!empty($buttonBackgroundColor)) {
                            $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                        }
                        if (!empty($buttonFontSize)) {
                            $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                        }
                        if (!empty($buttonFontWeight)) {
                            $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                        }
                        if (!empty($buttonBorderColor)) {
                            $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                        }
                        if (!empty($buttonBorderType)) {
                            $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                        }

                        // Border Width
                        if (
                            isset($buttonBorderWidth['top']) || 
                            isset($buttonBorderWidth['right']) || 
                            isset($buttonBorderWidth['bottom']) || 
                            isset($buttonBorderWidth['left'])
                        ) {
                            $buttonInlineStyles .= 'border-width: ' .
                                (isset($buttonBorderWidth['top']) ? (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) : '0px') . ' ' .
                                (isset($buttonBorderWidth['right']) ? (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) : '0px') . ' ' .
                                (isset($buttonBorderWidth['bottom']) ? (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) : '0px') . ' ' .
                                (isset($buttonBorderWidth['left']) ? (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) : '0px') . '; ';
                        }

                        // Border Radius
                        if (
                            isset($buttonBorderRadius['top']) || 
                            isset($buttonBorderRadius['right']) || 
                            isset($buttonBorderRadius['bottom']) || 
                            isset($buttonBorderRadius['left'])
                        ) {
                            $buttonInlineStyles .= 'border-radius: ' .
                                (isset($buttonBorderRadius['top']) ? (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) : '0px') . ' ' .
                                (isset($buttonBorderRadius['right']) ? (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) : '0px') . ' ' .
                                (isset($buttonBorderRadius['bottom']) ? (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) : '0px') . ' ' .
                                (isset($buttonBorderRadius['left']) ? (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) : '0px') . '; ';
                        }

                        // Padding
                        if (
                            isset($buttonPaddingNew['top']) || 
                            isset($buttonPaddingNew['right']) || 
                            isset($buttonPaddingNew['bottom']) || 
                            isset($buttonPaddingNew['left'])
                        ) {
                            $buttonInlineStyles .= 'padding: ' .
                                (isset($buttonPaddingNew['top']) ? (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) : '0px') . ' ' .
                                (isset($buttonPaddingNew['right']) ? (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) : '0px') . ' ' .
                                (isset($buttonPaddingNew['bottom']) ? (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) : '0px') . ' ' .
                                (isset($buttonPaddingNew['left']) ? (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) : '0px') . '; ';
                        } 

                        // Hover styles
                        $buttonHoverInlineStyles = '';
                        $buttonResetStyles = '';

                        if (!empty($buttonHoverTextColor)) {
                            $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                            $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                        }
                        if (!empty($buttonHoverBorderColor)) {
                            $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                            $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                        }
                        if (!empty($buttonHoverBackgroundColor)) {
                            $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                            $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                        }

                        // Button anchor tag
                        $output .= '<a class="fpg-btn read-more ' . esc_attr($buttonStyle11) . '" href="' . esc_url(get_permalink()) . '" ' . $targetAttr . ' style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                        if (!empty($buttonHoverInlineStyles)) {
                            $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                        }

                        if (!empty($buttonResetStyles)) {
                            $output .= ' onmouseout="' . $buttonResetStyles . '"';
                        }

                        $output .= '>';

                        // Icon handling
                        $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                        $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                        $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                        if ($iconPosition === 'left' && $showButtonIcon) {
                            $output .= $leftIcon . ' ';
                        }

                        $output .= esc_html($readMoreLabel);

                        if ($iconPosition === 'right' && $showButtonIcon) {
                            $output .= ' ' . $rightIcon;
                        }

                        $output .= '</a></div>';
                    }
                    // End Button

                    $output .= '</div>';
                    // End MAIN Content
                    $output .= '</div>';
                    // End Full post layout
                }
                else if ($gridLayoutStyle === 'style12') {
                    // Full post layout
                    $borderStyles = '.fpg-blog-layout-26-item .fpg-content .fpg-btn.fpg-border::before {';
                    
                    $borderStyles .= 'background: ' . (!empty($buttonHoverTextColor) ? esc_attr($buttonHoverTextColor) : '#332FFF') . ';';
                    
                    $borderStyles .= '}';
                    $output .= '<style>' . $borderStyles . '</style>';
                    $output .= '<div class="fpg-blog-layout-26-item align-' . $itemBoxAlignment12 . ' ' . $hoverAnimation . ' ' . $postLinkType . '" style="';
                        // MARGIN    
                        if (isset($itemMargin['top']) || isset($itemMargin['right']) || isset($itemMargin['bottom']) || isset($itemMargin['left'])) {
                            $output .= 'margin: ' .
                                (isset($itemMargin['top']) ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' .
                                (isset($itemMargin['right']) ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' .
                                (isset($itemMargin['bottom']) ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' .
                                (isset($itemMargin['left']) ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; ';
                        }

                        // PADDING
                        if (isset($itemPadding['top']) || isset($itemPadding['right']) || isset($itemPadding['bottom']) || isset($itemPadding['left'])) {
                            $output .= 'padding: ' .
                                (isset($itemPadding['top']) ? (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) : '0px') . ' ' .
                                (isset($itemPadding['right']) ? (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) : '0px') . ' ' .
                                (isset($itemPadding['bottom']) ? (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) : '0px') . ' ' .
                                (isset($itemPadding['left']) ? (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) : '0px') . '; ';
                        }

                        // BORDER RADIUS
                        if (isset($itemBorderRadius['top']) || isset($itemBorderRadius['right']) || isset($itemBorderRadius['bottom']) || isset($itemBorderRadius['left'])) {
                            $output .= 'border-radius: ' .
                                (isset($itemBorderRadius['top']) ? (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) : '0px') . ' ' .
                                (isset($itemBorderRadius['right']) ? (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) : '0px') . ' ' .
                                (isset($itemBorderRadius['bottom']) ? (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) : '0px') . ' ' .
                                (isset($itemBorderRadius['left']) ? (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) : '0px') . '; ';
                        }

                        // BORDER WIDTH
                        if (isset($itemBorderWidth['top']) || isset($itemBorderWidth['right']) || isset($itemBorderWidth['bottom']) || isset($itemBorderWidth['left'])) {
                            $output .= 'border-width: ' .
                                (isset($itemBorderWidth['top']) ? (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) : '0px') . ' ' .
                                (isset($itemBorderWidth['right']) ? (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) : '0px') . ' ' .
                                (isset($itemBorderWidth['bottom']) ? (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) : '0px') . ' ' .
                                (isset($itemBorderWidth['left']) ? (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) : '0px') . '; ';
                        }

                        // Border Style & Color
                        if (!empty($itemBorderType)) {
                            $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                        }
                        if (!empty($itemBorderColor)) {
                            $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                        }

                        // Background Color
                        if (!empty($itemBackgroundColor)) {
                            $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                        }

                        // Box Shadow
                        if (
                            isset($itemBoxShadow['left']) ||  // horizontal offset
                            isset($itemBoxShadow['top']) ||  // vertical offset
                            isset($itemBoxShadow['right']) ||  // blur radius
                            isset($itemBoxShadow['bottom']) ||  // spread radius
                            isset($itemBoxShadowColor)
                        ) {
                            $output .= 'box-shadow: ' .
                                (isset($itemBoxShadow['left']) ? (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) : '0px') . ' ' .
                                (isset($itemBoxShadow['top']) ? (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) : '0px') . ' ' .
                                (isset($itemBoxShadow['right']) ? (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) : '0px') . ' ' .
                                (isset($itemBoxShadow['bottom']) ? (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) : '0px') . ' ' .
                                (!empty($itemBoxShadowColor) ? esc_attr($itemBoxShadowColor) : 'rgba(0,0,0,0.1)') . '; ';
                        }

                    $output .= '">';

                    // Thumbnail
                    if ($thumbnail && $showThumbnail) {
                        $output .= '<div class="fpg-thumb" style="';

                        // MARGIN
                        if (
                            isset($thumbnailMargin['top']) ||
                            isset($thumbnailMargin['right']) ||
                            isset($thumbnailMargin['bottom']) ||
                            isset($thumbnailMargin['left'])
                        ) {
                            $output .= 'margin: ' .
                                (isset($thumbnailMargin['top']) ? (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) : '0px') . ' ' .
                                (isset($thumbnailMargin['right']) ? (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) : '0px') . ' ' .
                                (isset($thumbnailMargin['bottom']) ? (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) : '0px') . ' ' .
                                (isset($thumbnailMargin['left']) ? (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) : '0px') . '; ';
                        }

                        // PADDING
                        if (
                            isset($thumbnailPadding['top']) ||
                            isset($thumbnailPadding['right']) ||
                            isset($thumbnailPadding['bottom']) ||
                            isset($thumbnailPadding['left'])
                        ) {
                            $output .= 'padding: ' .
                                (isset($thumbnailPadding['top']) ? (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) : '0px') . ' ' .
                                (isset($thumbnailPadding['right']) ? (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) : '0px') . ' ' .
                                (isset($thumbnailPadding['bottom']) ? (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) : '0px') . ' ' .
                                (isset($thumbnailPadding['left']) ? (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) : '0px') . '; ';
                        }

                        // BORDER RADIUS
                        if (
                            isset($thumbnailBorderRadius['top']) ||
                            isset($thumbnailBorderRadius['right']) ||
                            isset($thumbnailBorderRadius['bottom']) ||
                            isset($thumbnailBorderRadius['left'])
                        ) {
                            $output .= 'border-radius: ' .
                                (isset($thumbnailBorderRadius['top']) ? (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) : '0px') . ' ' .
                                (isset($thumbnailBorderRadius['right']) ? (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) : '0px') . ' ' .
                                (isset($thumbnailBorderRadius['bottom']) ? (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) : '0px') . ' ' .
                                (isset($thumbnailBorderRadius['left']) ? (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) : '0px') . '; ';
                        }

                        $output .= '">';

                        // Anchor with optional border-radius and overflow
                        if ($thumbnailLink) {
                            $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '>';
                            $output .= $thumbnail;
                            $output .= '</a>';
                        } else {
                            $output .= $thumbnail;
                        }
                        $output .= '</div>';
                    }
                    // END Thumbnail

                    // MAIN Content
                    // Generate hover attributes
                    $onmouseover = !empty($contentHoverBgColor)
                        ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($contentHoverBgColor) . '\';"'
                        : '';

                    $onmouseout = !empty($contentBgColor)
                        ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($contentBgColor) . '\';"'
                        : '';

                    // Start building the output
                    $output .= '<div class="fpg-content" style="';

                    // Margin
                    if (isset($contentitemMarginNew['top']) || isset($contentitemMarginNew['right']) || isset($contentitemMarginNew['bottom']) || isset($contentitemMarginNew['left'])) {
                        $output .= 'margin: ' .
                            (isset($contentitemMarginNew['top']) ? (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) : '0px') . ' ' .
                            (isset($contentitemMarginNew['right']) ? (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) : '0px') . ' ' .
                            (isset($contentitemMarginNew['bottom']) ? (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) : '0px') . ' ' .
                            (isset($contentitemMarginNew['left']) ? (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) : '0px') . '; ';
                    }

                    // Padding
                    if (isset($contentitemPaddingNew['top']) || isset($contentitemPaddingNew['right']) || isset($contentitemPaddingNew['bottom']) || isset($contentitemPaddingNew['left'])) {
                        $output .= 'padding: ' .
                            (isset($contentitemPaddingNew['top']) ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' .
                            (isset($contentitemPaddingNew['right']) ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' .
                            (isset($contentitemPaddingNew['bottom']) ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' .
                            (isset($contentitemPaddingNew['left']) ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; ';
                    }

                    // Border Width
                    if (isset($contentBorderWidth['top']) || isset($contentBorderWidth['right']) || isset($contentBorderWidth['bottom']) || isset($contentBorderWidth['left'])) {
                        $output .= 'border-width: ' .
                            (isset($contentBorderWidth['top']) ? (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) : '0px') . ' ' .
                            (isset($contentBorderWidth['right']) ? (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) : '0px') . ' ' .
                            (isset($contentBorderWidth['bottom']) ? (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) : '0px') . ' ' .
                            (isset($contentBorderWidth['left']) ? (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) : '0px') . '; ';
                    }

                    // Border Radius
                    if (isset($contentitemRadius['top']) || isset($contentitemRadius['right']) || isset($contentitemRadius['bottom']) || isset($contentitemRadius['left'])) {
                        $output .= 'border-radius: ' .
                            (isset($contentitemRadius['top']) ? (is_numeric($contentitemRadius['top']) ? $contentitemRadius['top'] . 'px' : esc_attr($contentitemRadius['top'])) : '0px') . ' ' .
                            (isset($contentitemRadius['right']) ? (is_numeric($contentitemRadius['right']) ? $contentitemRadius['right'] . 'px' : esc_attr($contentitemRadius['right'])) : '0px') . ' ' .
                            (isset($contentitemRadius['bottom']) ? (is_numeric($contentitemRadius['bottom']) ? $contentitemRadius['bottom'] . 'px' : esc_attr($contentitemRadius['bottom'])) : '0px') . ' ' .
                            (isset($contentitemRadius['left']) ? (is_numeric($contentitemRadius['left']) ? $contentitemRadius['left'] . 'px' : esc_attr($contentitemRadius['left'])) : '0px') . '; ';
                    }

                    // Border Style
                    if (!empty($contentNormalBorderType)) {
                        $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                    }

                    // Background Color
                    if (!empty($contentBgColor)) {
                        $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                    }

                    // Border Color
                    if (!empty($contentBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                    }

                    $output .= '" ' . $onmouseover . $onmouseout . '>'; // Close opening div tag with events

                    // Meta Data
                    if ($showMetaData) {
                                
                        $output .= '<div class="fpg-meta align-' . $metaAlignment . ' " style="';  
                            // MARGIN
                            if (
                                isset($metaMarginNew['top']) ||
                                isset($metaMarginNew['right']) ||
                                isset($metaMarginNew['bottom']) ||
                                isset($metaMarginNew['left'])
                            ) {
                                $output .= 'margin: ' .
                                    (isset($metaMarginNew['top']) ? (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) : '0px') . ' ' .
                                    (isset($metaMarginNew['right']) ? (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) : '0px') . ' ' .
                                    (isset($metaMarginNew['bottom']) ? (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) : '0px') . ' ' .
                                    (isset($metaMarginNew['left']) ? (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) : '0px') . '; ';
                            }

                            // PADDING
                            if (
                                isset($metaPadding['top']) ||
                                isset($metaPadding['right']) ||
                                isset($metaPadding['bottom']) ||
                                isset($metaPadding['left'])
                            ) {
                                $output .= 'padding: ' .
                                    (isset($metaPadding['top']) ? (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) : '0px') . ' ' .
                                    (isset($metaPadding['right']) ? (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) : '0px') . ' ' .
                                    (isset($metaPadding['bottom']) ? (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) : '0px') . ' ' .
                                    (isset($metaPadding['left']) ? (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) : '0px') . '; ';
                            } 
                            
                            // Color
                            if (!empty($metaTextColor)) {
                                $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                            }
                            // Order
                            if (!empty($metaOrder)) {
                                $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                            }
                        $output .= '">';

                        $meta_items = [];

                        // Date
                        if ($showPostDate) {
                            $meta = '<div class="meta-date" style="';

                            // Color
                            if (!empty($metaTextColor)) {
                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                            }

                            // Font size
                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }
                            $meta .= '">';
                            $meta .= '<span>' . esc_html($getdate) . '</span>';
                            $meta .= '</div>';

                            $meta_items[] = $meta;
                        }

                        // Author
                        if ($showPostCategory) {
                            $meta = '<div class="meta-category" style="';

                            if (!empty($metaTextColor)) {
                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                            }
                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '">';

                            // Get category names without links
                            $categories_list = get_the_category($post_id);
                            if (!empty($categories_list)) {
                                $category_names = array();

                                foreach ($categories_list as $category) {
                                    // If you want to link to the category archive, use get_category_link()
                                    $category_link = esc_url(get_category_link($category->term_id));
                                    $category_names[] = '<a href="' . $category_link . '">' . esc_html($category->name) . '</a>';
                                }

                                $meta .= implode(', ', $category_names); // comma-separated category links
                            }

                            $meta .= '</div>';
                            $meta_items[] = $meta;
                        }


                        // Now join meta items with the separator
                        $output .= implode( $meta_items);

                        $output .= '</div>'; // Close meta-data-list
                        
                    }
                    // End Meta Data

                    // title
                    if ($showPostTitle) {
                        $titleStyles = '';

                        // Order
                        if (!empty($titleOrder)) {
                            $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                        }

                        // Background color
                        if (!empty($postTitleBgColor)) {
                            $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                        }

                        // Margin
                        if (isset($postTitleMargin['top']) || isset($postTitleMargin['right']) || isset($postTitleMargin['bottom']) || isset($postTitleMargin['left'])) {
                            $titleStyles .= 'margin: ' .
                                (isset($postTitleMargin['top']) ? (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) : '0px') . ' ' .
                                (isset($postTitleMargin['right']) ? (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) : '0px') . ' ' .
                                (isset($postTitleMargin['bottom']) ? (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) : '0px') . ' ' .
                                (isset($postTitleMargin['left']) ? (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) : '0px') . '; ';
                        }

                        // Padding
                        if (isset($postTitlePadding['top']) || isset($postTitlePadding['right']) || isset($postTitlePadding['bottom']) || isset($postTitlePadding['left'])) {
                            $titleStyles .= 'padding: ' .
                                (isset($postTitlePadding['top']) ? (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) : '0px') . ' ' .
                                (isset($postTitlePadding['right']) ? (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) : '0px') . ' ' .
                                (isset($postTitlePadding['bottom']) ? (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) : '0px') . ' ' .
                                (isset($postTitlePadding['left']) ? (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) : '0px') . '; ';
                        }

                        // Determine if underline should be shown
                        $showUnderline = $postLinkType === 'yeslink' && $titleHoverUnderLine === 'enable';

                        // Class name
                        $classNames = 'title align-' . esc_attr($postTitleAlignment);
                        if ($showUnderline) {
                            $classNames .= ' underline';
                        }

                        // Hover/Out events for nolink
                        $onmouseover = '';
                        $onmouseout  = '';

                        if (!empty($postTitleHoverBgColor)) {
                            $onmouseover .= 'this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';';
                        }

                        if (!empty($postTitleHoverColor)) {
                            $onmouseover .= ' this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                        }

                        if (!empty($postTitleBgColor)) {
                            $onmouseout .= 'this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';';
                        } else {
                            $onmouseout .= 'this.style.removeProperty(\'background-color\');';
                        }

                        if (!empty($postTitleColor)) {
                            $onmouseout .= ' this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                        } else {
                            $onmouseout .= ' this.style.removeProperty(\'color\');';
                        }

                        // Opening title tag
                        $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"'
                            . (!empty($onmouseover) ? ' onmouseover="' . trim($onmouseover) . '"' : '')
                            . (!empty($onmouseout)  ? ' onmouseout="'  . trim($onmouseout)  . '"' : '') . '>';

                        if ($postLinkType === 'yeslink') {
                            // Anchor styles
                            $style = '';
                            $hoverStyle = '';
                            $mouseoutStyle = '';

                            if (!empty($postTitleFontSize)) {
                                $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                            }

                            if (!empty($postTitleLineHeight)) {
                                $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                            }

                            if (!empty($postTitleLetterSpacing)) {
                                $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                            }

                            if (!empty($postTitleFontWeight)) {
                                $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                            }

                            if (!empty($postTitleColor)) {
                                $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                $mouseoutStyle .= 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                            } else {
                                $mouseoutStyle .= 'this.style.color=\'\';';
                            }

                            if (!empty($postTitleHoverColor)) {
                                $hoverStyle .= 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                            }

                            if ($showUnderline && !empty($postTitleHoverColor)) {
                                $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                                $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                $hoverStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                            }

                            if ($showUnderline && empty($postTitleColor ) && !empty($postTitleColor )) {
                                $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                                $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                $mouseoutStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                            } else {
                                
                                $mouseoutStyle .= ' this.style.removeProperty(\'background-position\');';
                                $mouseoutStyle .= ' this.style.removeProperty(\'background-size\');';
                            }

                            $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '
                                style="' . esc_attr(trim($style)) . '"'
                                . (!empty($hoverStyle)   ? ' onmouseover="' . $hoverStyle . '"' : '')
                                . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                . esc_html($croppedTitle) . '</a>';
                        } else {
                            // No link  render span with inline styles
                            $inlineStyle = '';
                            if (!empty($postTitleFontSize)) {
                                $inlineStyle .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                            }
                            if (!empty($postTitleLineHeight)) {
                                $inlineStyle .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                            }
                            if (!empty($postTitleLetterSpacing)) {
                                $inlineStyle .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                            }
                            if (!empty($postTitleFontWeight)) {
                                $inlineStyle .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                            }
                            if (!empty($postTitleColor)) {
                                $inlineStyle .= 'color: ' . esc_attr($postTitleColor) . '; ';
                            }

                            $output .= '<span style="' . esc_attr(trim($inlineStyle)) . '">' . esc_html($croppedTitle) . '</span>';
                        }

                        $output .= '</' . esc_attr($titleTag) . '>';
                    }
                    if ($showPostExcerpt) {
                        $excerptStyles = '';

                        // Order
                        if (!empty($excerptOrder)) {
                            $excerptStyles .= 'order: ' . esc_attr($excerptOrder) . '; ';
                        }

                        // Typography
                        if (!empty($excerptFontSize)) {
                            $excerptStyles .= 'font-size: ' . esc_attr($excerptFontSize) . 'px; ';
                        }

                        if (!empty($excerptLineHeight)) {
                            $excerptStyles .= 'line-height: ' . esc_attr($excerptLineHeight) . '; ';
                        }

                        if (!empty($excerptLetterSpacing)) {
                            $excerptStyles .= 'letter-spacing: ' . esc_attr($excerptLetterSpacing) . 'px; ';
                        }

                        if (!empty($excerptFontWeight)) {
                            $excerptStyles .= 'font-weight: ' . esc_attr($excerptFontWeight) . '; ';
                        }

                        if (!empty($excerptColor)) {
                            $excerptStyles .= 'color: ' . esc_attr($excerptColor) . '; ';
                        }

                        if (!empty($excerptBgColor)) {
                            $excerptStyles .= 'background-color: ' . esc_attr($excerptBgColor) . '; ';
                        }

                        if (!empty($excerptBorderType)) {
                            $excerptStyles .= 'border-style: ' . esc_attr($excerptBorderType) . '; ';
                        }

                        // Margin
                        if (isset($excerptMargin['top']) || isset($excerptMargin['right']) || isset($excerptMargin['bottom']) || isset($excerptMargin['left'])) {
                            $excerptStyles .= 'margin: ' .
                                (isset($excerptMargin['top']) ? (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) : '0px') . ' ' .
                                (isset($excerptMargin['right']) ? (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) : '0px') . ' ' .
                                (isset($excerptMargin['bottom']) ? (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) : '0px') . ' ' .
                                (isset($excerptMargin['left']) ? (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) : '0px') . '; ';
                        }

                        // Padding
                        if (isset($excerptPadding['top']) || isset($excerptPadding['right']) || isset($excerptPadding['bottom']) || isset($excerptPadding['left'])) {
                            $excerptStyles .= 'padding: ' .
                                (isset($excerptPadding['top']) ? (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) : '0px') . ' ' .
                                (isset($excerptPadding['right']) ? (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) : '0px') . ' ' .
                                (isset($excerptPadding['bottom']) ? (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) : '0px') . ' ' .
                                (isset($excerptPadding['left']) ? (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) : '0px') . '; ';
                        }

                        // Handle hover logic conditionally
                        $hoverIn = '';
                        $hoverOut = '';

                        if (!empty($excerptHoverColor)) {
                            $hoverIn .= 'this.style.color=\'' . esc_attr($excerptHoverColor) . '\';';
                            $hoverOut .= 'this.style.color=\'' . esc_attr($excerptColor) . '\';';
                        }

                        if (!empty($excerptHoverBgColor)) {
                            $hoverIn .= 'this.style.backgroundColor=\'' . esc_attr($excerptHoverBgColor) . '\';';
                            $hoverOut .= 'this.style.backgroundColor=\'' . esc_attr($excerptBgColor) . '\';';
                        }

                        $output .= '<p class="fpg-excerpt' . ' align-' . esc_attr($excerptAlignment) . '" style="' . esc_attr(trim($excerptStyles)) . '"';

                        if (!empty($hoverIn) || !empty($hoverOut)) {
                            $output .= ' onmouseover="' . esc_attr($hoverIn) . '"';
                            $output .= ' onmouseout="' . esc_attr($hoverOut) . '"';
                        }

                        $output .= '>';
                        $output .= '' . esc_html($excerpt) . '</p>';
                        
                    }
                    // Button Output                
                    if ($showReadMoreButton) {
                        // Button wrapper styles
                        $buttonWrapperStyle = '';

                        if (
                            isset($buttonMarginNew['top']) || 
                            isset($buttonMarginNew['right']) || 
                            isset($buttonMarginNew['bottom']) || 
                            isset($buttonMarginNew['left'])
                        ) {
                            $buttonWrapperStyle .= 'margin: ' .
                                (isset($buttonMarginNew['top']) ? (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) : '0px') . ' ' .
                                (isset($buttonMarginNew['right']) ? (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) : '0px') . ' ' .
                                (isset($buttonMarginNew['bottom']) ? (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) : '0px') . ' ' .
                                (isset($buttonMarginNew['left']) ? (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) : '0px') . '; ';
                        }

                        // Order
                        if (!empty($buttonOrder)) {
                            $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                        }
       
                        $output .= '<div class="btn-wrapper align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';

                        // Button inline styles
                        $buttonInlineStyles = '';

                        if (!empty($buttonTextColor)) {
                            $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                        }
                        if (!empty($buttonBackgroundColor)) {
                            $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                        }
                        if (!empty($buttonFontSize)) {
                            $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                        }
                        if (!empty($buttonFontWeight)) {
                            $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                        }
                        if (!empty($buttonBorderColor)) {
                            $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                        }
                        if (!empty($buttonBorderType)) {
                            $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                        }

                        // Border Width
                        if (
                            isset($buttonBorderWidth['top']) || 
                            isset($buttonBorderWidth['right']) || 
                            isset($buttonBorderWidth['bottom']) || 
                            isset($buttonBorderWidth['left'])
                        ) {
                            $buttonInlineStyles .= 'border-width: ' .
                                (isset($buttonBorderWidth['top']) ? (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) : '0px') . ' ' .
                                (isset($buttonBorderWidth['right']) ? (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) : '0px') . ' ' .
                                (isset($buttonBorderWidth['bottom']) ? (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) : '0px') . ' ' .
                                (isset($buttonBorderWidth['left']) ? (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) : '0px') . '; ';
                        }

                        // Border Radius
                        if (
                            isset($buttonBorderRadius['top']) || 
                            isset($buttonBorderRadius['right']) || 
                            isset($buttonBorderRadius['bottom']) || 
                            isset($buttonBorderRadius['left'])
                        ) {
                            $buttonInlineStyles .= 'border-radius: ' .
                                (isset($buttonBorderRadius['top']) ? (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) : '0px') . ' ' .
                                (isset($buttonBorderRadius['right']) ? (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) : '0px') . ' ' .
                                (isset($buttonBorderRadius['bottom']) ? (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) : '0px') . ' ' .
                                (isset($buttonBorderRadius['left']) ? (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) : '0px') . '; ';
                        }

                        // Padding
                        if (
                            isset($buttonPaddingNew['top']) || 
                            isset($buttonPaddingNew['right']) || 
                            isset($buttonPaddingNew['bottom']) || 
                            isset($buttonPaddingNew['left'])
                        ) {
                            $buttonInlineStyles .= 'padding: ' .
                                (isset($buttonPaddingNew['top']) ? (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) : '0px') . ' ' .
                                (isset($buttonPaddingNew['right']) ? (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) : '0px') . ' ' .
                                (isset($buttonPaddingNew['bottom']) ? (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) : '0px') . ' ' .
                                (isset($buttonPaddingNew['left']) ? (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) : '0px') . '; ';
                        } 

                        // Hover styles
                        $buttonHoverInlineStyles = '';
                        $buttonResetStyles = '';

                        if (!empty($buttonHoverTextColor)) {
                            $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                            $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                        }
                        if (!empty($buttonHoverBorderColor)) {
                            $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                            $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                        }
                        if (!empty($buttonHoverBackgroundColor)) {
                            $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                            $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                        }

                        // Button anchor tag
                        $output .= '<a class="fpg-btn read-more ' . esc_attr($buttonStyle12) . '" href="' . esc_url(get_permalink()) . '" ' . $targetAttr . ' style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                        if (!empty($buttonHoverInlineStyles)) {
                            $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                        }

                        if (!empty($buttonResetStyles)) {
                            $output .= ' onmouseout="' . $buttonResetStyles . '"';
                        }

                        $output .= '>';

                        // Icon handling
                        $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                        $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                        $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                        if ($iconPosition === 'left' && $showButtonIcon) {
                            $output .= $leftIcon . ' ';
                        }

                        $output .= esc_html($readMoreLabel);

                        if ($iconPosition === 'right' && $showButtonIcon) {
                            $output .= ' ' . $rightIcon;
                        }

                        $output .= '</a></div>';
                    }
                    // End Button

                    $output .= '</div>';
                    // End MAIN Content
                    $output .= '</div>';
                    // End Full post layout
                }
            }
            
            $output .= '</div>'; // End .fancy-post-grid

            if ($enablePagination) {
                // Generate individual style strings
                // MARGIN    
                if (isset($paginationMarginNew['top']) || isset($paginationMarginNew['right']) || isset($paginationMarginNew['bottom']) || isset($paginationMarginNew['left'])) {
                    $margin = 
                        (isset($paginationMarginNew['top']) ? (is_numeric($paginationMarginNew['top']) ? $paginationMarginNew['top'] . 'px' : esc_attr($paginationMarginNew['top'])) : '0px') . ' ' .
                        (isset($paginationMarginNew['right']) ? (is_numeric($paginationMarginNew['right']) ? $paginationMarginNew['right'] . 'px' : esc_attr($paginationMarginNew['right'])) : '0px') . ' ' .
                        (isset($paginationMarginNew['bottom']) ? (is_numeric($paginationMarginNew['bottom']) ? $paginationMarginNew['bottom'] . 'px' : esc_attr($paginationMarginNew['bottom'])) : '0px') . ' ' .
                        (isset($paginationMarginNew['left']) ? (is_numeric($paginationMarginNew['left']) ? $paginationMarginNew['left'] . 'px' : esc_attr($paginationMarginNew['left'])) : '0px') . '; ';
                }

                // PADDING
                if (isset($paginationPaddingNew['top']) || isset($paginationPaddingNew['right']) || isset($paginationPaddingNew['bottom']) || isset($paginationPaddingNew['left'])) {
                    $padding =
                        (isset($paginationPaddingNew['top']) ? (is_numeric($paginationPaddingNew['top']) ? $paginationPaddingNew['top'] . 'px' : esc_attr($paginationPaddingNew['top'])) : '0px') . ' ' .
                        (isset($paginationPaddingNew['right']) ? (is_numeric($paginationPaddingNew['right']) ? $paginationPaddingNew['right'] . 'px' : esc_attr($paginationPaddingNew['right'])) : '0px') . ' ' .
                        (isset($paginationPaddingNew['bottom']) ? (is_numeric($paginationPaddingNew['bottom']) ? $paginationPaddingNew['bottom'] . 'px' : esc_attr($paginationPaddingNew['bottom'])) : '0px') . ' ' .
                        (isset($paginationPaddingNew['left']) ? (is_numeric($paginationPaddingNew['left']) ? $paginationPaddingNew['left'] . 'px' : esc_attr($paginationPaddingNew['left'])) : '0px') . '; ';
                }

                // BORDER RADIUS
                if (isset($paginationBorderRadius['top']) || isset($paginationBorderRadius['right']) || isset($paginationBorderRadius['bottom']) || isset($paginationBorderRadius['left'])) {
                    $borderRadius =
                        (isset($paginationBorderRadius['top']) ? (is_numeric($paginationBorderRadius['top']) ? $paginationBorderRadius['top'] . 'px' : esc_attr($paginationBorderRadius['top'])) : '0px') . ' ' .
                        (isset($paginationBorderRadius['right']) ? (is_numeric($paginationBorderRadius['right']) ? $paginationBorderRadius['right'] . 'px' : esc_attr($paginationBorderRadius['right'])) : '0px') . ' ' .
                        (isset($paginationBorderRadius['bottom']) ? (is_numeric($paginationBorderRadius['bottom']) ? $paginationBorderRadius['bottom'] . 'px' : esc_attr($paginationBorderRadius['bottom'])) : '0px') . ' ' .
                        (isset($paginationBorderRadius['left']) ? (is_numeric($paginationBorderRadius['left']) ? $paginationBorderRadius['left'] . 'px' : esc_attr($paginationBorderRadius['left'])) : '0px') . '; ';
                }

                // BORDER WIDTH
                if (isset($paginationBorderWidthNew['top']) || isset($paginationBorderWidthNew['right']) || isset($paginationBorderWidthNew['bottom']) || isset($paginationBorderWidthNew['left'])) {
                    $borderWidth =
                        (isset($paginationBorderWidthNew['top']) ? (is_numeric($paginationBorderWidthNew['top']) ? $paginationBorderWidthNew['top'] . 'px' : esc_attr($paginationBorderWidthNew['top'])) : '0px') . ' ' .
                        (isset($paginationBorderWidthNew['right']) ? (is_numeric($paginationBorderWidthNew['right']) ? $paginationBorderWidthNew['right'] . 'px' : esc_attr($paginationBorderWidthNew['right'])) : '0px') . ' ' .
                        (isset($paginationBorderWidthNew['bottom']) ? (is_numeric($paginationBorderWidthNew['bottom']) ? $paginationBorderWidthNew['bottom'] . 'px' : esc_attr($paginationBorderWidthNew['bottom'])) : '0px') . ' ' .
                        (isset($paginationBorderWidthNew['left']) ? (is_numeric($paginationBorderWidthNew['left']) ? $paginationBorderWidthNew['left'] . 'px' : esc_attr($paginationBorderWidthNew['left'])) : '0px') . '; ';
                }
                
                $gap = is_numeric($paginationGap) ? $paginationGap . 'px' : esc_attr($paginationGap);
                $fontSize = is_numeric($paginationFontSize) ? $paginationFontSize . 'px' : esc_attr($paginationFontSize);

                // Pagination wrapper
                $output .= '<div class="fpg-pagination" style="display: flex; justify-content: ' . esc_attr($paginationAlignment) . '; margin: ' . $margin . ';">';

                // UL
                $output .= '<ul class="fancy-page-numbers" style=" gap: ' . $gap . ';">';

                // Generate links
                $pagination_links = paginate_links(array(
                    'total'     => $query->max_num_pages,
                    'current'   => $paged,
                    'format'    => '?paged=%#%',
                    'prev_text' => esc_html__(' Prev', 'fancy-post-grid'),
                    'next_text' => esc_html__('Next ', 'fancy-post-grid'),
                    'type'      => 'array',
                ));

                if (!empty($pagination_links)) {
                    foreach ($pagination_links as $link) {
                        $styled_link = preg_replace_callback(
                            '/<(a|span)([^>]*)>/',
                            function ($matches) use (
                                $borderWidth, $paginationBorderStyle, $paginationBorderColor, $borderRadius,$padding,
                                $paginationTextColor, $paginationBackgroundColor,
                                $paginationHoverTextColor, $paginationHoverBackgroundColor, $paginationHoverBorderColor,
                                $paginationActiveTextColor, $paginationActiveBackgroundColor, $paginationActiveBorderColor,$fontSize
                            ) {
                                $tag = $matches[1];
                                $attrs = $matches[2];

                                //  Replace 'page-numbers' with 'fpg-page-numbers'
                                $attrs = preg_replace('/class="([^"]*?)page-numbers([^"]*?)"/', 'class="$1fpg-page-numbers$2"', $attrs);

                                $is_current = strpos($attrs, 'current') !== false;

                                $style = '';
                                $style .= 'font-size:' . esc_attr($fontSize) . '; ';
                                $style .= 'border-width:' . esc_attr($borderWidth) . '; ';
                                $style .= 'border-style:' . esc_attr($paginationBorderStyle) . '; ';
                                $style .= 'border-color:' . esc_attr($is_current ? $paginationActiveBorderColor : $paginationBorderColor) . '; ';
                                $style .= 'border-radius:' . esc_attr($borderRadius) . '; ';
                                $style .= 'padding:' . esc_attr($padding) . '; ';
                                $style .= 'color:' . esc_attr($is_current ? $paginationActiveTextColor : $paginationTextColor) . '; ';
                                $style .= 'background-color:' . esc_attr($is_current ? $paginationActiveBackgroundColor : $paginationBackgroundColor) . '; ';

                                $hover = 'this.style.color=\'' . esc_attr($paginationHoverTextColor) . '\';' .
                                         'this.style.backgroundColor=\'' . esc_attr($paginationHoverBackgroundColor) . '\';' .
                                         'this.style.borderColor=\'' . esc_attr($paginationHoverBorderColor) . '\';';

                                $out = '<' . $tag . $attrs . ' style="' . $style . '"';
                                if (!$is_current) {
                                    $out .= ' onmouseover="' . $hover . '"';
                                    $out .= ' onmouseout="this.style.color=\'' . esc_attr($paginationTextColor) . '\';' .
                                            'this.style.backgroundColor=\'' . esc_attr($paginationBackgroundColor) . '\';' .
                                            'this.style.borderColor=\'' . esc_attr($paginationBorderColor) . '\';"';
                                }
                                $out .= '>';
                                return $out;
                            },
                            $link
                        );

                        $output .= '<li>' . $styled_link . '</li>';
                    }
                }

                $output .= '</ul>';
                $output .= '</div>';
            }

        wp_reset_postdata();

        return $output;
    }

    public function fancy_post_slider_free_render_callback($attributes) {
        // Content Layout

        $sliderLayoutStyle = isset($attributes['sliderLayoutStyle']) ? $attributes['sliderLayoutStyle'] : 'style1';
        $gridColumns = isset($attributes['gridColumns']) ? absint($attributes['gridColumns']) : 3;
        //Query Builder
        $selectedCategories = isset($attributes['selectedCategories']) && is_array($attributes['selectedCategories'])
        ? array_map('absint', $attributes['selectedCategories'])
        : [];
        $selectedTags = isset($attributes['selectedTags']) && is_array($attributes['selectedTags'])
        ? array_map('absint', $attributes['selectedTags'])
        : [];
        $orderBy = isset($attributes['orderBy']) ? sanitize_text_field($attributes['orderBy']) : 'title';
        $postLimit = isset($attributes['postLimit']) ? absint($attributes['postLimit']) : 9;
          
        // Pagination settings
        $enablePagination = isset($attributes['enablePagination']) ? filter_var($attributes['enablePagination'], FILTER_VALIDATE_BOOLEAN) : true;
        $enableArrow = isset($attributes['enableArrow']) ? filter_var($attributes['enableArrow'], FILTER_VALIDATE_BOOLEAN) : true;
        $enableKeyboard = isset($attributes['enableKeyboard']) ? filter_var($attributes['enableKeyboard'], FILTER_VALIDATE_BOOLEAN) : true;
        $enableDynamicBullets = isset($attributes['enableDynamicBullets']) ? filter_var($attributes['enableDynamicBullets'], FILTER_VALIDATE_BOOLEAN) : false;
        $enableLoop = isset($attributes['enableLoop']) ? filter_var($attributes['enableLoop'], FILTER_VALIDATE_BOOLEAN) : true;
        $enableFreeMode = isset($attributes['enableFreeMode']) ? filter_var($attributes['enableFreeMode'], FILTER_VALIDATE_BOOLEAN) : true;
        $enableAutoPlay = isset($attributes['enableAutoPlay']) ? filter_var($attributes['enableAutoPlay'], FILTER_VALIDATE_BOOLEAN) : false;
        $paginationClickable = isset($attributes['paginationClickable']) ? filter_var($attributes['paginationClickable'], FILTER_VALIDATE_BOOLEAN) : true;
        $paginationType = isset($attributes['paginationType']) ? sanitize_text_field($attributes['paginationType']) : 'bullets';
        $autoPlaySpeed = isset($attributes['autoPlaySpeed']) ? absint($attributes['autoPlaySpeed']) : 3000;

        // Links
        $postLinkTarget = isset($attributes['postLinkTarget']) ? sanitize_text_field($attributes['postLinkTarget']) : 'newWindow';
        $thumbnailLink = isset($attributes['thumbnailLink']) ? filter_var($attributes['thumbnailLink'], FILTER_VALIDATE_BOOLEAN) : true;
        $postLinkType = isset($attributes['postLinkType']) ? sanitize_text_field($attributes['postLinkType']) : 'yeslink';

        // Field Selector
        $showPostTitle = isset($attributes['showPostTitle']) ? filter_var($attributes['showPostTitle'], FILTER_VALIDATE_BOOLEAN) : true;
        $showThumbnail = isset($attributes['showThumbnail']) ? filter_var($attributes['showThumbnail'], FILTER_VALIDATE_BOOLEAN) : true;
        $showPostExcerpt = isset($attributes['showPostExcerpt']) ? filter_var($attributes['showPostExcerpt'], FILTER_VALIDATE_BOOLEAN) : true;
        $showReadMoreButton = isset($attributes['showReadMoreButton']) ? filter_var($attributes['showReadMoreButton'], FILTER_VALIDATE_BOOLEAN) : true;
        $showMetaData = isset($attributes['showMetaData']) ? filter_var($attributes['showMetaData'], FILTER_VALIDATE_BOOLEAN) : true;
        $showPostDate = isset($attributes['showPostDate']) ? filter_var($attributes['showPostDate'], FILTER_VALIDATE_BOOLEAN) : true;
        $showPostAuthor = isset($attributes['showPostAuthor']) ? filter_var($attributes['showPostAuthor'], FILTER_VALIDATE_BOOLEAN) : true;
        $showPostCategory = isset($attributes['showPostCategory']) ? filter_var($attributes['showPostCategory'], FILTER_VALIDATE_BOOLEAN) : true;
        $showPostTags = isset($attributes['showPostTags']) ? filter_var($attributes['showPostTags'], FILTER_VALIDATE_BOOLEAN) : false;
        $showPostCommentsCount = isset($attributes['showPostCommentsCount']) ? filter_var($attributes['showPostCommentsCount'], FILTER_VALIDATE_BOOLEAN) : false;
        $showMetaIcon = isset($attributes['showMetaIcon']) ? filter_var($attributes['showMetaIcon'], FILTER_VALIDATE_BOOLEAN) : true;
        $showPostDateIcon = isset($attributes['showPostDateIcon']) ? filter_var($attributes['showPostDateIcon'], FILTER_VALIDATE_BOOLEAN) : true;
        $showPostAuthorIcon = isset($attributes['showPostAuthorIcon']) ? filter_var($attributes['showPostAuthorIcon'], FILTER_VALIDATE_BOOLEAN) : true;
        $showPostCategoryIcon = isset($attributes['showPostCategoryIcon']) ? filter_var($attributes['showPostCategoryIcon'], FILTER_VALIDATE_BOOLEAN) : true;
        $showPostTagsIcon = isset($attributes['showPostTagsIcon']) ? filter_var($attributes['showPostTagsIcon'], FILTER_VALIDATE_BOOLEAN) : false;
        $showPostCommentsCountIcon = isset($attributes['showPostCommentsCountIcon']) ? filter_var($attributes['showPostCommentsCountIcon'], FILTER_VALIDATE_BOOLEAN) : false;

        // Order values
        $metaOrder = isset($attributes['metaOrder']) ? absint($attributes['metaOrder']) : '';
        $titleOrder = isset($attributes['titleOrder']) ? absint($attributes['titleOrder']) : '';
        $excerptOrder = isset($attributes['excerptOrder']) ? absint($attributes['excerptOrder']) : '';
        $buttonOrder = isset($attributes['buttonOrder']) ? absint($attributes['buttonOrder']) : '';

        // Post title settings
        $titleTag               = isset($attributes['titleTag']) ? sanitize_text_field($attributes['titleTag']) : 'h3';
        $titleHoverUnderLine    = isset($attributes['titleHoverUnderLine']) ? sanitize_text_field($attributes['titleHoverUnderLine']) : 'enable';
        $titleCropBy            = isset($attributes['titleCropBy']) ? sanitize_text_field($attributes['titleCropBy']) : 'word';
        $titleLength            = isset($attributes['titleLength']) ? absint($attributes['titleLength']) : 12;
        
        //THUMB sETTINGS
        $thumbnailSize = isset($attributes['thumbnailSize']) ? sanitize_text_field($attributes['thumbnailSize']) : '';
        $hoverAnimation = isset($attributes['hoverAnimation']) ? sanitize_text_field($attributes['hoverAnimation']) : 'hover-zoom_in';
        // Excerpt Settings
        $excerptType = isset($attributes['excerptType']) ? sanitize_text_field($attributes['excerptType']) : 'word';
        $excerptIndicator = isset($attributes['excerptIndicator']) ? sanitize_text_field($attributes['excerptIndicator']) : '...';
        $excerptLimit = isset($attributes['excerptLimit']) ? absint($attributes['excerptLimit']) : 10;
        // Meta data Settings
        $metaAuthorPrefix = isset($attributes['metaAuthorPrefix']) ? sanitize_text_field($attributes['metaAuthorPrefix']) : __('By', 'fancy-post-grid');
        $metaSeperator = isset($attributes['metaSeperator']) ? sanitize_text_field($attributes['metaSeperator']) : '';
        //Button Settings   
        $showButtonIcon = isset($attributes['showButtonIcon']) ? filter_var($attributes['showPostCommentsCountIcon'], FILTER_VALIDATE_BOOLEAN) : true;
        $iconPosition = isset($attributes['iconPosition']) ? sanitize_text_field($attributes['iconPosition']) : 'right';
        $buttonStyle = isset($attributes['buttonStyle']) ? sanitize_text_field($attributes['buttonStyle']) : '';
        $readMoreLabel = isset($attributes['readMoreLabel']) ? sanitize_text_field($attributes['readMoreLabel']) : __('Read More', 'fancy-post-grid');
        // SECTION Area
        $sectionBgColor    = isset($attributes['sectionBgColor']) ? sanitize_text_field($attributes['sectionBgColor']) : '';
        $sectionMargin = isset($attributes['sectionMargin']) ? $attributes['sectionMargin'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $sectionPadding = isset($attributes['sectionPadding']) ? $attributes['sectionPadding'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        // ITEM Box
        $itemPadding = isset($attributes['itemPadding']) ? $attributes['itemPadding'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $itemMargin = isset($attributes['itemMargin']) ? $attributes['itemMargin'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $itemBorderRadius = isset($attributes['itemBorderRadius']) ? $attributes['itemBorderRadius'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $itemBorderWidth = isset($attributes['itemBorderWidth']) ? $attributes['itemBorderWidth'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $itemBoxAlignment   = isset($attributes['itemBoxAlignment']) ? sanitize_text_field($attributes['itemBoxAlignment']) : '';
        $itemBorderType     = isset($attributes['itemBorderType']) ? sanitize_text_field($attributes['itemBorderType']) : '';
        $itemBoxShadow = isset($attributes['itemBoxShadow']) ? $attributes['itemBoxShadow'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $itemBackgroundColor = isset($attributes['itemBackgroundColor']) ? sanitize_text_field($attributes['itemBackgroundColor']) : '';
        $itemBorderColor    = isset($attributes['itemBorderColor']) ? sanitize_text_field($attributes['itemBorderColor']) : '';   
        $itemBoxShadowColor = isset($attributes['itemBoxShadowColor']) ? sanitize_text_field($attributes['itemBoxShadowColor']) : '';
        $itemGap      = isset($attributes['itemGap']) ? absint($attributes['itemGap']) : 30;

        // Content Box
        $contentitemPaddingNew = isset($attributes['contentitemPaddingNew']) ? $attributes['contentitemPaddingNew'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $contentitemMarginNew = isset($attributes['contentitemMarginNew']) ? $attributes['contentitemMarginNew'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $contentBorderWidth = isset($attributes['contentBorderWidth']) ? $attributes['contentBorderWidth'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $contentitemRadius = isset($attributes['contentitemRadius']) ? $attributes['contentitemRadius'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $contentNormalBorderType = isset($attributes['contentnormalBorderType']) ? sanitize_text_field($attributes['contentnormalBorderType']) : '';
        $contentBgColor    = isset($attributes['contentBgColor']) ? sanitize_text_field($attributes['contentBgColor']) : '';   
        $contentBorderColor = isset($attributes['contentBorderColor']) ? sanitize_text_field($attributes['contentBorderColor']) : '';
        // Thumbnail
        $thumbnailMargin = isset($attributes['thumbnailMargin']) ? $attributes['thumbnailMargin'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $thumbnailPadding = isset($attributes['thumbnailPadding']) ? $attributes['thumbnailPadding'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $thumbnailBorderRadius = isset($attributes['thumbnailBorderRadius']) ? $attributes['thumbnailBorderRadius'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];

        // Post Title
        $postTitleFontSize      = isset($attributes['postTitleFontSize']) ? absint($attributes['postTitleFontSize']) : '';
        $postTitleLineHeight    = isset($attributes['postTitleLineHeight']) ? floatval($attributes['postTitleLineHeight']) : '';
        $postTitleLetterSpacing = isset($attributes['postTitleLetterSpacing']) ? floatval($attributes['postTitleLetterSpacing']) : '';
        $postTitleFontWeight    = isset($attributes['postTitleFontWeight']) ? sanitize_text_field($attributes['postTitleFontWeight']) : '';
        $postTitleAlignment     = isset($attributes['postTitleAlignment']) ? sanitize_text_field($attributes['postTitleAlignment']) : '';
        $postTitleColor         = isset($attributes['postTitleColor']) ? sanitize_text_field($attributes['postTitleColor']) : '';
        $postTitleBgColor       = isset($attributes['postTitleBgColor']) ? sanitize_text_field($attributes['postTitleBgColor']) : ''; 
        $postTitleHoverColor    = isset($attributes['postTitleHoverColor']) ? sanitize_text_field($attributes['postTitleHoverColor']) : '';
        $postTitleHoverBgColor  = isset($attributes['postTitleHoverBgColor']) ? sanitize_text_field($attributes['postTitleHoverBgColor']) : '';
        // var_dump($postTitleHoverBgColor);
        $postTitleMargin  = isset($attributes['postTitleMargin']) ? array_map('sanitize_text_field', $attributes['postTitleMargin']) : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $postTitlePadding = isset($attributes['postTitlePadding']) ? array_map('sanitize_text_field', $attributes['postTitlePadding']) : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];

        // Excerpt
        $excerptFontSize = isset($attributes['excerptFontSize']) ? absint($attributes['excerptFontSize']) : '';
        $excerptLineHeight = isset($attributes['excerptLineHeight']) ? floatval($attributes['excerptLineHeight']) : '';
        $excerptLetterSpacing = isset($attributes['excerptLetterSpacing']) ? floatval($attributes['excerptLetterSpacing']) : '';
        $excerptFontWeight = isset($attributes['excerptFontWeight']) ? sanitize_text_field($attributes['excerptFontWeight']) : '';
        $excerptAlignment = isset($attributes['excerptAlignment']) ? sanitize_text_field($attributes['excerptAlignment']) : '';
        $excerptMargin = isset($attributes['excerptMargin']) ? array_map('sanitize_text_field', $attributes['excerptMargin']) : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $excerptPadding = isset($attributes['excerptPadding']) ? array_map('sanitize_text_field', $attributes['excerptPadding']) : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $excerptColor = isset($attributes['excerptColor']) ? sanitize_text_field($attributes['excerptColor']) : '';
        $excerptBgColor = isset($attributes['excerptBgColor']) ? sanitize_text_field($attributes['excerptBgColor']) : '';
        $excerptBorderType = isset($attributes['excerptBorderType']) ? sanitize_text_field($attributes['excerptBorderType']) : '';
        $excerptHoverColor = isset($attributes['excerptHoverColor']) ? sanitize_text_field($attributes['excerptHoverColor']) : '';
        $excerptHoverBgColor = isset($attributes['excerptHoverBgColor']) ? sanitize_text_field($attributes['excerptHoverBgColor']) : '';

        // Meta Data Attributes
        $metaAlignment = isset($attributes['metaAlignment']) ? sanitize_text_field($attributes['metaAlignment']) : '';
        $metaMarginNew = isset($attributes['metaMarginNew']) ? $attributes['metaMarginNew'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $metaPadding = isset($attributes['metaPadding']) ? $attributes['metaPadding'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $metaTextColor = isset($attributes['metaTextColor']) ? sanitize_text_field($attributes['metaTextColor']) : '';
        $separatorColor = isset($attributes['separatorColor']) ? sanitize_text_field($attributes['separatorColor']) : '';
        $metaFontSize = isset($attributes['metaFontSize']) ? absint($attributes['metaFontSize']) : '15';
        $metaIconColor = isset($attributes['metaIconColor']) ? sanitize_text_field($attributes['metaIconColor']) : '';
        $metaBgColor = isset($attributes['metaBgColor']) ? sanitize_text_field($attributes['metaBgColor']) : '';
        
        // Button Alignment
        $buttonAlignment = isset($attributes['buttonAlignment']) ? sanitize_text_field($attributes['buttonAlignment']) : '';
        $buttonMarginNew = isset($attributes['buttonMarginNew']) ? array_map('sanitize_text_field', $attributes['buttonMarginNew']) : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $buttonPaddingNew = isset($attributes['buttonPaddingNew']) ? array_map('sanitize_text_field', $attributes['buttonPaddingNew']) : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $buttonFontSize = isset($attributes['buttonFontSize']) ? absint($attributes['buttonFontSize']) : '';
        $buttonBorderWidth = isset($attributes['buttonBorderWidth']) ? array_map('sanitize_text_field', $attributes['buttonBorderWidth']) : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $buttonFontWeight = isset($attributes['buttonFontWeight']) ? sanitize_text_field($attributes['buttonFontWeight']) : '';
        $buttonTextColor = isset($attributes['buttonTextColor']) ? sanitize_text_field($attributes['buttonTextColor']) : '';
        $buttonBackgroundColor = isset($attributes['buttonBackgroundColor']) ? sanitize_text_field($attributes['buttonBackgroundColor']) : '';
        $buttonBorderType = isset($attributes['buttonBorderType']) ? sanitize_text_field($attributes['buttonBorderType']) : '';
        $buttonBorderRadius = isset($attributes['buttonBorderRadius']) ? array_map('sanitize_text_field', $attributes['buttonBorderRadius']) : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        
        $buttonHoverTextColor = isset($attributes['buttonHoverTextColor']) ? sanitize_text_field($attributes['buttonHoverTextColor']) : '';
        $buttonHoverBackgroundColor = isset($attributes['buttonHoverBackgroundColor']) ? sanitize_text_field($attributes['buttonHoverBackgroundColor']) : ''; 
        $buttonBorderColor = isset($attributes['buttonBorderColor']) ? sanitize_text_field($attributes['buttonBorderColor']) : '';
        $buttonHoverBorderColor = isset($attributes['buttonHoverBorderColor']) ? sanitize_text_field($attributes['buttonHoverBorderColor']) : '';

        $sliderDots = isset($attributes['sliderDots']) ? sanitize_text_field($attributes['sliderDots']) : '';
        $sliderDotsActive = isset($attributes['sliderDotsActive']) ? sanitize_text_field($attributes['sliderDotsActive']) : '';
        $normalProcessColor = isset($attributes['normalProcessColor']) ? sanitize_text_field($attributes['normalProcessColor']) : '';
        $activeProcessColor = isset($attributes['activeProcessColor']) ? sanitize_text_field($attributes['activeProcessColor']) : '';
        $arrowColor = isset($attributes['arrowColor']) ? sanitize_text_field($attributes['arrowColor']) : '';
        $arrowHoverColor = isset($attributes['arrowHoverColor']) ? sanitize_text_field($attributes['arrowHoverColor']) : '';
        $arrowBgColorr = isset($attributes['arrowBgColorr']) ? sanitize_text_field($attributes['arrowBgColorr']) : '';
        $arrowBgHoverColor = isset($attributes['arrowBgHoverColor']) ? sanitize_text_field($attributes['arrowBgHoverColor']) : '';
        $arrowFontSize = isset($attributes['arrowFontSize']) ? absint($attributes['arrowFontSize']) : '';
        $fractionCurrentColor = isset($attributes['fractionCurrentColor']) ? sanitize_text_field($attributes['fractionCurrentColor']) : '';   
        $fractionFontSize = isset($attributes['fractionFontSize']) ? absint($attributes['fractionFontSize']) : '';
        $arrowHeight = isset($attributes['arrowHeight']) ? absint($attributes['arrowHeight']) : '';
        $arrowWeight = isset($attributes['arrowWeight']) ? absint($attributes['arrowWeight']) : '';
        $bulletHeight = isset($attributes['bulletHeight']) ? absint($attributes['bulletHeight']) : '';
        $bulletWeight = isset($attributes['bulletWeight']) ? absint($attributes['bulletWeight']) : '';
        $arrowBorderRadius = isset($attributes['arrowBorderRadius']) ? array_map('sanitize_text_field', $attributes['arrowBorderRadius']) : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $bulletsRadius = isset($attributes['bulletsRadius']) ? array_map('sanitize_text_field', $attributes['bulletsRadius']) : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        
        //END ATTRIBUTES
        
        $paged = (get_query_var('paged')) ? get_query_var('paged') : 1;

        $query_args = array(
            'post_type'      => 'post',
            'posts_per_page' => $postLimit,
            'paged'          => $paged,
            'orderby'        => $orderBy,
            'category__in'   => $selectedCategories, // fetch only selected categories
            'order'          => 'DESC', // Ensure ordering
        );
        
        if ( ! empty( $selectedCategories ) ) {
            $query_args['category__in'] = $selectedCategories;
        }
        if ( ! empty( $selectedTags ) ) {
            $query_args['tag__in'] = $selectedTags;
        }
        // Include Posts
        $includePosts = isset($attributes['includePosts']) ? $attributes['includePosts'] : '';
        if ( ! empty($includePosts) ) {
            $ids = array_filter(array_map('absint', explode(',', $includePosts)));
            if ( ! empty($ids) ) {
                $query_args['post__in'] = $ids;
            }
        }

        // Exclude Posts
        $excludePosts = isset($attributes['excludePosts']) ? $attributes['excludePosts'] : '';
        if ( ! empty($excludePosts) ) {
            $ids = array_filter(array_map('absint', explode(',', $excludePosts)));
            if ( ! empty($ids) ) {
                $query_args['post__not_in'] = $ids;
            }
        }

        // thumbnailSize
        $thumbnailSize1 = ($sliderLayoutStyle === 'style1' && $thumbnailSize == null)
                  ? 'fancy_post_custom_size' : $thumbnailSize; 
        $thumbnailSize2 = ($sliderLayoutStyle === 'style2' && $thumbnailSize == null)
                  ? 'fancy_post_custom_size' : $thumbnailSize; 
        $thumbnailSize3 = ($sliderLayoutStyle === 'style3' && $thumbnailSize == null)
                  ? 'fancy_post_custom_size' : $thumbnailSize; 
        $thumbnailSize4 = ($sliderLayoutStyle === 'style4' && $thumbnailSize == null)
                  ? 'fancy_post_landscape' : $thumbnailSize; 
        $thumbnailSize5 = ($sliderLayoutStyle === 'style5' && $thumbnailSize == null)
                  ? 'fancy_post_square' : $thumbnailSize; 
        $thumbnailSize6 = ($sliderLayoutStyle === 'style6' && $thumbnailSize == null)
                  ? 'fancy_post_square' : $thumbnailSize; 
        $thumbnailSize7 = ($sliderLayoutStyle === 'style7' && $thumbnailSize == null)
                  ? 'fancy_post_landscape' : $thumbnailSize;

        // thumbnailSize
        $itemBoxAlignment1 = ($sliderLayoutStyle === 'style1' && $itemBoxAlignment == null)
                  ? 'start' : $itemBoxAlignment; 
        $itemBoxAlignment2 = ($sliderLayoutStyle === 'style2' && $itemBoxAlignment == null)
                  ? 'start' : $itemBoxAlignment; 
        $itemBoxAlignment3 = ($sliderLayoutStyle === 'style3' && $itemBoxAlignment == null)
                  ? 'center' : $itemBoxAlignment; 
        $itemBoxAlignment4 = ($sliderLayoutStyle === 'style4' && $itemBoxAlignment == null)
                  ? 'start' : $itemBoxAlignment; 
        $itemBoxAlignment5 = ($sliderLayoutStyle === 'style5' && $itemBoxAlignment == null)
                  ? 'start' : $itemBoxAlignment; 
        $itemBoxAlignment6 = ($sliderLayoutStyle === 'style6' && $itemBoxAlignment == null)
                  ? 'start' : $itemBoxAlignment; 
        $itemBoxAlignment7 = ($sliderLayoutStyle === 'style7' && $itemBoxAlignment == null)
                  ? 'start' : $itemBoxAlignment;           
         
        // buttonStyle
        $buttonStyle1 = ($sliderLayoutStyle === 'style1' && $buttonStyle == null)
                  ? 'fpg-border' : $buttonStyle; 
        $buttonStyle2 = ($sliderLayoutStyle === 'style2' && $buttonStyle == null)
                  ? 'fpg-flat' : $buttonStyle; 
        $buttonStyle3 = ($sliderLayoutStyle === 'style3' && $buttonStyle == null)
                  ? 'fpg-filled' : $buttonStyle; 
        $buttonStyle4 = ($sliderLayoutStyle === 'style4' && $buttonStyle == null)
                  ? 'fpg-flat' : $buttonStyle; 
        $buttonStyle5 = ($sliderLayoutStyle === 'style5' && $buttonStyle == null)
                  ? 'fpg-flat' : $buttonStyle; 
        $buttonStyle6 = ($sliderLayoutStyle === 'style6' && $buttonStyle == null)
                  ? 'fpg-border' : $buttonStyle; 
        $buttonStyle7 = ($sliderLayoutStyle === 'style7' && $buttonStyle == null)
                  ? 'fpg-filled' : $buttonStyle; 
        $targetAttr = ($postLinkTarget === 'newWindow') ? ' target="_blank"' : ' target="_self"';  
        // Run the query
        $query = new WP_Query($query_args);

        if (!$query->have_posts()) {
            return '<p>' . esc_html__('No posts found.', 'fancy-post-grid') . '</p>';
        }
        
        $unique_id = 'swiper_' . uniqid(); // Generate unique ID per Swiper
        $pagination_class = '';

        switch ($sliderLayoutStyle) {
            case 'style1':
            case 'style7':
                $pagination_class = 'swiper-pagination-1';
                break;
            case 'style2':
                $pagination_class = 'swiper-pagination-2';
                break;
            case 'style3':
                $pagination_class = 'swiper-pagination-3';
                break;
            case 'style4':
                $pagination_class = 'swiper-pagination-4';
                break;
            case 'style5':
                $pagination_class = 'swiper-pagination-18';
                break;
            case 'style6':
                $pagination_class = 'swiper-pagination-23';
                break;
        }

        $pagination_selector = '.' . $unique_id . '-' . $pagination_class;                
        // Build swiper config array
        $swiper_config = array(
            'spaceBetween' => $itemGap,
            'slidesPerView' => $gridColumns, // Single slide
            'loop' => $enableLoop,
            'freeMode' => $enableFreeMode,
            'keyboard' => array(
                'enabled' => $enableKeyboard,
            ),
            'pagination' => array(
                'el'        => $pagination_selector,
                'clickable' => $paginationClickable,
                'dynamicBullets' => $enableDynamicBullets,
                'type'      => $paginationType,
            ),
             'navigation' => array(
                'nextEl' => '.' . $unique_id . '-next',
                'prevEl' => '.' . $unique_id . '-prev',
            ),
        );
        // Add autoplay config only if it's enabled
        if ($enableAutoPlay) {
            $swiper_config['autoplay'] = array(
                'delay' => (int)$autoPlaySpeed,
                
            );
        }

        // Convert to JSON
        $swiper_data_attr = esc_attr(wp_json_encode($swiper_config));
        $output = ''; // Initialize the variable first
        $style = '';

            if (!empty($sectionBgColor)) {
                $style .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
            }

            // Margin
            if (!empty($sectionMargin['top']) || !empty($sectionMargin['right']) || !empty($sectionMargin['bottom']) || !empty($sectionMargin['left'])) {
                $style .= 'margin: ' .
                    (isset($sectionMargin['top']) && $sectionMargin['top'] !== '' ? (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) : '0px') . ' ' .
                    (isset($sectionMargin['right']) && $sectionMargin['right'] !== '' ? (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) : '0px') . ' ' .
                    (isset($sectionMargin['bottom']) && $sectionMargin['bottom'] !== '' ? (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) : '0px') . ' ' .
                    (isset($sectionMargin['left']) && $sectionMargin['left'] !== '' ? (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) : '0px') . '; ';
            }

            // Padding
            if (!empty($sectionPadding['top']) || !empty($sectionPadding['right']) || !empty($sectionPadding['bottom']) || !empty($sectionPadding['left'])) {
                $style .= 'padding: ' .
                    (isset($sectionPadding['top']) && $sectionPadding['top'] !== '' ? (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) : '0px') . ' ' .
                    (isset($sectionPadding['right']) && $sectionPadding['right'] !== '' ? (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) : '0px') . ' ' .
                    (isset($sectionPadding['bottom']) && $sectionPadding['bottom'] !== '' ? (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) : '0px') . ' ' .
                    (isset($sectionPadding['left']) && $sectionPadding['left'] !== '' ? (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) : '0px') . '; ';
            }
        if ($sliderLayoutStyle === 'style1'){
            
        $output = '<div class="fpg-blog-layout-1" style="' . trim($style) . '">';
        } else if ($sliderLayoutStyle === 'style2'){
            $output = '<div class="fpg-blog-layout-2" style="' . trim($style) . '">';
        } else if ($sliderLayoutStyle === 'style3'){
            $output = '<div class="fpg-blog-layout-3" style="' . trim($style) . '">';
        } else if ($sliderLayoutStyle === 'style4'){
            $output = '<div class="fpg-blog-layout-4" style="' . trim($style) . '">';
        } else if ($sliderLayoutStyle === 'style5'){
            $output = '<div class="fpg-blog-layout-18" style="' . trim($style) . '">';
        } else if ($sliderLayoutStyle === 'style6'){
            $output = '<div class="fpg-blog-layout-23" style="' . trim($style) . '">';
        } else if ($sliderLayoutStyle === 'style7'){
            $output = '<div class="fpg-blog-layout-28" style="' . trim($style) . '">';
        }
        $output .= '<div class="row">';
        $output .= '<div class="col-lg-12">';
        $output .= '<div class="swiper_wrap">';
      
        $output .= '<div class="swiper ' . esc_attr($unique_id) . '" data-swiper=\'' . $swiper_data_attr . '\'>';

        $output .= '<div class="swiper-wrapper">';

        // Loop through posts and add swiper-slide class
        while ($query->have_posts()) {
            $query->the_post();
            $post_id = get_the_ID();
            $permalink = get_permalink($post_id);
            $title = get_the_title();
            $getdate = get_the_date('M j, Y', $post_id);
            $date = get_the_date();
            $author = get_the_author();
            $categories = get_the_category_list(', ');
            $tags = get_the_tag_list('', ', ');
            $comments_count = get_comments_number();

            $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize, ['class' => 'fancy-post-thumbnail']);
            if ($sliderLayoutStyle === 'style1') {
            $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize1, ['class' => 'fancy-post-thumbnail']);}
            if ($sliderLayoutStyle === 'style2') {
            $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize2, ['class' => 'fancy-post-thumbnail']);}
            if ($sliderLayoutStyle === 'style3') {
            $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize3, ['class' => 'fancy-post-thumbnail']);}
            if ($sliderLayoutStyle === 'style4') {
            $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize4, ['class' => 'fancy-post-thumbnail']);}
            if ($sliderLayoutStyle === 'style5') {
            $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize5, ['class' => 'fancy-post-thumbnail']);}
            if ($sliderLayoutStyle === 'style6') {
            $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize6, ['class' => 'fancy-post-thumbnail']);}
            if ($sliderLayoutStyle === 'style7') {
            $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize7, ['class' => 'fancy-post-thumbnail']);}
            // Title Crop
            if ($titleCropBy === 'word') {
                $titleArray = explode(' ', $title);
                $croppedTitle = implode(' ', array_slice($titleArray, 0, (int) $titleLength));
            } elseif ($titleCropBy === 'cha') {
                $croppedTitle = mb_substr($title, 0, $titleLength);
            } else {
                $croppedTitle = $title; // fallback
            }
            // Fetch full content when 'full_content' is selected
            if ($excerptType === 'full_content') {
                $excerpt = apply_filters('the_content', get_the_content());
            } elseif ($excerptType === 'word') {
                $excerpt = wp_trim_words(get_the_excerpt(), $excerptLimit, $excerptIndicator);
            } else { // 'character'
                $excerpt = mb_substr(get_the_excerpt(), 0, $excerptLimit) . $excerptIndicator;
            }
            if ($sliderLayoutStyle === 'style1') {
                $borderStyles = '.fpg-blog-layout-1 .blog-item .blog-content .blog-btn .read-more.fpg-border::before {'; 
                $borderStyles .= 'background: ' . (!empty($buttonHoverTextColor) ? esc_attr($buttonHoverTextColor) : '#332FFF') . ';';
                $borderStyles .= '}';

                $output .= '<style>' . $borderStyles . '</style>';
                $output .= '<div class="swiper-slide">';
                // Full post layout
                $output .= '<div class="blog-item align-' . $itemBoxAlignment1 . ' ' . $hoverAnimation . ' ' . $postLinkType . '" style="';
                    // MARGIN    
                    if (isset($itemMargin['top']) || isset($itemMargin['right']) || isset($itemMargin['bottom']) || isset($itemMargin['left'])) {
                        $output .= 'margin: ' .
                            (isset($itemMargin['top']) ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' .
                            (isset($itemMargin['right']) ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' .
                            (isset($itemMargin['bottom']) ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' .
                            (isset($itemMargin['left']) ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; ';
                    }

                    // PADDING
                    if (isset($itemPadding['top']) || isset($itemPadding['right']) || isset($itemPadding['bottom']) || isset($itemPadding['left'])) {
                        $output .= 'padding: ' .
                            (isset($itemPadding['top']) ? (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) : '0px') . ' ' .
                            (isset($itemPadding['right']) ? (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) : '0px') . ' ' .
                            (isset($itemPadding['bottom']) ? (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) : '0px') . ' ' .
                            (isset($itemPadding['left']) ? (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) : '0px') . '; ';
                    }

                    // BORDER RADIUS
                    if (isset($itemBorderRadius['top']) || isset($itemBorderRadius['right']) || isset($itemBorderRadius['bottom']) || isset($itemBorderRadius['left'])) {
                        $output .= 'border-radius: ' .
                            (isset($itemBorderRadius['top']) ? (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) : '0px') . ' ' .
                            (isset($itemBorderRadius['right']) ? (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) : '0px') . ' ' .
                            (isset($itemBorderRadius['bottom']) ? (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) : '0px') . ' ' .
                            (isset($itemBorderRadius['left']) ? (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) : '0px') . '; ';
                    }

                    // BORDER WIDTH
                    if (isset($itemBorderWidth['top']) || isset($itemBorderWidth['right']) || isset($itemBorderWidth['bottom']) || isset($itemBorderWidth['left'])) {
                        $output .= 'border-width: ' .
                            (isset($itemBorderWidth['top']) ? (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) : '0px') . ' ' .
                            (isset($itemBorderWidth['right']) ? (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) : '0px') . ' ' .
                            (isset($itemBorderWidth['bottom']) ? (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) : '0px') . ' ' .
                            (isset($itemBorderWidth['left']) ? (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) : '0px') . '; ';
                    }

                    // Border Style & Color
                    if (!empty($itemBorderType)) {
                        $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                    }
                    if (!empty($itemBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                    }

                    // Background Color
                    if (!empty($itemBackgroundColor)) {
                        $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                    }

                    // Box Shadow
                    if (
                        isset($itemBoxShadow['left']) ||  // horizontal offset
                        isset($itemBoxShadow['top']) ||  // vertical offset
                        isset($itemBoxShadow['right']) ||  // blur radius
                        isset($itemBoxShadow['bottom']) ||  // spread radius
                        isset($itemBoxShadowColor)
                    ) {
                        $output .= 'box-shadow: ' .
                            (isset($itemBoxShadow['left']) ? (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) : '0px') . ' ' .
                            (isset($itemBoxShadow['top']) ? (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) : '0px') . ' ' .
                            (isset($itemBoxShadow['right']) ? (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) : '0px') . ' ' .
                            (isset($itemBoxShadow['bottom']) ? (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) : '0px') . ' ' .
                            (!empty($itemBoxShadowColor) ? esc_attr($itemBoxShadowColor) : 'rgba(0,0,0,0.1)') . '; ';
                    }

                $output .= '">';
                // Thumbnail
                if ($thumbnail && $showThumbnail) {
                    $output .= '<div class="image-wrap shape-show" style="';

                    // MARGIN
                    if (
                        isset($thumbnailMargin['top']) ||
                        isset($thumbnailMargin['right']) ||
                        isset($thumbnailMargin['bottom']) ||
                        isset($thumbnailMargin['left'])
                    ) {
                        $output .= 'margin: ' .
                            (isset($thumbnailMargin['top']) ? (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) : '0px') . ' ' .
                            (isset($thumbnailMargin['right']) ? (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) : '0px') . ' ' .
                            (isset($thumbnailMargin['bottom']) ? (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) : '0px') . ' ' .
                            (isset($thumbnailMargin['left']) ? (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) : '0px') . '; ';
                    }

                    // PADDING
                    if (
                        isset($thumbnailPadding['top']) ||
                        isset($thumbnailPadding['right']) ||
                        isset($thumbnailPadding['bottom']) ||
                        isset($thumbnailPadding['left'])
                    ) {
                        $output .= 'padding: ' .
                            (isset($thumbnailPadding['top']) ? (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) : '0px') . ' ' .
                            (isset($thumbnailPadding['right']) ? (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) : '0px') . ' ' .
                            (isset($thumbnailPadding['bottom']) ? (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) : '0px') . ' ' .
                            (isset($thumbnailPadding['left']) ? (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) : '0px') . '; ';
                    }

                    // BORDER RADIUS
                    if (
                        isset($thumbnailBorderRadius['top']) ||
                        isset($thumbnailBorderRadius['right']) ||
                        isset($thumbnailBorderRadius['bottom']) ||
                        isset($thumbnailBorderRadius['left'])
                    ) {
                        $output .= 'border-radius: ' .
                            (isset($thumbnailBorderRadius['top']) ? (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) : '0px') . ' ' .
                            (isset($thumbnailBorderRadius['right']) ? (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) : '0px') . ' ' .
                            (isset($thumbnailBorderRadius['bottom']) ? (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) : '0px') . ' ' .
                            (isset($thumbnailBorderRadius['left']) ? (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) : '0px') . '; ';
                    }

                    $output .= '">';

                    // Anchor with optional border-radius and overflow
                    if ($thumbnailLink) {
                        $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '>';
                        $output .= $thumbnail;
                        $output .= '</a>';
                    } else {
                        $output .= $thumbnail;
                    }
                    $output .= '</div>';
                }
                // END Thumbnail
                
                // MAIN Content
                $output .= '<div class="blog-content" style="';
                    // MARGIN
                    if (
                        isset($contentitemMarginNew['top']) ||
                        isset($contentitemMarginNew['right']) ||
                        isset($contentitemMarginNew['bottom']) ||
                        isset($contentitemMarginNew['left'])
                    ) {
                        $output .= 'margin: ' .
                            (isset($contentitemMarginNew['top']) ? (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) : '0px') . ' ' .
                            (isset($contentitemMarginNew['right']) ? (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) : '0px') . ' ' .
                            (isset($contentitemMarginNew['bottom']) ? (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) : '0px') . ' ' .
                            (isset($contentitemMarginNew['left']) ? (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) : '0px') . '; ';
                    }

                    // PADDING
                    if (
                        isset($contentitemPaddingNew['top']) ||
                        isset($contentitemPaddingNew['right']) ||
                        isset($contentitemPaddingNew['bottom']) ||
                        isset($contentitemPaddingNew['left'])
                    ) {
                        $output .= 'padding: ' .
                            (isset($contentitemPaddingNew['top']) ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' .
                            (isset($contentitemPaddingNew['right']) ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' .
                            (isset($contentitemPaddingNew['bottom']) ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' .
                            (isset($contentitemPaddingNew['left']) ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; ';
                    }

                    // BORDER WIDTH
                    if (
                        isset($contentBorderWidth['top']) ||
                        isset($contentBorderWidth['right']) ||
                        isset($contentBorderWidth['bottom']) ||
                        isset($contentBorderWidth['left'])
                    ) {
                        $output .= 'border-width: ' .
                            (isset($contentBorderWidth['top']) ? (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) : '0px') . ' ' .
                            (isset($contentBorderWidth['right']) ? (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) : '0px') . ' ' .
                            (isset($contentBorderWidth['bottom']) ? (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) : '0px') . ' ' .
                            (isset($contentBorderWidth['left']) ? (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) : '0px') . '; ';
                    }
                    // BORDER radius
                    if (
                        isset($contentitemRadius['top']) ||
                        isset($contentitemRadius['right']) ||
                        isset($contentitemRadius['bottom']) ||
                        isset($contentitemRadius['left'])
                    ) {
                        $output .= 'border-radius: ' .
                            (isset($contentitemRadius['top']) ? (is_numeric($contentitemRadius['top']) ? $contentitemRadius['top'] . 'px' : esc_attr($contentitemRadius['top'])) : '0px') . ' ' .
                            (isset($contentitemRadius['right']) ? (is_numeric($contentitemRadius['right']) ? $contentitemRadius['right'] . 'px' : esc_attr($contentitemRadius['right'])) : '0px') . ' ' .
                            (isset($contentitemRadius['bottom']) ? (is_numeric($contentitemRadius['bottom']) ? $contentitemRadius['bottom'] . 'px' : esc_attr($contentitemRadius['bottom'])) : '0px') . ' ' .
                            (isset($contentitemRadius['left']) ? (is_numeric($contentitemRadius['left']) ? $contentitemRadius['left'] . 'px' : esc_attr($contentitemRadius['left'])) : '0px') . '; ';
                    }
                    // Border Style
                    if (!empty($contentNormalBorderType)) {
                        $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                    }
                    // Background Color
                    if (!empty($contentBgColor)) {
                        $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                    }
                    // Border Color
                    if (!empty($contentBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                    }
                $output .= '">';

                // Meta Data
                if ($showMetaData) {
                    $output .= '<ul class="blog-meta align-' . $metaAlignment . ' " style="';  
                        // MARGIN
                        if (
                            isset($metaMarginNew['top']) ||
                            isset($metaMarginNew['right']) ||
                            isset($metaMarginNew['bottom']) ||
                            isset($metaMarginNew['left'])
                        ) {
                            $output .= 'margin: ' .
                                (isset($metaMarginNew['top']) ? (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) : '0px') . ' ' .
                                (isset($metaMarginNew['right']) ? (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) : '0px') . ' ' .
                                (isset($metaMarginNew['bottom']) ? (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) : '0px') . ' ' .
                                (isset($metaMarginNew['left']) ? (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) : '0px') . '; ';
                        }

                        // PADDING
                        if (
                            isset($metaPadding['top']) ||
                            isset($metaPadding['right']) ||
                            isset($metaPadding['bottom']) ||
                            isset($metaPadding['left'])
                        ) {
                            $output .= 'padding: ' .
                                (isset($metaPadding['top']) ? (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) : '0px') . ' ' .
                                (isset($metaPadding['right']) ? (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) : '0px') . ' ' .
                                (isset($metaPadding['bottom']) ? (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) : '0px') . ' ' .
                                (isset($metaPadding['left']) ? (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) : '0px') . '; ';
                        }
                        
                        // Color
                        if (!empty($metaTextColor)) {
                            $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                        }
                        // Order
                        if (!empty($metaOrder)) {
                            $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                        }
                    $output .= '">';

                    $meta_items = [];

                    // Date
                    if ($showPostDate) {
                        $meta = '<li class="meta-date" style="';

                        // Color
                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        // Font size
                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        // Icon
                        if ($showPostDateIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-calendar-alt" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($getdate) . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Author
                    if ($showPostAuthor) {
                        $meta = '<li class="meta-author" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostAuthorIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-user" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Category
                    if ($showPostCategory) {
                        $meta = '<li class="meta-categories" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostCategoryIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-folder" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        // Get category names without links
                        $categories_list = get_the_category($post_id);
                        if (!empty($categories_list)) {
                            $category_names = array();
                            foreach ($categories_list as $category) {
                                $category_names[] = esc_html($category->name);
                            }
                            $meta .= implode(', ', $category_names); // comma-separated plain text categories
                        }

                        $meta .= '</li>';
                        $meta_items[] = $meta;
                    }
                    // Tags
                    if ($showPostTags && !empty($tags)) {
                        $meta = '<li class="meta-tags" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostTagsIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-tags" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html__('Tags:', 'fancy-post-grid') . ' ' . $tags . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Comment Count
                    if ($showPostCommentsCount) {
                        $meta = '<li class="meta-comment-count" style="';
                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }
                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostCommentsCountIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-comments" style="';
                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }
                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }
                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($comments_count) . ' ' . esc_html__('Comments', 'fancy-post-grid') . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Now join meta items with the separator
                    if (!empty($meta_items)) {
                        $separator = '';

                        if ($metaSeperator !== '') {
                            $separator = '';
                            if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                $separatorStyle = '';
                                if (!empty($separatorColor)) {
                                    $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                }
                                if (!empty($metaFontSize)) {
                                    $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                            }
                        }

                        $output .= implode($separator, $meta_items);
                    }
                    $output .= '</ul>'; // Close meta-data-list               
                }
                // End Meta Data

                // title
                if ($showPostTitle) {
                    $titleStyles = '';

                    // Order
                    if (!empty($titleOrder)) {
                        $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                    }

                    // Background color
                    if (!empty($postTitleBgColor)) {
                        $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                    }

                    // Margin
                    if (isset($postTitleMargin['top']) || isset($postTitleMargin['right']) || isset($postTitleMargin['bottom']) || isset($postTitleMargin['left'])) {
                        $titleStyles .= 'margin: ' .
                            (isset($postTitleMargin['top']) ? (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) : '0px') . ' ' .
                            (isset($postTitleMargin['right']) ? (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) : '0px') . ' ' .
                            (isset($postTitleMargin['bottom']) ? (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) : '0px') . ' ' .
                            (isset($postTitleMargin['left']) ? (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) : '0px') . '; ';
                    }

                    // Padding
                    if (isset($postTitlePadding['top']) || isset($postTitlePadding['right']) || isset($postTitlePadding['bottom']) || isset($postTitlePadding['left'])) {
                        $titleStyles .= 'padding: ' .
                            (isset($postTitlePadding['top']) ? (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) : '0px') . ' ' .
                            (isset($postTitlePadding['right']) ? (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) : '0px') . ' ' .
                            (isset($postTitlePadding['bottom']) ? (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) : '0px') . ' ' .
                            (isset($postTitlePadding['left']) ? (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) : '0px') . '; ';
                    }

                    // Determine if underline should be shown
                    $showUnderline = $postLinkType === 'yeslink' && $titleHoverUnderLine === 'enable';

                    // Class name
                    $classNames = 'blog-title align-' . esc_attr($postTitleAlignment);
                    if ($showUnderline) {
                        $classNames .= ' underline';
                    }

                    // Hover/Out events for nolink
                    $onmouseover = '';
                    $onmouseout  = '';

                    if (!empty($postTitleHoverBgColor)) {
                        $onmouseover .= 'this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';';
                    }

                    if (!empty($postTitleHoverColor)) {
                        $onmouseover .= ' this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                    }

                    if (!empty($postTitleBgColor)) {
                        $onmouseout .= 'this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';';
                    } else {
                        $onmouseout .= 'this.style.removeProperty(\'background-color\');';
                    }

                    if (!empty($postTitleColor)) {
                        $onmouseout .= ' this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                    } else {
                        $onmouseout .= ' this.style.removeProperty(\'color\');';
                    }

                    // Opening title tag
                    $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"'
                        . (!empty($onmouseover) ? ' onmouseover="' . trim($onmouseover) . '"' : '')
                        . (!empty($onmouseout)  ? ' onmouseout="'  . trim($onmouseout)  . '"' : '') . '>';

                    if ($postLinkType === 'yeslink') {
                        // Anchor styles
                        $style = '';
                        $hoverStyle = '';
                        $mouseoutStyle = '';

                        if (!empty($postTitleFontSize)) {
                            $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                        }

                        if (!empty($postTitleLineHeight)) {
                            $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                        }

                        if (!empty($postTitleLetterSpacing)) {
                            $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                        }

                        if (!empty($postTitleFontWeight)) {
                            $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                        }

                        if (!empty($postTitleColor)) {
                            $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                            $mouseoutStyle .= 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                        } else {
                            $mouseoutStyle .= 'this.style.color=\'\';';
                        }

                        if (!empty($postTitleHoverColor)) {
                            $hoverStyle .= 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                        }

                        if ($showUnderline && !empty($postTitleHoverColor)) {
                            $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                            $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                            $hoverStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                        }

                        if ($showUnderline && empty($postTitleColor ) && !empty($postTitleColor )) {
                            $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                            $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                            $mouseoutStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                        } else {
                            
                            $mouseoutStyle .= ' this.style.removeProperty(\'background-position\');';
                            $mouseoutStyle .= ' this.style.removeProperty(\'background-size\');';
                        }

                        $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '
                            style="' . esc_attr(trim($style)) . '"'
                            . (!empty($hoverStyle)   ? ' onmouseover="' . $hoverStyle . '"' : '')
                            . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                            . esc_html($croppedTitle) . '</a>';
                    } else {
                        // No link  render span with inline styles
                        $inlineStyle = '';
                        if (!empty($postTitleFontSize)) {
                            $inlineStyle .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                        }
                        if (!empty($postTitleLineHeight)) {
                            $inlineStyle .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                        }
                        if (!empty($postTitleLetterSpacing)) {
                            $inlineStyle .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                        }
                        if (!empty($postTitleFontWeight)) {
                            $inlineStyle .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                        }
                        if (!empty($postTitleColor)) {
                            $inlineStyle .= 'color: ' . esc_attr($postTitleColor) . '; ';
                        }

                        $output .= '<span style="' . esc_attr(trim($inlineStyle)) . '">' . esc_html($croppedTitle) . '</span>';
                    }

                    $output .= '</' . esc_attr($titleTag) . '>';
                }

                // Excerpt
                if ($showPostExcerpt) {
                    $excerptStyles = '';
                    $excerptColorStyles = '';

                    // Order
                    if (!empty($excerptOrder)) {
                        $excerptStyles .= 'order: ' . esc_attr($excerptOrder) . '; ';
                    }

                    // Typography
                    if (!empty($excerptFontSize)) {
                        $excerptStyles .= 'font-size: ' . esc_attr($excerptFontSize) . 'px; ';
                    }

                    if (!empty($excerptLineHeight)) {
                        $excerptStyles .= 'line-height: ' . esc_attr($excerptLineHeight) . '; ';
                    }

                    if (!empty($excerptLetterSpacing)) {
                        $excerptStyles .= 'letter-spacing: ' . esc_attr($excerptLetterSpacing) . 'px; ';
                    }

                    if (!empty($excerptFontWeight)) {
                        $excerptStyles .= 'font-weight: ' . esc_attr($excerptFontWeight) . '; ';
                    }

                    if (!empty($excerptColor)) {
                        $excerptColorStyles .= 'color: ' . esc_attr($excerptColor) . '; ';
                    }

                    if (!empty($excerptBgColor)) {
                        $excerptColorStyles .= 'background-color: ' . esc_attr($excerptBgColor) . '; ';
                    }

                    if (!empty($excerptBorderType)) {
                        $excerptStyles .= 'border-style: ' . esc_attr($excerptBorderType) . '; ';
                    }

                    // Margin
                    if (isset($excerptMargin['top']) || isset($excerptMargin['right']) || isset($excerptMargin['bottom']) || isset($excerptMargin['left'])) {
                        $excerptStyles .= 'margin: ' .
                            (isset($excerptMargin['top']) ? (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) : '0px') . ' ' .
                            (isset($excerptMargin['right']) ? (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) : '0px') . ' ' .
                            (isset($excerptMargin['bottom']) ? (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) : '0px') . ' ' .
                            (isset($excerptMargin['left']) ? (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) : '0px') . '; ';
                    }

                    // Padding
                    if (isset($excerptPadding['top']) || isset($excerptPadding['right']) || isset($excerptPadding['bottom']) || isset($excerptPadding['left'])) {
                        $excerptStyles .= 'padding: ' .
                            (isset($excerptPadding['top']) ? (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) : '0px') . ' ' .
                            (isset($excerptPadding['right']) ? (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) : '0px') . ' ' .
                            (isset($excerptPadding['bottom']) ? (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) : '0px') . ' ' .
                            (isset($excerptPadding['left']) ? (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) : '0px') . '; ';
                    }

                    // Handle hover logic conditionally
                    $hoverIn = '';
                    $hoverOut = '';

                    if (!empty($excerptHoverColor)) {
                        $hoverIn .= 'this.style.color=\'' . esc_attr($excerptHoverColor) . '\';';
                        $hoverOut .= 'this.style.color=\'' . esc_attr($excerptColor) . '\';';
                    }

                    if (!empty($excerptHoverBgColor)) {
                        $hoverIn .= 'this.style.backgroundColor=\'' . esc_attr($excerptHoverBgColor) . '\';';
                        $hoverOut .= 'this.style.backgroundColor=\'' . esc_attr($excerptBgColor) . '\';';
                    }

                    $output .= '<div class="desc' . ' align-' . esc_attr($excerptAlignment) . '" style="' . esc_attr(trim($excerptStyles)) . '"';

                    $output .= '>';
                    $output .= '<p style="' . esc_attr(trim($excerptColorStyles)) . '"';

                        if (!empty($hoverIn) || !empty($hoverOut)) {
                            if (!empty($hoverIn)) {
                                $output .= ' onmouseover="' . esc_attr($hoverIn) . '"';
                            }
                            if (!empty($hoverOut)) {
                                $output .= ' onmouseout="' . esc_attr($hoverOut) . '"';
                            }
                        }

                        $output .= '>' . esc_html($excerpt) . '</p>';
                    $output .= '</div>';
                }
                // End Excerpt

                // Button Output                
                if ($showReadMoreButton) {
                    // Button wrapper styles
                    $buttonWrapperStyle = '';

                    if (
                        isset($buttonMarginNew['top']) || 
                        isset($buttonMarginNew['right']) || 
                        isset($buttonMarginNew['bottom']) || 
                        isset($buttonMarginNew['left'])
                    ) {
                        $buttonWrapperStyle .= 'margin: ' .
                            (isset($buttonMarginNew['top']) ? (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) : '0px') . ' ' .
                            (isset($buttonMarginNew['right']) ? (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) : '0px') . ' ' .
                            (isset($buttonMarginNew['bottom']) ? (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) : '0px') . ' ' .
                            (isset($buttonMarginNew['left']) ? (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) : '0px') . '; ';
                    }

                    // Order
                    if (!empty($buttonOrder)) {
                        $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                    }
                   
                    $output .= '<div class="blog-btn align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';

                    // Button inline styles
                    $buttonInlineStyles = '';

                    if (!empty($buttonTextColor)) {
                        $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                    }
                    if (!empty($buttonBackgroundColor)) {
                        $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                    }
                    if (!empty($buttonFontSize)) {
                        $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                    }
                    if (!empty($buttonFontWeight)) {
                        $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                    }
                    if (!empty($buttonBorderColor)) {
                        $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                    }
                    if (!empty($buttonBorderType)) {
                        $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                    }

                    // Border Width
                    if (
                        isset($buttonBorderWidth['top']) || 
                        isset($buttonBorderWidth['right']) || 
                        isset($buttonBorderWidth['bottom']) || 
                        isset($buttonBorderWidth['left'])
                    ) {
                        $buttonInlineStyles .= 'border-width: ' .
                            (isset($buttonBorderWidth['top']) ? (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) : '0px') . ' ' .
                            (isset($buttonBorderWidth['right']) ? (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) : '0px') . ' ' .
                            (isset($buttonBorderWidth['bottom']) ? (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) : '0px') . ' ' .
                            (isset($buttonBorderWidth['left']) ? (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) : '0px') . '; ';
                    }

                    // Border Radius
                    if (
                        isset($buttonBorderRadius['top']) || 
                        isset($buttonBorderRadius['right']) || 
                        isset($buttonBorderRadius['bottom']) || 
                        isset($buttonBorderRadius['left'])
                    ) {
                        $buttonInlineStyles .= 'border-radius: ' .
                            (isset($buttonBorderRadius['top']) ? (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) : '0px') . ' ' .
                            (isset($buttonBorderRadius['right']) ? (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) : '0px') . ' ' .
                            (isset($buttonBorderRadius['bottom']) ? (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) : '0px') . ' ' .
                            (isset($buttonBorderRadius['left']) ? (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) : '0px') . '; ';
                    }

                    // Padding
                    if (
                        isset($buttonPaddingNew['top']) || 
                        isset($buttonPaddingNew['right']) || 
                        isset($buttonPaddingNew['bottom']) || 
                        isset($buttonPaddingNew['left'])
                    ) {
                        $buttonInlineStyles .= 'padding: ' .
                            (isset($buttonPaddingNew['top']) ? (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) : '0px') . ' ' .
                            (isset($buttonPaddingNew['right']) ? (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) : '0px') . ' ' .
                            (isset($buttonPaddingNew['bottom']) ? (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) : '0px') . ' ' .
                            (isset($buttonPaddingNew['left']) ? (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) : '0px') . '; ';
                    } 

                    // Hover styles
                    $buttonHoverInlineStyles = '';
                    $buttonResetStyles = '';

                    if (!empty($buttonHoverTextColor)) {
                        $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                        $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                    }
                    if (!empty($buttonHoverBorderColor)) {
                        $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                        $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                    }
                    if (!empty($buttonHoverBackgroundColor)) {
                        $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                        $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                    }

                    // Button anchor tag
                    $output .= '<a class="fpg-link read-more ' . esc_attr($buttonStyle1) . '" href="' . esc_url(get_permalink()) . '" ' . $targetAttr . ' style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                    if (!empty($buttonHoverInlineStyles)) {
                        $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                    }

                    if (!empty($buttonResetStyles)) {
                        $output .= ' onmouseout="' . $buttonResetStyles . '"';
                    }

                    $output .= '>';

                    // Icon handling
                    $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                        $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                        $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                    if ($iconPosition === 'left' && $showButtonIcon) {
                        $output .= $leftIcon . ' ';
                    }

                    $output .= esc_html($readMoreLabel);

                    if ($iconPosition === 'right' && $showButtonIcon) {
                        $output .= ' ' . $rightIcon;
                    }

                    $output .= '</a></div>';
                }
                // End Button

                $output .= '</div>';
                // End MAIN Content
                $output .= '</div>';
                // End Full post layout
                $output .= '</div>';
            }
            elseif ($sliderLayoutStyle === 'style2') {
                $borderStyles = '.fpg-blog-layout-2 .blog-item .blog-content .blog-btn .read-more.fpg-border::before {'; 
                $borderStyles .= 'background: ' . (!empty($buttonHoverTextColor) ? esc_attr($buttonHoverTextColor) : '#332FFF') . ';';
                $borderStyles .= '}';

                $output .= '<style>' . $borderStyles . '</style>';
                $output .= '<div class="swiper-slide">';
                // Full post layout
                $output .= '<div class="blog-item align-' . $itemBoxAlignment2 . ' ' . $hoverAnimation . ' ' . $postLinkType . '" style="';
                    // MARGIN    
                    if (isset($itemMargin['top']) || isset($itemMargin['right']) || isset($itemMargin['bottom']) || isset($itemMargin['left'])) {
                        $output .= 'margin: ' .
                            (isset($itemMargin['top']) ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' .
                            (isset($itemMargin['right']) ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' .
                            (isset($itemMargin['bottom']) ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' .
                            (isset($itemMargin['left']) ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; ';
                    }

                    // PADDING
                    if (isset($itemPadding['top']) || isset($itemPadding['right']) || isset($itemPadding['bottom']) || isset($itemPadding['left'])) {
                        $output .= 'padding: ' .
                            (isset($itemPadding['top']) ? (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) : '0px') . ' ' .
                            (isset($itemPadding['right']) ? (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) : '0px') . ' ' .
                            (isset($itemPadding['bottom']) ? (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) : '0px') . ' ' .
                            (isset($itemPadding['left']) ? (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) : '0px') . '; ';
                    }

                    // BORDER RADIUS
                    if (isset($itemBorderRadius['top']) || isset($itemBorderRadius['right']) || isset($itemBorderRadius['bottom']) || isset($itemBorderRadius['left'])) {
                        $output .= 'border-radius: ' .
                            (isset($itemBorderRadius['top']) ? (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) : '0px') . ' ' .
                            (isset($itemBorderRadius['right']) ? (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) : '0px') . ' ' .
                            (isset($itemBorderRadius['bottom']) ? (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) : '0px') . ' ' .
                            (isset($itemBorderRadius['left']) ? (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) : '0px') . '; ';
                    }

                    // BORDER WIDTH
                    if (isset($itemBorderWidth['top']) || isset($itemBorderWidth['right']) || isset($itemBorderWidth['bottom']) || isset($itemBorderWidth['left'])) {
                        $output .= 'border-width: ' .
                            (isset($itemBorderWidth['top']) ? (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) : '0px') . ' ' .
                            (isset($itemBorderWidth['right']) ? (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) : '0px') . ' ' .
                            (isset($itemBorderWidth['bottom']) ? (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) : '0px') . ' ' .
                            (isset($itemBorderWidth['left']) ? (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) : '0px') . '; ';
                    }

                    // Border Style & Color
                    if (!empty($itemBorderType)) {
                        $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                    }
                    if (!empty($itemBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                    }

                    // Background Color
                    if (!empty($itemBackgroundColor)) {
                        $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                    }

                    // Box Shadow
                    if (
                        isset($itemBoxShadow['left']) ||  // horizontal offset
                        isset($itemBoxShadow['top']) ||  // vertical offset
                        isset($itemBoxShadow['right']) ||  // blur radius
                        isset($itemBoxShadow['bottom']) ||  // spread radius
                        isset($itemBoxShadowColor)
                    ) {
                        $output .= 'box-shadow: ' .
                            (isset($itemBoxShadow['left']) ? (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) : '0px') . ' ' .
                            (isset($itemBoxShadow['top']) ? (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) : '0px') . ' ' .
                            (isset($itemBoxShadow['right']) ? (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) : '0px') . ' ' .
                            (isset($itemBoxShadow['bottom']) ? (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) : '0px') . ' ' .
                            (!empty($itemBoxShadowColor) ? esc_attr($itemBoxShadowColor) : 'rgba(0,0,0,0.1)') . '; ';
                    }

                $output .= '">';
                // Thumbnail
                if ($thumbnail && $showThumbnail) {
                    $output .= '<div class="image-wrap shape-show" style="';

                    // MARGIN
                    if (
                        isset($thumbnailMargin['top']) ||
                        isset($thumbnailMargin['right']) ||
                        isset($thumbnailMargin['bottom']) ||
                        isset($thumbnailMargin['left'])
                    ) {
                        $output .= 'margin: ' .
                            (isset($thumbnailMargin['top']) ? (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) : '0px') . ' ' .
                            (isset($thumbnailMargin['right']) ? (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) : '0px') . ' ' .
                            (isset($thumbnailMargin['bottom']) ? (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) : '0px') . ' ' .
                            (isset($thumbnailMargin['left']) ? (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) : '0px') . '; ';
                    }

                    // PADDING
                    if (
                        isset($thumbnailPadding['top']) ||
                        isset($thumbnailPadding['right']) ||
                        isset($thumbnailPadding['bottom']) ||
                        isset($thumbnailPadding['left'])
                    ) {
                        $output .= 'padding: ' .
                            (isset($thumbnailPadding['top']) ? (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) : '0px') . ' ' .
                            (isset($thumbnailPadding['right']) ? (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) : '0px') . ' ' .
                            (isset($thumbnailPadding['bottom']) ? (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) : '0px') . ' ' .
                            (isset($thumbnailPadding['left']) ? (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) : '0px') . '; ';
                    }

                    // BORDER RADIUS
                    if (
                        isset($thumbnailBorderRadius['top']) ||
                        isset($thumbnailBorderRadius['right']) ||
                        isset($thumbnailBorderRadius['bottom']) ||
                        isset($thumbnailBorderRadius['left'])
                    ) {
                        $output .= 'border-radius: ' .
                            (isset($thumbnailBorderRadius['top']) ? (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) : '0px') . ' ' .
                            (isset($thumbnailBorderRadius['right']) ? (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) : '0px') . ' ' .
                            (isset($thumbnailBorderRadius['bottom']) ? (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) : '0px') . ' ' .
                            (isset($thumbnailBorderRadius['left']) ? (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) : '0px') . '; ';
                    }

                    $output .= '">';

                    // Anchor with optional border-radius and overflow
                    if ($thumbnailLink) {
                        $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '>';
                        $output .= $thumbnail;
                        $output .= '</a>';
                    } else {
                        $output .= $thumbnail;
                    }
                    $output .= '</div>';
                }
                // END Thumbnail
                
                // MAIN Content
                $output .= '<div class="blog-content" style="';
                    // MARGIN
                    if (
                        isset($contentitemMarginNew['top']) ||
                        isset($contentitemMarginNew['right']) ||
                        isset($contentitemMarginNew['bottom']) ||
                        isset($contentitemMarginNew['left'])
                    ) {
                        $output .= 'margin: ' .
                            (isset($contentitemMarginNew['top']) ? (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) : '0px') . ' ' .
                            (isset($contentitemMarginNew['right']) ? (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) : '0px') . ' ' .
                            (isset($contentitemMarginNew['bottom']) ? (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) : '0px') . ' ' .
                            (isset($contentitemMarginNew['left']) ? (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) : '0px') . '; ';
                    }

                    // PADDING
                    if (
                        isset($contentitemPaddingNew['top']) ||
                        isset($contentitemPaddingNew['right']) ||
                        isset($contentitemPaddingNew['bottom']) ||
                        isset($contentitemPaddingNew['left'])
                    ) {
                        $output .= 'padding: ' .
                            (isset($contentitemPaddingNew['top']) ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' .
                            (isset($contentitemPaddingNew['right']) ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' .
                            (isset($contentitemPaddingNew['bottom']) ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' .
                            (isset($contentitemPaddingNew['left']) ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; ';
                    }

                    // BORDER WIDTH
                    if (
                        isset($contentBorderWidth['top']) ||
                        isset($contentBorderWidth['right']) ||
                        isset($contentBorderWidth['bottom']) ||
                        isset($contentBorderWidth['left'])
                    ) {
                        $output .= 'border-width: ' .
                            (isset($contentBorderWidth['top']) ? (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) : '0px') . ' ' .
                            (isset($contentBorderWidth['right']) ? (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) : '0px') . ' ' .
                            (isset($contentBorderWidth['bottom']) ? (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) : '0px') . ' ' .
                            (isset($contentBorderWidth['left']) ? (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) : '0px') . '; ';
                    }
                    // BORDER radius
                    if (
                        isset($contentitemRadius['top']) ||
                        isset($contentitemRadius['right']) ||
                        isset($contentitemRadius['bottom']) ||
                        isset($contentitemRadius['left'])
                    ) {
                        $output .= 'border-radius: ' .
                            (isset($contentitemRadius['top']) ? (is_numeric($contentitemRadius['top']) ? $contentitemRadius['top'] . 'px' : esc_attr($contentitemRadius['top'])) : '0px') . ' ' .
                            (isset($contentitemRadius['right']) ? (is_numeric($contentitemRadius['right']) ? $contentitemRadius['right'] . 'px' : esc_attr($contentitemRadius['right'])) : '0px') . ' ' .
                            (isset($contentitemRadius['bottom']) ? (is_numeric($contentitemRadius['bottom']) ? $contentitemRadius['bottom'] . 'px' : esc_attr($contentitemRadius['bottom'])) : '0px') . ' ' .
                            (isset($contentitemRadius['left']) ? (is_numeric($contentitemRadius['left']) ? $contentitemRadius['left'] . 'px' : esc_attr($contentitemRadius['left'])) : '0px') . '; ';
                    }
                    // Border Style
                    if (!empty($contentNormalBorderType)) {
                        $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                    }
                    // Background Color
                    if (!empty($contentBgColor)) {
                        $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                    }
                    // Border Color
                    if (!empty($contentBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                    }
                $output .= '">';
                // Meta Data
                if ($showMetaData) {
                    $output .= '<ul class="blog-meta align-' . $metaAlignment . ' " style="';  
                        // MARGIN
                        if (
                            isset($metaMarginNew['top']) ||
                            isset($metaMarginNew['right']) ||
                            isset($metaMarginNew['bottom']) ||
                            isset($metaMarginNew['left'])
                        ) {
                            $output .= 'margin: ' .
                                (isset($metaMarginNew['top']) ? (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) : '0px') . ' ' .
                                (isset($metaMarginNew['right']) ? (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) : '0px') . ' ' .
                                (isset($metaMarginNew['bottom']) ? (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) : '0px') . ' ' .
                                (isset($metaMarginNew['left']) ? (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) : '0px') . '; ';
                        }

                        // PADDING
                        if (
                            isset($metaPadding['top']) ||
                            isset($metaPadding['right']) ||
                            isset($metaPadding['bottom']) ||
                            isset($metaPadding['left'])
                        ) {
                            $output .= 'padding: ' .
                                (isset($metaPadding['top']) ? (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) : '0px') . ' ' .
                                (isset($metaPadding['right']) ? (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) : '0px') . ' ' .
                                (isset($metaPadding['bottom']) ? (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) : '0px') . ' ' .
                                (isset($metaPadding['left']) ? (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) : '0px') . '; ';
                        } 
                        
                        // Color
                        if (!empty($metaTextColor)) {
                            $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                        }
                        // Order
                        if (!empty($metaOrder)) {
                            $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                        }
                    $output .= '">';

                    $meta_items = [];

                    // Date
                    if ($showPostDate) {
                        $meta = '<li class="meta-date" style="';

                        // Color
                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        // Font size
                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        // Icon
                        if ($showPostDateIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-calendar-alt" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($getdate) . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Author
                    if ($showPostAuthor) {
                        $meta = '<li class="meta-author" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostAuthorIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-user" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Category
                    if ($showPostCategory) {
                        $meta = '<li class="meta-categories" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostCategoryIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-folder" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        // Get category names without links
                        $categories_list = get_the_category($post_id);
                        if (!empty($categories_list)) {
                            $category_names = array();
                            foreach ($categories_list as $category) {
                                $category_names[] = esc_html($category->name);
                            }
                            $meta .= implode(', ', $category_names); // comma-separated plain text categories
                        }

                        $meta .= '</li>';
                        $meta_items[] = $meta;
                    }
                    // Tags
                    if ($showPostTags && !empty($tags)) {
                        $meta = '<li class="meta-tags" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostTagsIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-tags" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html__('Tags:', 'fancy-post-grid') . ' ' . $tags . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Comment Count
                    if ($showPostCommentsCount) {
                        $meta = '<li class="meta-comment-count" style="';
                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }
                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostCommentsCountIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-comments" style="';
                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }
                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }
                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($comments_count) . ' ' . esc_html__('Comments', 'fancy-post-grid') . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Now join meta items with the separator
                    if (!empty($meta_items)) {
                        $separator = '';

                        if ($metaSeperator !== '') {
                            $separator = '';
                            if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                $separatorStyle = '';
                                if (!empty($separatorColor)) {
                                    $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                }
                                if (!empty($metaFontSize)) {
                                    $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                            }
                        }

                        $output .= implode($separator, $meta_items);
                    }
                    $output .= '</ul>'; // Close meta-data-list               
                }
                // End Meta Data

                // title
                if ($showPostTitle) {
                    $titleStyles = '';

                    // Order
                    if (!empty($titleOrder)) {
                        $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                    }

                    // Background color
                    if (!empty($postTitleBgColor)) {
                        $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                    }

                    // Margin
                    if (isset($postTitleMargin['top']) || isset($postTitleMargin['right']) || isset($postTitleMargin['bottom']) || isset($postTitleMargin['left'])) {
                        $titleStyles .= 'margin: ' .
                            (isset($postTitleMargin['top']) ? (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) : '0px') . ' ' .
                            (isset($postTitleMargin['right']) ? (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) : '0px') . ' ' .
                            (isset($postTitleMargin['bottom']) ? (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) : '0px') . ' ' .
                            (isset($postTitleMargin['left']) ? (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) : '0px') . '; ';
                    }

                    // Padding
                    if (isset($postTitlePadding['top']) || isset($postTitlePadding['right']) || isset($postTitlePadding['bottom']) || isset($postTitlePadding['left'])) {
                        $titleStyles .= 'padding: ' .
                            (isset($postTitlePadding['top']) ? (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) : '0px') . ' ' .
                            (isset($postTitlePadding['right']) ? (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) : '0px') . ' ' .
                            (isset($postTitlePadding['bottom']) ? (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) : '0px') . ' ' .
                            (isset($postTitlePadding['left']) ? (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) : '0px') . '; ';
                    }

                    // Determine if underline should be shown
                    $showUnderline = $postLinkType === 'yeslink' && $titleHoverUnderLine === 'enable';

                    // Class name
                    $classNames = 'blog-title align-' . esc_attr($postTitleAlignment);
                    if ($showUnderline) {
                        $classNames .= ' underline';
                    }

                    // Hover/Out events for nolink
                    $onmouseover = '';
                    $onmouseout  = '';

                    if (!empty($postTitleHoverBgColor)) {
                        $onmouseover .= 'this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';';
                    }

                    if (!empty($postTitleHoverColor)) {
                        $onmouseover .= ' this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                    }

                    if (!empty($postTitleBgColor)) {
                        $onmouseout .= 'this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';';
                    } else {
                        $onmouseout .= 'this.style.removeProperty(\'background-color\');';
                    }

                    if (!empty($postTitleColor)) {
                        $onmouseout .= ' this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                    } else {
                        $onmouseout .= ' this.style.removeProperty(\'color\');';
                    }

                    // Opening title tag
                    $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"'
                        . (!empty($onmouseover) ? ' onmouseover="' . trim($onmouseover) . '"' : '')
                        . (!empty($onmouseout)  ? ' onmouseout="'  . trim($onmouseout)  . '"' : '') . '>';

                    if ($postLinkType === 'yeslink') {
                        // Anchor styles
                        $style = '';
                        $hoverStyle = '';
                        $mouseoutStyle = '';

                        if (!empty($postTitleFontSize)) {
                            $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                        }

                        if (!empty($postTitleLineHeight)) {
                            $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                        }

                        if (!empty($postTitleLetterSpacing)) {
                            $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                        }

                        if (!empty($postTitleFontWeight)) {
                            $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                        }

                        if (!empty($postTitleColor)) {
                            $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                            $mouseoutStyle .= 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                        } else {
                            $mouseoutStyle .= 'this.style.color=\'\';';
                        }

                        if (!empty($postTitleHoverColor)) {
                            $hoverStyle .= 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                        }

                        if ($showUnderline && !empty($postTitleHoverColor)) {
                            $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                            $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                            $hoverStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                        }

                        if ($showUnderline && empty($postTitleColor ) && !empty($postTitleColor )) {
                            $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                            $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                            $mouseoutStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                        } else {
                            
                            $mouseoutStyle .= ' this.style.removeProperty(\'background-position\');';
                            $mouseoutStyle .= ' this.style.removeProperty(\'background-size\');';
                        }

                        $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '
                            style="' . esc_attr(trim($style)) . '"'
                            . (!empty($hoverStyle)   ? ' onmouseover="' . $hoverStyle . '"' : '')
                            . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                            . esc_html($croppedTitle) . '</a>';
                    } else {
                        // No link  render span with inline styles
                        $inlineStyle = '';
                        if (!empty($postTitleFontSize)) {
                            $inlineStyle .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                        }
                        if (!empty($postTitleLineHeight)) {
                            $inlineStyle .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                        }
                        if (!empty($postTitleLetterSpacing)) {
                            $inlineStyle .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                        }
                        if (!empty($postTitleFontWeight)) {
                            $inlineStyle .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                        }
                        if (!empty($postTitleColor)) {
                            $inlineStyle .= 'color: ' . esc_attr($postTitleColor) . '; ';
                        }

                        $output .= '<span style="' . esc_attr(trim($inlineStyle)) . '">' . esc_html($croppedTitle) . '</span>';
                    }

                    $output .= '</' . esc_attr($titleTag) . '>';
                }

                if ($showPostExcerpt) {
                    $excerptStyles = '';
                    $excerptColorStyles = '';

                    // Order
                    if (!empty($excerptOrder)) {
                        $excerptStyles .= 'order: ' . esc_attr($excerptOrder) . '; ';
                    }

                    // Typography
                    if (!empty($excerptFontSize)) {
                        $excerptStyles .= 'font-size: ' . esc_attr($excerptFontSize) . 'px; ';
                    }

                    if (!empty($excerptLineHeight)) {
                        $excerptStyles .= 'line-height: ' . esc_attr($excerptLineHeight) . '; ';
                    }

                    if (!empty($excerptLetterSpacing)) {
                        $excerptStyles .= 'letter-spacing: ' . esc_attr($excerptLetterSpacing) . 'px; ';
                    }

                    if (!empty($excerptFontWeight)) {
                        $excerptStyles .= 'font-weight: ' . esc_attr($excerptFontWeight) . '; ';
                    }

                    if (!empty($excerptColor)) {
                        $excerptColorStyles .= 'color: ' . esc_attr($excerptColor) . '; ';
                    }

                    if (!empty($excerptBgColor)) {
                        $excerptColorStyles .= 'background-color: ' . esc_attr($excerptBgColor) . '; ';
                    }

                    if (!empty($excerptBorderType)) {
                        $excerptStyles .= 'border-style: ' . esc_attr($excerptBorderType) . '; ';
                    }

                    // Margin
                    if (isset($excerptMargin['top']) || isset($excerptMargin['right']) || isset($excerptMargin['bottom']) || isset($excerptMargin['left'])) {
                        $excerptStyles .= 'margin: ' .
                            (isset($excerptMargin['top']) ? (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) : '0px') . ' ' .
                            (isset($excerptMargin['right']) ? (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) : '0px') . ' ' .
                            (isset($excerptMargin['bottom']) ? (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) : '0px') . ' ' .
                            (isset($excerptMargin['left']) ? (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) : '0px') . '; ';
                    }

                    // Padding
                    if (isset($excerptPadding['top']) || isset($excerptPadding['right']) || isset($excerptPadding['bottom']) || isset($excerptPadding['left'])) {
                        $excerptStyles .= 'padding: ' .
                            (isset($excerptPadding['top']) ? (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) : '0px') . ' ' .
                            (isset($excerptPadding['right']) ? (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) : '0px') . ' ' .
                            (isset($excerptPadding['bottom']) ? (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) : '0px') . ' ' .
                            (isset($excerptPadding['left']) ? (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) : '0px') . '; ';
                    }

                    // Handle hover logic conditionally
                    $hoverIn = '';
                    $hoverOut = '';

                    if (!empty($excerptHoverColor)) {
                        $hoverIn .= 'this.style.color=\'' . esc_attr($excerptHoverColor) . '\';';
                        $hoverOut .= 'this.style.color=\'' . esc_attr($excerptColor) . '\';';
                    }

                    if (!empty($excerptHoverBgColor)) {
                        $hoverIn .= 'this.style.backgroundColor=\'' . esc_attr($excerptHoverBgColor) . '\';';
                        $hoverOut .= 'this.style.backgroundColor=\'' . esc_attr($excerptBgColor) . '\';';
                    }

                    $output .= '<div class="desc' . ' align-' . esc_attr($excerptAlignment) . '" style="' . esc_attr(trim($excerptStyles)) . '"';

                    $output .= '>';
                    $output .= '<p style="' . esc_attr(trim($excerptColorStyles)) . '"';

                        if (!empty($hoverIn) || !empty($hoverOut)) {
                            if (!empty($hoverIn)) {
                                $output .= ' onmouseover="' . esc_attr($hoverIn) . '"';
                            }
                            if (!empty($hoverOut)) {
                                $output .= ' onmouseout="' . esc_attr($hoverOut) . '"';
                            }
                        }

                        $output .= '>' . esc_html($excerpt) . '</p>';
                    $output .= '</div>';
                }

                // Button Output                
                if ($showReadMoreButton) {
                    // Button wrapper styles
                    $buttonWrapperStyle = '';

                    // Margin
                    if (
                        isset($buttonMarginNew['top']) || 
                        isset($buttonMarginNew['right']) || 
                        isset($buttonMarginNew['bottom']) || 
                        isset($buttonMarginNew['left'])
                    ) {
                        $buttonWrapperStyle .= 'margin: ' .
                            (isset($buttonMarginNew['top']) ? (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) : '0px') . ' ' .
                            (isset($buttonMarginNew['right']) ? (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) : '0px') . ' ' .
                            (isset($buttonMarginNew['bottom']) ? (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) : '0px') . ' ' .
                            (isset($buttonMarginNew['left']) ? (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) : '0px') . '; ';
                    }
                    // Order
                    if (!empty($buttonOrder)) {
                        $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                    }
                   
                    $output .= '<div class="blog-btn align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';

                    // Button inline styles
                    $buttonInlineStyles = '';

                    if (!empty($buttonTextColor)) {
                        $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                    }
                    if (!empty($buttonBackgroundColor)) {
                        $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                    }
                    if (!empty($buttonFontSize)) {
                        $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                    }
                    if (!empty($buttonFontWeight)) {
                        $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                    }
                    if (!empty($buttonBorderColor)) {
                        $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                    }
                    if (!empty($buttonBorderType)) {
                        $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                    }

                    // Border Width
                    if (
                        isset($buttonBorderWidth['top']) || 
                        isset($buttonBorderWidth['right']) || 
                        isset($buttonBorderWidth['bottom']) || 
                        isset($buttonBorderWidth['left'])
                    ) {
                        $buttonInlineStyles .= 'border-width: ' .
                            (isset($buttonBorderWidth['top']) ? (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) : '0px') . ' ' .
                            (isset($buttonBorderWidth['right']) ? (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) : '0px') . ' ' .
                            (isset($buttonBorderWidth['bottom']) ? (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) : '0px') . ' ' .
                            (isset($buttonBorderWidth['left']) ? (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) : '0px') . '; ';
                    }

                    // Border Radius
                    if (
                        isset($buttonBorderRadius['top']) || 
                        isset($buttonBorderRadius['right']) || 
                        isset($buttonBorderRadius['bottom']) || 
                        isset($buttonBorderRadius['left'])
                    ) {
                        $buttonInlineStyles .= 'border-radius: ' .
                            (isset($buttonBorderRadius['top']) ? (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) : '0px') . ' ' .
                            (isset($buttonBorderRadius['right']) ? (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) : '0px') . ' ' .
                            (isset($buttonBorderRadius['bottom']) ? (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) : '0px') . ' ' .
                            (isset($buttonBorderRadius['left']) ? (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) : '0px') . '; ';
                    }

                    // Padding
                    if (
                        isset($buttonPaddingNew['top']) || 
                        isset($buttonPaddingNew['right']) || 
                        isset($buttonPaddingNew['bottom']) || 
                        isset($buttonPaddingNew['left'])
                    ) {
                        $buttonInlineStyles .= 'padding: ' .
                            (isset($buttonPaddingNew['top']) ? (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) : '0px') . ' ' .
                            (isset($buttonPaddingNew['right']) ? (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) : '0px') . ' ' .
                            (isset($buttonPaddingNew['bottom']) ? (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) : '0px') . ' ' .
                            (isset($buttonPaddingNew['left']) ? (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) : '0px') . '; ';
                    } 

                    // Hover styles
                    $buttonHoverInlineStyles = '';
                    $buttonResetStyles = '';

                    if (!empty($buttonHoverTextColor)) {
                        $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                        $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                    }
                    if (!empty($buttonHoverBorderColor)) {
                        $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                        $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                    }
                    if (!empty($buttonHoverBackgroundColor)) {
                        $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                        $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                    }

                    // Button anchor tag
                    $output .= '<a class="fpg-link read-more ' . esc_attr($buttonStyle2) . '" href="' . esc_url(get_permalink()) . '" ' . $targetAttr . ' style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                    if (!empty($buttonHoverInlineStyles)) {
                        $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                    }

                    if (!empty($buttonResetStyles)) {
                        $output .= ' onmouseout="' . $buttonResetStyles . '"';
                    }

                    $output .= '>';

                    // Icon handling
                    $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                        $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                        $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                    if ($iconPosition === 'left' && $showButtonIcon) {
                        $output .= $leftIcon . ' ';
                    }

                    $output .= esc_html($readMoreLabel);

                    if ($iconPosition === 'right' && $showButtonIcon) {
                        $output .= ' ' . $rightIcon;
                    }

                    $output .= '</a></div>';
                }
                // End Button

                $output .= '</div>';
                // End MAIN Content
                $output .= '</div>';
                // End Full post layout
                $output .= '</div>';
            }
            elseif ($sliderLayoutStyle === 'style3') {
                $borderStyles = '.fpg-blog-layout-3 .fpg-blog__single .content .fpg-blog-author .fpg-link a.fpg-border::before {'; 
                $borderStyles .= 'background: ' . (!empty($buttonHoverTextColor) ? esc_attr($buttonHoverTextColor) : '#332FFF') . ';';
                $borderStyles .= '}';

                $output .= '<style>' . $borderStyles . '</style>';
                $afterMetaStyles = '.fpg-blog-layout-3 .fpg-blog__single .content .fpg-blog-category a .icon svg path {';
                    
                $afterMetaStyles .= 'fill: ' . (!empty($metaTextColor) ? esc_attr($metaTextColor) : '#513de8') . ';';
                $afterMetaStyles .= '}';
                $output .= '<style>' . $afterMetaStyles . '</style>';
                $output .= '<div class="swiper-slide">';
                // Full post layout
                $output .= '<div class="fpg-blog__single align-' . $itemBoxAlignment3 . ' ' . $hoverAnimation . ' ' . $postLinkType . '" style="';
                    // MARGIN    
                    if (isset($itemMargin['top']) || isset($itemMargin['right']) || isset($itemMargin['bottom']) || isset($itemMargin['left'])) {
                        $output .= 'margin: ' .
                            (isset($itemMargin['top']) ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' .
                            (isset($itemMargin['right']) ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' .
                            (isset($itemMargin['bottom']) ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' .
                            (isset($itemMargin['left']) ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; ';
                    }

                    // PADDING
                    if (isset($itemPadding['top']) || isset($itemPadding['right']) || isset($itemPadding['bottom']) || isset($itemPadding['left'])) {
                        $output .= 'padding: ' .
                            (isset($itemPadding['top']) ? (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) : '0px') . ' ' .
                            (isset($itemPadding['right']) ? (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) : '0px') . ' ' .
                            (isset($itemPadding['bottom']) ? (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) : '0px') . ' ' .
                            (isset($itemPadding['left']) ? (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) : '0px') . '; ';
                    }

                    // BORDER RADIUS
                    if (isset($itemBorderRadius['top']) || isset($itemBorderRadius['right']) || isset($itemBorderRadius['bottom']) || isset($itemBorderRadius['left'])) {
                        $output .= 'border-radius: ' .
                            (isset($itemBorderRadius['top']) ? (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) : '0px') . ' ' .
                            (isset($itemBorderRadius['right']) ? (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) : '0px') . ' ' .
                            (isset($itemBorderRadius['bottom']) ? (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) : '0px') . ' ' .
                            (isset($itemBorderRadius['left']) ? (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) : '0px') . '; ';
                    }

                    // BORDER WIDTH
                    if (isset($itemBorderWidth['top']) || isset($itemBorderWidth['right']) || isset($itemBorderWidth['bottom']) || isset($itemBorderWidth['left'])) {
                        $output .= 'border-width: ' .
                            (isset($itemBorderWidth['top']) ? (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) : '0px') . ' ' .
                            (isset($itemBorderWidth['right']) ? (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) : '0px') . ' ' .
                            (isset($itemBorderWidth['bottom']) ? (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) : '0px') . ' ' .
                            (isset($itemBorderWidth['left']) ? (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) : '0px') . '; ';
                    }

                    // Border Style & Color
                    if (!empty($itemBorderType)) {
                        $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                    }
                    if (!empty($itemBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                    }

                    // Background Color
                    if (!empty($itemBackgroundColor)) {
                        $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                    }

                    // Box Shadow
                    if (
                        isset($itemBoxShadow['left']) ||  // horizontal offset
                        isset($itemBoxShadow['top']) ||  // vertical offset
                        isset($itemBoxShadow['right']) ||  // blur radius
                        isset($itemBoxShadow['bottom']) ||  // spread radius
                        isset($itemBoxShadowColor)
                    ) {
                        $output .= 'box-shadow: ' .
                            (isset($itemBoxShadow['left']) ? (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) : '0px') . ' ' .
                            (isset($itemBoxShadow['top']) ? (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) : '0px') . ' ' .
                            (isset($itemBoxShadow['right']) ? (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) : '0px') . ' ' .
                            (isset($itemBoxShadow['bottom']) ? (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) : '0px') . ' ' .
                            (!empty($itemBoxShadowColor) ? esc_attr($itemBoxShadowColor) : 'rgba(0,0,0,0.1)') . '; ';
                    }

                $output .= '">';
                // Thumbnail
                if ($thumbnail && $showThumbnail) {
                    $output .= '<div class="thumb" style="';

                    // MARGIN
                    if (
                        isset($thumbnailMargin['top']) ||
                        isset($thumbnailMargin['right']) ||
                        isset($thumbnailMargin['bottom']) ||
                        isset($thumbnailMargin['left'])
                    ) {
                        $output .= 'margin: ' .
                            (isset($thumbnailMargin['top']) ? (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) : '0px') . ' ' .
                            (isset($thumbnailMargin['right']) ? (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) : '0px') . ' ' .
                            (isset($thumbnailMargin['bottom']) ? (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) : '0px') . ' ' .
                            (isset($thumbnailMargin['left']) ? (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) : '0px') . '; ';
                    }

                    // PADDING
                    if (
                        isset($thumbnailPadding['top']) ||
                        isset($thumbnailPadding['right']) ||
                        isset($thumbnailPadding['bottom']) ||
                        isset($thumbnailPadding['left'])
                    ) {
                        $output .= 'padding: ' .
                            (isset($thumbnailPadding['top']) ? (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) : '0px') . ' ' .
                            (isset($thumbnailPadding['right']) ? (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) : '0px') . ' ' .
                            (isset($thumbnailPadding['bottom']) ? (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) : '0px') . ' ' .
                            (isset($thumbnailPadding['left']) ? (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) : '0px') . '; ';
                    }

                    // BORDER RADIUS
                    if (
                        isset($thumbnailBorderRadius['top']) ||
                        isset($thumbnailBorderRadius['right']) ||
                        isset($thumbnailBorderRadius['bottom']) ||
                        isset($thumbnailBorderRadius['left'])
                    ) {
                        $output .= 'border-radius: ' .
                            (isset($thumbnailBorderRadius['top']) ? (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) : '0px') . ' ' .
                            (isset($thumbnailBorderRadius['right']) ? (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) : '0px') . ' ' .
                            (isset($thumbnailBorderRadius['bottom']) ? (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) : '0px') . ' ' .
                            (isset($thumbnailBorderRadius['left']) ? (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) : '0px') . '; ';
                    }

                    $output .= '">';

                    // Anchor with optional border-radius and overflow
                    if ($thumbnailLink) {
                        $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '>';
                        $output .= $thumbnail;
                        $output .= '</a>';
                    } else {
                        $output .= $thumbnail;
                    }
                    $output .= '</div>';
                }
                // END Thumbnail
                
                // MAIN Content
                $output .= '<div class="content" style="';
                    // MARGIN
                    if (
                        isset($contentitemMarginNew['top']) ||
                        isset($contentitemMarginNew['right']) ||
                        isset($contentitemMarginNew['bottom']) ||
                        isset($contentitemMarginNew['left'])
                    ) {
                        $output .= 'margin: ' .
                            (isset($contentitemMarginNew['top']) ? (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) : '0px') . ' ' .
                            (isset($contentitemMarginNew['right']) ? (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) : '0px') . ' ' .
                            (isset($contentitemMarginNew['bottom']) ? (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) : '0px') . ' ' .
                            (isset($contentitemMarginNew['left']) ? (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) : '0px') . '; ';
                    }

                    // PADDING
                    if (
                        isset($contentitemPaddingNew['top']) ||
                        isset($contentitemPaddingNew['right']) ||
                        isset($contentitemPaddingNew['bottom']) ||
                        isset($contentitemPaddingNew['left'])
                    ) {
                        $output .= 'padding: ' .
                            (isset($contentitemPaddingNew['top']) ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' .
                            (isset($contentitemPaddingNew['right']) ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' .
                            (isset($contentitemPaddingNew['bottom']) ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' .
                            (isset($contentitemPaddingNew['left']) ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; ';
                    }

                    // BORDER WIDTH
                    if (
                        isset($contentBorderWidth['top']) ||
                        isset($contentBorderWidth['right']) ||
                        isset($contentBorderWidth['bottom']) ||
                        isset($contentBorderWidth['left'])
                    ) {
                        $output .= 'border-width: ' .
                            (isset($contentBorderWidth['top']) ? (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) : '0px') . ' ' .
                            (isset($contentBorderWidth['right']) ? (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) : '0px') . ' ' .
                            (isset($contentBorderWidth['bottom']) ? (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) : '0px') . ' ' .
                            (isset($contentBorderWidth['left']) ? (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) : '0px') . '; ';
                    }
                    // BORDER radius
                    if (
                        isset($contentitemRadius['top']) ||
                        isset($contentitemRadius['right']) ||
                        isset($contentitemRadius['bottom']) ||
                        isset($contentitemRadius['left'])
                    ) {
                        $output .= 'border-radius: ' .
                            (isset($contentitemRadius['top']) ? (is_numeric($contentitemRadius['top']) ? $contentitemRadius['top'] . 'px' : esc_attr($contentitemRadius['top'])) : '0px') . ' ' .
                            (isset($contentitemRadius['right']) ? (is_numeric($contentitemRadius['right']) ? $contentitemRadius['right'] . 'px' : esc_attr($contentitemRadius['right'])) : '0px') . ' ' .
                            (isset($contentitemRadius['bottom']) ? (is_numeric($contentitemRadius['bottom']) ? $contentitemRadius['bottom'] . 'px' : esc_attr($contentitemRadius['bottom'])) : '0px') . ' ' .
                            (isset($contentitemRadius['left']) ? (is_numeric($contentitemRadius['left']) ? $contentitemRadius['left'] . 'px' : esc_attr($contentitemRadius['left'])) : '0px') . '; ';
                    }
                        // Border Style
                        if (!empty($contentNormalBorderType)) {
                            $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                        }
                        // Background Color
                        if (!empty($contentBgColor)) {
                            $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                        }
                        // Border Color
                        if (!empty($contentBorderColor)) {
                            $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                        }
                    $output .= '">';
                // Categories

                if ($showPostCategory) {
                    $categories = get_the_category($post_id);
                    if (!empty($categories)) {
                        $category = $categories[0]; // Show the first category only

                        $output .= '<div class="fpg-blog-category">';

                        // Anchor tag style
                        $style = '';
                        if (!empty($metaTextColor)) {
                            $style .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }
                        if (!empty($metaBgColor)) {
                            $style .= 'background:' . esc_attr($metaBgColor) . '; ';
                        }
                        if (!empty($metaFontSize)) {
                            $style .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $output .= '<a href="' . esc_url(get_category_link($category->term_id)) . '" style="' . esc_attr($style) . '">';
                        $output .= '<div class="icon">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="6" height="6" viewBox="0 0 6 6" fill="none">
                                            <path d="M3 0L5.59808 1.5V4.5L3 6L0.401924 4.5V1.5L3 0Z" fill="#513DE8"></path>
                                            <defs>
                                                <linearGradient x1="-3.93273e-08" y1="0.803572" x2="6.33755" y2="1.30989" gradientUnits="userSpaceOnUse">
                                                    <stop stop-color="#513DE8" offset="1"></stop>
                                                    <stop offset="1" stop-color="#8366E3"></stop>
                                                </linearGradient>
                                            </defs>
                                        </svg>
                                    </div>';
                        $output .= esc_html($category->name);
                        $output .= '</a>';
                        $output .= '</div>';

                    }
                }
       
                // title
                if ($showPostTitle) {
                    $titleStyles = '';

                    // Order
                    if (!empty($titleOrder)) {
                        $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                    }

                    // Background color
                    if (!empty($postTitleBgColor)) {
                        $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                    }

                    // Margin
                    if (isset($postTitleMargin['top']) || isset($postTitleMargin['right']) || isset($postTitleMargin['bottom']) || isset($postTitleMargin['left'])) {
                        $titleStyles .= 'margin: ' .
                            (isset($postTitleMargin['top']) ? (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) : '0px') . ' ' .
                            (isset($postTitleMargin['right']) ? (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) : '0px') . ' ' .
                            (isset($postTitleMargin['bottom']) ? (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) : '0px') . ' ' .
                            (isset($postTitleMargin['left']) ? (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) : '0px') . '; ';
                    }

                    // Padding
                    if (isset($postTitlePadding['top']) || isset($postTitlePadding['right']) || isset($postTitlePadding['bottom']) || isset($postTitlePadding['left'])) {
                        $titleStyles .= 'padding: ' .
                            (isset($postTitlePadding['top']) ? (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) : '0px') . ' ' .
                            (isset($postTitlePadding['right']) ? (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) : '0px') . ' ' .
                            (isset($postTitlePadding['bottom']) ? (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) : '0px') . ' ' .
                            (isset($postTitlePadding['left']) ? (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) : '0px') . '; ';
                    }

                    // Determine if underline should be shown
                    $showUnderline = $postLinkType === 'yeslink' && $titleHoverUnderLine === 'enable';

                    // Class name
                    $classNames = 'title align-' . esc_attr($postTitleAlignment);
                    if ($showUnderline) {
                        $classNames .= ' underline';
                    }

                    // Hover/Out events for nolink
                    $onmouseover = '';
                    $onmouseout  = '';

                    if (!empty($postTitleHoverBgColor)) {
                        $onmouseover .= 'this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';';
                    }

                    if (!empty($postTitleHoverColor)) {
                        $onmouseover .= ' this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                    }

                    if (!empty($postTitleBgColor)) {
                        $onmouseout .= 'this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';';
                    } else {
                        $onmouseout .= 'this.style.removeProperty(\'background-color\');';
                    }

                    if (!empty($postTitleColor)) {
                        $onmouseout .= ' this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                    } else {
                        $onmouseout .= ' this.style.removeProperty(\'color\');';
                    }

                    // Opening title tag
                    $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"'
                        . (!empty($onmouseover) ? ' onmouseover="' . trim($onmouseover) . '"' : '')
                        . (!empty($onmouseout)  ? ' onmouseout="'  . trim($onmouseout)  . '"' : '') . '>';

                    if ($postLinkType === 'yeslink') {
                        // Anchor styles
                        $style = '';
                        $hoverStyle = '';
                        $mouseoutStyle = '';

                        if (!empty($postTitleFontSize)) {
                            $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                        }

                        if (!empty($postTitleLineHeight)) {
                            $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                        }

                        if (!empty($postTitleLetterSpacing)) {
                            $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                        }

                        if (!empty($postTitleFontWeight)) {
                            $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                        }

                        if (!empty($postTitleColor)) {
                            $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                            $mouseoutStyle .= 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                        } else {
                            $mouseoutStyle .= 'this.style.color=\'\';';
                        }

                        if (!empty($postTitleHoverColor)) {
                            $hoverStyle .= 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                        }

                        if ($showUnderline && !empty($postTitleHoverColor)) {
                            $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                            $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                            $hoverStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                        }

                        if ($showUnderline && empty($postTitleColor ) && !empty($postTitleColor )) {
                            $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                            $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                            $mouseoutStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                        } else {
                            
                            $mouseoutStyle .= ' this.style.removeProperty(\'background-position\');';
                            $mouseoutStyle .= ' this.style.removeProperty(\'background-size\');';
                        }

                        $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '
                            style="' . esc_attr(trim($style)) . '"'
                            . (!empty($hoverStyle)   ? ' onmouseover="' . $hoverStyle . '"' : '')
                            . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                            . esc_html($croppedTitle) . '</a>';
                    } else {
                        // No link  render span with inline styles
                        $inlineStyle = '';
                        if (!empty($postTitleFontSize)) {
                            $inlineStyle .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                        }
                        if (!empty($postTitleLineHeight)) {
                            $inlineStyle .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                        }
                        if (!empty($postTitleLetterSpacing)) {
                            $inlineStyle .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                        }
                        if (!empty($postTitleFontWeight)) {
                            $inlineStyle .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                        }
                        if (!empty($postTitleColor)) {
                            $inlineStyle .= 'color: ' . esc_attr($postTitleColor) . '; ';
                        }

                        $output .= '<span style="' . esc_attr(trim($inlineStyle)) . '">' . esc_html($croppedTitle) . '</span>';
                    }

                    $output .= '</' . esc_attr($titleTag) . '>';
                }

                // Meta Data
                if ($showMetaData) {
                    $output .= '<ul class="blog-meta align-' . $metaAlignment . ' " style="';  
                        // MARGIN
                        if (
                            isset($metaMarginNew['top']) ||
                            isset($metaMarginNew['right']) ||
                            isset($metaMarginNew['bottom']) ||
                            isset($metaMarginNew['left'])
                        ) {
                            $output .= 'margin: ' .
                                (isset($metaMarginNew['top']) ? (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) : '0px') . ' ' .
                                (isset($metaMarginNew['right']) ? (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) : '0px') . ' ' .
                                (isset($metaMarginNew['bottom']) ? (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) : '0px') . ' ' .
                                (isset($metaMarginNew['left']) ? (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) : '0px') . '; ';
                        }

                        // PADDING
                        if (
                            isset($metaPadding['top']) ||
                            isset($metaPadding['right']) ||
                            isset($metaPadding['bottom']) ||
                            isset($metaPadding['left'])
                        ) {
                            $output .= 'padding: ' .
                                (isset($metaPadding['top']) ? (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) : '0px') . ' ' .
                                (isset($metaPadding['right']) ? (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) : '0px') . ' ' .
                                (isset($metaPadding['bottom']) ? (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) : '0px') . ' ' .
                                (isset($metaPadding['left']) ? (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) : '0px') . '; ';
                        }   
                        
                        // Color
                        if (!empty($metaTextColor)) {
                            $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                        }
                        // Order
                        if (!empty($metaOrder)) {
                            $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                        }
                    $output .= '">';

                    $meta_items = [];

                    // Date
                    if ($showPostDate) {
                        $meta = '<li class="meta-date" style="';

                        // Color
                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        // Font size
                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        // Icon
                        if ($showPostDateIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-calendar-alt" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($getdate) . '</li>';
                        $meta_items[] = $meta;
                    }
                    
                    // Now join meta items with the separator
                    if (!empty($meta_items)) {
                        $separator = '';

                        if ($metaSeperator !== '') {
                            $separator = '';
                            if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                $separatorStyle = '';
                                if (!empty($separatorColor)) {
                                    $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                }
                                if (!empty($metaFontSize)) {
                                    $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                            }
                        }

                        $output .= implode($separator, $meta_items);
                    }
                    $output .= '</ul>'; // Close meta-data-list               
                }
                // End Meta Data

                // Excerpt
                if ($showPostExcerpt) {
                    $excerptTextStyles = '';

                    // Typography
                    if (!empty($excerptFontSize)) {
                        $excerptTextStyles .= 'font-size: ' . esc_attr($excerptFontSize) . 'px; ';
                    }

                    if (!empty($excerptLineHeight)) {
                        $excerptTextStyles .= 'line-height: ' . esc_attr($excerptLineHeight) . '; ';
                    }

                    if (!empty($excerptLetterSpacing)) {
                        $excerptTextStyles .= 'letter-spacing: ' . esc_attr($excerptLetterSpacing) . 'px; ';
                    }

                    if (!empty($excerptFontWeight)) {
                        $excerptTextStyles .= 'font-weight: ' . esc_attr($excerptFontWeight) . '; ';
                    }

                    if (!empty($excerptColor)) {
                        $excerptTextStyles .= 'color: ' . esc_attr($excerptColor) . '; ';
                    }

                    if (!empty($excerptBgColor)) {
                        $excerptTextStyles .= 'background-color: ' . esc_attr($excerptBgColor) . '; ';
                    }

                    if (!empty($excerptBorderType)) {
                        $excerptTextStyles .= 'border-style: ' . esc_attr($excerptBorderType) . '; ';
                    }

                    // Margin
                    if (isset($excerptMargin['top']) || isset($excerptMargin['right']) || isset($excerptMargin['bottom']) || isset($excerptMargin['left'])) {
                        $excerptTextStyles .= 'margin: ' .
                            (isset($excerptMargin['top']) ? (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) : '0px') . ' ' .
                            (isset($excerptMargin['right']) ? (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) : '0px') . ' ' .
                            (isset($excerptMargin['bottom']) ? (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) : '0px') . ' ' .
                            (isset($excerptMargin['left']) ? (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) : '0px') . '; ';
                    }

                    // Padding
                    if (isset($excerptPadding['top']) || isset($excerptPadding['right']) || isset($excerptPadding['bottom']) || isset($excerptPadding['left'])) {
                        $excerptTextStyles .= 'padding: ' .
                            (isset($excerptPadding['top']) ? (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) : '0px') . ' ' .
                            (isset($excerptPadding['right']) ? (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) : '0px') . ' ' .
                            (isset($excerptPadding['bottom']) ? (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) : '0px') . ' ' .
                            (isset($excerptPadding['left']) ? (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) : '0px') . '; ';
                    }

                    // Hover Effects
                    $hoverIn = '';
                    $hoverOut = '';

                    if (!empty($excerptHoverColor)) {
                        $hoverIn .= 'this.style.color=\'' . esc_attr($excerptHoverColor) . '\';';
                        $hoverOut .= 'this.style.color=\'' . esc_attr($excerptColor) . '\';';
                    }

                    if (!empty($excerptHoverBgColor)) {
                        $hoverIn .= 'this.style.backgroundColor=\'' . esc_attr($excerptHoverBgColor) . '\';';
                        $hoverOut .= 'this.style.backgroundColor=\'' . esc_attr($excerptBgColor) . '\';';
                    }

                    // Final output: only <p> with all styling
                    $output .= '<p class="desc align-' . $excerptAlignment . ' " style="' . esc_attr(trim($excerptTextStyles)) . '"';

                    if (!empty($hoverIn) || !empty($hoverOut)) {
                        $output .= ' onmouseover="' . esc_attr($hoverIn) . '"';
                        $output .= ' onmouseout="' . esc_attr($hoverOut) . '"';
                    }

                    $output .= '>';
                    $output .= esc_html($excerpt);
                    $output .= '</p>';
                }

                // End Excerpt
                //Footer
                $output .= '<div class="fpg-blog-author">';

                    if ($showPostAuthor) {
                        $meta = '';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $output .= '<div class="user">';
                        $output .= '<a href="' . esc_url(get_author_posts_url(get_the_author_meta('ID'))) . '">';
                        $output .= '<div class="author-thumb">';
                        $output .= get_avatar(get_the_author_meta('ID'), 32);
                        $output .= '</div>';
                        $output .= '<span style="' . esc_attr(trim($meta)) . '">';
                        $output .= esc_html__('by', 'fancy-post-grid') . ' ' . get_the_author();
                        $output .= '</span>';
                        $output .= '</a>';
                        $output .= '</div>';
                    }

                    if ($showReadMoreButton) {
                        // Button wrapper styles
                        $buttonWrapperStyle = '';
                        //margin
                        if (
                            isset($buttonMarginNew['top']) || 
                            isset($buttonMarginNew['right']) || 
                            isset($buttonMarginNew['bottom']) || 
                            isset($buttonMarginNew['left'])
                        ) {
                            $buttonWrapperStyle .= 'margin: ' .
                                (isset($buttonMarginNew['top']) ? (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) : '0px') . ' ' .
                                (isset($buttonMarginNew['right']) ? (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) : '0px') . ' ' .
                                (isset($buttonMarginNew['bottom']) ? (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) : '0px') . ' ' .
                                (isset($buttonMarginNew['left']) ? (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) : '0px') . '; ';
                        }

                        // Order
                        if (!empty($buttonOrder)) {
                            $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                        }

                        $output .= '<div class="fpg-link align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';

                        // Button inline styles
                        $buttonInlineStyles = '';

                        if (!empty($buttonTextColor)) {
                            $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                        }
                        if (!empty($buttonBackgroundColor)) {
                            $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                        }
                        if (!empty($buttonFontSize)) {
                            $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                        }
                        if (!empty($buttonFontWeight)) {
                            $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                        }
                        if (!empty($buttonBorderColor)) {
                            $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                        }
                        if (!empty($buttonBorderType)) {
                            $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                        }

                        // Border Width
                        if (
                            isset($buttonBorderWidth['top']) || 
                            isset($buttonBorderWidth['right']) || 
                            isset($buttonBorderWidth['bottom']) || 
                            isset($buttonBorderWidth['left'])
                        ) {
                            $buttonInlineStyles .= 'border-width: ' .
                                (isset($buttonBorderWidth['top']) ? (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) : '0px') . ' ' .
                                (isset($buttonBorderWidth['right']) ? (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) : '0px') . ' ' .
                                (isset($buttonBorderWidth['bottom']) ? (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) : '0px') . ' ' .
                                (isset($buttonBorderWidth['left']) ? (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) : '0px') . '; ';
                        }

                        // Border Radius
                        if (
                            isset($buttonBorderRadius['top']) || 
                            isset($buttonBorderRadius['right']) || 
                            isset($buttonBorderRadius['bottom']) || 
                            isset($buttonBorderRadius['left'])
                        ) {
                            $buttonInlineStyles .= 'border-radius: ' .
                                (isset($buttonBorderRadius['top']) ? (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) : '0px') . ' ' .
                                (isset($buttonBorderRadius['right']) ? (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) : '0px') . ' ' .
                                (isset($buttonBorderRadius['bottom']) ? (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) : '0px') . ' ' .
                                (isset($buttonBorderRadius['left']) ? (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) : '0px') . '; ';
                        }

                        // Padding
                        if (
                            isset($buttonPaddingNew['top']) || 
                            isset($buttonPaddingNew['right']) || 
                            isset($buttonPaddingNew['bottom']) || 
                            isset($buttonPaddingNew['left'])
                        ) {
                            $buttonInlineStyles .= 'padding: ' .
                                (isset($buttonPaddingNew['top']) ? (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) : '0px') . ' ' .
                                (isset($buttonPaddingNew['right']) ? (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) : '0px') . ' ' .
                                (isset($buttonPaddingNew['bottom']) ? (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) : '0px') . ' ' .
                                (isset($buttonPaddingNew['left']) ? (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) : '0px') . '; ';
                        } 

                        // Hover styles
                        $buttonHoverInlineStyles = '';
                        $buttonResetStyles = '';

                        if (!empty($buttonHoverTextColor)) {
                            $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                            $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                        }
                        if (!empty($buttonHoverBorderColor)) {
                            $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                            $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                        }
                        if (!empty($buttonHoverBackgroundColor)) {
                            $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                            $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                        }

                        // Button anchor tag
                        $output .= '<a class="read-more ' . esc_attr($buttonStyle3) . '" href="' . esc_url(get_permalink()) . '" ' . $targetAttr . ' style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                        if (!empty($buttonHoverInlineStyles)) {
                            $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                        }

                        if (!empty($buttonResetStyles)) {
                            $output .= ' onmouseout="' . $buttonResetStyles . '"';
                        }

                        $output .= '>';

                        // Icon handling
                        $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                        $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                        $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                        if ($iconPosition === 'left' && $showButtonIcon) {
                            $output .= $leftIcon . ' ';
                        }

                        $output .= esc_html($readMoreLabel);

                        if ($iconPosition === 'right' && $showButtonIcon) {
                            $output .= ' ' . $rightIcon;
                        }

                        $output .= '</a></div>';
                    }

                $output .= '</div>';
                //end Footer
                $output .= '</div>';
                // End MAIN Content
                $output .= '</div>';
                // End Full post layout
                $output .= '</div>';
            }
            elseif ($sliderLayoutStyle === 'style4') {
                $borderStyles = '.fpg-blog-layout-4 .fpg-blog__item .fpg-content .fpg-blog-footer .btn-link.fpg-border::before {'; 
                $borderStyles .= 'background: ' . (!empty($buttonHoverTextColor) ? esc_attr($buttonHoverTextColor) : '#332FFF') . ';';
                $borderStyles .= '}';

                $output .= '<style>' . $borderStyles . '</style>';
                $output .= '<div class="swiper-slide">';
                // Full post layout
                $output .= '<div class="fpg-blog__item align-' . $itemBoxAlignment4 . ' ' . $hoverAnimation . ' ' . $postLinkType . '" style="';
                    // MARGIN    
                    if (isset($itemMargin['top']) || isset($itemMargin['right']) || isset($itemMargin['bottom']) || isset($itemMargin['left'])) {
                        $output .= 'margin: ' .
                            (isset($itemMargin['top']) ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' .
                            (isset($itemMargin['right']) ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' .
                            (isset($itemMargin['bottom']) ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' .
                            (isset($itemMargin['left']) ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; ';
                    }

                    // PADDING
                    if (isset($itemPadding['top']) || isset($itemPadding['right']) || isset($itemPadding['bottom']) || isset($itemPadding['left'])) {
                        $output .= 'padding: ' .
                            (isset($itemPadding['top']) ? (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) : '0px') . ' ' .
                            (isset($itemPadding['right']) ? (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) : '0px') . ' ' .
                            (isset($itemPadding['bottom']) ? (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) : '0px') . ' ' .
                            (isset($itemPadding['left']) ? (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) : '0px') . '; ';
                    }

                    // BORDER RADIUS
                    if (isset($itemBorderRadius['top']) || isset($itemBorderRadius['right']) || isset($itemBorderRadius['bottom']) || isset($itemBorderRadius['left'])) {
                        $output .= 'border-radius: ' .
                            (isset($itemBorderRadius['top']) ? (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) : '0px') . ' ' .
                            (isset($itemBorderRadius['right']) ? (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) : '0px') . ' ' .
                            (isset($itemBorderRadius['bottom']) ? (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) : '0px') . ' ' .
                            (isset($itemBorderRadius['left']) ? (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) : '0px') . '; ';
                    }

                    // BORDER WIDTH
                    if (isset($itemBorderWidth['top']) || isset($itemBorderWidth['right']) || isset($itemBorderWidth['bottom']) || isset($itemBorderWidth['left'])) {
                        $output .= 'border-width: ' .
                            (isset($itemBorderWidth['top']) ? (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) : '0px') . ' ' .
                            (isset($itemBorderWidth['right']) ? (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) : '0px') . ' ' .
                            (isset($itemBorderWidth['bottom']) ? (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) : '0px') . ' ' .
                            (isset($itemBorderWidth['left']) ? (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) : '0px') . '; ';
                    }

                    // Border Style & Color
                    if (!empty($itemBorderType)) {
                        $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                    }
                    if (!empty($itemBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                    }

                    // Background Color
                    if (!empty($itemBackgroundColor)) {
                        $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                    }

                    // Box Shadow
                    if (
                        isset($itemBoxShadow['left']) ||  // horizontal offset
                        isset($itemBoxShadow['top']) ||  // vertical offset
                        isset($itemBoxShadow['right']) ||  // blur radius
                        isset($itemBoxShadow['bottom']) ||  // spread radius
                        isset($itemBoxShadowColor)
                    ) {
                        $output .= 'box-shadow: ' .
                            (isset($itemBoxShadow['left']) ? (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) : '0px') . ' ' .
                            (isset($itemBoxShadow['top']) ? (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) : '0px') . ' ' .
                            (isset($itemBoxShadow['right']) ? (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) : '0px') . ' ' .
                            (isset($itemBoxShadow['bottom']) ? (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) : '0px') . ' ' .
                            (!empty($itemBoxShadowColor) ? esc_attr($itemBoxShadowColor) : 'rgba(0,0,0,0.1)') . '; ';
                    }


                $output .= '">';
                // Thumbnail
                if ($thumbnail && $showThumbnail) {
                    $output .= '<div class="fpg-thumb" style="';

                    // MARGIN
                    if (
                        isset($thumbnailMargin['top']) ||
                        isset($thumbnailMargin['right']) ||
                        isset($thumbnailMargin['bottom']) ||
                        isset($thumbnailMargin['left'])
                    ) {
                        $output .= 'margin: ' .
                            (isset($thumbnailMargin['top']) ? (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) : '0px') . ' ' .
                            (isset($thumbnailMargin['right']) ? (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) : '0px') . ' ' .
                            (isset($thumbnailMargin['bottom']) ? (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) : '0px') . ' ' .
                            (isset($thumbnailMargin['left']) ? (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) : '0px') . '; ';
                    }

                    // PADDING
                    if (
                        isset($thumbnailPadding['top']) ||
                        isset($thumbnailPadding['right']) ||
                        isset($thumbnailPadding['bottom']) ||
                        isset($thumbnailPadding['left'])
                    ) {
                        $output .= 'padding: ' .
                            (isset($thumbnailPadding['top']) ? (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) : '0px') . ' ' .
                            (isset($thumbnailPadding['right']) ? (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) : '0px') . ' ' .
                            (isset($thumbnailPadding['bottom']) ? (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) : '0px') . ' ' .
                            (isset($thumbnailPadding['left']) ? (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) : '0px') . '; ';
                    }

                    // BORDER RADIUS
                    if (
                        isset($thumbnailBorderRadius['top']) ||
                        isset($thumbnailBorderRadius['right']) ||
                        isset($thumbnailBorderRadius['bottom']) ||
                        isset($thumbnailBorderRadius['left'])
                    ) {
                        $output .= 'border-radius: ' .
                            (isset($thumbnailBorderRadius['top']) ? (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) : '0px') . ' ' .
                            (isset($thumbnailBorderRadius['right']) ? (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) : '0px') . ' ' .
                            (isset($thumbnailBorderRadius['bottom']) ? (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) : '0px') . ' ' .
                            (isset($thumbnailBorderRadius['left']) ? (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) : '0px') . '; ';
                    }

                    $output .= '">';

                    // Anchor with optional border-radius and overflow
                    if ($thumbnailLink) {
                        $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '>';
                        $output .= $thumbnail;
                        $output .= '</a>';
                    } else {
                        $output .= $thumbnail;
                    }
                    $output .= '</div>';
                }
                // END Thumbnail
                
                // MAIN Content
                $output .= '<div class="fpg-content" style="';
                    // MARGIN
                    if (
                        isset($contentitemMarginNew['top']) ||
                        isset($contentitemMarginNew['right']) ||
                        isset($contentitemMarginNew['bottom']) ||
                        isset($contentitemMarginNew['left'])
                    ) {
                        $output .= 'margin: ' .
                            (isset($contentitemMarginNew['top']) ? (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) : '0px') . ' ' .
                            (isset($contentitemMarginNew['right']) ? (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) : '0px') . ' ' .
                            (isset($contentitemMarginNew['bottom']) ? (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) : '0px') . ' ' .
                            (isset($contentitemMarginNew['left']) ? (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) : '0px') . '; ';
                    }

                    // PADDING
                    if (
                        isset($contentitemPaddingNew['top']) ||
                        isset($contentitemPaddingNew['right']) ||
                        isset($contentitemPaddingNew['bottom']) ||
                        isset($contentitemPaddingNew['left'])
                    ) {
                        $output .= 'padding: ' .
                            (isset($contentitemPaddingNew['top']) ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' .
                            (isset($contentitemPaddingNew['right']) ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' .
                            (isset($contentitemPaddingNew['bottom']) ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' .
                            (isset($contentitemPaddingNew['left']) ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; ';
                    }

                    // BORDER WIDTH
                    if (
                        isset($contentBorderWidth['top']) ||
                        isset($contentBorderWidth['right']) ||
                        isset($contentBorderWidth['bottom']) ||
                        isset($contentBorderWidth['left'])
                    ) {
                        $output .= 'border-width: ' .
                            (isset($contentBorderWidth['top']) ? (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) : '0px') . ' ' .
                            (isset($contentBorderWidth['right']) ? (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) : '0px') . ' ' .
                            (isset($contentBorderWidth['bottom']) ? (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) : '0px') . ' ' .
                            (isset($contentBorderWidth['left']) ? (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) : '0px') . '; ';
                    }
                    // BORDER radius
                    if (
                        isset($contentitemRadius['top']) ||
                        isset($contentitemRadius['right']) ||
                        isset($contentitemRadius['bottom']) ||
                        isset($contentitemRadius['left'])
                    ) {
                        $output .= 'border-radius: ' .
                            (isset($contentitemRadius['top']) ? (is_numeric($contentitemRadius['top']) ? $contentitemRadius['top'] . 'px' : esc_attr($contentitemRadius['top'])) : '0px') . ' ' .
                            (isset($contentitemRadius['right']) ? (is_numeric($contentitemRadius['right']) ? $contentitemRadius['right'] . 'px' : esc_attr($contentitemRadius['right'])) : '0px') . ' ' .
                            (isset($contentitemRadius['bottom']) ? (is_numeric($contentitemRadius['bottom']) ? $contentitemRadius['bottom'] . 'px' : esc_attr($contentitemRadius['bottom'])) : '0px') . ' ' .
                            (isset($contentitemRadius['left']) ? (is_numeric($contentitemRadius['left']) ? $contentitemRadius['left'] . 'px' : esc_attr($contentitemRadius['left'])) : '0px') . '; ';
                    }
                    // Border Style
                    if (!empty($contentNormalBorderType)) {
                        $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                    }
                    // Background Color
                    if (!empty($contentBgColor)) {
                        $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                    }
                    // Border Color
                    if (!empty($contentBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                    }
                $output .= '">';

                // Categories
                if ($showPostCategory) {
                    $categories = get_the_category($post_id);
                    if (!empty($categories)) {
                        $category = $categories[0]; // Show the first category only

                        $output .= '<div class="fpg-category align-' . $metaAlignment . '">';
                        // Anchor tag style
                        $style = '';
                        if (!empty($metaTextColor)) {
                            $style .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }
                        if (!empty($metaBgColor)) {
                            $style .= 'background:' . esc_attr($metaBgColor) . '; ';
                        }
                        if (!empty($metaFontSize)) {
                            $style .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }
                        // Margin
                        if (isset($excerptMargin['top']) || isset($excerptMargin['right']) || isset($excerptMargin['bottom']) || isset($excerptMargin['left'])) {
                            $style .= 'margin: ' .
                                (isset($excerptMargin['top']) ? (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) : '0px') . ' ' .
                                (isset($excerptMargin['right']) ? (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) : '0px') . ' ' .
                                (isset($excerptMargin['bottom']) ? (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) : '0px') . ' ' .
                                (isset($excerptMargin['left']) ? (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) : '0px') . '; ';
                        }

                        // Padding
                        if (isset($excerptPadding['top']) || isset($excerptPadding['right']) || isset($excerptPadding['bottom']) || isset($excerptPadding['left'])) {
                            $style .= 'padding: ' .
                                (isset($excerptPadding['top']) ? (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) : '0px') . ' ' .
                                (isset($excerptPadding['right']) ? (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) : '0px') . ' ' .
                                (isset($excerptPadding['bottom']) ? (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) : '0px') . ' ' .
                                (isset($excerptPadding['left']) ? (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) : '0px') . '; ';
                        } 

                        $output .= '<a href="' . esc_url(get_category_link($category->term_id)) . '" style="' . esc_attr($style) . '">';
                        $output .= esc_html($category->name);
                        $output .= '</a>';
                        $output .= '</div>';
                    }
                }
       
                // title
                if ($showPostTitle) {
                    $titleStyles = '';

                    // Order
                    if (!empty($titleOrder)) {
                        $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                    }

                    // Background color
                    if (!empty($postTitleBgColor)) {
                        $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                    }

                    // Margin
                    if (isset($postTitleMargin['top']) || isset($postTitleMargin['right']) || isset($postTitleMargin['bottom']) || isset($postTitleMargin['left'])) {
                        $titleStyles .= 'margin: ' .
                            (isset($postTitleMargin['top']) ? (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) : '0px') . ' ' .
                            (isset($postTitleMargin['right']) ? (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) : '0px') . ' ' .
                            (isset($postTitleMargin['bottom']) ? (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) : '0px') . ' ' .
                            (isset($postTitleMargin['left']) ? (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) : '0px') . '; ';
                    }

                    // Padding
                    if (isset($postTitlePadding['top']) || isset($postTitlePadding['right']) || isset($postTitlePadding['bottom']) || isset($postTitlePadding['left'])) {
                        $titleStyles .= 'padding: ' .
                            (isset($postTitlePadding['top']) ? (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) : '0px') . ' ' .
                            (isset($postTitlePadding['right']) ? (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) : '0px') . ' ' .
                            (isset($postTitlePadding['bottom']) ? (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) : '0px') . ' ' .
                            (isset($postTitlePadding['left']) ? (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) : '0px') . '; ';
                    }

                    // Determine if underline should be shown
                    $showUnderline = $postLinkType === 'yeslink' && $titleHoverUnderLine === 'enable';

                    // Class name
                    $classNames = 'title align-' . esc_attr($postTitleAlignment);
                    if ($showUnderline) {
                        $classNames .= ' underline';
                    }

                    // Hover/Out events for nolink
                    $onmouseover = '';
                    $onmouseout  = '';

                    if (!empty($postTitleHoverBgColor)) {
                        $onmouseover .= 'this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';';
                    }

                    if (!empty($postTitleHoverColor)) {
                        $onmouseover .= ' this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                    }

                    if (!empty($postTitleBgColor)) {
                        $onmouseout .= 'this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';';
                    } else {
                        $onmouseout .= 'this.style.removeProperty(\'background-color\');';
                    }

                    if (!empty($postTitleColor)) {
                        $onmouseout .= ' this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                    } else {
                        $onmouseout .= ' this.style.removeProperty(\'color\');';
                    }

                    // Opening title tag
                    $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"'
                        . (!empty($onmouseover) ? ' onmouseover="' . trim($onmouseover) . '"' : '')
                        . (!empty($onmouseout)  ? ' onmouseout="'  . trim($onmouseout)  . '"' : '') . '>';

                    if ($postLinkType === 'yeslink') {
                        // Anchor styles
                        $style = '';
                        $hoverStyle = '';
                        $mouseoutStyle = '';

                        if (!empty($postTitleFontSize)) {
                            $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                        }

                        if (!empty($postTitleLineHeight)) {
                            $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                        }

                        if (!empty($postTitleLetterSpacing)) {
                            $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                        }

                        if (!empty($postTitleFontWeight)) {
                            $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                        }

                        if (!empty($postTitleColor)) {
                            $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                            $mouseoutStyle .= 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                        } else {
                            $mouseoutStyle .= 'this.style.color=\'\';';
                        }

                        if (!empty($postTitleHoverColor)) {
                            $hoverStyle .= 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                        }

                        if ($showUnderline && !empty($postTitleHoverColor)) {
                            $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                            $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                            $hoverStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                        }

                        if ($showUnderline && empty($postTitleColor ) && !empty($postTitleColor )) {
                            $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                            $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                            $mouseoutStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                        } else {
                            
                            $mouseoutStyle .= ' this.style.removeProperty(\'background-position\');';
                            $mouseoutStyle .= ' this.style.removeProperty(\'background-size\');';
                        }

                        $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '
                            style="' . esc_attr(trim($style)) . '"'
                            . (!empty($hoverStyle)   ? ' onmouseover="' . $hoverStyle . '"' : '')
                            . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                            . esc_html($croppedTitle) . '</a>';
                    } else {
                        // No link  render span with inline styles
                        $inlineStyle = '';
                        if (!empty($postTitleFontSize)) {
                            $inlineStyle .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                        }
                        if (!empty($postTitleLineHeight)) {
                            $inlineStyle .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                        }
                        if (!empty($postTitleLetterSpacing)) {
                            $inlineStyle .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                        }
                        if (!empty($postTitleFontWeight)) {
                            $inlineStyle .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                        }
                        if (!empty($postTitleColor)) {
                            $inlineStyle .= 'color: ' . esc_attr($postTitleColor) . '; ';
                        }

                        $output .= '<span style="' . esc_attr(trim($inlineStyle)) . '">' . esc_html($croppedTitle) . '</span>';
                    }

                    $output .= '</' . esc_attr($titleTag) . '>';
                }

                // Excerpt
                if ($showPostExcerpt) {
                    $excerptStyles = '';
                    $excerptColorStyles = '';

                    // Order
                    if (!empty($excerptOrder)) {
                        $excerptStyles .= 'order: ' . esc_attr($excerptOrder) . '; ';
                    }

                    // Typography
                    if (!empty($excerptFontSize)) {
                        $excerptStyles .= 'font-size: ' . esc_attr($excerptFontSize) . 'px; ';
                    }

                    if (!empty($excerptLineHeight)) {
                        $excerptStyles .= 'line-height: ' . esc_attr($excerptLineHeight) . '; ';
                    }

                    if (!empty($excerptLetterSpacing)) {
                        $excerptStyles .= 'letter-spacing: ' . esc_attr($excerptLetterSpacing) . 'px; ';
                    }

                    if (!empty($excerptFontWeight)) {
                        $excerptStyles .= 'font-weight: ' . esc_attr($excerptFontWeight) . '; ';
                    }

                    if (!empty($excerptColor)) {
                        $excerptColorStyles .= 'color: ' . esc_attr($excerptColor) . '; ';
                    }

                    if (!empty($excerptBgColor)) {
                        $excerptColorStyles .= 'background-color: ' . esc_attr($excerptBgColor) . '; ';
                    }

                    if (!empty($excerptBorderType)) {
                        $excerptStyles .= 'border-style: ' . esc_attr($excerptBorderType) . '; ';
                    }

                    // Margin
                    if (isset($excerptMargin['top']) || isset($excerptMargin['right']) || isset($excerptMargin['bottom']) || isset($excerptMargin['left'])) {
                        $excerptStyles .= 'margin: ' .
                            (isset($excerptMargin['top']) ? (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) : '0px') . ' ' .
                            (isset($excerptMargin['right']) ? (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) : '0px') . ' ' .
                            (isset($excerptMargin['bottom']) ? (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) : '0px') . ' ' .
                            (isset($excerptMargin['left']) ? (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) : '0px') . '; ';
                    }

                    // Padding
                    if (isset($excerptPadding['top']) || isset($excerptPadding['right']) || isset($excerptPadding['bottom']) || isset($excerptPadding['left'])) {
                        $excerptStyles .= 'padding: ' .
                            (isset($excerptPadding['top']) ? (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) : '0px') . ' ' .
                            (isset($excerptPadding['right']) ? (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) : '0px') . ' ' .
                            (isset($excerptPadding['bottom']) ? (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) : '0px') . ' ' .
                            (isset($excerptPadding['left']) ? (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) : '0px') . '; ';
                    }

                    // Handle hover logic conditionally
                    $hoverIn = '';
                    $hoverOut = '';

                    if (!empty($excerptHoverColor)) {
                        $hoverIn .= 'this.style.color=\'' . esc_attr($excerptHoverColor) . '\';';
                        $hoverOut .= 'this.style.color=\'' . esc_attr($excerptColor) . '\';';
                    }

                    if (!empty($excerptHoverBgColor)) {
                        $hoverIn .= 'this.style.backgroundColor=\'' . esc_attr($excerptHoverBgColor) . '\';';
                        $hoverOut .= 'this.style.backgroundColor=\'' . esc_attr($excerptBgColor) . '\';';
                    }

                    $output .= '<div class="fpg-excerpt' . ' align-' . esc_attr($excerptAlignment) . '" style="' . esc_attr(trim($excerptStyles)) . '"';

                    $output .= '>';
                    $output .= '<p style="' . esc_attr(trim($excerptColorStyles)) . '"';

                        if (!empty($hoverIn) || !empty($hoverOut)) {
                            if (!empty($hoverIn)) {
                                $output .= ' onmouseover="' . esc_attr($hoverIn) . '"';
                            }
                            if (!empty($hoverOut)) {
                                $output .= ' onmouseout="' . esc_attr($hoverOut) . '"';
                            }
                        }

                        $output .= '>' . esc_html($excerpt) . '</p>';
                    $output .= '</div>';
                }
                // End Excerpt
                
                //Footer
                $output .= '<div class="fpg-blog-footer" style="order: ' . esc_attr($buttonOrder) . ';">';
                    
                    if ($showPostAuthor) {
                        $meta = '';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $output .= '<div class="user">';
                        $output .= '<a href="' . esc_url(get_author_posts_url(get_the_author_meta('ID'))) . '">';
                        $output .= '<div class="author-thumb">';
                        $output .= get_avatar(get_the_author_meta('ID'), 32);
                        $output .= '</div>';
                        $output .= '<span style="' . esc_attr(trim($meta)) . '">';
                        $output .= esc_html__('by', 'fancy-post-grid') . ' ' . get_the_author();
                        $output .= '</span>';
                        $output .= '</a>';
                        $output .= '</div>';
                    }

                    if ($showReadMoreButton) {
                        // Button wrapper styles
                        $buttonWrapperStyle = '';

                        if (
                            isset($buttonMarginNew['top']) || 
                            isset($buttonMarginNew['right']) || 
                            isset($buttonMarginNew['bottom']) || 
                            isset($buttonMarginNew['left'])
                        ) {
                            $buttonWrapperStyle .= 'margin: ' .
                                (isset($buttonMarginNew['top']) ? (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) : '0px') . ' ' .
                                (isset($buttonMarginNew['right']) ? (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) : '0px') . ' ' .
                                (isset($buttonMarginNew['bottom']) ? (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) : '0px') . ' ' .
                                (isset($buttonMarginNew['left']) ? (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) : '0px') . '; ';
                        }

                        // Order
                        if (!empty($buttonOrder)) {
                            $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                        }

                        $output .= '<div class="btn-wrapper align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';

                        // Button inline styles
                        $buttonInlineStyles = '';

                        if (!empty($buttonTextColor)) {
                            $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                        }
                        if (!empty($buttonBackgroundColor)) {
                            $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                        }
                        if (!empty($buttonFontSize)) {
                            $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                        }
                        if (!empty($buttonFontWeight)) {
                            $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                        }
                        if (!empty($buttonBorderColor)) {
                            $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                        }
                        if (!empty($buttonBorderType)) {
                            $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                        }

                        // Border Width
                        if (
                            isset($buttonBorderWidth['top']) || 
                            isset($buttonBorderWidth['right']) || 
                            isset($buttonBorderWidth['bottom']) || 
                            isset($buttonBorderWidth['left'])
                        ) {
                            $buttonInlineStyles .= 'border-width: ' .
                                (isset($buttonBorderWidth['top']) ? (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) : '0px') . ' ' .
                                (isset($buttonBorderWidth['right']) ? (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) : '0px') . ' ' .
                                (isset($buttonBorderWidth['bottom']) ? (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) : '0px') . ' ' .
                                (isset($buttonBorderWidth['left']) ? (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) : '0px') . '; ';
                        }

                        // Border Radius
                        if (
                            isset($buttonBorderRadius['top']) || 
                            isset($buttonBorderRadius['right']) || 
                            isset($buttonBorderRadius['bottom']) || 
                            isset($buttonBorderRadius['left'])
                        ) {
                            $buttonInlineStyles .= 'border-radius: ' .
                                (isset($buttonBorderRadius['top']) ? (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) : '0px') . ' ' .
                                (isset($buttonBorderRadius['right']) ? (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) : '0px') . ' ' .
                                (isset($buttonBorderRadius['bottom']) ? (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) : '0px') . ' ' .
                                (isset($buttonBorderRadius['left']) ? (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) : '0px') . '; ';
                        }

                        // Padding
                        if (
                            isset($buttonPaddingNew['top']) || 
                            isset($buttonPaddingNew['right']) || 
                            isset($buttonPaddingNew['bottom']) || 
                            isset($buttonPaddingNew['left'])
                        ) {
                            $buttonInlineStyles .= 'padding: ' .
                                (isset($buttonPaddingNew['top']) ? (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) : '0px') . ' ' .
                                (isset($buttonPaddingNew['right']) ? (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) : '0px') . ' ' .
                                (isset($buttonPaddingNew['bottom']) ? (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) : '0px') . ' ' .
                                (isset($buttonPaddingNew['left']) ? (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) : '0px') . '; ';
                        } 

                        // Hover styles
                        $buttonHoverInlineStyles = '';
                        $buttonResetStyles = '';

                        if (!empty($buttonHoverTextColor)) {
                            $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                            $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                        }
                        if (!empty($buttonHoverBorderColor)) {
                            $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                            $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                        }
                        if (!empty($buttonHoverBackgroundColor)) {
                            $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                            $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                        }

                        // Button anchor tag
                        $output .= '<a class="btn-link read-more ' . esc_attr($buttonStyle4) . '" href="' . esc_url(get_permalink()) . '" ' . $targetAttr . ' style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                        if (!empty($buttonHoverInlineStyles)) {
                            $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                        }

                        if (!empty($buttonResetStyles)) {
                            $output .= ' onmouseout="' . $buttonResetStyles . '"';
                        }

                        $output .= '>';

                        // Icon handling
                        $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                        $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                        $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                        if ($iconPosition === 'left' && $showButtonIcon) {
                            $output .= $leftIcon . ' ';
                        }

                        $output .= esc_html($readMoreLabel);

                        if ($iconPosition === 'right' && $showButtonIcon) {
                            $output .= ' ' . $rightIcon;
                        }

                        $output .= '</a></div>';
                    }

                $output .= '</div>';
                //end Footer
                $output .= '</div>';
                // End MAIN Content
                $output .= '</div>';
                // End Full post layout
                $output .= '</div>';
            }
            elseif ($sliderLayoutStyle === 'style5') {
                $borderStyles = '.fpg-blog-layout-18-item .fpg-content a.fpg-btn.fpg-border::before {'; 
                $borderStyles .= 'background: ' . (!empty($buttonHoverTextColor) ? esc_attr($buttonHoverTextColor) : '#332FFF') . ';';
                $borderStyles .= '}';

                $output .= '<style>' . $borderStyles . '</style>';
                $output .= '<div class="swiper-slide">';
                // Full post layout
                $output .= '<div class="fpg-blog-layout-18-item align-' . $itemBoxAlignment5 . ' ' . $hoverAnimation . ' ' . $postLinkType . '" style="';
                    // MARGIN    
                    if (isset($itemMargin['top']) || isset($itemMargin['right']) || isset($itemMargin['bottom']) || isset($itemMargin['left'])) {
                        $output .= 'margin: ' .
                            (isset($itemMargin['top']) ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' .
                            (isset($itemMargin['right']) ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' .
                            (isset($itemMargin['bottom']) ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' .
                            (isset($itemMargin['left']) ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; ';
                    }

                    // PADDING
                    if (isset($itemPadding['top']) || isset($itemPadding['right']) || isset($itemPadding['bottom']) || isset($itemPadding['left'])) {
                        $output .= 'padding: ' .
                            (isset($itemPadding['top']) ? (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) : '0px') . ' ' .
                            (isset($itemPadding['right']) ? (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) : '0px') . ' ' .
                            (isset($itemPadding['bottom']) ? (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) : '0px') . ' ' .
                            (isset($itemPadding['left']) ? (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) : '0px') . '; ';
                    }

                    // BORDER RADIUS
                    if (isset($itemBorderRadius['top']) || isset($itemBorderRadius['right']) || isset($itemBorderRadius['bottom']) || isset($itemBorderRadius['left'])) {
                        $output .= 'border-radius: ' .
                            (isset($itemBorderRadius['top']) ? (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) : '0px') . ' ' .
                            (isset($itemBorderRadius['right']) ? (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) : '0px') . ' ' .
                            (isset($itemBorderRadius['bottom']) ? (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) : '0px') . ' ' .
                            (isset($itemBorderRadius['left']) ? (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) : '0px') . '; ';
                    }

                    // BORDER WIDTH
                    if (isset($itemBorderWidth['top']) || isset($itemBorderWidth['right']) || isset($itemBorderWidth['bottom']) || isset($itemBorderWidth['left'])) {
                        $output .= 'border-width: ' .
                            (isset($itemBorderWidth['top']) ? (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) : '0px') . ' ' .
                            (isset($itemBorderWidth['right']) ? (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) : '0px') . ' ' .
                            (isset($itemBorderWidth['bottom']) ? (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) : '0px') . ' ' .
                            (isset($itemBorderWidth['left']) ? (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) : '0px') . '; ';
                    }

                    // Border Style & Color
                    if (!empty($itemBorderType)) {
                        $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                    }
                    if (!empty($itemBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                    }

                    // Background Color
                    if (!empty($itemBackgroundColor)) {
                        $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                    }

                    // Box Shadow
                    if (
                        isset($itemBoxShadow['left']) ||  // horizontal offset
                        isset($itemBoxShadow['top']) ||  // vertical offset
                        isset($itemBoxShadow['right']) ||  // blur radius
                        isset($itemBoxShadow['bottom']) ||  // spread radius
                        isset($itemBoxShadowColor)
                    ) {
                        $output .= 'box-shadow: ' .
                            (isset($itemBoxShadow['left']) ? (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) : '0px') . ' ' .
                            (isset($itemBoxShadow['top']) ? (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) : '0px') . ' ' .
                            (isset($itemBoxShadow['right']) ? (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) : '0px') . ' ' .
                            (isset($itemBoxShadow['bottom']) ? (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) : '0px') . ' ' .
                            (!empty($itemBoxShadowColor) ? esc_attr($itemBoxShadowColor) : 'rgba(0,0,0,0.1)') . '; ';
                    }

                $output .= '">';
                // Thumbnail
                if ($thumbnail && $showThumbnail) {
                    $output .= '<div class="fpg-thumb" style="';

                    // MARGIN
                    if (
                        isset($thumbnailMargin['top']) ||
                        isset($thumbnailMargin['right']) ||
                        isset($thumbnailMargin['bottom']) ||
                        isset($thumbnailMargin['left'])
                    ) {
                        $output .= 'margin: ' .
                            (isset($thumbnailMargin['top']) ? (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) : '0px') . ' ' .
                            (isset($thumbnailMargin['right']) ? (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) : '0px') . ' ' .
                            (isset($thumbnailMargin['bottom']) ? (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) : '0px') . ' ' .
                            (isset($thumbnailMargin['left']) ? (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) : '0px') . '; ';
                    }

                    // PADDING
                    if (
                        isset($thumbnailPadding['top']) ||
                        isset($thumbnailPadding['right']) ||
                        isset($thumbnailPadding['bottom']) ||
                        isset($thumbnailPadding['left'])
                    ) {
                        $output .= 'padding: ' .
                            (isset($thumbnailPadding['top']) ? (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) : '0px') . ' ' .
                            (isset($thumbnailPadding['right']) ? (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) : '0px') . ' ' .
                            (isset($thumbnailPadding['bottom']) ? (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) : '0px') . ' ' .
                            (isset($thumbnailPadding['left']) ? (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) : '0px') . '; ';
                    }

                    // BORDER RADIUS
                    if (
                        isset($thumbnailBorderRadius['top']) ||
                        isset($thumbnailBorderRadius['right']) ||
                        isset($thumbnailBorderRadius['bottom']) ||
                        isset($thumbnailBorderRadius['left'])
                    ) {
                        $output .= 'border-radius: ' .
                            (isset($thumbnailBorderRadius['top']) ? (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) : '0px') . ' ' .
                            (isset($thumbnailBorderRadius['right']) ? (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) : '0px') . ' ' .
                            (isset($thumbnailBorderRadius['bottom']) ? (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) : '0px') . ' ' .
                            (isset($thumbnailBorderRadius['left']) ? (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) : '0px') . '; ';
                    }

                    $output .= '">';

                    // Anchor with optional border-radius and overflow
                    if ($thumbnailLink) {
                        $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '>';
                        $output .= $thumbnail;
                        $output .= '</a>';
                    } else {
                        $output .= $thumbnail;
                    }
                    $output .= '</div>';
                }
                // END Thumbnail
                
                // MAIN Content
                $output .= '<div class="fpg-content" style="';
                    // MARGIN
                    if (
                        isset($contentitemMarginNew['top']) ||
                        isset($contentitemMarginNew['right']) ||
                        isset($contentitemMarginNew['bottom']) ||
                        isset($contentitemMarginNew['left'])
                    ) {
                        $output .= 'margin: ' .
                            (isset($contentitemMarginNew['top']) ? (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) : '0px') . ' ' .
                            (isset($contentitemMarginNew['right']) ? (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) : '0px') . ' ' .
                            (isset($contentitemMarginNew['bottom']) ? (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) : '0px') . ' ' .
                            (isset($contentitemMarginNew['left']) ? (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) : '0px') . '; ';
                    }

                    // PADDING
                    if (
                        isset($contentitemPaddingNew['top']) ||
                        isset($contentitemPaddingNew['right']) ||
                        isset($contentitemPaddingNew['bottom']) ||
                        isset($contentitemPaddingNew['left'])
                    ) {
                        $output .= 'padding: ' .
                            (isset($contentitemPaddingNew['top']) ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' .
                            (isset($contentitemPaddingNew['right']) ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' .
                            (isset($contentitemPaddingNew['bottom']) ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' .
                            (isset($contentitemPaddingNew['left']) ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; ';
                    }

                    // BORDER WIDTH
                    if (
                        isset($contentBorderWidth['top']) ||
                        isset($contentBorderWidth['right']) ||
                        isset($contentBorderWidth['bottom']) ||
                        isset($contentBorderWidth['left'])
                    ) {
                        $output .= 'border-width: ' .
                            (isset($contentBorderWidth['top']) ? (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) : '0px') . ' ' .
                            (isset($contentBorderWidth['right']) ? (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) : '0px') . ' ' .
                            (isset($contentBorderWidth['bottom']) ? (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) : '0px') . ' ' .
                            (isset($contentBorderWidth['left']) ? (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) : '0px') . '; ';
                    }
                    // BORDER radius
                    if (
                        isset($contentitemRadius['top']) ||
                        isset($contentitemRadius['right']) ||
                        isset($contentitemRadius['bottom']) ||
                        isset($contentitemRadius['left'])
                    ) {
                        $output .= 'border-radius: ' .
                            (isset($contentitemRadius['top']) ? (is_numeric($contentitemRadius['top']) ? $contentitemRadius['top'] . 'px' : esc_attr($contentitemRadius['top'])) : '0px') . ' ' .
                            (isset($contentitemRadius['right']) ? (is_numeric($contentitemRadius['right']) ? $contentitemRadius['right'] . 'px' : esc_attr($contentitemRadius['right'])) : '0px') . ' ' .
                            (isset($contentitemRadius['bottom']) ? (is_numeric($contentitemRadius['bottom']) ? $contentitemRadius['bottom'] . 'px' : esc_attr($contentitemRadius['bottom'])) : '0px') . ' ' .
                            (isset($contentitemRadius['left']) ? (is_numeric($contentitemRadius['left']) ? $contentitemRadius['left'] . 'px' : esc_attr($contentitemRadius['left'])) : '0px') . '; ';
                    }
                    // Border Style
                    if (!empty($contentNormalBorderType)) {
                        $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                    }
                    // Background Color
                    if (!empty($contentBgColor)) {
                        $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                    }
                    // Border Color
                    if (!empty($contentBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                    }
                $output .= '">';
                // Meta Data
                if ($showMetaData) {
                     
                    $output .= '<div class="fpg-meta post-meta align-' . $metaAlignment . '"';

                    $style = '';
                    if (!empty($metaBgColor)) {
                        $style .= 'background:' . esc_attr($metaBgColor) . '; ';
                    }   
                    // MARGIN
                    if (
                        isset($metaMarginNew['top']) ||
                        isset($metaMarginNew['right']) ||
                        isset($metaMarginNew['bottom']) ||
                        isset($metaMarginNew['left'])
                    ) {
                        $output .= 'margin: ' .
                            (isset($metaMarginNew['top']) ? (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) : '0px') . ' ' .
                            (isset($metaMarginNew['right']) ? (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) : '0px') . ' ' .
                            (isset($metaMarginNew['bottom']) ? (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) : '0px') . ' ' .
                            (isset($metaMarginNew['left']) ? (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) : '0px') . '; ';
                    }

                    // PADDING
                    if (
                        isset($metaPadding['top']) ||
                        isset($metaPadding['right']) ||
                        isset($metaPadding['bottom']) ||
                        isset($metaPadding['left'])
                    ) {
                        $output .= 'padding: ' .
                            (isset($metaPadding['top']) ? (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) : '0px') . ' ' .
                            (isset($metaPadding['right']) ? (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) : '0px') . ' ' .
                            (isset($metaPadding['bottom']) ? (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) : '0px') . ' ' .
                            (isset($metaPadding['left']) ? (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) : '0px') . '; ';
                    }  
                                            

                    if (!empty($style)) {
                        $output .= ' style="' . esc_attr($style) . '"';
                    }

                    $output .= '>'; 
                    $output .= '<ul class="blog-meta" style="';  
                        
                        // Color
                        if (!empty($metaTextColor)) {
                            $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                        }
                        
                        // Order
                        if (!empty($metaOrder)) {
                            $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                        }
                    $output .= '">';

                    $meta_items = [];

                    
                    // Author
                    if ($showPostAuthor) {
                        $meta = '<li style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostAuthorIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-user" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Category
                    if ($showPostCategory) {
                        $meta = '<li style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostCategoryIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-folder" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        // Get category names without links
                        $categories_list = get_the_category($post_id);
                        if (!empty($categories_list)) {
                            $category_names = array();
                            foreach ($categories_list as $category) {
                                $category_names[] = esc_html($category->name);
                            }
                            $meta .= implode(', ', $category_names); // comma-separated plain text categories
                        }

                        $meta .= '</li>';
                        $meta_items[] = $meta;
                    }
                    
                    // Now join meta items with the separator
                    if (!empty($meta_items)) {
                        $separator = '';

                        if ($metaSeperator !== '') {
                            $separator = '';
                            if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                $separatorStyle = '';
                                if (!empty($separatorColor)) {
                                    $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                }
                                if (!empty($metaFontSize)) {
                                    $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                            }
                        }

                        $output .= implode($separator, $meta_items);
                    }
                    $output .= '</ul>'; // Close meta-data-list
                    $output .= '</div>';               
                }
                // End Meta Data

                // title
                if ($showPostTitle) {
                    $titleStyles = '';

                    // Order
                    if (!empty($titleOrder)) {
                        $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                    }

                    // Background color
                    if (!empty($postTitleBgColor)) {
                        $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                    }

                    // Margin
                    if (isset($postTitleMargin['top']) || isset($postTitleMargin['right']) || isset($postTitleMargin['bottom']) || isset($postTitleMargin['left'])) {
                        $titleStyles .= 'margin: ' .
                            (isset($postTitleMargin['top']) ? (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) : '0px') . ' ' .
                            (isset($postTitleMargin['right']) ? (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) : '0px') . ' ' .
                            (isset($postTitleMargin['bottom']) ? (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) : '0px') . ' ' .
                            (isset($postTitleMargin['left']) ? (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) : '0px') . '; ';
                    }

                    // Padding
                    if (isset($postTitlePadding['top']) || isset($postTitlePadding['right']) || isset($postTitlePadding['bottom']) || isset($postTitlePadding['left'])) {
                        $titleStyles .= 'padding: ' .
                            (isset($postTitlePadding['top']) ? (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) : '0px') . ' ' .
                            (isset($postTitlePadding['right']) ? (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) : '0px') . ' ' .
                            (isset($postTitlePadding['bottom']) ? (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) : '0px') . ' ' .
                            (isset($postTitlePadding['left']) ? (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) : '0px') . '; ';
                    }

                    // Determine if underline should be shown
                    $showUnderline = $postLinkType === 'yeslink' && $titleHoverUnderLine === 'enable';

                    // Class name
                    $classNames = 'title align-' . esc_attr($postTitleAlignment);
                    if ($showUnderline) {
                        $classNames .= ' underline';
                    }

                    // Hover/Out events for nolink
                    $onmouseover = '';
                    $onmouseout  = '';

                    if (!empty($postTitleHoverBgColor)) {
                        $onmouseover .= 'this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';';
                    }

                    if (!empty($postTitleHoverColor)) {
                        $onmouseover .= ' this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                    }

                    if (!empty($postTitleBgColor)) {
                        $onmouseout .= 'this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';';
                    } else {
                        $onmouseout .= 'this.style.removeProperty(\'background-color\');';
                    }

                    if (!empty($postTitleColor)) {
                        $onmouseout .= ' this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                    } else {
                        $onmouseout .= ' this.style.removeProperty(\'color\');';
                    }

                    // Opening title tag
                    $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"'
                        . (!empty($onmouseover) ? ' onmouseover="' . trim($onmouseover) . '"' : '')
                        . (!empty($onmouseout)  ? ' onmouseout="'  . trim($onmouseout)  . '"' : '') . '>';

                    if ($postLinkType === 'yeslink') {
                        // Anchor styles
                        $style = '';
                        $hoverStyle = '';
                        $mouseoutStyle = '';

                        if (!empty($postTitleFontSize)) {
                            $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                        }

                        if (!empty($postTitleLineHeight)) {
                            $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                        }

                        if (!empty($postTitleLetterSpacing)) {
                            $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                        }

                        if (!empty($postTitleFontWeight)) {
                            $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                        }

                        if (!empty($postTitleColor)) {
                            $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                            $mouseoutStyle .= 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                        } else {
                            $mouseoutStyle .= 'this.style.color=\'\';';
                        }

                        if (!empty($postTitleHoverColor)) {
                            $hoverStyle .= 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                        }

                        if ($showUnderline && !empty($postTitleHoverColor)) {
                            $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                            $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                            $hoverStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                        }

                        if ($showUnderline && empty($postTitleColor ) && !empty($postTitleColor )) {
                            $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                            $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                            $mouseoutStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                        } else {
                            
                            $mouseoutStyle .= ' this.style.removeProperty(\'background-position\');';
                            $mouseoutStyle .= ' this.style.removeProperty(\'background-size\');';
                        }

                        $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '
                            style="' . esc_attr(trim($style)) . '"'
                            . (!empty($hoverStyle)   ? ' onmouseover="' . $hoverStyle . '"' : '')
                            . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                            . esc_html($croppedTitle) . '</a>';
                    } else {
                        // No link  render span with inline styles
                        $inlineStyle = '';
                        if (!empty($postTitleFontSize)) {
                            $inlineStyle .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                        }
                        if (!empty($postTitleLineHeight)) {
                            $inlineStyle .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                        }
                        if (!empty($postTitleLetterSpacing)) {
                            $inlineStyle .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                        }
                        if (!empty($postTitleFontWeight)) {
                            $inlineStyle .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                        }
                        if (!empty($postTitleColor)) {
                            $inlineStyle .= 'color: ' . esc_attr($postTitleColor) . '; ';
                        }

                        $output .= '<span style="' . esc_attr(trim($inlineStyle)) . '">' . esc_html($croppedTitle) . '</span>';
                    }

                    $output .= '</' . esc_attr($titleTag) . '>';
                }

                //Button
                if ($showReadMoreButton) {
                    // Button wrapper styles
                    $buttonWrapperStyle = '';

                    // Margin
                    if (
                        isset($buttonMarginNew['top']) || 
                        isset($buttonMarginNew['right']) || 
                        isset($buttonMarginNew['bottom']) || 
                        isset($buttonMarginNew['left'])
                    ) {
                        $buttonWrapperStyle .= 'margin: ' .
                            (isset($buttonMarginNew['top']) ? (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) : '0px') . ' ' .
                            (isset($buttonMarginNew['right']) ? (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) : '0px') . ' ' .
                            (isset($buttonMarginNew['bottom']) ? (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) : '0px') . ' ' .
                            (isset($buttonMarginNew['left']) ? (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) : '0px') . '; ';
                    }

                    // Order
                    if (!empty($buttonOrder)) {
                        $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                    }
                   
                    $output .= '<div class="blgo-btn-box align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';

                    // Button inline styles
                    $buttonInlineStyles = '';

                    if (!empty($buttonTextColor)) {
                        $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                    }
                    if (!empty($buttonBackgroundColor)) {
                        $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                    }
                    if (!empty($buttonFontSize)) {
                        $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                    }
                    if (!empty($buttonFontWeight)) {
                        $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                    }
                    if (!empty($buttonBorderColor)) {
                        $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                    }
                    if (!empty($buttonBorderType)) {
                        $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                    }

                    // Border Width
                    if (
                        isset($buttonBorderWidth['top']) || 
                        isset($buttonBorderWidth['right']) || 
                        isset($buttonBorderWidth['bottom']) || 
                        isset($buttonBorderWidth['left'])
                    ) {
                        $buttonInlineStyles .= 'border-width: ' .
                            (isset($buttonBorderWidth['top']) ? (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) : '0px') . ' ' .
                            (isset($buttonBorderWidth['right']) ? (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) : '0px') . ' ' .
                            (isset($buttonBorderWidth['bottom']) ? (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) : '0px') . ' ' .
                            (isset($buttonBorderWidth['left']) ? (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) : '0px') . '; ';
                    }

                    // Border Radius
                    if (
                        isset($buttonBorderRadius['top']) || 
                        isset($buttonBorderRadius['right']) || 
                        isset($buttonBorderRadius['bottom']) || 
                        isset($buttonBorderRadius['left'])
                    ) {
                        $buttonInlineStyles .= 'border-radius: ' .
                            (isset($buttonBorderRadius['top']) ? (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) : '0px') . ' ' .
                            (isset($buttonBorderRadius['right']) ? (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) : '0px') . ' ' .
                            (isset($buttonBorderRadius['bottom']) ? (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) : '0px') . ' ' .
                            (isset($buttonBorderRadius['left']) ? (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) : '0px') . '; ';
                    }

                    // Padding
                    if (
                        isset($buttonPaddingNew['top']) || 
                        isset($buttonPaddingNew['right']) || 
                        isset($buttonPaddingNew['bottom']) || 
                        isset($buttonPaddingNew['left'])
                    ) {
                        $buttonInlineStyles .= 'padding: ' .
                            (isset($buttonPaddingNew['top']) ? (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) : '0px') . ' ' .
                            (isset($buttonPaddingNew['right']) ? (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) : '0px') . ' ' .
                            (isset($buttonPaddingNew['bottom']) ? (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) : '0px') . ' ' .
                            (isset($buttonPaddingNew['left']) ? (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) : '0px') . '; ';
                    } 

                    // Hover styles
                    $buttonHoverInlineStyles = '';
                    $buttonResetStyles = '';

                    if (!empty($buttonHoverTextColor)) {
                        $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                        $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                    }
                    if (!empty($buttonHoverBorderColor)) {
                        $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                        $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                    }
                    if (!empty($buttonHoverBackgroundColor)) {
                        $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                        $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                    }

                    // Button anchor tag
                    $output .= '<a class="fpg-btn ' . esc_attr($buttonStyle5) . '" href="' . esc_url(get_permalink()) . '" ' . $targetAttr . ' style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                    if (!empty($buttonHoverInlineStyles)) {
                        $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                    }

                    if (!empty($buttonResetStyles)) {
                        $output .= ' onmouseout="' . $buttonResetStyles . '"';
                    }

                    $output .= '>';

                    // Icon handling
                    $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                    $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                    $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                    if ($iconPosition === 'left' && $showButtonIcon) {
                        $output .= $leftIcon . ' ';
                    }

                    $output .= esc_html($readMoreLabel);

                    if ($iconPosition === 'right' && $showButtonIcon) {
                        $output .= ' ' . $rightIcon;
                    }

                    $output .= '</a></div>';
                }
                //end Footer
                $output .= '</div>';
                // End MAIN Content
                $output .= '</div>';
                // End Full post layout
                $output .= '</div>';
            }
            elseif ($sliderLayoutStyle === 'style6') {
                $borderStyles = '.fpg-blog-layout-23-item .fpg-blog-layout-23-overlay .fpg-btn.fpg-border::before {'; 
                $borderStyles .= 'background: ' . (!empty($buttonHoverTextColor) ? esc_attr($buttonHoverTextColor) : '#332FFF') . ';';
                $borderStyles .= '}';

                $output .= '<style>' . $borderStyles . '</style>';
                $output .= '<div class="swiper-slide">';
                // Full post layout
                $output .= '<div class="fpg-blog-layout-23-item align-' . $itemBoxAlignment6 . ' ' . $hoverAnimation . ' ' . $postLinkType . '" style="';
                    // MARGIN    
                    if (isset($itemMargin['top']) || isset($itemMargin['right']) || isset($itemMargin['bottom']) || isset($itemMargin['left'])) {
                        $output .= 'margin: ' .
                            (isset($itemMargin['top']) ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' .
                            (isset($itemMargin['right']) ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' .
                            (isset($itemMargin['bottom']) ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' .
                            (isset($itemMargin['left']) ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; ';
                    }

                    // PADDING
                    if (isset($itemPadding['top']) || isset($itemPadding['right']) || isset($itemPadding['bottom']) || isset($itemPadding['left'])) {
                        $output .= 'padding: ' .
                            (isset($itemPadding['top']) ? (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) : '0px') . ' ' .
                            (isset($itemPadding['right']) ? (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) : '0px') . ' ' .
                            (isset($itemPadding['bottom']) ? (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) : '0px') . ' ' .
                            (isset($itemPadding['left']) ? (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) : '0px') . '; ';
                    }

                    // BORDER RADIUS
                    if (isset($itemBorderRadius['top']) || isset($itemBorderRadius['right']) || isset($itemBorderRadius['bottom']) || isset($itemBorderRadius['left'])) {
                        $output .= 'border-radius: ' .
                            (isset($itemBorderRadius['top']) ? (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) : '0px') . ' ' .
                            (isset($itemBorderRadius['right']) ? (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) : '0px') . ' ' .
                            (isset($itemBorderRadius['bottom']) ? (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) : '0px') . ' ' .
                            (isset($itemBorderRadius['left']) ? (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) : '0px') . '; ';
                    }

                    // BORDER WIDTH
                    if (isset($itemBorderWidth['top']) || isset($itemBorderWidth['right']) || isset($itemBorderWidth['bottom']) || isset($itemBorderWidth['left'])) {
                        $output .= 'border-width: ' .
                            (isset($itemBorderWidth['top']) ? (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) : '0px') . ' ' .
                            (isset($itemBorderWidth['right']) ? (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) : '0px') . ' ' .
                            (isset($itemBorderWidth['bottom']) ? (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) : '0px') . ' ' .
                            (isset($itemBorderWidth['left']) ? (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) : '0px') . '; ';
                    }

                    // Border Style & Color
                    if (!empty($itemBorderType)) {
                        $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                    }
                    if (!empty($itemBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                    }

                    // Background Color
                    if (!empty($itemBackgroundColor)) {
                        $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                    }

                    // Box Shadow
                    if (
                        isset($itemBoxShadow['left']) ||  // horizontal offset
                        isset($itemBoxShadow['top']) ||  // vertical offset
                        isset($itemBoxShadow['right']) ||  // blur radius
                        isset($itemBoxShadow['bottom']) ||  // spread radius
                        isset($itemBoxShadowColor)
                    ) {
                        $output .= 'box-shadow: ' .
                            (isset($itemBoxShadow['left']) ? (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) : '0px') . ' ' .
                            (isset($itemBoxShadow['top']) ? (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) : '0px') . ' ' .
                            (isset($itemBoxShadow['right']) ? (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) : '0px') . ' ' .
                            (isset($itemBoxShadow['bottom']) ? (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) : '0px') . ' ' .
                            (!empty($itemBoxShadowColor) ? esc_attr($itemBoxShadowColor) : 'rgba(0,0,0,0.1)') . '; ';
                    }

                $output .= '">';
                // Thumbnail
                if ($thumbnail && $showThumbnail) {
                    $output .= '<div class="fpg-thumb" style="';

                    // MARGIN
                    if (
                        isset($thumbnailMargin['top']) ||
                        isset($thumbnailMargin['right']) ||
                        isset($thumbnailMargin['bottom']) ||
                        isset($thumbnailMargin['left'])
                    ) {
                        $output .= 'margin: ' .
                            (isset($thumbnailMargin['top']) ? (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) : '0px') . ' ' .
                            (isset($thumbnailMargin['right']) ? (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) : '0px') . ' ' .
                            (isset($thumbnailMargin['bottom']) ? (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) : '0px') . ' ' .
                            (isset($thumbnailMargin['left']) ? (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) : '0px') . '; ';
                    }

                    // PADDING
                    if (
                        isset($thumbnailPadding['top']) ||
                        isset($thumbnailPadding['right']) ||
                        isset($thumbnailPadding['bottom']) ||
                        isset($thumbnailPadding['left'])
                    ) {
                        $output .= 'padding: ' .
                            (isset($thumbnailPadding['top']) ? (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) : '0px') . ' ' .
                            (isset($thumbnailPadding['right']) ? (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) : '0px') . ' ' .
                            (isset($thumbnailPadding['bottom']) ? (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) : '0px') . ' ' .
                            (isset($thumbnailPadding['left']) ? (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) : '0px') . '; ';
                    }

                    // BORDER RADIUS
                    if (
                        isset($thumbnailBorderRadius['top']) ||
                        isset($thumbnailBorderRadius['right']) ||
                        isset($thumbnailBorderRadius['bottom']) ||
                        isset($thumbnailBorderRadius['left'])
                    ) {
                        $output .= 'border-radius: ' .
                            (isset($thumbnailBorderRadius['top']) ? (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) : '0px') . ' ' .
                            (isset($thumbnailBorderRadius['right']) ? (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) : '0px') . ' ' .
                            (isset($thumbnailBorderRadius['bottom']) ? (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) : '0px') . ' ' .
                            (isset($thumbnailBorderRadius['left']) ? (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) : '0px') . '; ';
                    }

                    $output .= '">';

                    // Anchor with optional border-radius and overflow
                    if ($thumbnailLink) {
                        $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '>';
                        $output .= $thumbnail;
                        $output .= '</a>';
                    } else {
                        $output .= $thumbnail;
                    }
                    $output .= '</div>';
                }
                // END Thumbnail
                
                // MAIN Content
                $output .= '<div class="fpg-blog-layout-23-overlay" style="';
                    // MARGIN
                    if (
                        isset($contentitemMarginNew['top']) ||
                        isset($contentitemMarginNew['right']) ||
                        isset($contentitemMarginNew['bottom']) ||
                        isset($contentitemMarginNew['left'])
                    ) {
                        $output .= 'margin: ' .
                            (isset($contentitemMarginNew['top']) ? (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) : '0px') . ' ' .
                            (isset($contentitemMarginNew['right']) ? (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) : '0px') . ' ' .
                            (isset($contentitemMarginNew['bottom']) ? (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) : '0px') . ' ' .
                            (isset($contentitemMarginNew['left']) ? (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) : '0px') . '; ';
                    }

                    // PADDING
                    if (
                        isset($contentitemPaddingNew['top']) ||
                        isset($contentitemPaddingNew['right']) ||
                        isset($contentitemPaddingNew['bottom']) ||
                        isset($contentitemPaddingNew['left'])
                    ) {
                        $output .= 'padding: ' .
                            (isset($contentitemPaddingNew['top']) ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' .
                            (isset($contentitemPaddingNew['right']) ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' .
                            (isset($contentitemPaddingNew['bottom']) ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' .
                            (isset($contentitemPaddingNew['left']) ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; ';
                    }

                    // BORDER WIDTH
                    if (
                        isset($contentBorderWidth['top']) ||
                        isset($contentBorderWidth['right']) ||
                        isset($contentBorderWidth['bottom']) ||
                        isset($contentBorderWidth['left'])
                    ) {
                        $output .= 'border-width: ' .
                            (isset($contentBorderWidth['top']) ? (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) : '0px') . ' ' .
                            (isset($contentBorderWidth['right']) ? (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) : '0px') . ' ' .
                            (isset($contentBorderWidth['bottom']) ? (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) : '0px') . ' ' .
                            (isset($contentBorderWidth['left']) ? (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) : '0px') . '; ';
                    }
                    // BORDER radius
                    if (
                        isset($contentitemRadius['top']) ||
                        isset($contentitemRadius['right']) ||
                        isset($contentitemRadius['bottom']) ||
                        isset($contentitemRadius['left'])
                    ) {
                        $output .= 'border-radius: ' .
                            (isset($contentitemRadius['top']) ? (is_numeric($contentitemRadius['top']) ? $contentitemRadius['top'] . 'px' : esc_attr($contentitemRadius['top'])) : '0px') . ' ' .
                            (isset($contentitemRadius['right']) ? (is_numeric($contentitemRadius['right']) ? $contentitemRadius['right'] . 'px' : esc_attr($contentitemRadius['right'])) : '0px') . ' ' .
                            (isset($contentitemRadius['bottom']) ? (is_numeric($contentitemRadius['bottom']) ? $contentitemRadius['bottom'] . 'px' : esc_attr($contentitemRadius['bottom'])) : '0px') . ' ' .
                            (isset($contentitemRadius['left']) ? (is_numeric($contentitemRadius['left']) ? $contentitemRadius['left'] . 'px' : esc_attr($contentitemRadius['left'])) : '0px') . '; ';
                    }
                    // Border Style
                    if (!empty($contentNormalBorderType)) {
                        $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                    }
                    // Background Color
                    if (!empty($contentBgColor)) {
                        $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                    }
                    // Border Color
                    if (!empty($contentBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                    }
                $output .= '">';
                
                // title
                if ($showPostTitle) {
                    $titleStyles = '';

                    // Order
                    if (!empty($titleOrder)) {
                        $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                    }

                    // Background color
                    if (!empty($postTitleBgColor)) {
                        $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                    }

                    // Margin
                    if (isset($postTitleMargin['top']) || isset($postTitleMargin['right']) || isset($postTitleMargin['bottom']) || isset($postTitleMargin['left'])) {
                        $titleStyles .= 'margin: ' .
                            (isset($postTitleMargin['top']) ? (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) : '0px') . ' ' .
                            (isset($postTitleMargin['right']) ? (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) : '0px') . ' ' .
                            (isset($postTitleMargin['bottom']) ? (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) : '0px') . ' ' .
                            (isset($postTitleMargin['left']) ? (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) : '0px') . '; ';
                    }

                    // Padding
                    if (isset($postTitlePadding['top']) || isset($postTitlePadding['right']) || isset($postTitlePadding['bottom']) || isset($postTitlePadding['left'])) {
                        $titleStyles .= 'padding: ' .
                            (isset($postTitlePadding['top']) ? (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) : '0px') . ' ' .
                            (isset($postTitlePadding['right']) ? (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) : '0px') . ' ' .
                            (isset($postTitlePadding['bottom']) ? (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) : '0px') . ' ' .
                            (isset($postTitlePadding['left']) ? (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) : '0px') . '; ';
                    }

                    // Determine if underline should be shown
                    $showUnderline = $postLinkType === 'yeslink' && $titleHoverUnderLine === 'enable';

                    // Class name
                    $classNames = 'title align-' . esc_attr($postTitleAlignment);
                    if ($showUnderline) {
                        $classNames .= ' underline';
                    }

                    // Hover/Out events for nolink
                    $onmouseover = '';
                    $onmouseout  = '';

                    if (!empty($postTitleHoverBgColor)) {
                        $onmouseover .= 'this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';';
                    }

                    if (!empty($postTitleHoverColor)) {
                        $onmouseover .= ' this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                    }

                    if (!empty($postTitleBgColor)) {
                        $onmouseout .= 'this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';';
                    } else {
                        $onmouseout .= 'this.style.removeProperty(\'background-color\');';
                    }

                    if (!empty($postTitleColor)) {
                        $onmouseout .= ' this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                    } else {
                        $onmouseout .= ' this.style.removeProperty(\'color\');';
                    }

                    // Opening title tag
                    $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"'
                        . (!empty($onmouseover) ? ' onmouseover="' . trim($onmouseover) . '"' : '')
                        . (!empty($onmouseout)  ? ' onmouseout="'  . trim($onmouseout)  . '"' : '') . '>';

                    if ($postLinkType === 'yeslink') {
                        // Anchor styles
                        $style = '';
                        $hoverStyle = '';
                        $mouseoutStyle = '';

                        if (!empty($postTitleFontSize)) {
                            $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                        }

                        if (!empty($postTitleLineHeight)) {
                            $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                        }

                        if (!empty($postTitleLetterSpacing)) {
                            $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                        }

                        if (!empty($postTitleFontWeight)) {
                            $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                        }

                        if (!empty($postTitleColor)) {
                            $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                            $mouseoutStyle .= 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                        } else {
                            $mouseoutStyle .= 'this.style.color=\'\';';
                        }

                        if (!empty($postTitleHoverColor)) {
                            $hoverStyle .= 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                        }

                        if ($showUnderline && !empty($postTitleHoverColor)) {
                            $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                            $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                            $hoverStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                        }

                        if ($showUnderline && empty($postTitleColor ) && !empty($postTitleColor )) {
                            $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                            $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                            $mouseoutStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                        } else {
                            
                            $mouseoutStyle .= ' this.style.removeProperty(\'background-position\');';
                            $mouseoutStyle .= ' this.style.removeProperty(\'background-size\');';
                        }

                        $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '
                            style="' . esc_attr(trim($style)) . '"'
                            . (!empty($hoverStyle)   ? ' onmouseover="' . $hoverStyle . '"' : '')
                            . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                            . esc_html($croppedTitle) . '</a>';
                    } else {
                        // No link  render span with inline styles
                        $inlineStyle = '';
                        if (!empty($postTitleFontSize)) {
                            $inlineStyle .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                        }
                        if (!empty($postTitleLineHeight)) {
                            $inlineStyle .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                        }
                        if (!empty($postTitleLetterSpacing)) {
                            $inlineStyle .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                        }
                        if (!empty($postTitleFontWeight)) {
                            $inlineStyle .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                        }
                        if (!empty($postTitleColor)) {
                            $inlineStyle .= 'color: ' . esc_attr($postTitleColor) . '; ';
                        }

                        $output .= '<span style="' . esc_attr(trim($inlineStyle)) . '">' . esc_html($croppedTitle) . '</span>';
                    }

                    $output .= '</' . esc_attr($titleTag) . '>';
                }
                // Excerpt
                    if ($showPostExcerpt) {
                        $excerptStyles = '';
                        $excerptColorStyles = '';

                        // Order
                        if (!empty($excerptOrder)) {
                            $excerptStyles .= 'order: ' . esc_attr($excerptOrder) . '; ';
                        }

                        // Typography
                        if (!empty($excerptFontSize)) {
                            $excerptStyles .= 'font-size: ' . esc_attr($excerptFontSize) . 'px; ';
                        }

                        if (!empty($excerptLineHeight)) {
                            $excerptStyles .= 'line-height: ' . esc_attr($excerptLineHeight) . '; ';
                        }

                        if (!empty($excerptLetterSpacing)) {
                            $excerptStyles .= 'letter-spacing: ' . esc_attr($excerptLetterSpacing) . 'px; ';
                        }

                        if (!empty($excerptFontWeight)) {
                            $excerptStyles .= 'font-weight: ' . esc_attr($excerptFontWeight) . '; ';
                        }

                        if (!empty($excerptColor)) {
                            $excerptColorStyles .= 'color: ' . esc_attr($excerptColor) . '; ';
                        }

                        if (!empty($excerptBgColor)) {
                            $excerptColorStyles .= 'background-color: ' . esc_attr($excerptBgColor) . '; ';
                        }

                        if (!empty($excerptBorderType)) {
                            $excerptStyles .= 'border-style: ' . esc_attr($excerptBorderType) . '; ';
                        }

                        // Margin
                        if (isset($excerptMargin['top']) || isset($excerptMargin['right']) || isset($excerptMargin['bottom']) || isset($excerptMargin['left'])) {
                            $excerptStyles .= 'margin: ' .
                                (isset($excerptMargin['top']) ? (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) : '0px') . ' ' .
                                (isset($excerptMargin['right']) ? (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) : '0px') . ' ' .
                                (isset($excerptMargin['bottom']) ? (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) : '0px') . ' ' .
                                (isset($excerptMargin['left']) ? (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) : '0px') . '; ';
                        }

                        // Padding
                        if (isset($excerptPadding['top']) || isset($excerptPadding['right']) || isset($excerptPadding['bottom']) || isset($excerptPadding['left'])) {
                            $excerptStyles .= 'padding: ' .
                                (isset($excerptPadding['top']) ? (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) : '0px') . ' ' .
                                (isset($excerptPadding['right']) ? (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) : '0px') . ' ' .
                                (isset($excerptPadding['bottom']) ? (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) : '0px') . ' ' .
                                (isset($excerptPadding['left']) ? (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) : '0px') . '; ';
                        }

                        // Handle hover logic conditionally
                        $hoverIn = '';
                        $hoverOut = '';

                        if (!empty($excerptHoverColor)) {
                            $hoverIn .= 'this.style.color=\'' . esc_attr($excerptHoverColor) . '\';';
                            $hoverOut .= 'this.style.color=\'' . esc_attr($excerptColor) . '\';';
                        }

                        if (!empty($excerptHoverBgColor)) {
                            $hoverIn .= 'this.style.backgroundColor=\'' . esc_attr($excerptHoverBgColor) . '\';';
                            $hoverOut .= 'this.style.backgroundColor=\'' . esc_attr($excerptBgColor) . '\';';
                        }

                        $output .= '<div class="fpg-excerpt' . ' align-' . esc_attr($excerptAlignment) . '" style="' . esc_attr(trim($excerptStyles)) . '"';

                        $output .= '>';
                        $output .= '<p style="' . esc_attr(trim($excerptColorStyles)) . '"';

                            if (!empty($hoverIn) || !empty($hoverOut)) {
                                if (!empty($hoverIn)) {
                                    $output .= ' onmouseover="' . esc_attr($hoverIn) . '"';
                                }
                                if (!empty($hoverOut)) {
                                    $output .= ' onmouseout="' . esc_attr($hoverOut) . '"';
                                }
                            }

                            $output .= '>' . esc_html($excerpt) . '</p>';
                        $output .= '</div>';
                    }
                    // End Excerpt
                //Button
                if ($showReadMoreButton) {
                    // Button wrapper styles
                    $buttonWrapperStyle = '';

                    if (
                        isset($buttonMarginNew['top']) || 
                        isset($buttonMarginNew['right']) || 
                        isset($buttonMarginNew['bottom']) || 
                        isset($buttonMarginNew['left'])
                    ) {
                        $buttonWrapperStyle .= 'margin: ' .
                            (isset($buttonMarginNew['top']) ? (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) : '0px') . ' ' .
                            (isset($buttonMarginNew['right']) ? (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) : '0px') . ' ' .
                            (isset($buttonMarginNew['bottom']) ? (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) : '0px') . ' ' .
                            (isset($buttonMarginNew['left']) ? (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) : '0px') . '; ';
                    }

                    // Order
                    if (!empty($buttonOrder)) {
                        $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                    }
                   
                    $output .= '<div class="fpg-btn-box align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';

                    // Button inline styles
                    $buttonInlineStyles = '';

                    if (!empty($buttonTextColor)) {
                        $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                    }
                    if (!empty($buttonBackgroundColor)) {
                        $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                    }
                    if (!empty($buttonFontSize)) {
                        $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                    }
                    if (!empty($buttonFontWeight)) {
                        $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                    }
                    if (!empty($buttonBorderColor)) {
                        $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                    }
                    if (!empty($buttonBorderType)) {
                        $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                    }
                    // Border Width
     
                    // Hover styles
                    $buttonHoverInlineStyles = '';
                    $buttonResetStyles = '';

                    if (!empty($buttonHoverTextColor)) {
                        $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                        $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                    }
                    if (!empty($buttonHoverBorderColor)) {
                        $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                        $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                    }
                    if (!empty($buttonHoverBackgroundColor)) {
                        $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                        $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                    }

                    // Button anchor tag
                    $output .= '<a class="fpg-btn read-more ' . esc_attr($buttonStyle6) . '" href="' . esc_url(get_permalink()) . '" ' . $targetAttr . ' style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                    if (!empty($buttonHoverInlineStyles)) {
                        $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                    }

                    if (!empty($buttonResetStyles)) {
                        $output .= ' onmouseout="' . $buttonResetStyles . '"';
                    }

                    $output .= '>';

                    // Icon handling
                    $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                    $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                    $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                    if ($iconPosition === 'left' && $showButtonIcon) {
                        $output .= $leftIcon . ' ';
                    }

                    $output .= esc_html($readMoreLabel);

                    if ($iconPosition === 'right' && $showButtonIcon) {
                        $output .= ' ' . $rightIcon;
                    }

                    $output .= '</a></div>';
                }
                //end Footer
                $output .= '</div>';
                // End MAIN Content
                $output .= '</div>';
                // End Full post layout
                $output .= '</div>';
            }
            elseif ($sliderLayoutStyle === 'style7') {
                // Swiper Slide
                $borderStyles = '.fpg-blog-layout-28-item .fpg-content .fpg-btn.fpg-border::before {'; 
                $borderStyles .= 'background: ' . (!empty($buttonHoverTextColor) ? esc_attr($buttonHoverTextColor) : '#332FFF') . ';';
                $borderStyles .= '}';

                $output .= '<style>' . $borderStyles . '</style>';
                $output .= '<div class="swiper-slide">';
                // Full post layout
                $output .= '<div class="fpg-blog-layout-28-item align-' . $itemBoxAlignment7 . ' ' . $hoverAnimation . ' ' . $postLinkType . '" style="';
                    // MARGIN    
                    if (isset($itemMargin['top']) || isset($itemMargin['right']) || isset($itemMargin['bottom']) || isset($itemMargin['left'])) {
                        $output .= 'margin: ' .
                            (isset($itemMargin['top']) ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' .
                            (isset($itemMargin['right']) ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' .
                            (isset($itemMargin['bottom']) ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' .
                            (isset($itemMargin['left']) ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; ';
                    }

                    // PADDING
                    if (isset($itemPadding['top']) || isset($itemPadding['right']) || isset($itemPadding['bottom']) || isset($itemPadding['left'])) {
                        $output .= 'padding: ' .
                            (isset($itemPadding['top']) ? (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) : '0px') . ' ' .
                            (isset($itemPadding['right']) ? (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) : '0px') . ' ' .
                            (isset($itemPadding['bottom']) ? (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) : '0px') . ' ' .
                            (isset($itemPadding['left']) ? (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) : '0px') . '; ';
                    }

                    // BORDER RADIUS
                    if (isset($itemBorderRadius['top']) || isset($itemBorderRadius['right']) || isset($itemBorderRadius['bottom']) || isset($itemBorderRadius['left'])) {
                        $output .= 'border-radius: ' .
                            (isset($itemBorderRadius['top']) ? (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) : '0px') . ' ' .
                            (isset($itemBorderRadius['right']) ? (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) : '0px') . ' ' .
                            (isset($itemBorderRadius['bottom']) ? (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) : '0px') . ' ' .
                            (isset($itemBorderRadius['left']) ? (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) : '0px') . '; ';
                    }

                    // BORDER WIDTH
                    if (isset($itemBorderWidth['top']) || isset($itemBorderWidth['right']) || isset($itemBorderWidth['bottom']) || isset($itemBorderWidth['left'])) {
                        $output .= 'border-width: ' .
                            (isset($itemBorderWidth['top']) ? (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) : '0px') . ' ' .
                            (isset($itemBorderWidth['right']) ? (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) : '0px') . ' ' .
                            (isset($itemBorderWidth['bottom']) ? (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) : '0px') . ' ' .
                            (isset($itemBorderWidth['left']) ? (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) : '0px') . '; ';
                    }
                    // Border Style & Color
                    if (!empty($itemBorderType)) {
                        $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                    }
                    if (!empty($itemBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                    }

                    // Background Color
                    if (!empty($itemBackgroundColor)) {
                        $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                    }

                    // Box Shadow
                    if (
                        isset($itemBoxShadow['left']) ||  // horizontal offset
                        isset($itemBoxShadow['top']) ||  // vertical offset
                        isset($itemBoxShadow['right']) ||  // blur radius
                        isset($itemBoxShadow['bottom']) ||  // spread radius
                        isset($itemBoxShadowColor)
                    ) {
                        $output .= 'box-shadow: ' .
                            (isset($itemBoxShadow['left']) ? (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) : '0px') . ' ' .
                            (isset($itemBoxShadow['top']) ? (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) : '0px') . ' ' .
                            (isset($itemBoxShadow['right']) ? (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) : '0px') . ' ' .
                            (isset($itemBoxShadow['bottom']) ? (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) : '0px') . ' ' .
                            (!empty($itemBoxShadowColor) ? esc_attr($itemBoxShadowColor) : 'rgba(0,0,0,0.1)') . '; ';
                    }

                $output .= '">';

                // Thumbnail
                if ($thumbnail && $showThumbnail) {

                    $output .= '<div class="fpg-thumb" style="';
                        // MARGIN
                        if (
                            isset($thumbnailMargin['top']) ||
                            isset($thumbnailMargin['right']) ||
                            isset($thumbnailMargin['bottom']) ||
                            isset($thumbnailMargin['left'])
                        ) {
                            $output .= 'margin: ' .
                                (isset($thumbnailMargin['top']) ? (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) : '0px') . ' ' .
                                (isset($thumbnailMargin['right']) ? (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) : '0px') . ' ' .
                                (isset($thumbnailMargin['bottom']) ? (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) : '0px') . ' ' .
                                (isset($thumbnailMargin['left']) ? (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) : '0px') . '; ';
                        }

                        // PADDING
                        if (
                            isset($thumbnailPadding['top']) ||
                            isset($thumbnailPadding['right']) ||
                            isset($thumbnailPadding['bottom']) ||
                            isset($thumbnailPadding['left'])
                        ) {
                            $output .= 'padding: ' .
                                (isset($thumbnailPadding['top']) ? (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) : '0px') . ' ' .
                                (isset($thumbnailPadding['right']) ? (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) : '0px') . ' ' .
                                (isset($thumbnailPadding['bottom']) ? (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) : '0px') . ' ' .
                                (isset($thumbnailPadding['left']) ? (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) : '0px') . '; ';
                        }

                        // BORDER RADIUS
                        if (
                            isset($thumbnailBorderRadius['top']) ||
                            isset($thumbnailBorderRadius['right']) ||
                            isset($thumbnailBorderRadius['bottom']) ||
                            isset($thumbnailBorderRadius['left'])
                        ) {
                            $output .= 'border-radius: ' .
                                (isset($thumbnailBorderRadius['top']) ? (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) : '0px') . ' ' .
                                (isset($thumbnailBorderRadius['right']) ? (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) : '0px') . ' ' .
                                (isset($thumbnailBorderRadius['bottom']) ? (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) : '0px') . ' ' .
                                (isset($thumbnailBorderRadius['left']) ? (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) : '0px') . '; ';
                        }

                    $output .= '">';
                    
                    // Anchor with optional border-radius and overflow
                    if ($thumbnailLink) {
                        $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '>';
                        $output .= $thumbnail;
                        $output .= '</a>';
                    } else {
                        $output .= $thumbnail;
                    }
                
                    // Now Insert Meta Data inside the Thumbnail
                    if ($showMetaData) {
                        
                        $output .= '<div class="fpg-meta align-' . esc_attr($metaAlignment) . '"';

                        $metaStyle = '';
                        if (!empty($metaBgColor)) {
                            $metaStyle .= 'background-color: ' . esc_attr($metaBgColor) . '; ';
                        }

                        if (!empty($metaStyle)) {
                            $output .= ' style="' . trim($metaStyle) . '"';
                        }

                        $output .= '>';
                            $output .= '<ul class="meta-data-list " style="';  
                                // MARGIN
                                if (
                                    isset($metaMarginNew['top']) ||
                                    isset($metaMarginNew['right']) ||
                                    isset($metaMarginNew['bottom']) ||
                                    isset($metaMarginNew['left'])
                                ) {
                                    $output .= 'margin: ' .
                                        (isset($metaMarginNew['top']) ? (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) : '0px') . ' ' .
                                        (isset($metaMarginNew['right']) ? (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) : '0px') . ' ' .
                                        (isset($metaMarginNew['bottom']) ? (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) : '0px') . ' ' .
                                        (isset($metaMarginNew['left']) ? (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) : '0px') . '; ';
                                }

                                // PADDING
                                if (
                                    isset($metaPadding['top']) ||
                                    isset($metaPadding['right']) ||
                                    isset($metaPadding['bottom']) ||
                                    isset($metaPadding['left'])
                                ) {
                                    $output .= 'padding: ' .
                                        (isset($metaPadding['top']) ? (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) : '0px') . ' ' .
                                        (isset($metaPadding['right']) ? (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) : '0px') . ' ' .
                                        (isset($metaPadding['bottom']) ? (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) : '0px') . ' ' .
                                        (isset($metaPadding['left']) ? (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) : '0px') . '; ';
                                } 
                                                
                                // Color
                                if (!empty($metaTextColor)) {
                                    $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                                }
                                // Order
                                if (!empty($metaOrder)) {
                                    $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                                }
                            $output .= '">';

                                $meta_items = [];

                                // Date
                                if ($showPostDate) {
                                    $meta = '<li class="meta-date" style="';

                                    // Color
                                    if (!empty($metaTextColor)) {
                                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                    }

                                    // Font size
                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '">';

                                    // Icon
                                    if ($showPostDateIcon && $showMetaIcon) {
                                        $meta .= '<i class="fas fa-calendar-alt" style="';

                                        if (!empty($metaIconColor)) {
                                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '"></i> ';
                                    }

                                    $meta .= esc_html($getdate) . '</li>';
                                    $meta_items[] = $meta;
                                }
                                // Author
                                if ($showPostAuthor) {
                                    $meta = '<li class="meta-author" style="';

                                    if (!empty($metaTextColor)) {
                                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                    }

                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '">';

                                    if ($showPostAuthorIcon && $showMetaIcon) {
                                        $meta .= '<i class="fas fa-user" style="';

                                        if (!empty($metaIconColor)) {
                                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '"></i> ';
                                    }

                                    $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                                    $meta_items[] = $meta;
                                }
                                // Category
                                if ($showPostCategory) {
                                    $meta = '<li class="meta-categories" style="';

                                    if (!empty($metaTextColor)) {
                                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                    }

                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '">';

                                    if ($showPostCategoryIcon && $showMetaIcon) {
                                        $meta .= '<i class="fas fa-folder" style="';

                                        if (!empty($metaIconColor)) {
                                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '"></i> ';
                                    }

                                    // Get category names without links
                                    $categories_list = get_the_category($post_id);
                                    if (!empty($categories_list)) {
                                        $category_names = array();
                                        foreach ($categories_list as $category) {
                                            $category_names[] = esc_html($category->name);
                                        }
                                        $meta .= implode(', ', $category_names); // comma-separated plain text categories
                                    }

                                    $meta .= '</li>';
                                    $meta_items[] = $meta;
                                }
                                // Tags
                                if ($showPostTags && !empty($tags)) {
                                    $meta = '<li class="meta-tags" style="';

                                    if (!empty($metaTextColor)) {
                                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                    }

                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '">';

                                    if ($showPostTagsIcon && $showMetaIcon) {
                                        $meta .= '<i class="fas fa-tags" style="';

                                        if (!empty($metaIconColor)) {
                                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '"></i> ';
                                    }

                                    $meta .= esc_html__('Tags:', 'fancy-post-grid') . ' ' . $tags . '</li>';
                                    $meta_items[] = $meta;
                                }
                                // Comment Count
                                if ($showPostCommentsCount) {
                                    $meta = '<li class="meta-comment-count" style="';
                                    if (!empty($metaTextColor)) {
                                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                    }
                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '">';

                                    if ($showPostCommentsCountIcon && $showMetaIcon) {
                                        $meta .= '<i class="fas fa-comments" style="';
                                        if (!empty($metaIconColor)) {
                                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                        }
                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }
                                        $meta .= '"></i> ';
                                    }

                                    $meta .= esc_html($comments_count) . ' ' . esc_html__('Comments', 'fancy-post-grid') . '</li>';
                                    $meta_items[] = $meta;
                                }
                                // Now join meta items with the separator
                                if (!empty($meta_items)) {
                                    $separator = '';

                                    if ($metaSeperator !== '') {
                                        $separator = '';
                                        if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                            $separatorStyle = '';
                                            if (!empty($separatorColor)) {
                                                $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                            }
                                            if (!empty($metaFontSize)) {
                                                $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                                        }
                                    }

                                    $output .= implode($separator, $meta_items);
                                }
                            $output .= '</ul>'; // ul Close 
                        $output .= '</div>'; // Close meta-data-list
                    }

                    $output .= '</div>'; // Close fancy-post-image fpg-thumb
                }
                // END Thumbnail
                
                // MAIN Content
                $output .= '<div class="fpg-content" style="';
                    // MARGIN
                    if (
                        isset($contentitemMarginNew['top']) ||
                        isset($contentitemMarginNew['right']) ||
                        isset($contentitemMarginNew['bottom']) ||
                        isset($contentitemMarginNew['left'])
                    ) {
                        $output .= 'margin: ' .
                            (isset($contentitemMarginNew['top']) ? (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) : '0px') . ' ' .
                            (isset($contentitemMarginNew['right']) ? (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) : '0px') . ' ' .
                            (isset($contentitemMarginNew['bottom']) ? (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) : '0px') . ' ' .
                            (isset($contentitemMarginNew['left']) ? (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) : '0px') . '; ';
                    }

                    // PADDING
                    if (
                        isset($contentitemPaddingNew['top']) ||
                        isset($contentitemPaddingNew['right']) ||
                        isset($contentitemPaddingNew['bottom']) ||
                        isset($contentitemPaddingNew['left'])
                    ) {
                        $output .= 'padding: ' .
                            (isset($contentitemPaddingNew['top']) ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' .
                            (isset($contentitemPaddingNew['right']) ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' .
                            (isset($contentitemPaddingNew['bottom']) ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' .
                            (isset($contentitemPaddingNew['left']) ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; ';
                    }

                    // BORDER WIDTH
                    if (
                        isset($contentBorderWidth['top']) ||
                        isset($contentBorderWidth['right']) ||
                        isset($contentBorderWidth['bottom']) ||
                        isset($contentBorderWidth['left'])
                    ) {
                        $output .= 'border-width: ' .
                            (isset($contentBorderWidth['top']) ? (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) : '0px') . ' ' .
                            (isset($contentBorderWidth['right']) ? (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) : '0px') . ' ' .
                            (isset($contentBorderWidth['bottom']) ? (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) : '0px') . ' ' .
                            (isset($contentBorderWidth['left']) ? (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) : '0px') . '; ';
                    }
                    // BORDER radius
                    if (
                        isset($contentitemRadius['top']) ||
                        isset($contentitemRadius['right']) ||
                        isset($contentitemRadius['bottom']) ||
                        isset($contentitemRadius['left'])
                    ) {
                        $output .= 'border-radius: ' .
                            (isset($contentitemRadius['top']) ? (is_numeric($contentitemRadius['top']) ? $contentitemRadius['top'] . 'px' : esc_attr($contentitemRadius['top'])) : '0px') . ' ' .
                            (isset($contentitemRadius['right']) ? (is_numeric($contentitemRadius['right']) ? $contentitemRadius['right'] . 'px' : esc_attr($contentitemRadius['right'])) : '0px') . ' ' .
                            (isset($contentitemRadius['bottom']) ? (is_numeric($contentitemRadius['bottom']) ? $contentitemRadius['bottom'] . 'px' : esc_attr($contentitemRadius['bottom'])) : '0px') . ' ' .
                            (isset($contentitemRadius['left']) ? (is_numeric($contentitemRadius['left']) ? $contentitemRadius['left'] . 'px' : esc_attr($contentitemRadius['left'])) : '0px') . '; ';
                    }
                    // Border Style
                    if (!empty($contentNormalBorderType)) {
                        $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                    }
                    // Background Color
                    if (!empty($contentBgColor)) {
                        $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                    }
                    // Border Color
                    if (!empty($contentBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                    }
                $output .= '">';

                    // title
                    if ($showPostTitle) {
                        $titleStyles = '';

                        // Order
                        if (!empty($titleOrder)) {
                            $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                        }

                        // Background color
                        if (!empty($postTitleBgColor)) {
                            $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                        }

                        // Margin
                        if (isset($postTitleMargin['top']) || isset($postTitleMargin['right']) || isset($postTitleMargin['bottom']) || isset($postTitleMargin['left'])) {
                            $titleStyles .= 'margin: ' .
                                (isset($postTitleMargin['top']) ? (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) : '0px') . ' ' .
                                (isset($postTitleMargin['right']) ? (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) : '0px') . ' ' .
                                (isset($postTitleMargin['bottom']) ? (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) : '0px') . ' ' .
                                (isset($postTitleMargin['left']) ? (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) : '0px') . '; ';
                        }

                        // Padding
                        if (isset($postTitlePadding['top']) || isset($postTitlePadding['right']) || isset($postTitlePadding['bottom']) || isset($postTitlePadding['left'])) {
                            $titleStyles .= 'padding: ' .
                                (isset($postTitlePadding['top']) ? (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) : '0px') . ' ' .
                                (isset($postTitlePadding['right']) ? (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) : '0px') . ' ' .
                                (isset($postTitlePadding['bottom']) ? (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) : '0px') . ' ' .
                                (isset($postTitlePadding['left']) ? (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) : '0px') . '; ';
                        }

                        // Determine if underline should be shown
                        $showUnderline = $postLinkType === 'yeslink' && $titleHoverUnderLine === 'enable';

                        // Class name
                        $classNames = 'title align-' . esc_attr($postTitleAlignment);
                        if ($showUnderline) {
                            $classNames .= ' underline';
                        }

                        // Hover/Out events for nolink
                        $onmouseover = '';
                        $onmouseout  = '';

                        if (!empty($postTitleHoverBgColor)) {
                            $onmouseover .= 'this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';';
                        }

                        if (!empty($postTitleHoverColor)) {
                            $onmouseover .= ' this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                        }

                        if (!empty($postTitleBgColor)) {
                            $onmouseout .= 'this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';';
                        } else {
                            $onmouseout .= 'this.style.removeProperty(\'background-color\');';
                        }

                        if (!empty($postTitleColor)) {
                            $onmouseout .= ' this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                        } else {
                            $onmouseout .= ' this.style.removeProperty(\'color\');';
                        }

                        // Opening title tag
                        $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"'
                            . (!empty($onmouseover) ? ' onmouseover="' . trim($onmouseover) . '"' : '')
                            . (!empty($onmouseout)  ? ' onmouseout="'  . trim($onmouseout)  . '"' : '') . '>';

                        if ($postLinkType === 'yeslink') {
                            // Anchor styles
                            $style = '';
                            $hoverStyle = '';
                            $mouseoutStyle = '';

                            if (!empty($postTitleFontSize)) {
                                $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                            }

                            if (!empty($postTitleLineHeight)) {
                                $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                            }

                            if (!empty($postTitleLetterSpacing)) {
                                $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                            }

                            if (!empty($postTitleFontWeight)) {
                                $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                            }

                            if (!empty($postTitleColor)) {
                                $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                $mouseoutStyle .= 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                            } else {
                                $mouseoutStyle .= 'this.style.color=\'\';';
                            }

                            if (!empty($postTitleHoverColor)) {
                                $hoverStyle .= 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                            }

                            if ($showUnderline && !empty($postTitleHoverColor)) {
                                $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                                $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                $hoverStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                            }

                            if ($showUnderline && empty($postTitleColor ) && !empty($postTitleColor )) {
                                $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                                $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                $mouseoutStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                            } else {
                                
                                $mouseoutStyle .= ' this.style.removeProperty(\'background-position\');';
                                $mouseoutStyle .= ' this.style.removeProperty(\'background-size\');';
                            }

                            $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '
                                style="' . esc_attr(trim($style)) . '"'
                                . (!empty($hoverStyle)   ? ' onmouseover="' . $hoverStyle . '"' : '')
                                . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                . esc_html($croppedTitle) . '</a>';
                        } else {
                            // No link  render span with inline styles
                            $inlineStyle = '';
                            if (!empty($postTitleFontSize)) {
                                $inlineStyle .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                            }
                            if (!empty($postTitleLineHeight)) {
                                $inlineStyle .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                            }
                            if (!empty($postTitleLetterSpacing)) {
                                $inlineStyle .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                            }
                            if (!empty($postTitleFontWeight)) {
                                $inlineStyle .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                            }
                            if (!empty($postTitleColor)) {
                                $inlineStyle .= 'color: ' . esc_attr($postTitleColor) . '; ';
                            }

                            $output .= '<span style="' . esc_attr(trim($inlineStyle)) . '">' . esc_html($croppedTitle) . '</span>';
                        }

                        $output .= '</' . esc_attr($titleTag) . '>';
                    }

                    // Excerpt
                    if ($showPostExcerpt) {
                        $excerptStyles = '';
                        $excerptColorStyles = '';

                        // Order
                        if (!empty($excerptOrder)) {
                            $excerptStyles .= 'order: ' . esc_attr($excerptOrder) . '; ';
                        }

                        // Typography
                        if (!empty($excerptFontSize)) {
                            $excerptStyles .= 'font-size: ' . esc_attr($excerptFontSize) . 'px; ';
                        }

                        if (!empty($excerptLineHeight)) {
                            $excerptStyles .= 'line-height: ' . esc_attr($excerptLineHeight) . '; ';
                        }

                        if (!empty($excerptLetterSpacing)) {
                            $excerptStyles .= 'letter-spacing: ' . esc_attr($excerptLetterSpacing) . 'px; ';
                        }

                        if (!empty($excerptFontWeight)) {
                            $excerptStyles .= 'font-weight: ' . esc_attr($excerptFontWeight) . '; ';
                        }

                        if (!empty($excerptColor)) {
                            $excerptColorStyles .= 'color: ' . esc_attr($excerptColor) . '; ';
                        }

                        if (!empty($excerptBgColor)) {
                            $excerptColorStyles .= 'background-color: ' . esc_attr($excerptBgColor) . '; ';
                        }

                        if (!empty($excerptBorderType)) {
                            $excerptStyles .= 'border-style: ' . esc_attr($excerptBorderType) . '; ';
                        }

                        // Margin
                        if (isset($excerptMargin['top']) || isset($excerptMargin['right']) || isset($excerptMargin['bottom']) || isset($excerptMargin['left'])) {
                            $excerptStyles .= 'margin: ' .
                                (isset($excerptMargin['top']) ? (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) : '0px') . ' ' .
                                (isset($excerptMargin['right']) ? (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) : '0px') . ' ' .
                                (isset($excerptMargin['bottom']) ? (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) : '0px') . ' ' .
                                (isset($excerptMargin['left']) ? (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) : '0px') . '; ';
                        }

                        // Padding
                        if (isset($excerptPadding['top']) || isset($excerptPadding['right']) || isset($excerptPadding['bottom']) || isset($excerptPadding['left'])) {
                            $excerptStyles .= 'padding: ' .
                                (isset($excerptPadding['top']) ? (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) : '0px') . ' ' .
                                (isset($excerptPadding['right']) ? (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) : '0px') . ' ' .
                                (isset($excerptPadding['bottom']) ? (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) : '0px') . ' ' .
                                (isset($excerptPadding['left']) ? (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) : '0px') . '; ';
                        }

                        // Handle hover logic conditionally
                        $hoverIn = '';
                        $hoverOut = '';

                        if (!empty($excerptHoverColor)) {
                            $hoverIn .= 'this.style.color=\'' . esc_attr($excerptHoverColor) . '\';';
                            $hoverOut .= 'this.style.color=\'' . esc_attr($excerptColor) . '\';';
                        }

                        if (!empty($excerptHoverBgColor)) {
                            $hoverIn .= 'this.style.backgroundColor=\'' . esc_attr($excerptHoverBgColor) . '\';';
                            $hoverOut .= 'this.style.backgroundColor=\'' . esc_attr($excerptBgColor) . '\';';
                        }

                        $output .= '<div class="fpg-excerpt' . ' align-' . esc_attr($excerptAlignment) . '" style="' . esc_attr(trim($excerptStyles)) . '"';

                        $output .= '>';
                        $output .= '<p style="' . esc_attr(trim($excerptColorStyles)) . '"';

                            if (!empty($hoverIn) || !empty($hoverOut)) {
                                if (!empty($hoverIn)) {
                                    $output .= ' onmouseover="' . esc_attr($hoverIn) . '"';
                                }
                                if (!empty($hoverOut)) {
                                    $output .= ' onmouseout="' . esc_attr($hoverOut) . '"';
                                }
                            }

                            $output .= '>' . esc_html($excerpt) . '</p>';
                        $output .= '</div>';
                    }
                    // End Excerpt
                    
                    // Button Output                
                    if ($showReadMoreButton) {
                        // Button wrapper styles
                        $buttonWrapperStyle = '';

                        if (
                            isset($buttonMarginNew['top']) || 
                            isset($buttonMarginNew['right']) || 
                            isset($buttonMarginNew['bottom']) || 
                            isset($buttonMarginNew['left'])
                        ) {
                            $buttonWrapperStyle .= 'margin: ' .
                                (isset($buttonMarginNew['top']) ? (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) : '0px') . ' ' .
                                (isset($buttonMarginNew['right']) ? (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) : '0px') . ' ' .
                                (isset($buttonMarginNew['bottom']) ? (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) : '0px') . ' ' .
                                (isset($buttonMarginNew['left']) ? (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) : '0px') . '; ';
                        }

                        // Order
                        if (!empty($buttonOrder)) {
                            $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                        }

                       
                        $output .= '<div class="btn-wrapper align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';


                        // Button inline styles
                        $buttonInlineStyles = '';

                        if (!empty($buttonTextColor)) {
                            $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                        }
                        if (!empty($buttonBackgroundColor)) {
                            $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                        }
                        if (!empty($buttonFontSize)) {
                            $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                        }
                        if (!empty($buttonFontWeight)) {
                            $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                        }
                        if (!empty($buttonBorderColor)) {
                            $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                        }
                        if (!empty($buttonBorderType)) {
                            $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                        }

                        // Border Width
                        if (
                            isset($buttonBorderWidth['top']) || 
                            isset($buttonBorderWidth['right']) || 
                            isset($buttonBorderWidth['bottom']) || 
                            isset($buttonBorderWidth['left'])
                        ) {
                            $buttonInlineStyles .= 'border-width: ' .
                                (isset($buttonBorderWidth['top']) ? (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) : '0px') . ' ' .
                                (isset($buttonBorderWidth['right']) ? (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) : '0px') . ' ' .
                                (isset($buttonBorderWidth['bottom']) ? (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) : '0px') . ' ' .
                                (isset($buttonBorderWidth['left']) ? (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) : '0px') . '; ';
                        }

                        // Border Radius
                        if (
                            isset($buttonBorderRadius['top']) || 
                            isset($buttonBorderRadius['right']) || 
                            isset($buttonBorderRadius['bottom']) || 
                            isset($buttonBorderRadius['left'])
                        ) {
                            $buttonInlineStyles .= 'border-radius: ' .
                                (isset($buttonBorderRadius['top']) ? (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) : '0px') . ' ' .
                                (isset($buttonBorderRadius['right']) ? (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) : '0px') . ' ' .
                                (isset($buttonBorderRadius['bottom']) ? (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) : '0px') . ' ' .
                                (isset($buttonBorderRadius['left']) ? (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) : '0px') . '; ';
                        }

                        // Padding
                        if (
                            isset($buttonPaddingNew['top']) || 
                            isset($buttonPaddingNew['right']) || 
                            isset($buttonPaddingNew['bottom']) || 
                            isset($buttonPaddingNew['left'])
                        ) {
                            $buttonInlineStyles .= 'padding: ' .
                                (isset($buttonPaddingNew['top']) ? (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) : '0px') . ' ' .
                                (isset($buttonPaddingNew['right']) ? (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) : '0px') . ' ' .
                                (isset($buttonPaddingNew['bottom']) ? (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) : '0px') . ' ' .
                                (isset($buttonPaddingNew['left']) ? (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) : '0px') . '; ';
                        } 

                        // Hover styles
                        $buttonHoverInlineStyles = '';
                        $buttonResetStyles = '';

                        if (!empty($buttonHoverTextColor)) {
                            $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                            $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                        }
                        if (!empty($buttonHoverBorderColor)) {
                            $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                            $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                        }
                        if (!empty($buttonHoverBackgroundColor)) {
                            $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                            $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                        }

                        // Button anchor tag
                        $output .= '<a class="fpg-btn read-more ' . esc_attr($buttonStyle7) . '" href="' . esc_url(get_permalink()) . '" ' . $targetAttr . ' style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                        if (!empty($buttonHoverInlineStyles)) {
                            $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                        }

                        if (!empty($buttonResetStyles)) {
                            $output .= ' onmouseout="' . $buttonResetStyles . '"';
                        }

                        $output .= '>';

                        // Icon handling
                        $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                        $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                        $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                        if ($iconPosition === 'left' && $showButtonIcon) {
                            $output .= $leftIcon . ' ';
                        }

                        $output .= esc_html($readMoreLabel);

                        if ($iconPosition === 'right' && $showButtonIcon) {
                            $output .= ' ' . $rightIcon;
                        }

                        $output .= '</a></div>';
                    }
                    // End Button
                
                $output .= '</div>';
                // End MAIN Content
                $output .= '</div>';
                // End Full post layout
                $output .= '</div>';
                // Swiper Slide
            }
        }

        $output .= '</div>'; // close swiper-wrapper
        $output .= '</div>'; //close mySwiper
        // Add Swiper pagination if enabled
        if ($enablePagination && $pagination_class) {
            $output .= '<div class="swiper-pagination ' . esc_attr($pagination_class) . ' ' . esc_attr($unique_id) . '-' . esc_attr($pagination_class) . '"></div>';
        }

        // Add Swiper arrows if enabled
        if ($enableArrow) {
            // Inline background and size for visible button
            $arrowStyle = 'style="background: ' . esc_attr($arrowBgColorr) . ';"';

            // Inline JS hover/reset styles
            $hoverStyle = 'this.style.backgroundColor=\'' . esc_attr($arrowBgHoverColor) . '\';';
            $resetBgStyle = 'this.style.backgroundColor=\'' . esc_attr($arrowBgColorr) . '\';';

            // Output buttons with mouse events
            $output .= '<div class="swiper-button-next ' . esc_attr($unique_id) . '-next" ' . $arrowStyle . '
                onmouseover="' . $hoverStyle . '" 
                onmouseout="' . $resetBgStyle . '"></div>';

            $output .= '<div class="swiper-button-prev ' . esc_attr($unique_id) . '-prev" ' . $arrowStyle . '
                onmouseover="' . $hoverStyle . '" 
                onmouseout="' . $resetBgStyle . '"></div>';

            // Output style for pseudo-elements (for arrows themselves)
            $output .= '<style>
                .swiper-button-prev::after,
                .swiper-button-next::after {
                    color: ' . esc_attr($arrowColor) . ' !important;
                    font-size: ' . esc_attr($arrowFontSize) . 'px !important;
                }
                .swiper-button-prev:hover::after,
                .swiper-button-next:hover::after {
                    color: ' . esc_attr($arrowHoverColor) . ' !important;
                }
                .swiper_wrap .swiper-button-next, .swiper_wrap .swiper-button-prev{
                    height: ' . esc_attr($arrowHeight) . 'px !important;
                    width: ' . esc_attr($arrowWeight) . 'px !important;
                }
                .fpg-blog-layout-1 .swiper_wrap .swiper-button-prev,.fpg-blog-layout-1 .swiper_wrap .swiper-button-next,.fpg-blog-layout-2 .swiper_wrap .swiper-button-prev,.fpg-blog-layout-2 .swiper_wrap .swiper-button-next,.fpg-blog-layout-3 .swiper_wrap .swiper-button-prev,.fpg-blog-layout-3 .swiper_wrap .swiper-button-next,.fpg-blog-layout-4 .swiper_wrap .swiper-button-prev,.fpg-blog-layout-4 .swiper_wrap .swiper-button-next,.fpg-blog-layout-18 .swiper_wrap .swiper-button-prev,.fpg-blog-layout-18 .swiper_wrap .swiper-button-next,.fpg-blog-layout-23 .swiper_wrap .swiper-button-prev,.fpg-blog-layout-23 .swiper_wrap .swiper-button-next,.fpg-blog-layout-28 .swiper_wrap .swiper-button-prev,.fpg-blog-layout-28 .swiper_wrap .swiper-button-next{
                    
                    border-radius: ' .
                            (isset($arrowBorderRadius['top']) && $arrowBorderRadius['top'] !== '' ? (is_numeric($arrowBorderRadius['top']) ? $arrowBorderRadius['top'] . 'px' : esc_attr($arrowBorderRadius['top'])) : '50px') . ' ' .
                            (isset($arrowBorderRadius['right']) && $arrowBorderRadius['right'] !== '' ? (is_numeric($arrowBorderRadius['right']) ? $arrowBorderRadius['right'] . 'px' : esc_attr($arrowBorderRadius['right'])) : '50px') . ' ' .
                            (isset($arrowBorderRadius['bottom']) && $arrowBorderRadius['bottom'] !== '' ? (is_numeric($arrowBorderRadius['bottom']) ? $arrowBorderRadius['bottom'] . 'px' : esc_attr($arrowBorderRadius['bottom'])) : '50px') . ' ' .
                            (isset($arrowBorderRadius['left']) && $arrowBorderRadius['left'] !== '' ? (is_numeric($arrowBorderRadius['left']) ? $arrowBorderRadius['left'] . 'px' : esc_attr($arrowBorderRadius['left'])) : '50px') . ';
                    
                }
            </style>';
        }

        $output .= '</div>'; //close swiper_wrap
        $output .= '</div>'; // close col-lg-12
        $output .= '</div>'; //close row

        // Pagination & navigation
        
        $output .= '<style>

            .fpg-blog-layout-1 .swiper_wrap .swiper-pagination .swiper-pagination-bullet,.fpg-blog-layout-2 .swiper_wrap .swiper-pagination .swiper-pagination-bullet,.fpg-blog-layout-3 .swiper_wrap .swiper-pagination .swiper-pagination-bullet,.fpg-blog-layout-4 .swiper_wrap .swiper-pagination .swiper-pagination-bullet,.fpg-blog-layout-18 .swiper_wrap .swiper-pagination .swiper-pagination-bullet,.fpg-blog-layout-23 .swiper_wrap .swiper-pagination .swiper-pagination-bullet,.fpg-blog-layout-28 .swiper_wrap .swiper-pagination .swiper-pagination-bullet{
                background: ' . esc_attr($sliderDots) . ';
                height: ' . esc_attr($bulletHeight) . 'px !important;
                width: ' . esc_attr($bulletWeight) . 'px !important;
                border-radius: ' .
                            (isset($bulletsRadius['top']) && $bulletsRadius['top'] !== '' ? (is_numeric($bulletsRadius['top']) ? $bulletsRadius['top'] . 'px' : esc_attr($bulletsRadius['top'])) : '0px') . ' ' .
                            (isset($bulletsRadius['right']) && $bulletsRadius['right'] !== '' ? (is_numeric($bulletsRadius['right']) ? $bulletsRadius['right'] . 'px' : esc_attr($bulletsRadius['right'])) : '0px') . ' ' .
                            (isset($bulletsRadius['bottom']) && $bulletsRadius['bottom'] !== '' ? (is_numeric($bulletsRadius['bottom']) ? $bulletsRadius['bottom'] . 'px' : esc_attr($bulletsRadius['bottom'])) : '0px') . ' ' .
                            (isset($bulletsRadius['left']) && $bulletsRadius['left'] !== '' ? (is_numeric($bulletsRadius['left']) ? $bulletsRadius['left'] . 'px' : esc_attr($bulletsRadius['left'])) : '0px') . ';
                opacity: 1;
            }
            .fpg-blog-layout-1 .swiper_wrap .swiper-pagination .swiper-pagination-bullet.swiper-pagination-bullet-active, .fpg-blog-layout-1 .swiper_wrap .swiper-pagination .swiper-pagination-bullet:hover,.fpg-blog-layout-2 .swiper_wrap .swiper-pagination .swiper-pagination-bullet.swiper-pagination-bullet-active, .fpg-blog-layout-2 .swiper_wrap .swiper-pagination .swiper-pagination-bullet:hover,.fpg-blog-layout-3 .swiper_wrap .swiper-pagination .swiper-pagination-bullet.swiper-pagination-bullet-active, .fpg-blog-layout-3 .swiper_wrap .swiper-pagination .swiper-pagination-bullet:hover,.fpg-blog-layout-4 .swiper_wrap .swiper-pagination .swiper-pagination-bullet.swiper-pagination-bullet-active, .fpg-blog-layout-4 .swiper_wrap .swiper-pagination .swiper-pagination-bullet:hover,.fpg-blog-layout-18 .swiper_wrap .swiper-pagination .swiper-pagination-bullet.swiper-pagination-bullet-active, .fpg-blog-layout-18 .swiper_wrap .swiper-pagination .swiper-pagination-bullet:hover,.fpg-blog-layout-23 .swiper_wrap .swiper-pagination .swiper-pagination-bullet.swiper-pagination-bullet-active, .fpg-blog-layout-23 .swiper_wrap .swiper-pagination .swiper-pagination-bullet:hover,.fpg-blog-layout-28 .swiper_wrap .swiper-pagination .swiper-pagination-bullet.swiper-pagination-bullet-active, .fpg-blog-layout-28 .swiper_wrap .swiper-pagination .swiper-pagination-bullet:hover {
                background: ' . esc_attr($sliderDotsActive) . ';
            }
            .swiper_wrap .swiper-pagination-fraction {
                color: ' . esc_attr($fractionCurrentColor) . ';
                font-size: ' . esc_attr($fractionFontSize) . 'px !important;
                opacity: 1;   
            }
            .fpg-blog-layout-1 .swiper_wrap .swiper-pagination-progressbar,.fpg-blog-layout-2 .swiper_wrap .swiper-pagination-progressbar,.fpg-blog-layout-3 .swiper_wrap .swiper-pagination-progressbar,.fpg-blog-layout-4 .swiper_wrap .swiper-pagination-progressbar,.fpg-blog-layout-18 .swiper_wrap .swiper-pagination-progressbar,.fpg-blog-layout-23 .swiper_wrap .swiper-pagination-progressbar,.fpg-blog-layout-28 .swiper_wrap .swiper-pagination-progressbar {
                background: ' . esc_attr($normalProcessColor) . ';
                opacity: 1;
            }
            .fpg-blog-layout-1 .swiper_wrap .swiper-pagination-progressbar .swiper-pagination-progressbar-fill,.fpg-blog-layout-2 .swiper_wrap .swiper-pagination-progressbar .swiper-pagination-progressbar-fill,.fpg-blog-layout-3 .swiper_wrap .swiper-pagination-progressbar .swiper-pagination-progressbar-fill,.fpg-blog-layout-4 .swiper_wrap .swiper-pagination-progressbar .swiper-pagination-progressbar-fill,.fpg-blog-layout-18 .swiper_wrap .swiper-pagination-progressbar .swiper-pagination-progressbar-fill,.fpg-blog-layout-23 .swiper_wrap .swiper-pagination-progressbar .swiper-pagination-progressbar-fill,.fpg-blog-layout-28 .swiper_wrap .swiper-pagination-progressbar .swiper-pagination-progressbar-fill {
                background: ' . esc_attr($activeProcessColor) . ';
                opacity: 1;
            }
            
        </style>';

        
        $output .= '</div>'; // main Style
        wp_reset_postdata();
        return $output;
    }

    public function fancy_post_list_render_callback($attributes) {
    
        // Content Layout
        $listLayoutStyle = isset($attributes['listLayoutStyle']) ? $attributes['listLayoutStyle'] : 'style1';
        
        //Query Builder
        $selectedCategories = isset($attributes['selectedCategories']) && is_array($attributes['selectedCategories'])
        ? array_map('absint', $attributes['selectedCategories'])
        : [];
        $selectedTags = isset($attributes['selectedTags']) && is_array($attributes['selectedTags'])
        ? array_map('absint', $attributes['selectedTags'])
        : [];
        $orderBy = isset($attributes['orderBy']) ? sanitize_text_field($attributes['orderBy']) : 'title';
        $postLimit = isset($attributes['postLimit']) ? absint($attributes['postLimit']) : 3;
          
        // Links
        $postLinkTarget = isset($attributes['postLinkTarget']) ? sanitize_text_field($attributes['postLinkTarget']) : '';
        $thumbnailLink = isset($attributes['thumbnailLink']) ? filter_var($attributes['thumbnailLink'], FILTER_VALIDATE_BOOLEAN) : true;
        $postLinkType = isset($attributes['postLinkType']) ? sanitize_text_field($attributes['postLinkType']) : 'yeslink';

        // Field Selector
        $showPostTitle = isset($attributes['showPostTitle']) ? filter_var($attributes['showPostTitle'], FILTER_VALIDATE_BOOLEAN) : true;
        $showThumbnail = isset($attributes['showThumbnail']) ? filter_var($attributes['showThumbnail'], FILTER_VALIDATE_BOOLEAN) : true;
        $showPostExcerpt = isset($attributes['showPostExcerpt']) ? filter_var($attributes['showPostExcerpt'], FILTER_VALIDATE_BOOLEAN) : true;
        $showReadMoreButton = isset($attributes['showReadMoreButton']) ? filter_var($attributes['showReadMoreButton'], FILTER_VALIDATE_BOOLEAN) : true;
        $showMetaData = isset($attributes['showMetaData']) ? filter_var($attributes['showMetaData'], FILTER_VALIDATE_BOOLEAN) : true;
        $showPostDate = isset($attributes['showPostDate']) ? filter_var($attributes['showPostDate'], FILTER_VALIDATE_BOOLEAN) : true;
        $showPostAuthor = isset($attributes['showPostAuthor']) ? filter_var($attributes['showPostAuthor'], FILTER_VALIDATE_BOOLEAN) : true;
        $showPostCategory = isset($attributes['showPostCategory']) ? filter_var($attributes['showPostCategory'], FILTER_VALIDATE_BOOLEAN) : true;
        $showPostTags = isset($attributes['showPostTags']) ? filter_var($attributes['showPostTags'], FILTER_VALIDATE_BOOLEAN) : false;
        $showPostCommentsCount = isset($attributes['showPostCommentsCount']) ? filter_var($attributes['showPostCommentsCount'], FILTER_VALIDATE_BOOLEAN) : false;
        $showMetaIcon = isset($attributes['showMetaIcon']) ? filter_var($attributes['showMetaIcon'], FILTER_VALIDATE_BOOLEAN) : true;
        $showPostDateIcon = isset($attributes['showPostDateIcon']) ? filter_var($attributes['showPostDateIcon'], FILTER_VALIDATE_BOOLEAN) : true;
        $showPostAuthorIcon = isset($attributes['showPostAuthorIcon']) ? filter_var($attributes['showPostAuthorIcon'], FILTER_VALIDATE_BOOLEAN) : true;
        $showPostCategoryIcon = isset($attributes['showPostCategoryIcon']) ? filter_var($attributes['showPostCategoryIcon'], FILTER_VALIDATE_BOOLEAN) : true;
        $showPostTagsIcon = isset($attributes['showPostTagsIcon']) ? filter_var($attributes['showPostTagsIcon'], FILTER_VALIDATE_BOOLEAN) : false;
        $showPostCommentsCountIcon = isset($attributes['showPostCommentsCountIcon']) ? filter_var($attributes['showPostCommentsCountIcon'], FILTER_VALIDATE_BOOLEAN) : false;

        // Order values
        $metaOrder = isset($attributes['metaOrder']) ? absint($attributes['metaOrder']) : '';
        $titleOrder = isset($attributes['titleOrder']) ? absint($attributes['titleOrder']) : '';
        $excerptOrder = isset($attributes['excerptOrder']) ? absint($attributes['excerptOrder']) : '';
        $buttonOrder = isset($attributes['buttonOrder']) ? absint($attributes['buttonOrder']) : '';

        // Post title settings
        $titleTag               = isset($attributes['titleTag']) ? sanitize_text_field($attributes['titleTag']) : 'h3';
        $titleHoverUnderLine    = isset($attributes['titleHoverUnderLine']) ? sanitize_text_field($attributes['titleHoverUnderLine']) : 'enable';
        $titleCropBy            = isset($attributes['titleCropBy']) ? sanitize_text_field($attributes['titleCropBy']) : 'word';
        $titleLength            = isset($attributes['titleLength']) ? absint($attributes['titleLength']) : 12;
        
        //THUMB sETTINGS
        $thumbnailSize = isset($attributes['thumbnailSize']) ? sanitize_text_field($attributes['thumbnailSize']) : '';
        $leftThumbnailSize = isset($attributes['leftThumbnailSize']) ? sanitize_text_field($attributes['leftThumbnailSize']) : '';
        $rightThumbnailSize = isset($attributes['rightThumbnailSize']) ? sanitize_text_field($attributes['rightThumbnailSize']) : '';
        $hoverAnimation = isset($attributes['hoverAnimation']) ? sanitize_text_field($attributes['hoverAnimation']) : 'hover-zoom_in';

        // Excerpt Settings
        $excerptType = isset($attributes['excerptType']) ? sanitize_text_field($attributes['excerptType']) : 'word';
        $excerptIndicator = isset($attributes['excerptIndicator']) ? sanitize_text_field($attributes['excerptIndicator']) : '...';
        $excerptLimit = isset($attributes['excerptLimit']) ? absint($attributes['excerptLimit']) : 10;
        // Meta data Settings
        $metaAuthorPrefix = isset($attributes['metaAuthorPrefix']) ? sanitize_text_field($attributes['metaAuthorPrefix']) : __('By', 'fancy-post-grid');
        $metaSeperator = isset($attributes['metaSeperator']) ? sanitize_text_field($attributes['metaSeperator']) : '';
        //Button Settings   
        $showButtonIcon = isset($attributes['showButtonIcon']) ? filter_var($attributes['showPostCommentsCountIcon'], FILTER_VALIDATE_BOOLEAN) : true;
        $iconPosition = isset($attributes['iconPosition']) ? sanitize_text_field($attributes['iconPosition']) : 'right';
        $buttonStyle = isset($attributes['buttonStyle']) ? sanitize_text_field($attributes['buttonStyle']) : '';
        $readMoreLabel = isset($attributes['readMoreLabel']) ? sanitize_text_field($attributes['readMoreLabel']) : __('Read More', 'fancy-post-grid');
        // SECTION Area
        $sectionBgColor    = isset($attributes['sectionBgColor']) ? sanitize_text_field($attributes['sectionBgColor']) : '';
        $sectionMargin = isset($attributes['sectionMargin']) ? $attributes['sectionMargin'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $sectionPadding = isset($attributes['sectionPadding']) ? $attributes['sectionPadding'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        // ITEM Box
        $itemPadding = isset($attributes['itemPadding']) ? $attributes['itemPadding'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $itemMargin = isset($attributes['itemMargin']) ? $attributes['itemMargin'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $itemBorderRadius = isset($attributes['itemBorderRadius']) ? $attributes['itemBorderRadius'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $itemBorderWidth = isset($attributes['itemBorderWidth']) ? $attributes['itemBorderWidth'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $itemBoxAlignment   = isset($attributes['itemBoxAlignment']) ? sanitize_text_field($attributes['itemBoxAlignment']) : 'start';
        $itemBorderType     = isset($attributes['itemBorderType']) ? sanitize_text_field($attributes['itemBorderType']) : '';
        $itemBoxShadow = isset($attributes['itemBoxShadow']) ? $attributes['itemBoxShadow'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $itemBackgroundColor = isset($attributes['itemBackgroundColor']) ? sanitize_text_field($attributes['itemBackgroundColor']) : '';
        $itemBorderColor    = isset($attributes['itemBorderColor']) ? sanitize_text_field($attributes['itemBorderColor']) : '';   
        $itemBoxShadowColor = isset($attributes['itemBoxShadowColor']) ? sanitize_text_field($attributes['itemBoxShadowColor']) : '';
        $itemGap      = isset($attributes['itemGap']) ? absint($attributes['itemGap']) : '';

        // Content Box
        $contentitemPaddingNew = isset($attributes['contentitemPaddingNew']) ? $attributes['contentitemPaddingNew'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $contentitemMarginNew = isset($attributes['contentitemMarginNew']) ? $attributes['contentitemMarginNew'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $contentBorderWidth = isset($attributes['contentBorderWidth']) ? $attributes['contentBorderWidth'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $contentitemRadius = isset($attributes['contentitemRadius']) ? $attributes['contentitemRadius'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $contentNormalBorderType = isset($attributes['contentnormalBorderType']) ? sanitize_text_field($attributes['contentnormalBorderType']) : '';
        $contentBgColor    = isset($attributes['contentBgColor']) ? sanitize_text_field($attributes['contentBgColor']) : '';   
        $contentBorderColor = isset($attributes['contentBorderColor']) ? sanitize_text_field($attributes['contentBorderColor']) : '';
        // Thumbnail
        $thumbnailMargin = isset($attributes['thumbnailMargin']) ? $attributes['thumbnailMargin'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $thumbnailPadding = isset($attributes['thumbnailPadding']) ? $attributes['thumbnailPadding'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $thumbnailBorderRadius = isset($attributes['thumbnailBorderRadius']) ? $attributes['thumbnailBorderRadius'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];

        // Post Title
        $postTitleFontSize      = isset($attributes['postTitleFontSize']) ? absint($attributes['postTitleFontSize']) : '';
        $postTitleLineHeight    = isset($attributes['postTitleLineHeight']) ? floatval($attributes['postTitleLineHeight']) : '';
        $postTitleLetterSpacing = isset($attributes['postTitleLetterSpacing']) ? floatval($attributes['postTitleLetterSpacing']) : '';
        $postTitleFontWeight    = isset($attributes['postTitleFontWeight']) ? sanitize_text_field($attributes['postTitleFontWeight']) : '';
        $postTitleAlignment     = isset($attributes['postTitleAlignment']) ? sanitize_text_field($attributes['postTitleAlignment']) : '';
        $postTitleColor         = isset($attributes['postTitleColor']) ? sanitize_text_field($attributes['postTitleColor']) : '';
        $postTitleBgColor       = isset($attributes['postTitleBgColor']) ? sanitize_text_field($attributes['postTitleBgColor']) : ''; 
        $postTitleHoverColor    = isset($attributes['postTitleHoverColor']) ? sanitize_text_field($attributes['postTitleHoverColor']) : '';
        $postTitleHoverBgColor  = isset($attributes['postTitleHoverBgColor']) ? sanitize_text_field($attributes['postTitleHoverBgColor']) : '';
        $postTitleMargin  = isset($attributes['postTitleMargin']) ? array_map('sanitize_text_field', $attributes['postTitleMargin']) : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $postTitlePadding = isset($attributes['postTitlePadding']) ? array_map('sanitize_text_field', $attributes['postTitlePadding']) : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];

        // Excerpt
        $excerptFontSize = isset($attributes['excerptFontSize']) ? absint($attributes['excerptFontSize']) : '';
        $excerptLineHeight = isset($attributes['excerptLineHeight']) ? floatval($attributes['excerptLineHeight']) : '';
        $excerptLetterSpacing = isset($attributes['excerptLetterSpacing']) ? floatval($attributes['excerptLetterSpacing']) : '';
        $excerptFontWeight = isset($attributes['excerptFontWeight']) ? sanitize_text_field($attributes['excerptFontWeight']) : '';
        $excerptAlignment = isset($attributes['excerptAlignment']) ? sanitize_text_field($attributes['excerptAlignment']) : '';
        $excerptMargin = isset($attributes['excerptMargin']) ? array_map('sanitize_text_field', $attributes['excerptMargin']) : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $excerptPadding = isset($attributes['excerptPadding']) ? array_map('sanitize_text_field', $attributes['excerptPadding']) : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $excerptColor = isset($attributes['excerptColor']) ? sanitize_text_field($attributes['excerptColor']) : '';
        $excerptBgColor = isset($attributes['excerptBgColor']) ? sanitize_text_field($attributes['excerptBgColor']) : '';
        $excerptBorderType = isset($attributes['excerptBorderType']) ? sanitize_text_field($attributes['excerptBorderType']) : '';
        $excerptHoverColor = isset($attributes['excerptHoverColor']) ? sanitize_text_field($attributes['excerptHoverColor']) : '';
        $excerptHoverBgColor = isset($attributes['excerptHoverBgColor']) ? sanitize_text_field($attributes['excerptHoverBgColor']) : '';

        // Meta Data Attributes
        $metaAlignment = isset($attributes['metaAlignment']) ? sanitize_text_field($attributes['metaAlignment']) : '';
        $metaMarginNew = isset($attributes['metaMarginNew']) ? $attributes['metaMarginNew'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $metaPadding = isset($attributes['metaPadding']) ? $attributes['metaPadding'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $metaTextColor = isset($attributes['metaTextColor']) ? sanitize_text_field($attributes['metaTextColor']) : '';
        $separatorColor = isset($attributes['separatorColor']) ? sanitize_text_field($attributes['separatorColor']) : '';
        $metaFontSize = isset($attributes['metaFontSize']) ? absint($attributes['metaFontSize']) : '';
        $metaIconColor = isset($attributes['metaIconColor']) ? sanitize_text_field($attributes['metaIconColor']) : '';
        $metaBgColor = isset($attributes['metaBgColor']) ? sanitize_text_field($attributes['metaBgColor']) : '';
        
        // Button Alignment
        $buttonAlignment = isset($attributes['buttonAlignment']) ? sanitize_text_field($attributes['buttonAlignment']) : '';
        $buttonMarginNew = isset($attributes['buttonMarginNew']) ? array_map('sanitize_text_field', $attributes['buttonMarginNew']) : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $buttonPaddingNew = isset($attributes['buttonPaddingNew']) ? array_map('sanitize_text_field', $attributes['buttonPaddingNew']) : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $buttonFontSize = isset($attributes['buttonFontSize']) ? absint($attributes['buttonFontSize']) : '';
        $buttonBorderWidth = isset($attributes['buttonBorderWidth']) ? array_map('sanitize_text_field', $attributes['buttonBorderWidth']) : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $buttonFontWeight = isset($attributes['buttonFontWeight']) ? sanitize_text_field($attributes['buttonFontWeight']) : '';
        $buttonTextColor = isset($attributes['buttonTextColor']) ? sanitize_text_field($attributes['buttonTextColor']) : '';
        $buttonBackgroundColor = isset($attributes['buttonBackgroundColor']) ? sanitize_text_field($attributes['buttonBackgroundColor']) : '';
        $buttonBorderType = isset($attributes['buttonBorderType']) ? sanitize_text_field($attributes['buttonBorderType']) : '';
        $buttonBorderRadius = isset($attributes['buttonBorderRadius']) ? array_map('sanitize_text_field', $attributes['buttonBorderRadius']) : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
        $buttonHoverTextColor = isset($attributes['buttonHoverTextColor']) ? sanitize_text_field($attributes['buttonHoverTextColor']) : '';
        $buttonHoverBackgroundColor = isset($attributes['buttonHoverBackgroundColor']) ? sanitize_text_field($attributes['buttonHoverBackgroundColor']) : ''; 
        $buttonBorderColor = isset($attributes['buttonBorderColor']) ? sanitize_text_field($attributes['buttonBorderColor']) : '';
        $buttonHoverBorderColor = isset($attributes['buttonHoverBorderColor']) ? sanitize_text_field($attributes['buttonHoverBorderColor']) : '';

        //END ATTRIBUTES
        
        $paged = (get_query_var('paged')) ? get_query_var('paged') : 1;

        $query_args = array(
            'post_type'      => 'post',
            'posts_per_page' => $postLimit, // Adjust as needed
            'paged'          => $paged,
            'orderby'        => $orderBy,
            'order'          => 'DESC', // Ensure ordering
        );

        if ( ! empty( $selectedCategories ) ) {
            $query_args['category__in'] = $selectedCategories;
        }
        if ( ! empty( $selectedTags ) ) {
            $query_args['tag__in'] = $selectedTags;
        }
        // Include Posts
        $includePosts = isset($attributes['includePosts']) ? $attributes['includePosts'] : '';
        if ( ! empty($includePosts) ) {
            $ids = array_filter(array_map('absint', explode(',', $includePosts)));
            if ( ! empty($ids) ) {
                $query_args['post__in'] = $ids;
            }
        }

        // Exclude Posts
        $excludePosts = isset($attributes['excludePosts']) ? $attributes['excludePosts'] : '';
        if ( ! empty($excludePosts) ) {
            $ids = array_filter(array_map('absint', explode(',', $excludePosts)));
            if ( ! empty($ids) ) {
                $query_args['post__not_in'] = $ids;
            }
        }
        //Thumbnail
        $thumbnailSize1L = ($listLayoutStyle === 'style1' && $leftThumbnailSize == null)
                  ? 'fancy_post_custom_size' : $leftThumbnailSize; 
        $thumbnailSize1R = ($listLayoutStyle === 'style1' && $rightThumbnailSize == null)
                  ? 'fancy_post_square' : $rightThumbnailSize; 
        $thumbnailSize2L = ($listLayoutStyle === 'style2' && $leftThumbnailSize == null)
                  ? 'fancy_post_custom_size' : $leftThumbnailSize; 
        $thumbnailSize2R = ($listLayoutStyle === 'style2' && $rightThumbnailSize == null)
                  ? 'fancy_post_square' : $rightThumbnailSize;
        $thumbnailSize3L = ($listLayoutStyle === 'style3' && $leftThumbnailSize == null)
                  ? 'fancy_post_custom_size' : $leftThumbnailSize; 
        $thumbnailSize3R = ($listLayoutStyle === 'style3' && $rightThumbnailSize == null)
                  ? 'fancy_post_square' : $rightThumbnailSize; 
        $thumbnailSize4 = ($listLayoutStyle === 'style4' && $thumbnailSize == null)
                  ? 'fancy_post_square' : $thumbnailSize; 
        $thumbnailSize5 = ($listLayoutStyle === 'style5' && $thumbnailSize == null)
                  ? 'fancy_post_portrait' : $thumbnailSize; 
        $thumbnailSize6 = ($listLayoutStyle === 'style6' && $thumbnailSize == null)
                  ? 'thumbnail' : $thumbnailSize; 
        $thumbnailSize7 = ($listLayoutStyle === 'style7' && $thumbnailSize == null)
                  ? 'fancy_post_square' : $thumbnailSize; 
        $thumbnailSize8L = ($listLayoutStyle === 'style8' && $leftThumbnailSize == null)
                  ? 'fancy_post_custom_size' : $leftThumbnailSize; 
        $thumbnailSize8R = ($listLayoutStyle === 'style8' && $rightThumbnailSize == null)
                  ? 'fancy_post_custom_size' : $rightThumbnailSize; 

        // buttonStyle
        $buttonStyle1 = ($listLayoutStyle === 'style1' && $buttonStyle == null)
                  ? 'fpg-flat' : $buttonStyle; 
        $buttonStyle2 = ($listLayoutStyle === 'style2' && $buttonStyle == null)
                  ? 'fpg-flat' : $buttonStyle; 
        $buttonStyle3 = ($listLayoutStyle === 'style3' && $buttonStyle == null)
                  ? 'fpg-flat' : $buttonStyle; 
        $buttonStyle4 = ($listLayoutStyle === 'style4' && $buttonStyle == null)
                  ? 'fpg-filled' : $buttonStyle; 
        $buttonStyle5 = ($listLayoutStyle === 'style5' && $buttonStyle == null)
                  ? 'fpg-filled' : $buttonStyle; 
        $buttonStyle6 = ($listLayoutStyle === 'style6' && $buttonStyle == null)
                  ? 'fpg-flat' : $buttonStyle; 
        $buttonStyle7 = ($listLayoutStyle === 'style7' && $buttonStyle == null)
                  ? 'fpg-flat' : $buttonStyle; 
        $buttonStyle8 = ($listLayoutStyle === 'style8' && $buttonStyle == null)
                  ? 'fpg-flat' : $buttonStyle;  

        $targetAttr = ($postLinkTarget === 'newWindow') ? ' target="_blank"' : ' target="_self"';          
        // Run the query
        $query = new WP_Query($query_args);

        if (!$query->have_posts()) {
            return '<p>' . esc_html__('No posts found.', 'fancy-post-grid') . '</p>';
        }
        if ($listLayoutStyle === 'style1') {
            
            $output = '<div class="fpg-blog-layout-8" style="';
            
            // Background Color
            if (!empty($sectionBgColor)) {
                $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
            }

            // Margin
            if (!empty($sectionMargin['top']) || !empty($sectionMargin['right']) || !empty($sectionMargin['bottom']) || !empty($sectionMargin['left'])) {
                $output .= 'margin: ' .
                    (isset($sectionMargin['top']) && $sectionMargin['top'] !== '' ? (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) : '0px') . ' ' .
                    (isset($sectionMargin['right']) && $sectionMargin['right'] !== '' ? (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) : '0px') . ' ' .
                    (isset($sectionMargin['bottom']) && $sectionMargin['bottom'] !== '' ? (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) : '0px') . ' ' .
                    (isset($sectionMargin['left']) && $sectionMargin['left'] !== '' ? (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) : '0px') . '; ';
            }

            // Padding
            if (!empty($sectionPadding['top']) || !empty($sectionPadding['right']) || !empty($sectionPadding['bottom']) || !empty($sectionPadding['left'])) {
                $output .= 'padding: ' .
                    (isset($sectionPadding['top']) && $sectionPadding['top'] !== '' ? (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) : '0px') . ' ' .
                    (isset($sectionPadding['right']) && $sectionPadding['right'] !== '' ? (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) : '0px') . ' ' .
                    (isset($sectionPadding['bottom']) && $sectionPadding['bottom'] !== '' ? (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) : '0px') . ' ' .
                    (isset($sectionPadding['left']) && $sectionPadding['left'] !== '' ? (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) : '0px') . '; ';
            }

            $output .= '">';    
        } else if ($listLayoutStyle === 'style2') {
            
            $output = '<div class="fpg-blog-layout-1 fpg-blog-layout-9 " style="';
            
            // Background Color
            if (!empty($sectionBgColor)) {
                $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
            }
            
            // Margin
            if (!empty($sectionMargin['top']) || !empty($sectionMargin['right']) || !empty($sectionMargin['bottom']) || !empty($sectionMargin['left'])) {
                $output .= 'margin: ' .
                    (isset($sectionMargin['top']) && $sectionMargin['top'] !== '' ? (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) : '0px') . ' ' .
                    (isset($sectionMargin['right']) && $sectionMargin['right'] !== '' ? (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) : '0px') . ' ' .
                    (isset($sectionMargin['bottom']) && $sectionMargin['bottom'] !== '' ? (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) : '0px') . ' ' .
                    (isset($sectionMargin['left']) && $sectionMargin['left'] !== '' ? (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) : '0px') . '; ';
            }

            // Padding
            if (!empty($sectionPadding['top']) || !empty($sectionPadding['right']) || !empty($sectionPadding['bottom']) || !empty($sectionPadding['left'])) {
                $output .= 'padding: ' .
                    (isset($sectionPadding['top']) && $sectionPadding['top'] !== '' ? (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) : '0px') . ' ' .
                    (isset($sectionPadding['right']) && $sectionPadding['right'] !== '' ? (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) : '0px') . ' ' .
                    (isset($sectionPadding['bottom']) && $sectionPadding['bottom'] !== '' ? (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) : '0px') . ' ' .
                    (isset($sectionPadding['left']) && $sectionPadding['left'] !== '' ? (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) : '0px') . '; ';
            }

            $output .= '">';     
        } else if ($listLayoutStyle === 'style3') {
            
            $output = '<div class="fpg-blog-layout-17" style="';
            
            // Background Color
            if (!empty($sectionBgColor)) {
                $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
            }
            $output .= 'display: grid; ';

            // Margin
            if (!empty($sectionMargin['top']) || !empty($sectionMargin['right']) || !empty($sectionMargin['bottom']) || !empty($sectionMargin['left'])) {
                $output .= 'margin: ' .
                    (isset($sectionMargin['top']) && $sectionMargin['top'] !== '' ? (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) : '0px') . ' ' .
                    (isset($sectionMargin['right']) && $sectionMargin['right'] !== '' ? (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) : '0px') . ' ' .
                    (isset($sectionMargin['bottom']) && $sectionMargin['bottom'] !== '' ? (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) : '0px') . ' ' .
                    (isset($sectionMargin['left']) && $sectionMargin['left'] !== '' ? (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) : '0px') . '; ';
            }

            // Padding
            if (!empty($sectionPadding['top']) || !empty($sectionPadding['right']) || !empty($sectionPadding['bottom']) || !empty($sectionPadding['left'])) {
                $output .= 'padding: ' .
                    (isset($sectionPadding['top']) && $sectionPadding['top'] !== '' ? (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) : '0px') . ' ' .
                    (isset($sectionPadding['right']) && $sectionPadding['right'] !== '' ? (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) : '0px') . ' ' .
                    (isset($sectionPadding['bottom']) && $sectionPadding['bottom'] !== '' ? (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) : '0px') . ' ' .
                    (isset($sectionPadding['left']) && $sectionPadding['left'] !== '' ? (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) : '0px') . '; ';
            }

            $output .= '">';     
        } else if ($listLayoutStyle === 'style4') {
            
            $output = '<div class="fpg-blog-layout-20" style="';
            
            // Background Color
            if (!empty($sectionBgColor)) {
                $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
            }

            // Margin
            if (!empty($sectionMargin['top']) || !empty($sectionMargin['right']) || !empty($sectionMargin['bottom']) || !empty($sectionMargin['left'])) {
                $output .= 'margin: ' .
                    (isset($sectionMargin['top']) && $sectionMargin['top'] !== '' ? (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) : '0px') . ' ' .
                    (isset($sectionMargin['right']) && $sectionMargin['right'] !== '' ? (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) : '0px') . ' ' .
                    (isset($sectionMargin['bottom']) && $sectionMargin['bottom'] !== '' ? (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) : '0px') . ' ' .
                    (isset($sectionMargin['left']) && $sectionMargin['left'] !== '' ? (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) : '0px') . '; ';
            }

            // Padding
            if (!empty($sectionPadding['top']) || !empty($sectionPadding['right']) || !empty($sectionPadding['bottom']) || !empty($sectionPadding['left'])) {
                $output .= 'padding: ' .
                    (isset($sectionPadding['top']) && $sectionPadding['top'] !== '' ? (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) : '0px') . ' ' .
                    (isset($sectionPadding['right']) && $sectionPadding['right'] !== '' ? (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) : '0px') . ' ' .
                    (isset($sectionPadding['bottom']) && $sectionPadding['bottom'] !== '' ? (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) : '0px') . ' ' .
                    (isset($sectionPadding['left']) && $sectionPadding['left'] !== '' ? (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) : '0px') . '; ';
            }

            $output .= '">';     
        } else if ($listLayoutStyle === 'style5') {

            $output = '<div class="fpg-blog-layout-22" style="';
            
            // Background Color
            if (!empty($sectionBgColor)) {
                $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
            }

            // Margin
            if (!empty($sectionMargin['top']) || !empty($sectionMargin['right']) || !empty($sectionMargin['bottom']) || !empty($sectionMargin['left'])) {
                $output .= 'margin: ' .
                    (isset($sectionMargin['top']) && $sectionMargin['top'] !== '' ? (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) : '0px') . ' ' .
                    (isset($sectionMargin['right']) && $sectionMargin['right'] !== '' ? (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) : '0px') . ' ' .
                    (isset($sectionMargin['bottom']) && $sectionMargin['bottom'] !== '' ? (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) : '0px') . ' ' .
                    (isset($sectionMargin['left']) && $sectionMargin['left'] !== '' ? (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) : '0px') . '; ';
            }

            // Padding
            if (!empty($sectionPadding['top']) || !empty($sectionPadding['right']) || !empty($sectionPadding['bottom']) || !empty($sectionPadding['left'])) {
                $output .= 'padding: ' .
                    (isset($sectionPadding['top']) && $sectionPadding['top'] !== '' ? (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) : '0px') . ' ' .
                    (isset($sectionPadding['right']) && $sectionPadding['right'] !== '' ? (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) : '0px') . ' ' .
                    (isset($sectionPadding['bottom']) && $sectionPadding['bottom'] !== '' ? (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) : '0px') . ' ' .
                    (isset($sectionPadding['left']) && $sectionPadding['left'] !== '' ? (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) : '0px') . '; ';
            }

            $output .= '">';     
        } else if ($listLayoutStyle === 'style6') {
            
            $output = '<div class="fpg-blog-layout-24" style="';
            
            // Background Color
            if (!empty($sectionBgColor)) {
                $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
            }

            // Margin
            if (!empty($sectionMargin['top']) || !empty($sectionMargin['right']) || !empty($sectionMargin['bottom']) || !empty($sectionMargin['left'])) {
                $output .= 'margin: ' .
                    (isset($sectionMargin['top']) && $sectionMargin['top'] !== '' ? (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) : '0px') . ' ' .
                    (isset($sectionMargin['right']) && $sectionMargin['right'] !== '' ? (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) : '0px') . ' ' .
                    (isset($sectionMargin['bottom']) && $sectionMargin['bottom'] !== '' ? (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) : '0px') . ' ' .
                    (isset($sectionMargin['left']) && $sectionMargin['left'] !== '' ? (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) : '0px') . '; ';
            }

            // Padding
            if (!empty($sectionPadding['top']) || !empty($sectionPadding['right']) || !empty($sectionPadding['bottom']) || !empty($sectionPadding['left'])) {
                $output .= 'padding: ' .
                    (isset($sectionPadding['top']) && $sectionPadding['top'] !== '' ? (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) : '0px') . ' ' .
                    (isset($sectionPadding['right']) && $sectionPadding['right'] !== '' ? (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) : '0px') . ' ' .
                    (isset($sectionPadding['bottom']) && $sectionPadding['bottom'] !== '' ? (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) : '0px') . ' ' .
                    (isset($sectionPadding['left']) && $sectionPadding['left'] !== '' ? (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) : '0px') . '; ';
            }

            $output .= '">';     
        } else if ($listLayoutStyle === 'style7') {

            $output = '<div class="fpg-blog-layout-25" style="';
            
            // Background Color
            if (!empty($sectionBgColor)) {
                $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
            }

            // Margin
            if (!empty($sectionMargin['top']) || !empty($sectionMargin['right']) || !empty($sectionMargin['bottom']) || !empty($sectionMargin['left'])) {
                $output .= 'margin: ' .
                    (isset($sectionMargin['top']) && $sectionMargin['top'] !== '' ? (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) : '0px') . ' ' .
                    (isset($sectionMargin['right']) && $sectionMargin['right'] !== '' ? (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) : '0px') . ' ' .
                    (isset($sectionMargin['bottom']) && $sectionMargin['bottom'] !== '' ? (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) : '0px') . ' ' .
                    (isset($sectionMargin['left']) && $sectionMargin['left'] !== '' ? (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) : '0px') . '; ';
            }

            // Padding
            if (!empty($sectionPadding['top']) || !empty($sectionPadding['right']) || !empty($sectionPadding['bottom']) || !empty($sectionPadding['left'])) {
                $output .= 'padding: ' .
                    (isset($sectionPadding['top']) && $sectionPadding['top'] !== '' ? (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) : '0px') . ' ' .
                    (isset($sectionPadding['right']) && $sectionPadding['right'] !== '' ? (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) : '0px') . ' ' .
                    (isset($sectionPadding['bottom']) && $sectionPadding['bottom'] !== '' ? (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) : '0px') . ' ' .
                    (isset($sectionPadding['left']) && $sectionPadding['left'] !== '' ? (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) : '0px') . '; ';
            }

            $output .= '">';     
        } else if ($listLayoutStyle === 'style8') {
            
            $output = '<div class="fpg-blog-layout-27" style="';
            
            // Background Color
            if (!empty($sectionBgColor)) {
                $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
            }
            
            // Margin
            if (!empty($sectionMargin['top']) || !empty($sectionMargin['right']) || !empty($sectionMargin['bottom']) || !empty($sectionMargin['left'])) {
                $output .= 'margin: ' .
                    (isset($sectionMargin['top']) && $sectionMargin['top'] !== '' ? (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) : '0px') . ' ' .
                    (isset($sectionMargin['right']) && $sectionMargin['right'] !== '' ? (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) : '0px') . ' ' .
                    (isset($sectionMargin['bottom']) && $sectionMargin['bottom'] !== '' ? (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) : '0px') . ' ' .
                    (isset($sectionMargin['left']) && $sectionMargin['left'] !== '' ? (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) : '0px') . '; ';
            }

            // Padding
            if (!empty($sectionPadding['top']) || !empty($sectionPadding['right']) || !empty($sectionPadding['bottom']) || !empty($sectionPadding['left'])) {
                $output .= 'padding: ' .
                    (isset($sectionPadding['top']) && $sectionPadding['top'] !== '' ? (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) : '0px') . ' ' .
                    (isset($sectionPadding['right']) && $sectionPadding['right'] !== '' ? (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) : '0px') . ' ' .
                    (isset($sectionPadding['bottom']) && $sectionPadding['bottom'] !== '' ? (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) : '0px') . ' ' .
                    (isset($sectionPadding['left']) && $sectionPadding['left'] !== '' ? (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) : '0px') . '; ';
            }

            $output .= '">';     
        }

            
            $output .= '<div class="row">'; 
            $post_count = 0;
         
            while ($query->have_posts()) {
                
                $query->the_post();
                $post_id = get_the_ID();
                $post_count++;
                $permalink = get_permalink($post_id);
                $title = get_the_title();
                $date = get_the_date();
                $getdate = get_the_date('M j, Y', $post_id);
                $author = get_the_author();
                $categories = get_the_category_list(', ');
                $tags = get_the_tag_list('', ', ');
                $comments_count = get_comments_number();

                if ($listLayoutStyle === 'style1') {
                    $leftThumbnailSize = get_the_post_thumbnail($post_id, $thumbnailSize1L, ['class' => 'fancy-post-thumbnail']);
                    $rightThumbnailSize = get_the_post_thumbnail($post_id, $thumbnailSize1R, ['class' => 'fancy-post-thumbnail']);
                }
                
                if ($listLayoutStyle === 'style2') {
                    $leftThumbnailSize = get_the_post_thumbnail($post_id, $thumbnailSize2L, ['class' => 'fancy-post-thumbnail']);
                    $rightThumbnailSize = get_the_post_thumbnail($post_id, $thumbnailSize2R, ['class' => 'fancy-post-thumbnail']);
                }
                
                if ($listLayoutStyle === 'style3') {
                    $leftThumbnailSize = get_the_post_thumbnail($post_id, $thumbnailSize3L, ['class' => 'fancy-post-thumbnail']);
                    $rightThumbnailSize = get_the_post_thumbnail($post_id, $thumbnailSize3R, ['class' => 'fancy-post-thumbnail']);
                }
                
                if ($listLayoutStyle === 'style4') {
                    $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize4, ['class' => 'fancy-post-thumbnail']);
                }
                if ($listLayoutStyle === 'style5') {
                    $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize5, ['class' => 'fancy-post-thumbnail']);
                }
                if ($listLayoutStyle === 'style6') {
                    $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize6, ['class' => 'fancy-post-thumbnail']);
                }
                if ($listLayoutStyle === 'style7') {
                    $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize7, ['class' => 'fancy-post-thumbnail']);
                }
                if ($listLayoutStyle === 'style8') {
                    $leftThumbnailSize = get_the_post_thumbnail($post_id, $thumbnailSize8L, ['class' => 'fancy-post-thumbnail']);
                    $rightThumbnailSize = get_the_post_thumbnail($post_id, $thumbnailSize8R, ['class' => 'fancy-post-thumbnail']);
                }

                // Title Crop
                if ($titleCropBy === 'word') {
                    $titleArray = explode(' ', $title);
                    $croppedTitle = implode(' ', array_slice($titleArray, 0, (int) $titleLength));
                } elseif ($titleCropBy === 'cha') {
                    $croppedTitle = mb_substr($title, 0, $titleLength);
                } else {
                    $croppedTitle = $title; // fallback
                }
                // Fetch full content when 'full_content' is selected
                if ($excerptType === 'full_content') {
                    $excerpt = apply_filters('the_content', get_the_content());
                } elseif ($excerptType === 'word') {
                    $excerpt = wp_trim_words(get_the_excerpt(), $excerptLimit, $excerptIndicator);
                } else { // 'character'
                    $excerpt = mb_substr(get_the_excerpt(), 0, $excerptLimit) . $excerptIndicator;
                }

                // Style-based output
                
                if ($listLayoutStyle === 'style4') {
                    $borderStyles = '.fpg-blog-layout-20-item .fpg-content a.fpg-btn.fpg-border::before {';
                    
                        $borderStyles .= 'background: ' . (!empty($buttonHoverTextColor) ? esc_attr($buttonHoverTextColor) : '#332FFF') . ';';
                        
                        $borderStyles .= '}';
                        $output .= '<style>' . $borderStyles . '</style>';
                    // LEFT SIDE - Only the first post
                    $output .= '<div class="col-lg-6" style="';
                        if (!empty($itemGap)) {
                            $halfGap = is_numeric($itemGap) ? ($itemGap / 2) . 'px' : esc_attr($itemGap);
                            $output .= 'padding-left: ' . $halfGap . '; padding-right: ' . $halfGap . '; ';
                        }
                        $output .= '">';
                        $output .= '<div class="fpg-blog-layout-20-item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . ' ' . $postLinkType . '" style="';
                            // MARGIN    
                            if (isset($itemMargin['top']) || isset($itemMargin['right']) || isset($itemMargin['bottom']) || isset($itemMargin['left'])) {
                                $output .= 'margin: ' .
                                    (isset($itemMargin['top']) ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' .
                                    (isset($itemMargin['right']) ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' .
                                    (isset($itemMargin['bottom']) ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' .
                                    (isset($itemMargin['left']) ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; ';
                            }

                            // PADDING
                            if (isset($itemPadding['top']) || isset($itemPadding['right']) || isset($itemPadding['bottom']) || isset($itemPadding['left'])) {
                                $output .= 'padding: ' .
                                    (isset($itemPadding['top']) ? (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) : '0px') . ' ' .
                                    (isset($itemPadding['right']) ? (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) : '0px') . ' ' .
                                    (isset($itemPadding['bottom']) ? (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) : '0px') . ' ' .
                                    (isset($itemPadding['left']) ? (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) : '0px') . '; ';
                            }

                            // BORDER RADIUS
                            if (isset($itemBorderRadius['top']) || isset($itemBorderRadius['right']) || isset($itemBorderRadius['bottom']) || isset($itemBorderRadius['left'])) {
                                $output .= 'border-radius: ' .
                                    (isset($itemBorderRadius['top']) ? (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) : '0px') . ' ' .
                                    (isset($itemBorderRadius['right']) ? (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) : '0px') . ' ' .
                                    (isset($itemBorderRadius['bottom']) ? (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) : '0px') . ' ' .
                                    (isset($itemBorderRadius['left']) ? (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) : '0px') . '; ';
                            }

                            // BORDER WIDTH
                            if (isset($itemBorderWidth['top']) || isset($itemBorderWidth['right']) || isset($itemBorderWidth['bottom']) || isset($itemBorderWidth['left'])) {
                                $output .= 'border-width: ' .
                                    (isset($itemBorderWidth['top']) ? (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) : '0px') . ' ' .
                                    (isset($itemBorderWidth['right']) ? (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) : '0px') . ' ' .
                                    (isset($itemBorderWidth['bottom']) ? (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) : '0px') . ' ' .
                                    (isset($itemBorderWidth['left']) ? (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) : '0px') . '; ';
                            }

                            // Border Style & Color
                            if (!empty($itemBorderType)) {
                                $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                            }
                            if (!empty($itemBorderColor)) {
                                $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                            }

                            // Background Color
                            if (!empty($itemBackgroundColor)) {
                                $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                            }

                            // Box Shadow
                            if (
                                isset($itemBoxShadow['left']) ||  // horizontal offset
                                isset($itemBoxShadow['top']) ||  // vertical offset
                                isset($itemBoxShadow['right']) ||  // blur radius
                                isset($itemBoxShadow['bottom']) ||  // spread radius
                                isset($itemBoxShadowColor)
                            ) {
                                $output .= 'box-shadow: ' .
                                    (isset($itemBoxShadow['left']) ? (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) : '0px') . ' ' .
                                    (isset($itemBoxShadow['top']) ? (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) : '0px') . ' ' .
                                    (isset($itemBoxShadow['right']) ? (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) : '0px') . ' ' .
                                    (isset($itemBoxShadow['bottom']) ? (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) : '0px') . ' ' .
                                    (!empty($itemBoxShadowColor) ? esc_attr($itemBoxShadowColor) : 'rgba(0,0,0,0.1)') . '; ';
                            }

                        $output .= '">';

                            // Thumbnail
                            if ($thumbnail && $showThumbnail) {
                                $output .= '<div class="fpg-thumb" style="';

                                // MARGIN
                                if (
                                    isset($thumbnailMargin['top']) ||
                                    isset($thumbnailMargin['right']) ||
                                    isset($thumbnailMargin['bottom']) ||
                                    isset($thumbnailMargin['left'])
                                ) {
                                    $output .= 'margin: ' .
                                        (isset($thumbnailMargin['top']) ? (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) : '0px') . ' ' .
                                        (isset($thumbnailMargin['right']) ? (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) : '0px') . ' ' .
                                        (isset($thumbnailMargin['bottom']) ? (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) : '0px') . ' ' .
                                        (isset($thumbnailMargin['left']) ? (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) : '0px') . '; ';
                                }

                                // PADDING
                                if (
                                    isset($thumbnailPadding['top']) ||
                                    isset($thumbnailPadding['right']) ||
                                    isset($thumbnailPadding['bottom']) ||
                                    isset($thumbnailPadding['left'])
                                ) {
                                    $output .= 'padding: ' .
                                        (isset($thumbnailPadding['top']) ? (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) : '0px') . ' ' .
                                        (isset($thumbnailPadding['right']) ? (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) : '0px') . ' ' .
                                        (isset($thumbnailPadding['bottom']) ? (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) : '0px') . ' ' .
                                        (isset($thumbnailPadding['left']) ? (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) : '0px') . '; ';
                                }

                                // BORDER RADIUS
                                if (
                                    isset($thumbnailBorderRadius['top']) ||
                                    isset($thumbnailBorderRadius['right']) ||
                                    isset($thumbnailBorderRadius['bottom']) ||
                                    isset($thumbnailBorderRadius['left'])
                                ) {
                                    $output .= 'border-radius: ' .
                                        (isset($thumbnailBorderRadius['top']) ? (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) : '0px') . ' ' .
                                        (isset($thumbnailBorderRadius['right']) ? (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) : '0px') . ' ' .
                                        (isset($thumbnailBorderRadius['bottom']) ? (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) : '0px') . ' ' .
                                        (isset($thumbnailBorderRadius['left']) ? (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) : '0px') . '; ';
                                }

                                $output .= '">';

                                if ($thumbnailLink) {
                                    $output .= '<a href="' . esc_url($permalink) . '"' . $targetAttr . '>';
                                    $output .= $thumbnail;
                                    $output .= '</a>';
                                } else {
                                    $output .= $thumbnail;
                                }
                                
                                $output .= '</div>';
                            }
                            // END Thumbnail

                            // MAIN Content
                            $output .= '<div class="fpg-content" style="';
                                // MARGIN
                                if (
                                    isset($contentitemMarginNew['top']) ||
                                    isset($contentitemMarginNew['right']) ||
                                    isset($contentitemMarginNew['bottom']) ||
                                    isset($contentitemMarginNew['left'])
                                ) {
                                    $output .= 'margin: ' .
                                        (isset($contentitemMarginNew['top']) ? (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) : '0px') . ' ' .
                                        (isset($contentitemMarginNew['right']) ? (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) : '0px') . ' ' .
                                        (isset($contentitemMarginNew['bottom']) ? (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) : '0px') . ' ' .
                                        (isset($contentitemMarginNew['left']) ? (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) : '0px') . '; ';
                                }

                                // PADDING
                                if (
                                    isset($contentitemPaddingNew['top']) ||
                                    isset($contentitemPaddingNew['right']) ||
                                    isset($contentitemPaddingNew['bottom']) ||
                                    isset($contentitemPaddingNew['left'])
                                ) {
                                    $output .= 'padding: ' .
                                        (isset($contentitemPaddingNew['top']) ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' .
                                        (isset($contentitemPaddingNew['right']) ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' .
                                        (isset($contentitemPaddingNew['bottom']) ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' .
                                        (isset($contentitemPaddingNew['left']) ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; ';
                                }

                                // BORDER WIDTH
                                if (
                                    isset($contentBorderWidth['top']) ||
                                    isset($contentBorderWidth['right']) ||
                                    isset($contentBorderWidth['bottom']) ||
                                    isset($contentBorderWidth['left'])
                                ) {
                                    $output .= 'border-width: ' .
                                        (isset($contentBorderWidth['top']) ? (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) : '0px') . ' ' .
                                        (isset($contentBorderWidth['right']) ? (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) : '0px') . ' ' .
                                        (isset($contentBorderWidth['bottom']) ? (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) : '0px') . ' ' .
                                        (isset($contentBorderWidth['left']) ? (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) : '0px') . '; ';
                                }
                                // BORDER radius
                                    if (
                                        isset($contentitemRadius['top']) ||
                                        isset($contentitemRadius['right']) ||
                                        isset($contentitemRadius['bottom']) ||
                                        isset($contentitemRadius['left'])
                                    ) {
                                        $output .= 'border-radius: ' .
                                            (isset($contentitemRadius['top']) ? (is_numeric($contentitemRadius['top']) ? $contentitemRadius['top'] . 'px' : esc_attr($contentitemRadius['top'])) : '0px') . ' ' .
                                            (isset($contentitemRadius['right']) ? (is_numeric($contentitemRadius['right']) ? $contentitemRadius['right'] . 'px' : esc_attr($contentitemRadius['right'])) : '0px') . ' ' .
                                            (isset($contentitemRadius['bottom']) ? (is_numeric($contentitemRadius['bottom']) ? $contentitemRadius['bottom'] . 'px' : esc_attr($contentitemRadius['bottom'])) : '0px') . ' ' .
                                            (isset($contentitemRadius['left']) ? (is_numeric($contentitemRadius['left']) ? $contentitemRadius['left'] . 'px' : esc_attr($contentitemRadius['left'])) : '0px') . '; ';
                                    }
                                // Border Style
                                if (!empty($contentNormalBorderType)) {
                                    $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                                }
                                // Background Color
                                if (!empty($contentBgColor)) {
                                    $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                                }
                                // Border Color
                                if (!empty($contentBorderColor)) {
                                    $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                                }
                            $output .= '">';

                            // Meta Data
                            if ($showMetaData) {
                                 
                                $output .= '<div class="fpg-meta" " style="';    
                                    // Order
                                    if (!empty($metaOrder)) {
                                        $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                                    } 
                                
                                $output .= '">';       
                                    $output .= '<ul class="blog-meta align-' . $metaAlignment . ' " style="';  
                                        // MARGIN
                                        if (
                                            isset($metaMarginNew['top']) ||
                                            isset($metaMarginNew['right']) ||
                                            isset($metaMarginNew['bottom']) ||
                                            isset($metaMarginNew['left'])
                                        ) {
                                            $output .= 'margin: ' .
                                                (isset($metaMarginNew['top']) ? (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) : '0px') . ' ' .
                                                (isset($metaMarginNew['right']) ? (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) : '0px') . ' ' .
                                                (isset($metaMarginNew['bottom']) ? (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) : '0px') . ' ' .
                                                (isset($metaMarginNew['left']) ? (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) : '0px') . '; ';
                                        }

                                        // PADDING
                                        if (
                                            isset($metaPadding['top']) ||
                                            isset($metaPadding['right']) ||
                                            isset($metaPadding['bottom']) ||
                                            isset($metaPadding['left'])
                                        ) {
                                            $output .= 'padding: ' .
                                                (isset($metaPadding['top']) ? (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) : '0px') . ' ' .
                                                (isset($metaPadding['right']) ? (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) : '0px') . ' ' .
                                                (isset($metaPadding['bottom']) ? (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) : '0px') . ' ' .
                                                (isset($metaPadding['left']) ? (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) : '0px') . '; ';
                                        }  
                                        
                                        // Color
                                        if (!empty($metaTextColor)) {
                                            $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                                        }
                                        
                                    $output .= '">';

                                    $meta_items = [];

                                    // Date
                                    if ($showPostDate) {
                                        $meta = '<li class="meta-date" style="';

                                        // Color
                                        if (!empty($metaTextColor)) {
                                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                        }

                                        // Font size
                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '">';

                                        // Icon
                                        if ($showPostDateIcon && $showMetaIcon) {
                                            $meta .= '<i class="fas fa-calendar-alt" style="';

                                            if (!empty($metaIconColor)) {
                                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                            }

                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '"></i> ';
                                        }

                                        $meta .= esc_html($getdate) . '</li>';
                                        $meta_items[] = $meta;
                                    }
                                    // Author
                                    if ($showPostAuthor) {
                                        $meta = '<li class="meta-author" style="';

                                        if (!empty($metaTextColor)) {
                                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '">';

                                        if ($showPostAuthorIcon && $showMetaIcon) {
                                            $meta .= '<i class="fas fa-user" style="';

                                            if (!empty($metaIconColor)) {
                                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                            }

                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '"></i> ';
                                        }

                                        $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                                        $meta_items[] = $meta;
                                    }
                                    // Now join meta items with the separator
                                    $output .= implode('<span class="meta-separator" style="color:' . esc_attr($metaIconColor) . '; font-size:' . esc_attr($metaFontSize) . 'px;">' . esc_html($metaSeperator) . '</span>', $meta_items);

                                    $output .= '</ul>';  
                                $output .= '</div>';   
                            }
                            // End Meta Data

                            // title
                            if ($showPostTitle) {
                                $titleStyles = '';

                                // Order
                                if (!empty($titleOrder)) {
                                    $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                                }

                                // Background color
                                if (!empty($postTitleBgColor)) {
                                    $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                                }

                                // Margin
                                if (isset($postTitleMargin['top']) || isset($postTitleMargin['right']) || isset($postTitleMargin['bottom']) || isset($postTitleMargin['left'])) {
                                    $titleStyles .= 'margin: ' .
                                        (isset($postTitleMargin['top']) ? (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) : '0px') . ' ' .
                                        (isset($postTitleMargin['right']) ? (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) : '0px') . ' ' .
                                        (isset($postTitleMargin['bottom']) ? (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) : '0px') . ' ' .
                                        (isset($postTitleMargin['left']) ? (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) : '0px') . '; ';
                                }

                                // Padding
                                if (isset($postTitlePadding['top']) || isset($postTitlePadding['right']) || isset($postTitlePadding['bottom']) || isset($postTitlePadding['left'])) {
                                    $titleStyles .= 'padding: ' .
                                        (isset($postTitlePadding['top']) ? (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) : '0px') . ' ' .
                                        (isset($postTitlePadding['right']) ? (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) : '0px') . ' ' .
                                        (isset($postTitlePadding['bottom']) ? (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) : '0px') . ' ' .
                                        (isset($postTitlePadding['left']) ? (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) : '0px') . '; ';
                                }

                                // Determine if underline should be shown
                                $showUnderline = $postLinkType === 'yeslink' && $titleHoverUnderLine === 'enable';

                                // Class name
                                $classNames = 'title align-' . esc_attr($postTitleAlignment);
                                if ($showUnderline) {
                                    $classNames .= ' underline';
                                }

                                // Hover/Out events for nolink
                                $onmouseover = '';
                                $onmouseout  = '';

                                if (!empty($postTitleHoverBgColor)) {
                                    $onmouseover .= 'this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';';
                                }

                                if (!empty($postTitleHoverColor)) {
                                    $onmouseover .= ' this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                                }

                                if (!empty($postTitleBgColor)) {
                                    $onmouseout .= 'this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';';
                                } else {
                                    $onmouseout .= 'this.style.removeProperty(\'background-color\');';
                                }

                                if (!empty($postTitleColor)) {
                                    $onmouseout .= ' this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                                } else {
                                    $onmouseout .= ' this.style.removeProperty(\'color\');';
                                }

                                // Opening title tag
                                $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"'
                                    . (!empty($onmouseover) ? ' onmouseover="' . trim($onmouseover) . '"' : '')
                                    . (!empty($onmouseout)  ? ' onmouseout="'  . trim($onmouseout)  . '"' : '') . '>';

                                if ($postLinkType === 'yeslink') {
                                    // Anchor styles
                                    $style = '';
                                    $hoverStyle = '';
                                    $mouseoutStyle = '';

                                    if (!empty($postTitleFontSize)) {
                                        $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                                    }

                                    if (!empty($postTitleLineHeight)) {
                                        $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                                    }

                                    if (!empty($postTitleLetterSpacing)) {
                                        $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                                    }

                                    if (!empty($postTitleFontWeight)) {
                                        $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                                    }

                                    if (!empty($postTitleColor)) {
                                        $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                        $mouseoutStyle .= 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                                    } else {
                                        $mouseoutStyle .= 'this.style.color=\'\';';
                                    }

                                    if (!empty($postTitleHoverColor)) {
                                        $hoverStyle .= 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                                    }

                                    if ($showUnderline && !empty($postTitleHoverColor)) {
                                        $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                                        $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                        $hoverStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                                    }

                                    if ($showUnderline && empty($postTitleColor ) && !empty($postTitleColor )) {
                                        $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                                        $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                        $mouseoutStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                                    } else {
                                        
                                        $mouseoutStyle .= ' this.style.removeProperty(\'background-position\');';
                                        $mouseoutStyle .= ' this.style.removeProperty(\'background-size\');';
                                    }

                                    $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '
                                        style="' . esc_attr(trim($style)) . '"'
                                        . (!empty($hoverStyle)   ? ' onmouseover="' . $hoverStyle . '"' : '')
                                        . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                        . esc_html($croppedTitle) . '</a>';
                                } else {
                                    // No link  render span with inline styles
                                    $inlineStyle = '';
                                    if (!empty($postTitleFontSize)) {
                                        $inlineStyle .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                                    }
                                    if (!empty($postTitleLineHeight)) {
                                        $inlineStyle .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                                    }
                                    if (!empty($postTitleLetterSpacing)) {
                                        $inlineStyle .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                                    }
                                    if (!empty($postTitleFontWeight)) {
                                        $inlineStyle .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                                    }
                                    if (!empty($postTitleColor)) {
                                        $inlineStyle .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                    }

                                    $output .= '<span style="' . esc_attr(trim($inlineStyle)) . '">' . esc_html($croppedTitle) . '</span>';
                                }

                                $output .= '</' . esc_attr($titleTag) . '>';
                            }

                            // Button Output                
                            if ($showReadMoreButton) {
                                // Button wrapper styles
                                $buttonWrapperStyle = '';

                                if (
                                    isset($buttonMarginNew['top']) || 
                                    isset($buttonMarginNew['right']) || 
                                    isset($buttonMarginNew['bottom']) || 
                                    isset($buttonMarginNew['left'])
                                ) {
                                    $buttonWrapperStyle .= 'margin: ' .
                                        (isset($buttonMarginNew['top']) ? (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) : '0px') . ' ' .
                                        (isset($buttonMarginNew['right']) ? (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) : '0px') . ' ' .
                                        (isset($buttonMarginNew['bottom']) ? (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) : '0px') . ' ' .
                                        (isset($buttonMarginNew['left']) ? (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) : '0px') . '; ';
                                }

                                // Order
                                if (!empty($buttonOrder)) {
                                    $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                                }
                               
                                $output .= '<div class="btn-wrapper align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';

                                // Button inline styles
                                $buttonInlineStyles = '';

                                if (!empty($buttonTextColor)) {
                                    $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                                }
                                if (!empty($buttonBackgroundColor)) {
                                    $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                                }
                                if (!empty($buttonFontSize)) {
                                    $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                                }
                                if (!empty($buttonFontWeight)) {
                                    $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                                }
                                if (!empty($buttonBorderColor)) {
                                    $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                                }
                                if (!empty($buttonBorderType)) {
                                    $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                                }

                                // Border Width
                                if (
                                    isset($buttonBorderWidth['top']) || 
                                    isset($buttonBorderWidth['right']) || 
                                    isset($buttonBorderWidth['bottom']) || 
                                    isset($buttonBorderWidth['left'])
                                ) {
                                    $buttonInlineStyles .= 'border-width: ' .
                                        (isset($buttonBorderWidth['top']) ? (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) : '0px') . ' ' .
                                        (isset($buttonBorderWidth['right']) ? (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) : '0px') . ' ' .
                                        (isset($buttonBorderWidth['bottom']) ? (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) : '0px') . ' ' .
                                        (isset($buttonBorderWidth['left']) ? (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) : '0px') . '; ';
                                }

                                // Border Radius
                                if (
                                    isset($buttonBorderRadius['top']) || 
                                    isset($buttonBorderRadius['right']) || 
                                    isset($buttonBorderRadius['bottom']) || 
                                    isset($buttonBorderRadius['left'])
                                ) {
                                    $buttonInlineStyles .= 'border-radius: ' .
                                        (isset($buttonBorderRadius['top']) ? (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) : '0px') . ' ' .
                                        (isset($buttonBorderRadius['right']) ? (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) : '0px') . ' ' .
                                        (isset($buttonBorderRadius['bottom']) ? (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) : '0px') . ' ' .
                                        (isset($buttonBorderRadius['left']) ? (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) : '0px') . '; ';
                                }

                                // Padding
                                if (
                                    isset($buttonPaddingNew['top']) || 
                                    isset($buttonPaddingNew['right']) || 
                                    isset($buttonPaddingNew['bottom']) || 
                                    isset($buttonPaddingNew['left'])
                                ) {
                                    $buttonInlineStyles .= 'padding: ' .
                                        (isset($buttonPaddingNew['top']) ? (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) : '0px') . ' ' .
                                        (isset($buttonPaddingNew['right']) ? (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) : '0px') . ' ' .
                                        (isset($buttonPaddingNew['bottom']) ? (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) : '0px') . ' ' .
                                        (isset($buttonPaddingNew['left']) ? (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) : '0px') . '; ';
                                } 

                                // Hover styles
                                $buttonHoverInlineStyles = '';
                                $buttonResetStyles = '';

                                if (!empty($buttonHoverTextColor)) {
                                    $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                                    $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                                }
                                if (!empty($buttonHoverBorderColor)) {
                                    $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                                    $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                                }
                                if (!empty($buttonHoverBackgroundColor)) {
                                    $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                                    $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                                }

                                // Button anchor tag
                                $output .= '<a class="fpg-btn read-more ' . esc_attr($buttonStyle4) . '" href="' . esc_url(get_permalink()) . '" ' . $targetAttr . ' style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                                if (!empty($buttonHoverInlineStyles)) {
                                    $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                                }

                                if (!empty($buttonResetStyles)) {
                                    $output .= ' onmouseout="' . $buttonResetStyles . '"';
                                }

                                $output .= '>';

                                // Icon handling
                                $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                                $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                                $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                                if ($iconPosition === 'left' && $showButtonIcon) {
                                    $output .= $leftIcon . ' ';
                                }

                                $output .= esc_html($readMoreLabel);

                                if ($iconPosition === 'right' && $showButtonIcon) {
                                    $output .= ' ' . $rightIcon;
                                }

                                $output .= '</a></div>';
                            }
                            // End Button

                            $output .= '</div>';
                            // Add any other post content here (title, meta, etc.)
                        $output .= '</div>'; // .fancy-post-item
                    $output .= '</div>';              
                    
                } else if ($listLayoutStyle === 'style5') {
                    $borderStyles = '.fpg-blog-layout-22-item .fpg-content a.fpg-btn.fpg-border::before{';
                    
                        $borderStyles .= 'background: ' . (!empty($buttonHoverTextColor) ? esc_attr($buttonHoverTextColor) : '#332FFF') . ';';
                        
                        $borderStyles .= '}';
                        $output .= '<style>' . $borderStyles . '</style>';
                    // LEFT SIDE - Only the first post
                    $output .= '<div class="col-lg-6" style="';
                        if (!empty($itemGap)) {
                            $halfGap = is_numeric($itemGap) ? ($itemGap / 2) . 'px' : esc_attr($itemGap);
                            $output .= 'padding-left: ' . $halfGap . '; padding-right: ' . $halfGap . '; ';
                        }
                        $output .= '">';
                        $output .= '<div class="fpg-blog-layout-22-item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . ' ' . $postLinkType . '" style="';
                            // MARGIN    
                            if (isset($itemMargin['top']) || isset($itemMargin['right']) || isset($itemMargin['bottom']) || isset($itemMargin['left'])) {
                                $output .= 'margin: ' .
                                    (isset($itemMargin['top']) ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' .
                                    (isset($itemMargin['right']) ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' .
                                    (isset($itemMargin['bottom']) ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' .
                                    (isset($itemMargin['left']) ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; ';
                            }

                            // PADDING
                            if (isset($itemPadding['top']) || isset($itemPadding['right']) || isset($itemPadding['bottom']) || isset($itemPadding['left'])) {
                                $output .= 'padding: ' .
                                    (isset($itemPadding['top']) ? (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) : '0px') . ' ' .
                                    (isset($itemPadding['right']) ? (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) : '0px') . ' ' .
                                    (isset($itemPadding['bottom']) ? (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) : '0px') . ' ' .
                                    (isset($itemPadding['left']) ? (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) : '0px') . '; ';
                            }

                            // BORDER RADIUS
                            if (isset($itemBorderRadius['top']) || isset($itemBorderRadius['right']) || isset($itemBorderRadius['bottom']) || isset($itemBorderRadius['left'])) {
                                $output .= 'border-radius: ' .
                                    (isset($itemBorderRadius['top']) ? (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) : '0px') . ' ' .
                                    (isset($itemBorderRadius['right']) ? (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) : '0px') . ' ' .
                                    (isset($itemBorderRadius['bottom']) ? (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) : '0px') . ' ' .
                                    (isset($itemBorderRadius['left']) ? (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) : '0px') . '; ';
                            }

                            // BORDER WIDTH
                            if (isset($itemBorderWidth['top']) || isset($itemBorderWidth['right']) || isset($itemBorderWidth['bottom']) || isset($itemBorderWidth['left'])) {
                                $output .= 'border-width: ' .
                                    (isset($itemBorderWidth['top']) ? (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) : '0px') . ' ' .
                                    (isset($itemBorderWidth['right']) ? (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) : '0px') . ' ' .
                                    (isset($itemBorderWidth['bottom']) ? (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) : '0px') . ' ' .
                                    (isset($itemBorderWidth['left']) ? (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) : '0px') . '; ';
                            } 

                            // Border Style & Color
                            if (!empty($itemBorderType)) {
                                $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                            }
                            if (!empty($itemBorderColor)) {
                                $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                            }

                            // Background Color
                            if (!empty($itemBackgroundColor)) {
                                $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                            }

                            // Box Shadow
                            if (
                                isset($itemBoxShadow['left']) ||  // horizontal offset
                                isset($itemBoxShadow['top']) ||  // vertical offset
                                isset($itemBoxShadow['right']) ||  // blur radius
                                isset($itemBoxShadow['bottom']) ||  // spread radius
                                isset($itemBoxShadowColor)
                            ) {
                                $output .= 'box-shadow: ' .
                                    (isset($itemBoxShadow['left']) ? (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) : '0px') . ' ' .
                                    (isset($itemBoxShadow['top']) ? (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) : '0px') . ' ' .
                                    (isset($itemBoxShadow['right']) ? (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) : '0px') . ' ' .
                                    (isset($itemBoxShadow['bottom']) ? (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) : '0px') . ' ' .
                                    (!empty($itemBoxShadowColor) ? esc_attr($itemBoxShadowColor) : 'rgba(0,0,0,0.1)') . '; ';
                            }

                        $output .= '">';

                            // Thumbnail
                            if ($thumbnail && $showThumbnail) {
                                $output .= '<div class="fpg-thumb" style="';

                                // MARGIN
                                if (
                                    isset($thumbnailMargin['top']) ||
                                    isset($thumbnailMargin['right']) ||
                                    isset($thumbnailMargin['bottom']) ||
                                    isset($thumbnailMargin['left'])
                                ) {
                                    $output .= 'margin: ' .
                                        (isset($thumbnailMargin['top']) ? (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) : '0px') . ' ' .
                                        (isset($thumbnailMargin['right']) ? (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) : '0px') . ' ' .
                                        (isset($thumbnailMargin['bottom']) ? (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) : '0px') . ' ' .
                                        (isset($thumbnailMargin['left']) ? (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) : '0px') . '; ';
                                }

                                // PADDING
                                if (
                                    isset($thumbnailPadding['top']) ||
                                    isset($thumbnailPadding['right']) ||
                                    isset($thumbnailPadding['bottom']) ||
                                    isset($thumbnailPadding['left'])
                                ) {
                                    $output .= 'padding: ' .
                                        (isset($thumbnailPadding['top']) ? (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) : '0px') . ' ' .
                                        (isset($thumbnailPadding['right']) ? (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) : '0px') . ' ' .
                                        (isset($thumbnailPadding['bottom']) ? (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) : '0px') . ' ' .
                                        (isset($thumbnailPadding['left']) ? (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) : '0px') . '; ';
                                }

                                // BORDER RADIUS
                                if (
                                    isset($thumbnailBorderRadius['top']) ||
                                    isset($thumbnailBorderRadius['right']) ||
                                    isset($thumbnailBorderRadius['bottom']) ||
                                    isset($thumbnailBorderRadius['left'])
                                ) {
                                    $output .= 'border-radius: ' .
                                        (isset($thumbnailBorderRadius['top']) ? (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) : '0px') . ' ' .
                                        (isset($thumbnailBorderRadius['right']) ? (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) : '0px') . ' ' .
                                        (isset($thumbnailBorderRadius['bottom']) ? (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) : '0px') . ' ' .
                                        (isset($thumbnailBorderRadius['left']) ? (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) : '0px') . '; ';
                                }

                                $output .= '">';

                                // Anchor with optional border-radius and overflow
                                if ($thumbnailLink) {
                                    $output .= '<a href="' . esc_url($permalink) . '"' . $targetAttr . '>';
                                    $output .= $thumbnail;
                                    $output .= '</a>';
                                } else {
                                    $output .= $thumbnail;
                                }
                                
                                $output .= '</div>';
                            }

                            // END Thumbnail
                            // MAIN Content
                            $output .= '<div class="fpg-content" style="';
                                
                                // MARGIN
                                if (
                                    isset($contentitemMarginNew['top']) ||
                                    isset($contentitemMarginNew['right']) ||
                                    isset($contentitemMarginNew['bottom']) ||
                                    isset($contentitemMarginNew['left'])
                                ) {
                                    $output .= 'margin: ' .
                                        (isset($contentitemMarginNew['top']) ? (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) : '0px') . ' ' .
                                        (isset($contentitemMarginNew['right']) ? (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) : '0px') . ' ' .
                                        (isset($contentitemMarginNew['bottom']) ? (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) : '0px') . ' ' .
                                        (isset($contentitemMarginNew['left']) ? (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) : '0px') . '; ';
                                }
                                // PADDING
                                if (
                                    isset($contentitemPaddingNew['top']) ||
                                    isset($contentitemPaddingNew['right']) ||
                                    isset($contentitemPaddingNew['bottom']) ||
                                    isset($contentitemPaddingNew['left'])
                                ) {
                                    $output .= 'padding: ' .
                                        (isset($contentitemPaddingNew['top']) ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' .
                                        (isset($contentitemPaddingNew['right']) ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' .
                                        (isset($contentitemPaddingNew['bottom']) ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' .
                                        (isset($contentitemPaddingNew['left']) ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; ';
                                }

                                // BORDER WIDTH
                                if (
                                    isset($contentBorderWidth['top']) ||
                                    isset($contentBorderWidth['right']) ||
                                    isset($contentBorderWidth['bottom']) ||
                                    isset($contentBorderWidth['left'])
                                ) {
                                    $output .= 'border-width: ' .
                                        (isset($contentBorderWidth['top']) ? (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) : '0px') . ' ' .
                                        (isset($contentBorderWidth['right']) ? (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) : '0px') . ' ' .
                                        (isset($contentBorderWidth['bottom']) ? (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) : '0px') . ' ' .
                                        (isset($contentBorderWidth['left']) ? (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) : '0px') . '; ';
                                }
                                // BORDER radius
                                    if (
                                        isset($contentitemRadius['top']) ||
                                        isset($contentitemRadius['right']) ||
                                        isset($contentitemRadius['bottom']) ||
                                        isset($contentitemRadius['left'])
                                    ) {
                                        $output .= 'border-radius: ' .
                                            (isset($contentitemRadius['top']) ? (is_numeric($contentitemRadius['top']) ? $contentitemRadius['top'] . 'px' : esc_attr($contentitemRadius['top'])) : '0px') . ' ' .
                                            (isset($contentitemRadius['right']) ? (is_numeric($contentitemRadius['right']) ? $contentitemRadius['right'] . 'px' : esc_attr($contentitemRadius['right'])) : '0px') . ' ' .
                                            (isset($contentitemRadius['bottom']) ? (is_numeric($contentitemRadius['bottom']) ? $contentitemRadius['bottom'] . 'px' : esc_attr($contentitemRadius['bottom'])) : '0px') . ' ' .
                                            (isset($contentitemRadius['left']) ? (is_numeric($contentitemRadius['left']) ? $contentitemRadius['left'] . 'px' : esc_attr($contentitemRadius['left'])) : '0px') . '; ';
                                    }
                                // Border Style
                                if (!empty($contentNormalBorderType)) {
                                    $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                                }
                                // Background Color
                                if (!empty($contentBgColor)) {
                                    $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                                }
                                // Border Color
                                if (!empty($contentBorderColor)) {
                                    $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                                }
                            $output .= '">';

                            // Meta Data
                            if ($showMetaData) {
                                   
                                $output .= '<div class="fpg-meta" " style="';    
                                    // Order
                                    if (!empty($metaOrder)) {
                                        $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                                    } 
                                
                                $output .= '">';      
                                    $output .= '<ul class="blog-meta align-' . $metaAlignment . ' " style="';  
                                        // MARGIN
                                        if (
                                            isset($metaMarginNew['top']) ||
                                            isset($metaMarginNew['right']) ||
                                            isset($metaMarginNew['bottom']) ||
                                            isset($metaMarginNew['left'])
                                        ) {
                                            $output .= 'margin: ' .
                                                (isset($metaMarginNew['top']) ? (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) : '0px') . ' ' .
                                                (isset($metaMarginNew['right']) ? (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) : '0px') . ' ' .
                                                (isset($metaMarginNew['bottom']) ? (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) : '0px') . ' ' .
                                                (isset($metaMarginNew['left']) ? (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) : '0px') . '; ';
                                        }

                                        // PADDING
                                        if (
                                            isset($metaPadding['top']) ||
                                            isset($metaPadding['right']) ||
                                            isset($metaPadding['bottom']) ||
                                            isset($metaPadding['left'])
                                        ) {
                                            $output .= 'padding: ' .
                                                (isset($metaPadding['top']) ? (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) : '0px') . ' ' .
                                                (isset($metaPadding['right']) ? (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) : '0px') . ' ' .
                                                (isset($metaPadding['bottom']) ? (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) : '0px') . ' ' .
                                                (isset($metaPadding['left']) ? (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) : '0px') . '; ';
                                        }   
                                        
                                        // Color
                                        if (!empty($metaTextColor)) {
                                            $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                                        }
                                        
                                    $output .= '">';

                                    $meta_items = [];

                                    // Date
                                    if ($showPostDate) {
                                        $meta = '<li class="meta-date" style="';

                                        // Color
                                        if (!empty($metaTextColor)) {
                                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                        }

                                        // Font size
                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '">';

                                        // Icon
                                        if ($showPostDateIcon && $showMetaIcon) {
                                            $meta .= '<i class="fas fa-calendar-alt" style="';

                                            if (!empty($metaIconColor)) {
                                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                            }

                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '"></i> ';
                                        }

                                        $meta .= esc_html($getdate) . '</li>';
                                        $meta_items[] = $meta;
                                    }
                                    
                                    // Category
                                    if ($showPostCategory) {
                                        $meta = '<li class="meta-categories" style="';

                                        if (!empty($metaTextColor)) {
                                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '">';

                                        if ($showPostCategoryIcon && $showMetaIcon) {
                                            $meta .= '<i class="fas fa-folder" style="';

                                            if (!empty($metaIconColor)) {
                                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                            }

                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '"></i> ';
                                        }

                                        // Get category names without links
                                        $categories_list = get_the_category($post_id);
                                        if (!empty($categories_list)) {
                                            $category_names = array();
                                            foreach ($categories_list as $category) {
                                                $category_names[] = esc_html($category->name);
                                            }
                                            $meta .= implode(', ', $category_names); // comma-separated plain text categories
                                        }

                                        $meta .= '</li>';
                                        $meta_items[] = $meta;
                                    }
                                    

                                    // Now join meta items with the separator
                                    $output .= implode('<span class="meta-separator" style="color:' . esc_attr($metaIconColor) . '; font-size:' . esc_attr($metaFontSize) . 'px;">' . esc_html($metaSeperator) . '</span>', $meta_items);

                                    $output .= '</ul>'; // Close meta-data-list
                                $output .= '</div>'; // Close meta-data-list
                            }
                            // End Meta Data

                            // title
                            if ($showPostTitle) {
                                $titleStyles = '';

                                // Order
                                if (!empty($titleOrder)) {
                                    $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                                }

                                // Background color
                                if (!empty($postTitleBgColor)) {
                                    $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                                }

                                // Margin
                                if (isset($postTitleMargin['top']) || isset($postTitleMargin['right']) || isset($postTitleMargin['bottom']) || isset($postTitleMargin['left'])) {
                                    $titleStyles .= 'margin: ' .
                                        (isset($postTitleMargin['top']) ? (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) : '0px') . ' ' .
                                        (isset($postTitleMargin['right']) ? (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) : '0px') . ' ' .
                                        (isset($postTitleMargin['bottom']) ? (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) : '0px') . ' ' .
                                        (isset($postTitleMargin['left']) ? (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) : '0px') . '; ';
                                }

                                // Padding
                                if (isset($postTitlePadding['top']) || isset($postTitlePadding['right']) || isset($postTitlePadding['bottom']) || isset($postTitlePadding['left'])) {
                                    $titleStyles .= 'padding: ' .
                                        (isset($postTitlePadding['top']) ? (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) : '0px') . ' ' .
                                        (isset($postTitlePadding['right']) ? (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) : '0px') . ' ' .
                                        (isset($postTitlePadding['bottom']) ? (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) : '0px') . ' ' .
                                        (isset($postTitlePadding['left']) ? (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) : '0px') . '; ';
                                }

                                // Determine if underline should be shown
                                $showUnderline = $postLinkType === 'yeslink' && $titleHoverUnderLine === 'enable';

                                // Class name
                                $classNames = 'title align-' . esc_attr($postTitleAlignment);
                                if ($showUnderline) {
                                    $classNames .= ' underline';
                                }

                                // Hover/Out events for nolink
                                $onmouseover = '';
                                $onmouseout  = '';

                                if (!empty($postTitleHoverBgColor)) {
                                    $onmouseover .= 'this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';';
                                }

                                if (!empty($postTitleHoverColor)) {
                                    $onmouseover .= ' this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                                }

                                if (!empty($postTitleBgColor)) {
                                    $onmouseout .= 'this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';';
                                } else {
                                    $onmouseout .= 'this.style.removeProperty(\'background-color\');';
                                }

                                if (!empty($postTitleColor)) {
                                    $onmouseout .= ' this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                                } else {
                                    $onmouseout .= ' this.style.removeProperty(\'color\');';
                                }

                                // Opening title tag
                                $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"'
                                    . (!empty($onmouseover) ? ' onmouseover="' . trim($onmouseover) . '"' : '')
                                    . (!empty($onmouseout)  ? ' onmouseout="'  . trim($onmouseout)  . '"' : '') . '>';

                                if ($postLinkType === 'yeslink') {
                                    // Anchor styles
                                    $style = '';
                                    $hoverStyle = '';
                                    $mouseoutStyle = '';

                                    if (!empty($postTitleFontSize)) {
                                        $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                                    }

                                    if (!empty($postTitleLineHeight)) {
                                        $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                                    }

                                    if (!empty($postTitleLetterSpacing)) {
                                        $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                                    }

                                    if (!empty($postTitleFontWeight)) {
                                        $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                                    }

                                    if (!empty($postTitleColor)) {
                                        $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                        $mouseoutStyle .= 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                                    } else {
                                        $mouseoutStyle .= 'this.style.color=\'\';';
                                    }

                                    if (!empty($postTitleHoverColor)) {
                                        $hoverStyle .= 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                                    }

                                    if ($showUnderline && !empty($postTitleHoverColor)) {
                                        $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                                        $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                        $hoverStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                                    }

                                    if ($showUnderline && empty($postTitleColor ) && !empty($postTitleColor )) {
                                        $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                                        $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                        $mouseoutStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                                    } else {
                                        
                                        $mouseoutStyle .= ' this.style.removeProperty(\'background-position\');';
                                        $mouseoutStyle .= ' this.style.removeProperty(\'background-size\');';
                                    }

                                    $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '
                                        style="' . esc_attr(trim($style)) . '"'
                                        . (!empty($hoverStyle)   ? ' onmouseover="' . $hoverStyle . '"' : '')
                                        . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                        . esc_html($croppedTitle) . '</a>';
                                } else {
                                    // No link  render span with inline styles
                                    $inlineStyle = '';
                                    if (!empty($postTitleFontSize)) {
                                        $inlineStyle .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                                    }
                                    if (!empty($postTitleLineHeight)) {
                                        $inlineStyle .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                                    }
                                    if (!empty($postTitleLetterSpacing)) {
                                        $inlineStyle .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                                    }
                                    if (!empty($postTitleFontWeight)) {
                                        $inlineStyle .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                                    }
                                    if (!empty($postTitleColor)) {
                                        $inlineStyle .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                    }

                                    $output .= '<span style="' . esc_attr(trim($inlineStyle)) . '">' . esc_html($croppedTitle) . '</span>';
                                }

                                $output .= '</' . esc_attr($titleTag) . '>';
                            }

                            // Excerpt
                            if ($showPostExcerpt) {
                                $excerptStyles = '';

                                // Order
                                if (!empty($excerptOrder)) {
                                    $excerptStyles .= 'order: ' . esc_attr($excerptOrder) . '; ';
                                }

                                // Typography
                                if (!empty($excerptFontSize)) {
                                    $excerptStyles .= 'font-size: ' . esc_attr($excerptFontSize) . 'px; ';
                                }

                                if (!empty($excerptLineHeight)) {
                                    $excerptStyles .= 'line-height: ' . esc_attr($excerptLineHeight) . '; ';
                                }

                                if (!empty($excerptLetterSpacing)) {
                                    $excerptStyles .= 'letter-spacing: ' . esc_attr($excerptLetterSpacing) . 'px; ';
                                }

                                if (!empty($excerptFontWeight)) {
                                    $excerptStyles .= 'font-weight: ' . esc_attr($excerptFontWeight) . '; ';
                                }

                                if (!empty($excerptColor)) {
                                    $excerptStyles .= 'color: ' . esc_attr($excerptColor) . '; ';
                                }

                                if (!empty($excerptBgColor)) {
                                    $excerptStyles .= 'background-color: ' . esc_attr($excerptBgColor) . '; ';
                                }

                                if (!empty($excerptBorderType)) {
                                    $excerptStyles .= 'border-style: ' . esc_attr($excerptBorderType) . '; ';
                                }

                                // Margin
                                if (isset($excerptMargin['top']) || isset($excerptMargin['right']) || isset($excerptMargin['bottom']) || isset($excerptMargin['left'])) {
                                    $excerptStyles .= 'margin: ' .
                                        (isset($excerptMargin['top']) ? (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) : '0px') . ' ' .
                                        (isset($excerptMargin['right']) ? (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) : '0px') . ' ' .
                                        (isset($excerptMargin['bottom']) ? (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) : '0px') . ' ' .
                                        (isset($excerptMargin['left']) ? (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) : '0px') . '; ';
                                }

                                // Padding
                                if (isset($excerptPadding['top']) || isset($excerptPadding['right']) || isset($excerptPadding['bottom']) || isset($excerptPadding['left'])) {
                                    $excerptStyles .= 'padding: ' .
                                        (isset($excerptPadding['top']) ? (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) : '0px') . ' ' .
                                        (isset($excerptPadding['right']) ? (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) : '0px') . ' ' .
                                        (isset($excerptPadding['bottom']) ? (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) : '0px') . ' ' .
                                        (isset($excerptPadding['left']) ? (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) : '0px') . '; ';
                                }

                                // Handle hover logic conditionally
                                $hoverIn = '';
                                $hoverOut = '';

                                if (!empty($excerptHoverColor)) {
                                    $hoverIn .= 'this.style.color=\'' . esc_attr($excerptHoverColor) . '\';';
                                    $hoverOut .= 'this.style.color=\'' . esc_attr($excerptColor) . '\';';
                                }

                                if (!empty($excerptHoverBgColor)) {
                                    $hoverIn .= 'this.style.backgroundColor=\'' . esc_attr($excerptHoverBgColor) . '\';';
                                    $hoverOut .= 'this.style.backgroundColor=\'' . esc_attr($excerptBgColor) . '\';';
                                }

                                $output .= '<div class="fpg-excerpt' . ' align-' . esc_attr($excerptAlignment) . '" style="' . esc_attr(trim($excerptStyles)) . '"';

                                if (!empty($hoverIn) || !empty($hoverOut)) {
                                    $output .= ' onmouseover="' . esc_attr($hoverIn) . '"';
                                    $output .= ' onmouseout="' . esc_attr($hoverOut) . '"';
                                }

                                $output .= '>';
                                $output .= '<p>' . esc_html($excerpt) . '</p>';
                                $output .= '</div>';
                            }
                            // End Excerpt

                            // Button Output                
                            if ($showReadMoreButton) {
                                // Button wrapper styles
                                $buttonWrapperStyle = '';

                                // Margin
                                if (
                                    isset($buttonMarginNew['top']) || 
                                    isset($buttonMarginNew['right']) || 
                                    isset($buttonMarginNew['bottom']) || 
                                    isset($buttonMarginNew['left'])
                                ) {
                                    $buttonWrapperStyle .= 'margin: ' .
                                        (isset($buttonMarginNew['top']) ? (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) : '0px') . ' ' .
                                        (isset($buttonMarginNew['right']) ? (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) : '0px') . ' ' .
                                        (isset($buttonMarginNew['bottom']) ? (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) : '0px') . ' ' .
                                        (isset($buttonMarginNew['left']) ? (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) : '0px') . '; ';
                                }

                                // Order
                                if (!empty($buttonOrder)) {
                                    $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                                }

                                $output .= '<div class="btn-wrapper align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';

                                // Button inline styles
                                $buttonInlineStyles = '';

                                if (!empty($buttonTextColor)) {
                                    $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                                }
                                if (!empty($buttonBackgroundColor)) {
                                    $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                                }
                                if (!empty($buttonFontSize)) {
                                    $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                                }
                                if (!empty($buttonFontWeight)) {
                                    $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                                }
                                if (!empty($buttonBorderColor)) {
                                    $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                                }
                                if (!empty($buttonBorderType)) {
                                    $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                                }

                                // Border Width
                                if (
                                    isset($buttonBorderWidth['top']) || 
                                    isset($buttonBorderWidth['right']) || 
                                    isset($buttonBorderWidth['bottom']) || 
                                    isset($buttonBorderWidth['left'])
                                ) {
                                    $buttonInlineStyles .= 'border-width: ' .
                                        (isset($buttonBorderWidth['top']) ? (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) : '0px') . ' ' .
                                        (isset($buttonBorderWidth['right']) ? (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) : '0px') . ' ' .
                                        (isset($buttonBorderWidth['bottom']) ? (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) : '0px') . ' ' .
                                        (isset($buttonBorderWidth['left']) ? (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) : '0px') . '; ';
                                }

                                // Border Radius
                                if (
                                    isset($buttonBorderRadius['top']) || 
                                    isset($buttonBorderRadius['right']) || 
                                    isset($buttonBorderRadius['bottom']) || 
                                    isset($buttonBorderRadius['left'])
                                ) {
                                    $buttonInlineStyles .= 'border-radius: ' .
                                        (isset($buttonBorderRadius['top']) ? (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) : '0px') . ' ' .
                                        (isset($buttonBorderRadius['right']) ? (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) : '0px') . ' ' .
                                        (isset($buttonBorderRadius['bottom']) ? (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) : '0px') . ' ' .
                                        (isset($buttonBorderRadius['left']) ? (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) : '0px') . '; ';
                                }

                                // Padding
                                if (
                                    isset($buttonPaddingNew['top']) || 
                                    isset($buttonPaddingNew['right']) || 
                                    isset($buttonPaddingNew['bottom']) || 
                                    isset($buttonPaddingNew['left'])
                                ) {
                                    $buttonInlineStyles .= 'padding: ' .
                                        (isset($buttonPaddingNew['top']) ? (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) : '0px') . ' ' .
                                        (isset($buttonPaddingNew['right']) ? (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) : '0px') . ' ' .
                                        (isset($buttonPaddingNew['bottom']) ? (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) : '0px') . ' ' .
                                        (isset($buttonPaddingNew['left']) ? (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) : '0px') . '; ';
                                } 

                                // Hover styles
                                $buttonHoverInlineStyles = '';
                                $buttonResetStyles = '';

                                if (!empty($buttonHoverTextColor)) {
                                    $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                                    $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                                }
                                if (!empty($buttonHoverBorderColor)) {
                                    $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                                    $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                                }
                                if (!empty($buttonHoverBackgroundColor)) {
                                    $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                                    $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                                }

                                // Button anchor tag
                                $output .= '<a class="fpg-btn read-more ' . esc_attr($buttonStyle5) . '" href="' . esc_url(get_permalink()) . '" ' . $targetAttr . ' style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                                if (!empty($buttonHoverInlineStyles)) {
                                    $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                                }

                                if (!empty($buttonResetStyles)) {
                                    $output .= ' onmouseout="' . $buttonResetStyles . '"';
                                }

                                $output .= '>';

                                // Icon handling
                                $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                                $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                                $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                                if ($iconPosition === 'left' && $showButtonIcon) {
                                    $output .= $leftIcon . ' ';
                                }

                                $output .= esc_html($readMoreLabel);

                                if ($iconPosition === 'right' && $showButtonIcon) {
                                    $output .= ' ' . $rightIcon;
                                }

                                $output .= '</a></div>';
                            }
                            // End Button

                            $output .= '</div>';
                            // Add any other post content here (title, meta, etc.)
                        $output .= '</div>'; // .fancy-post-item
                    $output .= '</div>';              
                } else if ($listLayoutStyle === 'style6') {
                    
                    // LEFT SIDE - Only the first post
                    $output .= '<div class="col-lg-4" style="';
                        if (!empty($itemGap)) {
                            $halfGap = is_numeric($itemGap) ? ($itemGap / 2) . 'px' : esc_attr($itemGap);
                            $output .= 'padding-left: ' . $halfGap . '; padding-right: ' . $halfGap . '; ';
                        }
                    $output .= '">';
                        $output .= '<div class="fpg-blog-layout-24-item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . ' ' . $postLinkType . '" style="';
                            // MARGIN    
                            if (isset($itemMargin['top']) || isset($itemMargin['right']) || isset($itemMargin['bottom']) || isset($itemMargin['left'])) {
                                $output .= 'margin: ' .
                                    (isset($itemMargin['top']) ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' .
                                    (isset($itemMargin['right']) ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' .
                                    (isset($itemMargin['bottom']) ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' .
                                    (isset($itemMargin['left']) ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; ';
                            }

                            // PADDING
                            if (isset($itemPadding['top']) || isset($itemPadding['right']) || isset($itemPadding['bottom']) || isset($itemPadding['left'])) {
                                $output .= 'padding: ' .
                                    (isset($itemPadding['top']) ? (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) : '0px') . ' ' .
                                    (isset($itemPadding['right']) ? (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) : '0px') . ' ' .
                                    (isset($itemPadding['bottom']) ? (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) : '0px') . ' ' .
                                    (isset($itemPadding['left']) ? (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) : '0px') . '; ';
                            }

                            // BORDER RADIUS
                            if (isset($itemBorderRadius['top']) || isset($itemBorderRadius['right']) || isset($itemBorderRadius['bottom']) || isset($itemBorderRadius['left'])) {
                                $output .= 'border-radius: ' .
                                    (isset($itemBorderRadius['top']) ? (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) : '0px') . ' ' .
                                    (isset($itemBorderRadius['right']) ? (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) : '0px') . ' ' .
                                    (isset($itemBorderRadius['bottom']) ? (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) : '0px') . ' ' .
                                    (isset($itemBorderRadius['left']) ? (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) : '0px') . '; ';
                            }

                            // BORDER WIDTH
                            if (isset($itemBorderWidth['top']) || isset($itemBorderWidth['right']) || isset($itemBorderWidth['bottom']) || isset($itemBorderWidth['left'])) {
                                $output .= 'border-width: ' .
                                    (isset($itemBorderWidth['top']) ? (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) : '0px') . ' ' .
                                    (isset($itemBorderWidth['right']) ? (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) : '0px') . ' ' .
                                    (isset($itemBorderWidth['bottom']) ? (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) : '0px') . ' ' .
                                    (isset($itemBorderWidth['left']) ? (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) : '0px') . '; ';
                            }

                            // Border Style & Color
                            if (!empty($itemBorderType)) {
                                $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                            }
                            if (!empty($itemBorderColor)) {
                                $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                            }

                            // Background Color
                            if (!empty($itemBackgroundColor)) {
                                $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                            }

                            // Box Shadow
                            if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                                $output .= 'box-shadow: ' . 
                                    (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                                    (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                                    (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                                    (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                                    esc_attr($itemBoxShadowColor) . '; ';
                            }

                        $output .= '">';

                            // Thumbnail
                            if ($thumbnail && $showThumbnail) {
                                $output .= '<div class="fpg-thumb" style="';

                                // MARGIN
                                if (
                                    isset($thumbnailMargin['top']) ||
                                    isset($thumbnailMargin['right']) ||
                                    isset($thumbnailMargin['bottom']) ||
                                    isset($thumbnailMargin['left'])
                                ) {
                                    $output .= 'margin: ' .
                                        (isset($thumbnailMargin['top']) ? (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) : '0px') . ' ' .
                                        (isset($thumbnailMargin['right']) ? (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) : '0px') . ' ' .
                                        (isset($thumbnailMargin['bottom']) ? (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) : '0px') . ' ' .
                                        (isset($thumbnailMargin['left']) ? (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) : '0px') . '; ';
                                }

                                // PADDING
                                if (
                                    isset($thumbnailPadding['top']) ||
                                    isset($thumbnailPadding['right']) ||
                                    isset($thumbnailPadding['bottom']) ||
                                    isset($thumbnailPadding['left'])
                                ) {
                                    $output .= 'padding: ' .
                                        (isset($thumbnailPadding['top']) ? (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) : '0px') . ' ' .
                                        (isset($thumbnailPadding['right']) ? (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) : '0px') . ' ' .
                                        (isset($thumbnailPadding['bottom']) ? (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) : '0px') . ' ' .
                                        (isset($thumbnailPadding['left']) ? (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) : '0px') . '; ';
                                }

                                // BORDER RADIUS
                                if (
                                    isset($thumbnailBorderRadius['top']) ||
                                    isset($thumbnailBorderRadius['right']) ||
                                    isset($thumbnailBorderRadius['bottom']) ||
                                    isset($thumbnailBorderRadius['left'])
                                ) {
                                    $output .= 'border-radius: ' .
                                        (isset($thumbnailBorderRadius['top']) ? (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) : '0px') . ' ' .
                                        (isset($thumbnailBorderRadius['right']) ? (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) : '0px') . ' ' .
                                        (isset($thumbnailBorderRadius['bottom']) ? (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) : '0px') . ' ' .
                                        (isset($thumbnailBorderRadius['left']) ? (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) : '0px') . '; ';
                                }

                                $output .= '">';

                                if ($thumbnailLink) {
                                    $output .= '<a href="' . esc_url($permalink) . '"' . $targetAttr . '>';
                                    $output .= $thumbnail;
                                    $output .= '</a>';
                                } else {
                                    $output .= $thumbnail;
                                }
                                
                                $output .= '</div>';
                            }
                            // END Thumbnail

                            // MAIN Content
                            $output .= '<div class="fpg-content" style="';
                                // MARGIN
                                if (
                                    isset($contentitemMarginNew['top']) ||
                                    isset($contentitemMarginNew['right']) ||
                                    isset($contentitemMarginNew['bottom']) ||
                                    isset($contentitemMarginNew['left'])
                                ) {
                                    $output .= 'margin: ' .
                                        (isset($contentitemMarginNew['top']) ? (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) : '0px') . ' ' .
                                        (isset($contentitemMarginNew['right']) ? (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) : '0px') . ' ' .
                                        (isset($contentitemMarginNew['bottom']) ? (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) : '0px') . ' ' .
                                        (isset($contentitemMarginNew['left']) ? (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) : '0px') . '; ';
                                }

                                // PADDING
                                if (
                                    isset($contentitemPaddingNew['top']) ||
                                    isset($contentitemPaddingNew['right']) ||
                                    isset($contentitemPaddingNew['bottom']) ||
                                    isset($contentitemPaddingNew['left'])
                                ) {
                                    $output .= 'padding: ' .
                                        (isset($contentitemPaddingNew['top']) ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' .
                                        (isset($contentitemPaddingNew['right']) ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' .
                                        (isset($contentitemPaddingNew['bottom']) ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' .
                                        (isset($contentitemPaddingNew['left']) ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; ';
                                }

                                // BORDER WIDTH
                                if (
                                    isset($contentBorderWidth['top']) ||
                                    isset($contentBorderWidth['right']) ||
                                    isset($contentBorderWidth['bottom']) ||
                                    isset($contentBorderWidth['left'])
                                ) {
                                    $output .= 'border-width: ' .
                                        (isset($contentBorderWidth['top']) ? (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) : '0px') . ' ' .
                                        (isset($contentBorderWidth['right']) ? (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) : '0px') . ' ' .
                                        (isset($contentBorderWidth['bottom']) ? (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) : '0px') . ' ' .
                                        (isset($contentBorderWidth['left']) ? (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) : '0px') . '; ';
                                }
                                // BORDER radius
                                    if (
                                        isset($contentitemRadius['top']) ||
                                        isset($contentitemRadius['right']) ||
                                        isset($contentitemRadius['bottom']) ||
                                        isset($contentitemRadius['left'])
                                    ) {
                                        $output .= 'border-radius: ' .
                                            (isset($contentitemRadius['top']) ? (is_numeric($contentitemRadius['top']) ? $contentitemRadius['top'] . 'px' : esc_attr($contentitemRadius['top'])) : '0px') . ' ' .
                                            (isset($contentitemRadius['right']) ? (is_numeric($contentitemRadius['right']) ? $contentitemRadius['right'] . 'px' : esc_attr($contentitemRadius['right'])) : '0px') . ' ' .
                                            (isset($contentitemRadius['bottom']) ? (is_numeric($contentitemRadius['bottom']) ? $contentitemRadius['bottom'] . 'px' : esc_attr($contentitemRadius['bottom'])) : '0px') . ' ' .
                                            (isset($contentitemRadius['left']) ? (is_numeric($contentitemRadius['left']) ? $contentitemRadius['left'] . 'px' : esc_attr($contentitemRadius['left'])) : '0px') . '; ';
                                    }
                                // Border Style
                                if (!empty($contentNormalBorderType)) {
                                    $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                                }
                                // Background Color
                                if (!empty($contentBgColor)) {
                                    $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                                }
                                // Border Color
                                if (!empty($contentBorderColor)) {
                                    $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                                }
                            $output .= '">';

                            // Meta Data
                            if ($showMetaData) {
                                $output .= '<div class="fpg-meta" " style="';    
                                    // Order
                                    if (!empty($metaOrder)) {
                                        $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                                    } 
                                
                                $output .= '">';       
                                    $output .= '<ul class="blog-meta align-' . $metaAlignment . ' " style="';  
                                        // MARGIN
                                        if (
                                            isset($metaMarginNew['top']) ||
                                            isset($metaMarginNew['right']) ||
                                            isset($metaMarginNew['bottom']) ||
                                            isset($metaMarginNew['left'])
                                        ) {
                                            $output .= 'margin: ' .
                                                (isset($metaMarginNew['top']) ? (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) : '0px') . ' ' .
                                                (isset($metaMarginNew['right']) ? (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) : '0px') . ' ' .
                                                (isset($metaMarginNew['bottom']) ? (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) : '0px') . ' ' .
                                                (isset($metaMarginNew['left']) ? (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) : '0px') . '; ';
                                        }

                                        // PADDING
                                        if (
                                            isset($metaPadding['top']) ||
                                            isset($metaPadding['right']) ||
                                            isset($metaPadding['bottom']) ||
                                            isset($metaPadding['left'])
                                        ) {
                                            $output .= 'padding: ' .
                                                (isset($metaPadding['top']) ? (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) : '0px') . ' ' .
                                                (isset($metaPadding['right']) ? (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) : '0px') . ' ' .
                                                (isset($metaPadding['bottom']) ? (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) : '0px') . ' ' .
                                                (isset($metaPadding['left']) ? (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) : '0px') . '; ';
                                        }  
                                        
                                        // Color
                                        if (!empty($metaTextColor)) {
                                            $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                                        }
                                        
                                    $output .= '">';

                                    $meta_items = [];

                                    // Date
                                    if ($showPostDate) {
                                        $meta = '<li class="meta-date" style="';

                                        // Color
                                        if (!empty($metaTextColor)) {
                                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                        }

                                        // Font size
                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '">';

                                        // Icon
                                        if ($showPostDateIcon && $showMetaIcon) {
                                            $meta .= '<i class="fas fa-calendar-alt" style="';

                                            if (!empty($metaIconColor)) {
                                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                            }

                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '"></i> ';
                                        }

                                        $meta .= esc_html($getdate) . '</li>';
                                        $meta_items[] = $meta;
                                    }
                                    
                                    if ($showPostAuthor) {
                                        $meta = '<li class="meta-author" style="';

                                        if (!empty($metaTextColor)) {
                                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '">';

                                        if ($showPostAuthorIcon && $showMetaIcon) {
                                            $meta .= '<i class="fas fa-user" style="';

                                            if (!empty($metaIconColor)) {
                                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                            }

                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '"></i> ';
                                        }

                                        $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                                        $meta_items[] = $meta;
                                    }
                                    
                                    // Now join meta items with the separator
                                    $output .= implode('<span class="meta-separator" style="color:' . esc_attr($separatorColor) . '; font-size:' . esc_attr($metaFontSize) . 'px;">' . esc_html($metaSeperator) . '</span>', $meta_items);

                                    $output .= '</ul>'; // Close meta-data-list
                                $output .= '</div>'; // Close meta-data-list
                            }
                            // End Meta Data

                            // title
                            if ($showPostTitle) {
                                $titleStyles = '';

                                // Order
                                if (!empty($titleOrder)) {
                                    $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                                }

                                // Background color
                                if (!empty($postTitleBgColor)) {
                                    $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                                }

                                // Margin
                                if (isset($postTitleMargin['top']) || isset($postTitleMargin['right']) || isset($postTitleMargin['bottom']) || isset($postTitleMargin['left'])) {
                                    $titleStyles .= 'margin: ' .
                                        (isset($postTitleMargin['top']) ? (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) : '0px') . ' ' .
                                        (isset($postTitleMargin['right']) ? (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) : '0px') . ' ' .
                                        (isset($postTitleMargin['bottom']) ? (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) : '0px') . ' ' .
                                        (isset($postTitleMargin['left']) ? (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) : '0px') . '; ';
                                }

                                // Padding
                                if (isset($postTitlePadding['top']) || isset($postTitlePadding['right']) || isset($postTitlePadding['bottom']) || isset($postTitlePadding['left'])) {
                                    $titleStyles .= 'padding: ' .
                                        (isset($postTitlePadding['top']) ? (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) : '0px') . ' ' .
                                        (isset($postTitlePadding['right']) ? (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) : '0px') . ' ' .
                                        (isset($postTitlePadding['bottom']) ? (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) : '0px') . ' ' .
                                        (isset($postTitlePadding['left']) ? (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) : '0px') . '; ';
                                }

                                // Determine if underline should be shown
                                $showUnderline = $postLinkType === 'yeslink' && $titleHoverUnderLine === 'enable';

                                // Class name
                                $classNames = 'title align-' . esc_attr($postTitleAlignment);
                                if ($showUnderline) {
                                    $classNames .= ' underline';
                                }

                                // Hover/Out events for nolink
                                $onmouseover = '';
                                $onmouseout  = '';

                                if (!empty($postTitleHoverBgColor)) {
                                    $onmouseover .= 'this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';';
                                }

                                if (!empty($postTitleHoverColor)) {
                                    $onmouseover .= ' this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                                }

                                if (!empty($postTitleBgColor)) {
                                    $onmouseout .= 'this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';';
                                } else {
                                    $onmouseout .= 'this.style.removeProperty(\'background-color\');';
                                }

                                if (!empty($postTitleColor)) {
                                    $onmouseout .= ' this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                                } else {
                                    $onmouseout .= ' this.style.removeProperty(\'color\');';
                                }

                                // Opening title tag
                                $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"'
                                    . (!empty($onmouseover) ? ' onmouseover="' . trim($onmouseover) . '"' : '')
                                    . (!empty($onmouseout)  ? ' onmouseout="'  . trim($onmouseout)  . '"' : '') . '>';

                                if ($postLinkType === 'yeslink') {
                                    // Anchor styles
                                    $style = '';
                                    $hoverStyle = '';
                                    $mouseoutStyle = '';

                                    if (!empty($postTitleFontSize)) {
                                        $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                                    }

                                    if (!empty($postTitleLineHeight)) {
                                        $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                                    }

                                    if (!empty($postTitleLetterSpacing)) {
                                        $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                                    }

                                    if (!empty($postTitleFontWeight)) {
                                        $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                                    }

                                    if (!empty($postTitleColor)) {
                                        $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                        $mouseoutStyle .= 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                                    } else {
                                        $mouseoutStyle .= 'this.style.color=\'\';';
                                    }

                                    if (!empty($postTitleHoverColor)) {
                                        $hoverStyle .= 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                                    }

                                    if ($showUnderline && !empty($postTitleHoverColor)) {
                                        $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                                        $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                        $hoverStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                                    }

                                    if ($showUnderline && empty($postTitleColor ) && !empty($postTitleColor )) {
                                        $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                                        $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                        $mouseoutStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                                    } else {
                                        
                                        $mouseoutStyle .= ' this.style.removeProperty(\'background-position\');';
                                        $mouseoutStyle .= ' this.style.removeProperty(\'background-size\');';
                                    }

                                    $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '
                                        style="' . esc_attr(trim($style)) . '"'
                                        . (!empty($hoverStyle)   ? ' onmouseover="' . $hoverStyle . '"' : '')
                                        . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                        . esc_html($croppedTitle) . '</a>';
                                } else {
                                    // No link  render span with inline styles
                                    $inlineStyle = '';
                                    if (!empty($postTitleFontSize)) {
                                        $inlineStyle .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                                    }
                                    if (!empty($postTitleLineHeight)) {
                                        $inlineStyle .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                                    }
                                    if (!empty($postTitleLetterSpacing)) {
                                        $inlineStyle .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                                    }
                                    if (!empty($postTitleFontWeight)) {
                                        $inlineStyle .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                                    }
                                    if (!empty($postTitleColor)) {
                                        $inlineStyle .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                    }

                                    $output .= '<span style="' . esc_attr(trim($inlineStyle)) . '">' . esc_html($croppedTitle) . '</span>';
                                }

                                $output .= '</' . esc_attr($titleTag) . '>';
                            }

                            $output .= '</div>';
                            // Add any other post content here (title, meta, etc.)
                        $output .= '</div>'; // .fancy-post-item
                    $output .= '</div>';              
                } else if ($listLayoutStyle === 'style7') {
                    $borderStyles = '.fpg-blog-layout-25-item .fpg-content a.fpg-btn.fpg-border::before {';
                    
                    $borderStyles .= 'background: ' . (!empty($buttonHoverTextColor) ? esc_attr($buttonHoverTextColor) : '#332FFF') . ';';
                    
                    $borderStyles .= '}';
                    $output .= '<style>' . $borderStyles . '</style>';              
                    // LEFT SIDE - Only the first post
                    $output .= '<div class="col-lg-12">';
                        $output .= '<div class="fpg-blog-layout-25-item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . ' ' . $postLinkType . '" style="';
                            // MARGIN    
                            if (isset($itemMargin['top']) || isset($itemMargin['right']) || isset($itemMargin['bottom']) || isset($itemMargin['left'])) {
                                $output .= 'margin: ' .
                                    (isset($itemMargin['top']) ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' .
                                    (isset($itemMargin['right']) ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' .
                                    (isset($itemMargin['bottom']) ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' .
                                    (isset($itemMargin['left']) ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; ';
                            }

                            // PADDING
                            if (isset($itemPadding['top']) || isset($itemPadding['right']) || isset($itemPadding['bottom']) || isset($itemPadding['left'])) {
                                $output .= 'padding: ' .
                                    (isset($itemPadding['top']) ? (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) : '0px') . ' ' .
                                    (isset($itemPadding['right']) ? (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) : '0px') . ' ' .
                                    (isset($itemPadding['bottom']) ? (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) : '0px') . ' ' .
                                    (isset($itemPadding['left']) ? (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) : '0px') . '; ';
                            }

                            // BORDER RADIUS
                            if (isset($itemBorderRadius['top']) || isset($itemBorderRadius['right']) || isset($itemBorderRadius['bottom']) || isset($itemBorderRadius['left'])) {
                                $output .= 'border-radius: ' .
                                    (isset($itemBorderRadius['top']) ? (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) : '0px') . ' ' .
                                    (isset($itemBorderRadius['right']) ? (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) : '0px') . ' ' .
                                    (isset($itemBorderRadius['bottom']) ? (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) : '0px') . ' ' .
                                    (isset($itemBorderRadius['left']) ? (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) : '0px') . '; ';
                            }

                            // BORDER WIDTH
                            if (isset($itemBorderWidth['top']) || isset($itemBorderWidth['right']) || isset($itemBorderWidth['bottom']) || isset($itemBorderWidth['left'])) {
                                $output .= 'border-width: ' .
                                    (isset($itemBorderWidth['top']) ? (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) : '0px') . ' ' .
                                    (isset($itemBorderWidth['right']) ? (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) : '0px') . ' ' .
                                    (isset($itemBorderWidth['bottom']) ? (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) : '0px') . ' ' .
                                    (isset($itemBorderWidth['left']) ? (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) : '0px') . '; ';
                            }

                            // Border Style & Color
                            if (!empty($itemBorderType)) {
                                $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                            }
                            if (!empty($itemBorderColor)) {
                                $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                            }

                            // Background Color
                            if (!empty($itemBackgroundColor)) {
                                $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                            }

                            // Box Shadow
                            if (
                                isset($itemBoxShadow['left']) ||  // horizontal offset
                                isset($itemBoxShadow['top']) ||  // vertical offset
                                isset($itemBoxShadow['right']) ||  // blur radius
                                isset($itemBoxShadow['bottom']) ||  // spread radius
                                isset($itemBoxShadowColor)
                            ) {
                                $output .= 'box-shadow: ' .
                                    (isset($itemBoxShadow['left']) ? (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) : '0px') . ' ' .
                                    (isset($itemBoxShadow['top']) ? (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) : '0px') . ' ' .
                                    (isset($itemBoxShadow['right']) ? (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) : '0px') . ' ' .
                                    (isset($itemBoxShadow['bottom']) ? (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) : '0px') . ' ' .
                                    (!empty($itemBoxShadowColor) ? esc_attr($itemBoxShadowColor) : 'rgba(0,0,0,0.1)') . '; ';
                            }

                        $output .= '">';

                            // Thumbnail
                            if ($thumbnail && $showThumbnail) {
                                $output .= '<div class="fpg-thumb" style="';

                                // MARGIN
                                if (
                                    isset($thumbnailMargin['top']) ||
                                    isset($thumbnailMargin['right']) ||
                                    isset($thumbnailMargin['bottom']) ||
                                    isset($thumbnailMargin['left'])
                                ) {
                                    $output .= 'margin: ' .
                                        (isset($thumbnailMargin['top']) ? (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) : '0px') . ' ' .
                                        (isset($thumbnailMargin['right']) ? (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) : '0px') . ' ' .
                                        (isset($thumbnailMargin['bottom']) ? (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) : '0px') . ' ' .
                                        (isset($thumbnailMargin['left']) ? (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) : '0px') . '; ';
                                }

                                // PADDING
                                if (
                                    isset($thumbnailPadding['top']) ||
                                    isset($thumbnailPadding['right']) ||
                                    isset($thumbnailPadding['bottom']) ||
                                    isset($thumbnailPadding['left'])
                                ) {
                                    $output .= 'padding: ' .
                                        (isset($thumbnailPadding['top']) ? (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) : '0px') . ' ' .
                                        (isset($thumbnailPadding['right']) ? (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) : '0px') . ' ' .
                                        (isset($thumbnailPadding['bottom']) ? (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) : '0px') . ' ' .
                                        (isset($thumbnailPadding['left']) ? (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) : '0px') . '; ';
                                }

                                // BORDER RADIUS
                                if (
                                    isset($thumbnailBorderRadius['top']) ||
                                    isset($thumbnailBorderRadius['right']) ||
                                    isset($thumbnailBorderRadius['bottom']) ||
                                    isset($thumbnailBorderRadius['left'])
                                ) {
                                    $output .= 'border-radius: ' .
                                        (isset($thumbnailBorderRadius['top']) ? (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) : '0px') . ' ' .
                                        (isset($thumbnailBorderRadius['right']) ? (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) : '0px') . ' ' .
                                        (isset($thumbnailBorderRadius['bottom']) ? (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) : '0px') . ' ' .
                                        (isset($thumbnailBorderRadius['left']) ? (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) : '0px') . '; ';
                                }

                                $output .= '">';

                                // Anchor with optional border-radius and overflow
                                if ($thumbnailLink) {
                                    $output .= '<a href="' . esc_url($permalink) . '"' . $targetAttr . '>';
                                    $output .= $thumbnail;
                                    $output .= '</a>';
                                } else {
                                    $output .= $thumbnail;
                                }
                                $output .= '</div>';
                            }

                            // END Thumbnail
                            // MAIN Content
                            $output .= '<div class="fpg-content" style="';
                                // MARGIN
                                if (
                                    isset($contentitemMarginNew['top']) ||
                                    isset($contentitemMarginNew['right']) ||
                                    isset($contentitemMarginNew['bottom']) ||
                                    isset($contentitemMarginNew['left'])
                                ) {
                                    $output .= 'margin: ' .
                                        (isset($contentitemMarginNew['top']) ? (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) : '0px') . ' ' .
                                        (isset($contentitemMarginNew['right']) ? (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) : '0px') . ' ' .
                                        (isset($contentitemMarginNew['bottom']) ? (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) : '0px') . ' ' .
                                        (isset($contentitemMarginNew['left']) ? (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) : '0px') . '; ';
                                }

                                // PADDING
                                if (
                                    isset($contentitemPaddingNew['top']) ||
                                    isset($contentitemPaddingNew['right']) ||
                                    isset($contentitemPaddingNew['bottom']) ||
                                    isset($contentitemPaddingNew['left'])
                                ) {
                                    $output .= 'padding: ' .
                                        (isset($contentitemPaddingNew['top']) ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' .
                                        (isset($contentitemPaddingNew['right']) ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' .
                                        (isset($contentitemPaddingNew['bottom']) ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' .
                                        (isset($contentitemPaddingNew['left']) ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; ';
                                }

                                // BORDER WIDTH
                                if (
                                    isset($contentBorderWidth['top']) ||
                                    isset($contentBorderWidth['right']) ||
                                    isset($contentBorderWidth['bottom']) ||
                                    isset($contentBorderWidth['left'])
                                ) {
                                    $output .= 'border-width: ' .
                                        (isset($contentBorderWidth['top']) ? (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) : '0px') . ' ' .
                                        (isset($contentBorderWidth['right']) ? (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) : '0px') . ' ' .
                                        (isset($contentBorderWidth['bottom']) ? (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) : '0px') . ' ' .
                                        (isset($contentBorderWidth['left']) ? (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) : '0px') . '; ';
                                }
                                // BORDER radius
                                    if (
                                        isset($contentitemRadius['top']) ||
                                        isset($contentitemRadius['right']) ||
                                        isset($contentitemRadius['bottom']) ||
                                        isset($contentitemRadius['left'])
                                    ) {
                                        $output .= 'border-radius: ' .
                                            (isset($contentitemRadius['top']) ? (is_numeric($contentitemRadius['top']) ? $contentitemRadius['top'] . 'px' : esc_attr($contentitemRadius['top'])) : '0px') . ' ' .
                                            (isset($contentitemRadius['right']) ? (is_numeric($contentitemRadius['right']) ? $contentitemRadius['right'] . 'px' : esc_attr($contentitemRadius['right'])) : '0px') . ' ' .
                                            (isset($contentitemRadius['bottom']) ? (is_numeric($contentitemRadius['bottom']) ? $contentitemRadius['bottom'] . 'px' : esc_attr($contentitemRadius['bottom'])) : '0px') . ' ' .
                                            (isset($contentitemRadius['left']) ? (is_numeric($contentitemRadius['left']) ? $contentitemRadius['left'] . 'px' : esc_attr($contentitemRadius['left'])) : '0px') . '; ';
                                    }
                                // Border Style
                                if (!empty($contentNormalBorderType)) {
                                    $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                                }
                                // Background Color
                                if (!empty($contentBgColor)) {
                                    $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                                }
                                // Border Color
                                if (!empty($contentBorderColor)) {
                                    $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                                }
                            $output .= '">';

                            // Meta Data
                            if ($showMetaData) {
                                $output .= '<div class="fpg-cat align-' . $metaAlignment . '" style="';
                                
                                // Order
                                if (!empty($metaOrder)) {
                                    $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                                }

                                $output .= '">';

                                if ($showPostCategory) {
                                    $categories_list = get_the_category($post_id);
                                    if (!empty($categories_list)) {
                                        $category_names = array();
                                        foreach ($categories_list as $category) {
                                            $category_names[] = esc_html($category->name);
                                        }

                                        // Build inline styles for the <a> tag
                                        $a_styles = '';

                                        // Margin
                                        if (
                                            isset($metaMarginNew['top']) || isset($metaMarginNew['right']) ||
                                            isset($metaMarginNew['bottom']) || isset($metaMarginNew['left'])
                                        ) {
                                            $a_styles .= 'margin: ' .
                                                (isset($metaMarginNew['top']) ? (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) : '0px') . ' ' .
                                                (isset($metaMarginNew['right']) ? (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) : '0px') . ' ' .
                                                (isset($metaMarginNew['bottom']) ? (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) : '0px') . ' ' .
                                                (isset($metaMarginNew['left']) ? (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) : '0px') . '; ';
                                        }

                                        // Padding
                                        if (
                                            isset($metaPadding['top']) || isset($metaPadding['right']) ||
                                            isset($metaPadding['bottom']) || isset($metaPadding['left'])
                                        ) {
                                            $a_styles .= 'padding: ' .
                                                (isset($metaPadding['top']) ? (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) : '0px') . ' ' .
                                                (isset($metaPadding['right']) ? (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) : '0px') . ' ' .
                                                (isset($metaPadding['bottom']) ? (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) : '0px') . ' ' .
                                                (isset($metaPadding['left']) ? (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) : '0px') . '; ';
                                        }
                                        // Color
                                        if (!empty($metaTextColor)) {
                                            $a_styles .= 'color: ' . esc_attr($metaTextColor) . '; ';
                                        }
                                        // fONT SIZE
                                        if (!empty($metaFontSize)) {
                                            $a_styles .= 'font-size: ' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $output .= '<a class="category-names" style="' . esc_attr($a_styles) . '">' . implode(', ', $category_names) . '</a>';
                                    }
                                }

                                $output .= '</div>'; // Close fpg-cat
                            }
                            // End Meta Data

                            // title
                            if ($showPostTitle) {
                                $titleStyles = '';

                                // Order
                                if (!empty($titleOrder)) {
                                    $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                                }

                                // Background color
                                if (!empty($postTitleBgColor)) {
                                    $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                                }

                                // Margin
                                if (isset($postTitleMargin['top']) || isset($postTitleMargin['right']) || isset($postTitleMargin['bottom']) || isset($postTitleMargin['left'])) {
                                    $titleStyles .= 'margin: ' .
                                        (isset($postTitleMargin['top']) ? (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) : '0px') . ' ' .
                                        (isset($postTitleMargin['right']) ? (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) : '0px') . ' ' .
                                        (isset($postTitleMargin['bottom']) ? (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) : '0px') . ' ' .
                                        (isset($postTitleMargin['left']) ? (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) : '0px') . '; ';
                                }

                                // Padding
                                if (isset($postTitlePadding['top']) || isset($postTitlePadding['right']) || isset($postTitlePadding['bottom']) || isset($postTitlePadding['left'])) {
                                    $titleStyles .= 'padding: ' .
                                        (isset($postTitlePadding['top']) ? (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) : '0px') . ' ' .
                                        (isset($postTitlePadding['right']) ? (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) : '0px') . ' ' .
                                        (isset($postTitlePadding['bottom']) ? (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) : '0px') . ' ' .
                                        (isset($postTitlePadding['left']) ? (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) : '0px') . '; ';
                                }

                                // Determine if underline should be shown
                                $showUnderline = $postLinkType === 'yeslink' && $titleHoverUnderLine === 'enable';

                                // Class name
                                $classNames = 'blog-title align-' . esc_attr($postTitleAlignment);
                                if ($showUnderline) {
                                    $classNames .= ' underline';
                                }

                                // Hover/Out events for nolink
                                $onmouseover = '';
                                $onmouseout  = '';

                                if (!empty($postTitleHoverBgColor)) {
                                    $onmouseover .= 'this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';';
                                }

                                if (!empty($postTitleHoverColor)) {
                                    $onmouseover .= ' this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                                }

                                if (!empty($postTitleBgColor)) {
                                    $onmouseout .= 'this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';';
                                } else {
                                    $onmouseout .= 'this.style.removeProperty(\'background-color\');';
                                }

                                if (!empty($postTitleColor)) {
                                    $onmouseout .= ' this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                                } else {
                                    $onmouseout .= ' this.style.removeProperty(\'color\');';
                                }

                                // Opening title tag
                                $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"'
                                    . (!empty($onmouseover) ? ' onmouseover="' . trim($onmouseover) . '"' : '')
                                    . (!empty($onmouseout)  ? ' onmouseout="'  . trim($onmouseout)  . '"' : '') . '>';

                                if ($postLinkType === 'yeslink') {
                                    // Anchor styles
                                    $style = '';
                                    $hoverStyle = '';
                                    $mouseoutStyle = '';

                                    if (!empty($postTitleFontSize)) {
                                        $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                                    }

                                    if (!empty($postTitleLineHeight)) {
                                        $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                                    }

                                    if (!empty($postTitleLetterSpacing)) {
                                        $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                                    }

                                    if (!empty($postTitleFontWeight)) {
                                        $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                                    }

                                    if (!empty($postTitleColor)) {
                                        $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                        $mouseoutStyle .= 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                                    } else {
                                        $mouseoutStyle .= 'this.style.color=\'\';';
                                    }

                                    if (!empty($postTitleHoverColor)) {
                                        $hoverStyle .= 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                                    }

                                    if ($showUnderline && !empty($postTitleHoverColor)) {
                                        $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                                        $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                        $hoverStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                                    }

                                    if ($showUnderline && empty($postTitleColor ) && !empty($postTitleColor )) {
                                        $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                                        $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                        $mouseoutStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                                    } else {
                                        
                                        $mouseoutStyle .= ' this.style.removeProperty(\'background-position\');';
                                        $mouseoutStyle .= ' this.style.removeProperty(\'background-size\');';
                                    }

                                    $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '
                                        style="' . esc_attr(trim($style)) . '"'
                                        . (!empty($hoverStyle)   ? ' onmouseover="' . $hoverStyle . '"' : '')
                                        . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                        . esc_html($croppedTitle) . '</a>';
                                } else {
                                    // No link  render span with inline styles
                                    $inlineStyle = '';
                                    if (!empty($postTitleFontSize)) {
                                        $inlineStyle .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                                    }
                                    if (!empty($postTitleLineHeight)) {
                                        $inlineStyle .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                                    }
                                    if (!empty($postTitleLetterSpacing)) {
                                        $inlineStyle .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                                    }
                                    if (!empty($postTitleFontWeight)) {
                                        $inlineStyle .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                                    }
                                    if (!empty($postTitleColor)) {
                                        $inlineStyle .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                    }

                                    $output .= '<span style="' . esc_attr(trim($inlineStyle)) . '">' . esc_html($croppedTitle) . '</span>';
                                }

                                $output .= '</' . esc_attr($titleTag) . '>';
                            }
                            // Excerpt
                            if ($showPostExcerpt) {
                                $excerptStyles = '';
                                $excerptColorStyles = '';

                                // Order
                                if (!empty($excerptOrder)) {
                                    $excerptStyles .= 'order: ' . esc_attr($excerptOrder) . '; ';
                                }

                                // Typography
                                if (!empty($excerptFontSize)) {
                                    $excerptStyles .= 'font-size: ' . esc_attr($excerptFontSize) . 'px; ';
                                }

                                if (!empty($excerptLineHeight)) {
                                    $excerptStyles .= 'line-height: ' . esc_attr($excerptLineHeight) . '; ';
                                }

                                if (!empty($excerptLetterSpacing)) {
                                    $excerptStyles .= 'letter-spacing: ' . esc_attr($excerptLetterSpacing) . 'px; ';
                                }

                                if (!empty($excerptFontWeight)) {
                                    $excerptStyles .= 'font-weight: ' . esc_attr($excerptFontWeight) . '; ';
                                }

                                if (!empty($excerptColor)) {
                                    $excerptColorStyles .= 'color: ' . esc_attr($excerptColor) . '; ';
                                }

                                if (!empty($excerptBgColor)) {
                                    $excerptColorStyles .= 'background-color: ' . esc_attr($excerptBgColor) . '; ';
                                }

                                if (!empty($excerptBorderType)) {
                                    $excerptStyles .= 'border-style: ' . esc_attr($excerptBorderType) . '; ';
                                }

                                // Margin
                                if (isset($excerptMargin['top']) || isset($excerptMargin['right']) || isset($excerptMargin['bottom']) || isset($excerptMargin['left'])) {
                                    $excerptStyles .= 'margin: ' .
                                        (isset($excerptMargin['top']) ? (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) : '0px') . ' ' .
                                        (isset($excerptMargin['right']) ? (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) : '0px') . ' ' .
                                        (isset($excerptMargin['bottom']) ? (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) : '0px') . ' ' .
                                        (isset($excerptMargin['left']) ? (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) : '0px') . '; ';
                                }

                                // Padding
                                if (isset($excerptPadding['top']) || isset($excerptPadding['right']) || isset($excerptPadding['bottom']) || isset($excerptPadding['left'])) {
                                    $excerptStyles .= 'padding: ' .
                                        (isset($excerptPadding['top']) ? (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) : '0px') . ' ' .
                                        (isset($excerptPadding['right']) ? (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) : '0px') . ' ' .
                                        (isset($excerptPadding['bottom']) ? (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) : '0px') . ' ' .
                                        (isset($excerptPadding['left']) ? (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) : '0px') . '; ';
                                }

                                // Handle hover logic conditionally
                                $hoverIn = '';
                                $hoverOut = '';

                                if (!empty($excerptHoverColor)) {
                                    $hoverIn .= 'this.style.color=\'' . esc_attr($excerptHoverColor) . '\';';
                                    $hoverOut .= 'this.style.color=\'' . esc_attr($excerptColor) . '\';';
                                }

                                if (!empty($excerptHoverBgColor)) {
                                    $hoverIn .= 'this.style.backgroundColor=\'' . esc_attr($excerptHoverBgColor) . '\';';
                                    $hoverOut .= 'this.style.backgroundColor=\'' . esc_attr($excerptBgColor) . '\';';
                                }

                                $output .= '<div class="fpg-excerpt' . ' align-' . esc_attr($excerptAlignment) . '" style="' . esc_attr(trim($excerptStyles)) . '"';

                                $output .= '>';
                                $output .= '<p style="' . esc_attr(trim($excerptColorStyles)) . '"';

                                    if (!empty($hoverIn) || !empty($hoverOut)) {
                                        if (!empty($hoverIn)) {
                                            $output .= ' onmouseover="' . esc_attr($hoverIn) . '"';
                                        }
                                        if (!empty($hoverOut)) {
                                            $output .= ' onmouseout="' . esc_attr($hoverOut) . '"';
                                        }
                                    }

                                    $output .= '>' . esc_html($excerpt) . '</p>';
                                $output .= '</div>';
                            }
                            // Button Output                
                            if ($showReadMoreButton) {
                                // Button wrapper styles
                                $buttonWrapperStyle = '';

                                // Margin
                                if (
                                    isset($buttonMarginNew['top']) || 
                                    isset($buttonMarginNew['right']) || 
                                    isset($buttonMarginNew['bottom']) || 
                                    isset($buttonMarginNew['left'])
                                ) {
                                    $buttonWrapperStyle .= 'margin: ' .
                                        (isset($buttonMarginNew['top']) ? (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) : '0px') . ' ' .
                                        (isset($buttonMarginNew['right']) ? (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) : '0px') . ' ' .
                                        (isset($buttonMarginNew['bottom']) ? (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) : '0px') . ' ' .
                                        (isset($buttonMarginNew['left']) ? (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) : '0px') . '; ';
                                }
                                // Order
                                if (!empty($buttonOrder)) {
                                    $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                                }

                                $output .= '<div class="blog-btn align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';

                                // Button inline styles
                                $buttonInlineStyles = '';

                                if (!empty($buttonTextColor)) {
                                    $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                                }
                                if (!empty($buttonBackgroundColor)) {
                                    $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                                }
                                if (!empty($buttonFontSize)) {
                                    $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                                }
                                if (!empty($buttonFontWeight)) {
                                    $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                                }
                                if (!empty($buttonBorderColor)) {
                                    $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                                }
                                if (!empty($buttonBorderType)) {
                                    $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                                }

                                // Border Width
                                if (
                                    isset($buttonBorderWidth['top']) || 
                                    isset($buttonBorderWidth['right']) || 
                                    isset($buttonBorderWidth['bottom']) || 
                                    isset($buttonBorderWidth['left'])
                                ) {
                                    $buttonInlineStyles .= 'border-width: ' .
                                        (isset($buttonBorderWidth['top']) ? (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) : '0px') . ' ' .
                                        (isset($buttonBorderWidth['right']) ? (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) : '0px') . ' ' .
                                        (isset($buttonBorderWidth['bottom']) ? (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) : '0px') . ' ' .
                                        (isset($buttonBorderWidth['left']) ? (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) : '0px') . '; ';
                                }

                                // Border Radius
                                if (
                                    isset($buttonBorderRadius['top']) || 
                                    isset($buttonBorderRadius['right']) || 
                                    isset($buttonBorderRadius['bottom']) || 
                                    isset($buttonBorderRadius['left'])
                                ) {
                                    $buttonInlineStyles .= 'border-radius: ' .
                                        (isset($buttonBorderRadius['top']) ? (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) : '0px') . ' ' .
                                        (isset($buttonBorderRadius['right']) ? (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) : '0px') . ' ' .
                                        (isset($buttonBorderRadius['bottom']) ? (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) : '0px') . ' ' .
                                        (isset($buttonBorderRadius['left']) ? (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) : '0px') . '; ';
                                }

                                // Padding
                                if (
                                    isset($buttonPaddingNew['top']) || 
                                    isset($buttonPaddingNew['right']) || 
                                    isset($buttonPaddingNew['bottom']) || 
                                    isset($buttonPaddingNew['left'])
                                ) {
                                    $buttonInlineStyles .= 'padding: ' .
                                        (isset($buttonPaddingNew['top']) ? (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) : '0px') . ' ' .
                                        (isset($buttonPaddingNew['right']) ? (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) : '0px') . ' ' .
                                        (isset($buttonPaddingNew['bottom']) ? (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) : '0px') . ' ' .
                                        (isset($buttonPaddingNew['left']) ? (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) : '0px') . '; ';
                                } 

                                // Hover styles
                                $buttonHoverInlineStyles = '';
                                $buttonResetStyles = '';

                                if (!empty($buttonHoverTextColor)) {
                                    $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                                    $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                                }
                                if (!empty($buttonHoverBorderColor)) {
                                    $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                                    $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                                }
                                if (!empty($buttonHoverBackgroundColor)) {
                                    $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                                    $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                                }

                                // Button anchor tag
                                $output .= '<a class="fpg-btn read-more ' . esc_attr($buttonStyle7) . '" href="' . esc_url(get_permalink()) . '" ' . $targetAttr . ' style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                                if (!empty($buttonHoverInlineStyles)) {
                                    $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                                }

                                if (!empty($buttonResetStyles)) {
                                    $output .= ' onmouseout="' . $buttonResetStyles . '"';
                                }

                                $output .= '>';

                                // Icon handling
                                $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                                $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                                $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                                if ($iconPosition === 'left' && $showButtonIcon) {
                                    $output .= $leftIcon . ' ';
                                }

                                $output .= esc_html($readMoreLabel);

                                if ($iconPosition === 'right' && $showButtonIcon) {
                                    $output .= ' ' . $rightIcon;
                                }

                                $output .= '</a></div>';
                            }
                            // End Button

                            $output .= '</div>';
                            // Add any other post content here (title, meta, etc.)
                        $output .= '</div>'; // .fancy-post-item
                    $output .= '</div>';              
                } else if ($listLayoutStyle === 'style8') {
                    // LEFT SIDE: First 2 posts
                    // LEFT SIDE: Open left column on first post
                    $borderStyles = '.fpg-blog-layout-27-item .fpg-content a.fpg-btn.fpg-border::before {';
                    
                        $borderStyles .= 'background: ' . (!empty($buttonHoverTextColor) ? esc_attr($buttonHoverTextColor) : '#332FFF') . ';';
                        
                        $borderStyles .= '}';
                        $output .= '<style>' . $borderStyles . '</style>';
                    if ($post_count === 1) {
                        $output .= '<div class="col-lg-6">'; // Left column open
                    }

                    // Post 1  Large layout
                    if ($post_count === 1) {
                        $output .= '<div class="fpg-blog-layout-27-item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . ' ' . $postLinkType . '" style="';
                            // MARGIN    
                            if (isset($itemMargin['top']) || isset($itemMargin['right']) || isset($itemMargin['bottom']) || isset($itemMargin['left'])) {
                                $output .= 'margin: ' .
                                    (isset($itemMargin['top']) ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' .
                                    (isset($itemMargin['right']) ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' .
                                    (isset($itemMargin['bottom']) ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' .
                                    (isset($itemMargin['left']) ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; ';
                            }

                            // PADDING
                            if (isset($itemPadding['top']) || isset($itemPadding['right']) || isset($itemPadding['bottom']) || isset($itemPadding['left'])) {
                                $output .= 'padding: ' .
                                    (isset($itemPadding['top']) ? (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) : '0px') . ' ' .
                                    (isset($itemPadding['right']) ? (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) : '0px') . ' ' .
                                    (isset($itemPadding['bottom']) ? (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) : '0px') . ' ' .
                                    (isset($itemPadding['left']) ? (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) : '0px') . '; ';
                            }

                            // BORDER RADIUS
                            if (isset($itemBorderRadius['top']) || isset($itemBorderRadius['right']) || isset($itemBorderRadius['bottom']) || isset($itemBorderRadius['left'])) {
                                $output .= 'border-radius: ' .
                                    (isset($itemBorderRadius['top']) ? (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) : '0px') . ' ' .
                                    (isset($itemBorderRadius['right']) ? (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) : '0px') . ' ' .
                                    (isset($itemBorderRadius['bottom']) ? (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) : '0px') . ' ' .
                                    (isset($itemBorderRadius['left']) ? (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) : '0px') . '; ';
                            }

                            // BORDER WIDTH
                            if (isset($itemBorderWidth['top']) || isset($itemBorderWidth['right']) || isset($itemBorderWidth['bottom']) || isset($itemBorderWidth['left'])) {
                                $output .= 'border-width: ' .
                                    (isset($itemBorderWidth['top']) ? (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) : '0px') . ' ' .
                                    (isset($itemBorderWidth['right']) ? (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) : '0px') . ' ' .
                                    (isset($itemBorderWidth['bottom']) ? (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) : '0px') . ' ' .
                                    (isset($itemBorderWidth['left']) ? (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) : '0px') . '; ';
                            }
                            // Border Style & Color
                            if (!empty($itemBorderType)) {
                                $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                            }
                            if (!empty($itemBorderColor)) {
                                $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                            }

                            // Background Color
                            if (!empty($itemBackgroundColor)) {
                                $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                            }

                            // Box Shadow
                            if (
                                isset($itemBoxShadow['left']) ||  // horizontal offset
                                isset($itemBoxShadow['top']) ||  // vertical offset
                                isset($itemBoxShadow['right']) ||  // blur radius
                                isset($itemBoxShadow['bottom']) ||  // spread radius
                                isset($itemBoxShadowColor)
                            ) {
                                $output .= 'box-shadow: ' .
                                    (isset($itemBoxShadow['left']) ? (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) : '0px') . ' ' .
                                    (isset($itemBoxShadow['top']) ? (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) : '0px') . ' ' .
                                    (isset($itemBoxShadow['right']) ? (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) : '0px') . ' ' .
                                    (isset($itemBoxShadow['bottom']) ? (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) : '0px') . ' ' .
                                    (!empty($itemBoxShadowColor) ? esc_attr($itemBoxShadowColor) : 'rgba(0,0,0,0.1)') . '; ';
                            }

                        $output .= '">';

                        // Thumbnail
                        if ($leftThumbnailSize && $showThumbnail) {
                            $output .= '<div class="fpg-thumb" style="';

                            // MARGIN
                            if (
                                isset($thumbnailMargin['top']) ||
                                isset($thumbnailMargin['right']) ||
                                isset($thumbnailMargin['bottom']) ||
                                isset($thumbnailMargin['left'])
                            ) {
                                $output .= 'margin: ' .
                                    (isset($thumbnailMargin['top']) ? (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) : '0px') . ' ' .
                                    (isset($thumbnailMargin['right']) ? (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) : '0px') . ' ' .
                                    (isset($thumbnailMargin['bottom']) ? (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) : '0px') . ' ' .
                                    (isset($thumbnailMargin['left']) ? (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) : '0px') . '; ';
                            }

                            // PADDING
                            if (
                                isset($thumbnailPadding['top']) ||
                                isset($thumbnailPadding['right']) ||
                                isset($thumbnailPadding['bottom']) ||
                                isset($thumbnailPadding['left'])
                            ) {
                                $output .= 'padding: ' .
                                    (isset($thumbnailPadding['top']) ? (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) : '0px') . ' ' .
                                    (isset($thumbnailPadding['right']) ? (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) : '0px') . ' ' .
                                    (isset($thumbnailPadding['bottom']) ? (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) : '0px') . ' ' .
                                    (isset($thumbnailPadding['left']) ? (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) : '0px') . '; ';
                            }

                            // BORDER RADIUS
                            if (
                                isset($thumbnailBorderRadius['top']) ||
                                isset($thumbnailBorderRadius['right']) ||
                                isset($thumbnailBorderRadius['bottom']) ||
                                isset($thumbnailBorderRadius['left'])
                            ) {
                                $output .= 'border-radius: ' .
                                    (isset($thumbnailBorderRadius['top']) ? (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) : '0px') . ' ' .
                                    (isset($thumbnailBorderRadius['right']) ? (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) : '0px') . ' ' .
                                    (isset($thumbnailBorderRadius['bottom']) ? (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) : '0px') . ' ' .
                                    (isset($thumbnailBorderRadius['left']) ? (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) : '0px') . '; ';
                            }

                            $output .= '">';

                            if ($thumbnailLink) {
                                $output .= '<a href="' . esc_url($permalink) . '"' . $targetAttr . '>';
                                $output .= $leftThumbnailSize;
                                $output .= '</a>';
                            } else {
                                $output .= $leftThumbnailSize;
                            }
                            
                            $output .= '</div>';
                        }
                        // END Thumbnail
                            // MAIN Content
                            $output .= '<div class="fpg-content" style="';
                                // MARGIN
                                if (
                                    isset($contentitemMarginNew['top']) ||
                                    isset($contentitemMarginNew['right']) ||
                                    isset($contentitemMarginNew['bottom']) ||
                                    isset($contentitemMarginNew['left'])
                                ) {
                                    $output .= 'margin: ' .
                                        (isset($contentitemMarginNew['top']) ? (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) : '0px') . ' ' .
                                        (isset($contentitemMarginNew['right']) ? (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) : '0px') . ' ' .
                                        (isset($contentitemMarginNew['bottom']) ? (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) : '0px') . ' ' .
                                        (isset($contentitemMarginNew['left']) ? (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) : '0px') . '; ';
                                }

                                // PADDING
                                if (
                                    isset($contentitemPaddingNew['top']) ||
                                    isset($contentitemPaddingNew['right']) ||
                                    isset($contentitemPaddingNew['bottom']) ||
                                    isset($contentitemPaddingNew['left'])
                                ) {
                                    $output .= 'padding: ' .
                                        (isset($contentitemPaddingNew['top']) ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' .
                                        (isset($contentitemPaddingNew['right']) ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' .
                                        (isset($contentitemPaddingNew['bottom']) ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' .
                                        (isset($contentitemPaddingNew['left']) ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; ';
                                }

                                // BORDER WIDTH
                                if (
                                    isset($contentBorderWidth['top']) ||
                                    isset($contentBorderWidth['right']) ||
                                    isset($contentBorderWidth['bottom']) ||
                                    isset($contentBorderWidth['left'])
                                ) {
                                    $output .= 'border-width: ' .
                                        (isset($contentBorderWidth['top']) ? (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) : '0px') . ' ' .
                                        (isset($contentBorderWidth['right']) ? (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) : '0px') . ' ' .
                                        (isset($contentBorderWidth['bottom']) ? (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) : '0px') . ' ' .
                                        (isset($contentBorderWidth['left']) ? (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) : '0px') . '; ';
                                }
                                // BORDER radius
                                    if (
                                        isset($contentitemRadius['top']) ||
                                        isset($contentitemRadius['right']) ||
                                        isset($contentitemRadius['bottom']) ||
                                        isset($contentitemRadius['left'])
                                    ) {
                                        $output .= 'border-radius: ' .
                                            (isset($contentitemRadius['top']) ? (is_numeric($contentitemRadius['top']) ? $contentitemRadius['top'] . 'px' : esc_attr($contentitemRadius['top'])) : '0px') . ' ' .
                                            (isset($contentitemRadius['right']) ? (is_numeric($contentitemRadius['right']) ? $contentitemRadius['right'] . 'px' : esc_attr($contentitemRadius['right'])) : '0px') . ' ' .
                                            (isset($contentitemRadius['bottom']) ? (is_numeric($contentitemRadius['bottom']) ? $contentitemRadius['bottom'] . 'px' : esc_attr($contentitemRadius['bottom'])) : '0px') . ' ' .
                                            (isset($contentitemRadius['left']) ? (is_numeric($contentitemRadius['left']) ? $contentitemRadius['left'] . 'px' : esc_attr($contentitemRadius['left'])) : '0px') . '; ';
                                    }
                                // Border Style
                                if (!empty($contentNormalBorderType)) {
                                    $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                                }
                                // Background Color
                                if (!empty($contentBgColor)) {
                                    $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                                }
                                // Border Color
                                if (!empty($contentBorderColor)) {
                                    $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                                }
                            $output .= '">';
                                //meta
                                if ($showMetaData) {
                                      
                                    $output .= '<div class="fpg-meta" " style="';    
                                        // Order
                                        if (!empty($metaOrder)) {
                                            $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                                        } 
                                    
                                    $output .= '">';      
                                        $output .= '<ul class="blog-meta align-' . $metaAlignment . ' " style="';  
                                            // MARGIN
                                            if (
                                                isset($metaMarginNew['top']) ||
                                                isset($metaMarginNew['right']) ||
                                                isset($metaMarginNew['bottom']) ||
                                                isset($metaMarginNew['left'])
                                            ) {
                                                $output .= 'margin: ' .
                                                    (isset($metaMarginNew['top']) ? (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) : '0px') . ' ' .
                                                    (isset($metaMarginNew['right']) ? (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) : '0px') . ' ' .
                                                    (isset($metaMarginNew['bottom']) ? (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) : '0px') . ' ' .
                                                    (isset($metaMarginNew['left']) ? (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) : '0px') . '; ';
                                            }

                                            // PADDING
                                            if (
                                                isset($metaPadding['top']) ||
                                                isset($metaPadding['right']) ||
                                                isset($metaPadding['bottom']) ||
                                                isset($metaPadding['left'])
                                            ) {
                                                $output .= 'padding: ' .
                                                    (isset($metaPadding['top']) ? (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) : '0px') . ' ' .
                                                    (isset($metaPadding['right']) ? (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) : '0px') . ' ' .
                                                    (isset($metaPadding['bottom']) ? (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) : '0px') . ' ' .
                                                    (isset($metaPadding['left']) ? (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) : '0px') . '; ';
                                            }  
                                            
                                            // Color
                                            if (!empty($metaTextColor)) {
                                                $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                                            }
                                            
                                        $output .= '">';

                                        $meta_items = [];
                                        // Author
                                        if ($showPostAuthor) {
                                            $meta = '<li class="meta-author" style="';

                                            if (!empty($metaTextColor)) {
                                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                            }

                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '">';

                                            if ($showPostAuthorIcon && $showMetaIcon) {
                                                $meta .= '<i class="fas fa-user" style="';

                                                if (!empty($metaIconColor)) {
                                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                                }

                                                if (!empty($metaFontSize)) {
                                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                                }

                                                $meta .= '"></i> ';
                                            }

                                            $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                                            $meta_items[] = $meta;
                                        }
                                        // Date
                                        if ($showPostDate) {
                                            $meta = '<li class="meta-date" style="';

                                            // Color
                                            if (!empty($metaTextColor)) {
                                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                            }

                                            // Font size
                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '">';

                                            // Icon
                                            if ($showPostDateIcon && $showMetaIcon) {
                                                $meta .= '<i class="fas fa-calendar-alt" style="';

                                                if (!empty($metaIconColor)) {
                                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                                }

                                                if (!empty($metaFontSize)) {
                                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                                }

                                                $meta .= '"></i> ';
                                            }

                                            $meta .= esc_html($getdate) . '</li>';
                                            $meta_items[] = $meta;
                                        }
                                        
                                        // Now join meta items with the separator
                                        $output .= implode('<span class="meta-separator" style="color:' . esc_attr($separatorColor) . '; font-size:' . esc_attr($metaFontSize) . 'px;">' . esc_html($metaSeperator) . '</span>', $meta_items);

                                        $output .= '</ul>';  
                                    $output .= '</div>';   
                                }

                                // title
                                if ($showPostTitle) {
                                    $titleStyles = '';

                                    // Order
                                    if (!empty($titleOrder)) {
                                        $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                                    }

                                    // Background color
                                    if (!empty($postTitleBgColor)) {
                                        $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                                    }

                                    // Margin
                                    if (isset($postTitleMargin['top']) || isset($postTitleMargin['right']) || isset($postTitleMargin['bottom']) || isset($postTitleMargin['left'])) {
                                        $titleStyles .= 'margin: ' .
                                            (isset($postTitleMargin['top']) ? (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) : '0px') . ' ' .
                                            (isset($postTitleMargin['right']) ? (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) : '0px') . ' ' .
                                            (isset($postTitleMargin['bottom']) ? (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) : '0px') . ' ' .
                                            (isset($postTitleMargin['left']) ? (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) : '0px') . '; ';
                                    }

                                    // Padding
                                    if (isset($postTitlePadding['top']) || isset($postTitlePadding['right']) || isset($postTitlePadding['bottom']) || isset($postTitlePadding['left'])) {
                                        $titleStyles .= 'padding: ' .
                                            (isset($postTitlePadding['top']) ? (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) : '0px') . ' ' .
                                            (isset($postTitlePadding['right']) ? (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) : '0px') . ' ' .
                                            (isset($postTitlePadding['bottom']) ? (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) : '0px') . ' ' .
                                            (isset($postTitlePadding['left']) ? (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) : '0px') . '; ';
                                    }

                                    // Determine if underline should be shown
                                    $showUnderline = $postLinkType === 'yeslink' && $titleHoverUnderLine === 'enable';

                                    // Class name
                                    $classNames = 'title align-' . esc_attr($postTitleAlignment);
                                    if ($showUnderline) {
                                        $classNames .= ' underline';
                                    }

                                    // Hover/Out events for nolink
                                    $onmouseover = '';
                                    $onmouseout  = '';

                                    if (!empty($postTitleHoverBgColor)) {
                                        $onmouseover .= 'this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';';
                                    }

                                    if (!empty($postTitleHoverColor)) {
                                        $onmouseover .= ' this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                                    }

                                    if (!empty($postTitleBgColor)) {
                                        $onmouseout .= 'this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';';
                                    } else {
                                        $onmouseout .= 'this.style.removeProperty(\'background-color\');';
                                    }

                                    if (!empty($postTitleColor)) {
                                        $onmouseout .= ' this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                                    } else {
                                        $onmouseout .= ' this.style.removeProperty(\'color\');';
                                    }

                                    // Opening title tag
                                    $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"'
                                        . (!empty($onmouseover) ? ' onmouseover="' . trim($onmouseover) . '"' : '')
                                        . (!empty($onmouseout)  ? ' onmouseout="'  . trim($onmouseout)  . '"' : '') . '>';

                                    if ($postLinkType === 'yeslink') {
                                        // Anchor styles
                                        $style = '';
                                        $hoverStyle = '';
                                        $mouseoutStyle = '';

                                        if (!empty($postTitleFontSize)) {
                                            $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                                        }

                                        if (!empty($postTitleLineHeight)) {
                                            $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                                        }

                                        if (!empty($postTitleLetterSpacing)) {
                                            $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                                        }

                                        if (!empty($postTitleFontWeight)) {
                                            $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                                        }

                                        if (!empty($postTitleColor)) {
                                            $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                            $mouseoutStyle .= 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                                        } else {
                                            $mouseoutStyle .= 'this.style.color=\'\';';
                                        }

                                        if (!empty($postTitleHoverColor)) {
                                            $hoverStyle .= 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                                        }

                                        if ($showUnderline && !empty($postTitleHoverColor)) {
                                            $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                                            $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                            $hoverStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                                        }

                                        if ($showUnderline && empty($postTitleColor ) && !empty($postTitleColor )) {
                                            $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                                            $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                            $mouseoutStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                                        } else {
                                            
                                            $mouseoutStyle .= ' this.style.removeProperty(\'background-position\');';
                                            $mouseoutStyle .= ' this.style.removeProperty(\'background-size\');';
                                        }

                                        $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '
                                            style="' . esc_attr(trim($style)) . '"'
                                            . (!empty($hoverStyle)   ? ' onmouseover="' . $hoverStyle . '"' : '')
                                            . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                            . esc_html($croppedTitle) . '</a>';
                                    } else {
                                        // No link  render span with inline styles
                                        $inlineStyle = '';
                                        if (!empty($postTitleFontSize)) {
                                            $inlineStyle .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                                        }
                                        if (!empty($postTitleLineHeight)) {
                                            $inlineStyle .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                                        }
                                        if (!empty($postTitleLetterSpacing)) {
                                            $inlineStyle .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                                        }
                                        if (!empty($postTitleFontWeight)) {
                                            $inlineStyle .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                                        }
                                        if (!empty($postTitleColor)) {
                                            $inlineStyle .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                        }

                                        $output .= '<span style="' . esc_attr(trim($inlineStyle)) . '">' . esc_html($croppedTitle) . '</span>';
                                    }

                                    $output .= '</' . esc_attr($titleTag) . '>';
                                }

                                // Button Output                
                                if ($showReadMoreButton) {
                                    // Button wrapper styles
                                    $buttonWrapperStyle = '';

                                    if (
                                        isset($buttonMarginNew['top']) || 
                                        isset($buttonMarginNew['right']) || 
                                        isset($buttonMarginNew['bottom']) || 
                                        isset($buttonMarginNew['left'])
                                    ) {
                                        $buttonWrapperStyle .= 'margin: ' .
                                            (isset($buttonMarginNew['top']) ? (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) : '0px') . ' ' .
                                            (isset($buttonMarginNew['right']) ? (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) : '0px') . ' ' .
                                            (isset($buttonMarginNew['bottom']) ? (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) : '0px') . ' ' .
                                            (isset($buttonMarginNew['left']) ? (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) : '0px') . '; ';
                                    }

                                    // Order
                                    if (!empty($buttonOrder)) {
                                        $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                                    }
                                   
                                    $output .= '<div class="btn-wrapper align-' . esc_attr($buttonAlignment) . '" ' . $targetAttr . 'style="' . esc_attr(trim($buttonWrapperStyle)) . '">';

                                    // Button inline styles
                                    $buttonInlineStyles = '';

                                    if (!empty($buttonTextColor)) {
                                        $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                                    }
                                    if (!empty($buttonBackgroundColor)) {
                                        $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                                    }
                                    if (!empty($buttonFontSize)) {
                                        $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                                    }
                                    if (!empty($buttonFontWeight)) {
                                        $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                                    }
                                    if (!empty($buttonBorderColor)) {
                                        $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                                    }
                                    if (!empty($buttonBorderType)) {
                                        $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                                    }

                                    // Border Width
                                    if (
                                        isset($buttonBorderWidth['top']) || 
                                        isset($buttonBorderWidth['right']) || 
                                        isset($buttonBorderWidth['bottom']) || 
                                        isset($buttonBorderWidth['left'])
                                    ) {
                                        $buttonInlineStyles .= 'border-width: ' .
                                            (isset($buttonBorderWidth['top']) ? (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) : '0px') . ' ' .
                                            (isset($buttonBorderWidth['right']) ? (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) : '0px') . ' ' .
                                            (isset($buttonBorderWidth['bottom']) ? (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) : '0px') . ' ' .
                                            (isset($buttonBorderWidth['left']) ? (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) : '0px') . '; ';
                                    }

                                    // Border Radius
                                    if (
                                        isset($buttonBorderRadius['top']) || 
                                        isset($buttonBorderRadius['right']) || 
                                        isset($buttonBorderRadius['bottom']) || 
                                        isset($buttonBorderRadius['left'])
                                    ) {
                                        $buttonInlineStyles .= 'border-radius: ' .
                                            (isset($buttonBorderRadius['top']) ? (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) : '0px') . ' ' .
                                            (isset($buttonBorderRadius['right']) ? (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) : '0px') . ' ' .
                                            (isset($buttonBorderRadius['bottom']) ? (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) : '0px') . ' ' .
                                            (isset($buttonBorderRadius['left']) ? (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) : '0px') . '; ';
                                    }

                                    // Padding
                                    if (
                                        isset($buttonPaddingNew['top']) || 
                                        isset($buttonPaddingNew['right']) || 
                                        isset($buttonPaddingNew['bottom']) || 
                                        isset($buttonPaddingNew['left'])
                                    ) {
                                        $buttonInlineStyles .= 'padding: ' .
                                            (isset($buttonPaddingNew['top']) ? (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) : '0px') . ' ' .
                                            (isset($buttonPaddingNew['right']) ? (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) : '0px') . ' ' .
                                            (isset($buttonPaddingNew['bottom']) ? (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) : '0px') . ' ' .
                                            (isset($buttonPaddingNew['left']) ? (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) : '0px') . '; ';
                                    } 

                                    // Hover styles
                                    $buttonHoverInlineStyles = '';
                                    $buttonResetStyles = '';

                                    if (!empty($buttonHoverTextColor)) {
                                        $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                                        $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                                    }
                                    if (!empty($buttonHoverBorderColor)) {
                                        $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                                        $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                                    }
                                    if (!empty($buttonHoverBackgroundColor)) {
                                        $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                                        $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                                    }

                                    // Button anchor tag
                                    $output .= '<a class="fpg-btn read-more ' . esc_attr($buttonStyle8) . '" href="' . esc_url(get_permalink()) . '" ' . $targetAttr . ' style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                                    if (!empty($buttonHoverInlineStyles)) {
                                        $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                                    }

                                    if (!empty($buttonResetStyles)) {
                                        $output .= ' onmouseout="' . $buttonResetStyles . '"';
                                    }

                                    $output .= '>';

                                    // Icon handling
                                    $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                                    $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                                    $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                                    if ($iconPosition === 'left' && $showButtonIcon) {
                                        $output .= $leftIcon . ' ';
                                    }

                                    $output .= esc_html($readMoreLabel);

                                    if ($iconPosition === 'right' && $showButtonIcon) {
                                        $output .= ' ' . $rightIcon;
                                    }

                                    $output .= '</a></div>';
                                }
                                // End Button

                                $output .= '</div>';
                                // Add any other post content here (title, meta, etc.)
                            $output .= '</div>'; // .fancy-post-item
                    }

                    // Post 2  Medium layout
                    elseif ($post_count === 2) {
                        $output .= '<div class="fpg-blog-layout-27-item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . ' ' . $postLinkType . '" style="';
                            // MARGIN    
                            if (isset($itemMargin['top']) || isset($itemMargin['right']) || isset($itemMargin['bottom']) || isset($itemMargin['left'])) {
                                $output .= 'margin: ' .
                                    (isset($itemMargin['top']) ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' .
                                    (isset($itemMargin['right']) ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' .
                                    (isset($itemMargin['bottom']) ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' .
                                    (isset($itemMargin['left']) ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; ';
                            }

                            // PADDING
                            if (isset($itemPadding['top']) || isset($itemPadding['right']) || isset($itemPadding['bottom']) || isset($itemPadding['left'])) {
                                $output .= 'padding: ' .
                                    (isset($itemPadding['top']) ? (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) : '0px') . ' ' .
                                    (isset($itemPadding['right']) ? (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) : '0px') . ' ' .
                                    (isset($itemPadding['bottom']) ? (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) : '0px') . ' ' .
                                    (isset($itemPadding['left']) ? (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) : '0px') . '; ';
                            }

                            // BORDER RADIUS
                            if (isset($itemBorderRadius['top']) || isset($itemBorderRadius['right']) || isset($itemBorderRadius['bottom']) || isset($itemBorderRadius['left'])) {
                                $output .= 'border-radius: ' .
                                    (isset($itemBorderRadius['top']) ? (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) : '0px') . ' ' .
                                    (isset($itemBorderRadius['right']) ? (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) : '0px') . ' ' .
                                    (isset($itemBorderRadius['bottom']) ? (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) : '0px') . ' ' .
                                    (isset($itemBorderRadius['left']) ? (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) : '0px') . '; ';
                            }

                            // BORDER WIDTH
                            if (isset($itemBorderWidth['top']) || isset($itemBorderWidth['right']) || isset($itemBorderWidth['bottom']) || isset($itemBorderWidth['left'])) {
                                $output .= 'border-width: ' .
                                    (isset($itemBorderWidth['top']) ? (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) : '0px') . ' ' .
                                    (isset($itemBorderWidth['right']) ? (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) : '0px') . ' ' .
                                    (isset($itemBorderWidth['bottom']) ? (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) : '0px') . ' ' .
                                    (isset($itemBorderWidth['left']) ? (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) : '0px') . '; ';
                            }

                            // Border Style & Color
                            if (!empty($itemBorderType)) {
                                $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                            }
                            if (!empty($itemBorderColor)) {
                                $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                            }

                            // Background Color
                            if (!empty($itemBackgroundColor)) {
                                $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                            }

                            // Box Shadow
                            if (
                                isset($itemBoxShadow['left']) ||  // horizontal offset
                                isset($itemBoxShadow['top']) ||  // vertical offset
                                isset($itemBoxShadow['right']) ||  // blur radius
                                isset($itemBoxShadow['bottom']) ||  // spread radius
                                isset($itemBoxShadowColor)
                            ) {
                                $output .= 'box-shadow: ' .
                                    (isset($itemBoxShadow['left']) ? (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) : '0px') . ' ' .
                                    (isset($itemBoxShadow['top']) ? (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) : '0px') . ' ' .
                                    (isset($itemBoxShadow['right']) ? (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) : '0px') . ' ' .
                                    (isset($itemBoxShadow['bottom']) ? (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) : '0px') . ' ' .
                                    (!empty($itemBoxShadowColor) ? esc_attr($itemBoxShadowColor) : 'rgba(0,0,0,0.1)') . '; ';
                            }

                        $output .= '">';

                            // MAIN Content
                            $output .= '<div class="fpg-content" style="';
                                // MARGIN
                                if (
                                    isset($contentitemMarginNew['top']) ||
                                    isset($contentitemMarginNew['right']) ||
                                    isset($contentitemMarginNew['bottom']) ||
                                    isset($contentitemMarginNew['left'])
                                ) {
                                    $output .= 'margin: ' .
                                        (isset($contentitemMarginNew['top']) ? (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) : '0px') . ' ' .
                                        (isset($contentitemMarginNew['right']) ? (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) : '0px') . ' ' .
                                        (isset($contentitemMarginNew['bottom']) ? (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) : '0px') . ' ' .
                                        (isset($contentitemMarginNew['left']) ? (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) : '0px') . '; ';
                                }

                                // PADDING
                                if (
                                    isset($contentitemPaddingNew['top']) ||
                                    isset($contentitemPaddingNew['right']) ||
                                    isset($contentitemPaddingNew['bottom']) ||
                                    isset($contentitemPaddingNew['left'])
                                ) {
                                    $output .= 'padding: ' .
                                        (isset($contentitemPaddingNew['top']) ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' .
                                        (isset($contentitemPaddingNew['right']) ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' .
                                        (isset($contentitemPaddingNew['bottom']) ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' .
                                        (isset($contentitemPaddingNew['left']) ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; ';
                                }

                                // BORDER WIDTH
                                if (
                                    isset($contentBorderWidth['top']) ||
                                    isset($contentBorderWidth['right']) ||
                                    isset($contentBorderWidth['bottom']) ||
                                    isset($contentBorderWidth['left'])
                                ) {
                                    $output .= 'border-width: ' .
                                        (isset($contentBorderWidth['top']) ? (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) : '0px') . ' ' .
                                        (isset($contentBorderWidth['right']) ? (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) : '0px') . ' ' .
                                        (isset($contentBorderWidth['bottom']) ? (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) : '0px') . ' ' .
                                        (isset($contentBorderWidth['left']) ? (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) : '0px') . '; ';
                                }
                                // BORDER radius
                                    if (
                                        isset($contentitemRadius['top']) ||
                                        isset($contentitemRadius['right']) ||
                                        isset($contentitemRadius['bottom']) ||
                                        isset($contentitemRadius['left'])
                                    ) {
                                        $output .= 'border-radius: ' .
                                            (isset($contentitemRadius['top']) ? (is_numeric($contentitemRadius['top']) ? $contentitemRadius['top'] . 'px' : esc_attr($contentitemRadius['top'])) : '0px') . ' ' .
                                            (isset($contentitemRadius['right']) ? (is_numeric($contentitemRadius['right']) ? $contentitemRadius['right'] . 'px' : esc_attr($contentitemRadius['right'])) : '0px') . ' ' .
                                            (isset($contentitemRadius['bottom']) ? (is_numeric($contentitemRadius['bottom']) ? $contentitemRadius['bottom'] . 'px' : esc_attr($contentitemRadius['bottom'])) : '0px') . ' ' .
                                            (isset($contentitemRadius['left']) ? (is_numeric($contentitemRadius['left']) ? $contentitemRadius['left'] . 'px' : esc_attr($contentitemRadius['left'])) : '0px') . '; ';
                                    }
                                // Border Style
                                if (!empty($contentNormalBorderType)) {
                                    $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                                }
                                // Background Color
                                if (!empty($contentBgColor)) {
                                    $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                                }
                                // Border Color
                                if (!empty($contentBorderColor)) {
                                    $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                                }
                            $output .= '">';

                                //meta
                                if ($showMetaData) {
                                    
                                    $output .= '<div class="fpg-meta" " style="';    
                                        // Order
                                        if (!empty($metaOrder)) {
                                            $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                                        } 
                                    
                                    $output .= '">';        
                                        $output .= '<ul class="blog-meta align-' . $metaAlignment . ' " style="';  
                                            // MARGIN
                                            if (
                                                isset($metaMarginNew['top']) ||
                                                isset($metaMarginNew['right']) ||
                                                isset($metaMarginNew['bottom']) ||
                                                isset($metaMarginNew['left'])
                                            ) {
                                                $output .= 'margin: ' .
                                                    (isset($metaMarginNew['top']) ? (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) : '0px') . ' ' .
                                                    (isset($metaMarginNew['right']) ? (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) : '0px') . ' ' .
                                                    (isset($metaMarginNew['bottom']) ? (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) : '0px') . ' ' .
                                                    (isset($metaMarginNew['left']) ? (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) : '0px') . '; ';
                                            }

                                            // PADDING
                                            if (
                                                isset($metaPadding['top']) ||
                                                isset($metaPadding['right']) ||
                                                isset($metaPadding['bottom']) ||
                                                isset($metaPadding['left'])
                                            ) {
                                                $output .= 'padding: ' .
                                                    (isset($metaPadding['top']) ? (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) : '0px') . ' ' .
                                                    (isset($metaPadding['right']) ? (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) : '0px') . ' ' .
                                                    (isset($metaPadding['bottom']) ? (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) : '0px') . ' ' .
                                                    (isset($metaPadding['left']) ? (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) : '0px') . '; ';
                                            }   
                                            
                                            // Color
                                            if (!empty($metaTextColor)) {
                                                $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                                            }
                                            
                                        $output .= '">';

                                        $meta_items = [];
                                        // Author
                                        if ($showPostAuthor) {
                                            $meta = '<li class="meta-author" style="';

                                            if (!empty($metaTextColor)) {
                                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                            }

                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '">';

                                            if ($showPostAuthorIcon && $showMetaIcon) {
                                                $meta .= '<i class="fas fa-user" style="';

                                                if (!empty($metaIconColor)) {
                                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                                }

                                                if (!empty($metaFontSize)) {
                                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                                }

                                                $meta .= '"></i> ';
                                            }

                                            $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                                            $meta_items[] = $meta;
                                        }
                                        // Date
                                        if ($showPostDate) {
                                            $meta = '<li class="meta-date" style="';

                                            // Color
                                            if (!empty($metaTextColor)) {
                                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                            }

                                            // Font size
                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '">';

                                            // Icon
                                            if ($showPostDateIcon && $showMetaIcon) {
                                                $meta .= '<i class="fas fa-calendar-alt" style="';

                                                if (!empty($metaIconColor)) {
                                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                                }

                                                if (!empty($metaFontSize)) {
                                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                                }

                                                $meta .= '"></i> ';
                                            }

                                            $meta .= esc_html($getdate) . '</li>';
                                            $meta_items[] = $meta;
                                        }
                                        
                                        // Now join meta items with the separator
                                        $output .= implode('<span class="meta-separator" style="color:' . esc_attr($separatorColor) . '; font-size:' . esc_attr($metaFontSize) . 'px;">' . esc_html($metaSeperator) . '</span>', $meta_items);

                                        $output .= '</ul>';  
                                    $output .= '</div>';   
                                }

                                // title
                                if ($showPostTitle) {
                                    $titleStyles = '';

                                    // Order
                                    if (!empty($titleOrder)) {
                                        $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                                    }

                                    // Background color
                                    if (!empty($postTitleBgColor)) {
                                        $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                                    }

                                    // Margin
                                    if (isset($postTitleMargin['top']) || isset($postTitleMargin['right']) || isset($postTitleMargin['bottom']) || isset($postTitleMargin['left'])) {
                                        $titleStyles .= 'margin: ' .
                                            (isset($postTitleMargin['top']) ? (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) : '0px') . ' ' .
                                            (isset($postTitleMargin['right']) ? (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) : '0px') . ' ' .
                                            (isset($postTitleMargin['bottom']) ? (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) : '0px') . ' ' .
                                            (isset($postTitleMargin['left']) ? (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) : '0px') . '; ';
                                    }

                                    // Padding
                                    if (isset($postTitlePadding['top']) || isset($postTitlePadding['right']) || isset($postTitlePadding['bottom']) || isset($postTitlePadding['left'])) {
                                        $titleStyles .= 'padding: ' .
                                            (isset($postTitlePadding['top']) ? (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) : '0px') . ' ' .
                                            (isset($postTitlePadding['right']) ? (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) : '0px') . ' ' .
                                            (isset($postTitlePadding['bottom']) ? (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) : '0px') . ' ' .
                                            (isset($postTitlePadding['left']) ? (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) : '0px') . '; ';
                                    }

                                    // Determine if underline should be shown
                                    $showUnderline = $postLinkType === 'yeslink' && $titleHoverUnderLine === 'enable';

                                    // Class name
                                    $classNames = 'title align-' . esc_attr($postTitleAlignment);
                                    if ($showUnderline) {
                                        $classNames .= ' underline';
                                    }

                                    // Hover/Out events for nolink
                                    $onmouseover = '';
                                    $onmouseout  = '';

                                    if (!empty($postTitleHoverBgColor)) {
                                        $onmouseover .= 'this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';';
                                    }

                                    if (!empty($postTitleHoverColor)) {
                                        $onmouseover .= ' this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                                    }

                                    if (!empty($postTitleBgColor)) {
                                        $onmouseout .= 'this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';';
                                    } else {
                                        $onmouseout .= 'this.style.removeProperty(\'background-color\');';
                                    }

                                    if (!empty($postTitleColor)) {
                                        $onmouseout .= ' this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                                    } else {
                                        $onmouseout .= ' this.style.removeProperty(\'color\');';
                                    }

                                    // Opening title tag
                                    $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"'
                                        . (!empty($onmouseover) ? ' onmouseover="' . trim($onmouseover) . '"' : '')
                                        . (!empty($onmouseout)  ? ' onmouseout="'  . trim($onmouseout)  . '"' : '') . '>';

                                    if ($postLinkType === 'yeslink') {
                                        // Anchor styles
                                        $style = '';
                                        $hoverStyle = '';
                                        $mouseoutStyle = '';

                                        if (!empty($postTitleFontSize)) {
                                            $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                                        }

                                        if (!empty($postTitleLineHeight)) {
                                            $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                                        }

                                        if (!empty($postTitleLetterSpacing)) {
                                            $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                                        }

                                        if (!empty($postTitleFontWeight)) {
                                            $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                                        }

                                        if (!empty($postTitleColor)) {
                                            $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                            $mouseoutStyle .= 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                                        } else {
                                            $mouseoutStyle .= 'this.style.color=\'\';';
                                        }

                                        if (!empty($postTitleHoverColor)) {
                                            $hoverStyle .= 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                                        }

                                        if ($showUnderline && !empty($postTitleHoverColor)) {
                                            $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                                            $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                            $hoverStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                                        }

                                        if ($showUnderline && empty($postTitleColor ) && !empty($postTitleColor )) {
                                            $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                                            $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                            $mouseoutStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                                        } else {
                                            
                                            $mouseoutStyle .= ' this.style.removeProperty(\'background-position\');';
                                            $mouseoutStyle .= ' this.style.removeProperty(\'background-size\');';
                                        }

                                        $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '
                                            style="' . esc_attr(trim($style)) . '"'
                                            . (!empty($hoverStyle)   ? ' onmouseover="' . $hoverStyle . '"' : '')
                                            . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                            . esc_html($croppedTitle) . '</a>';
                                    } else {
                                        // No link  render span with inline styles
                                        $inlineStyle = '';
                                        if (!empty($postTitleFontSize)) {
                                            $inlineStyle .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                                        }
                                        if (!empty($postTitleLineHeight)) {
                                            $inlineStyle .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                                        }
                                        if (!empty($postTitleLetterSpacing)) {
                                            $inlineStyle .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                                        }
                                        if (!empty($postTitleFontWeight)) {
                                            $inlineStyle .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                                        }
                                        if (!empty($postTitleColor)) {
                                            $inlineStyle .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                        }

                                        $output .= '<span style="' . esc_attr(trim($inlineStyle)) . '">' . esc_html($croppedTitle) . '</span>';
                                    }

                                    $output .= '</' . esc_attr($titleTag) . '>';
                                }

                                // Button Output                
                                if ($showReadMoreButton) {
                                    // Button wrapper styles
                                    $buttonWrapperStyle = '';

                                    if (
                                        isset($buttonMarginNew['top']) || 
                                        isset($buttonMarginNew['right']) || 
                                        isset($buttonMarginNew['bottom']) || 
                                        isset($buttonMarginNew['left'])
                                    ) {
                                        $buttonWrapperStyle .= 'margin: ' .
                                            (isset($buttonMarginNew['top']) ? (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) : '0px') . ' ' .
                                            (isset($buttonMarginNew['right']) ? (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) : '0px') . ' ' .
                                            (isset($buttonMarginNew['bottom']) ? (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) : '0px') . ' ' .
                                            (isset($buttonMarginNew['left']) ? (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) : '0px') . '; ';
                                    }

                                    // Order
                                    if (!empty($buttonOrder)) {
                                        $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                                    }

                                    $output .= '<div class="btn-wrapper align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';

                                    // Button inline styles
                                    $buttonInlineStyles = '';

                                    if (!empty($buttonTextColor)) {
                                        $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                                    }
                                    if (!empty($buttonBackgroundColor)) {
                                        $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                                    }
                                    if (!empty($buttonFontSize)) {
                                        $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                                    }
                                    if (!empty($buttonFontWeight)) {
                                        $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                                    }
                                    if (!empty($buttonBorderColor)) {
                                        $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                                    }
                                    if (!empty($buttonBorderType)) {
                                        $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                                    }

                                    // Border Width
                                    if (
                                        isset($buttonBorderWidth['top']) || 
                                        isset($buttonBorderWidth['right']) || 
                                        isset($buttonBorderWidth['bottom']) || 
                                        isset($buttonBorderWidth['left'])
                                    ) {
                                        $buttonInlineStyles .= 'border-width: ' .
                                            (isset($buttonBorderWidth['top']) ? (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) : '0px') . ' ' .
                                            (isset($buttonBorderWidth['right']) ? (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) : '0px') . ' ' .
                                            (isset($buttonBorderWidth['bottom']) ? (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) : '0px') . ' ' .
                                            (isset($buttonBorderWidth['left']) ? (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) : '0px') . '; ';
                                    }

                                    // Border Radius
                                    if (
                                        isset($buttonBorderRadius['top']) || 
                                        isset($buttonBorderRadius['right']) || 
                                        isset($buttonBorderRadius['bottom']) || 
                                        isset($buttonBorderRadius['left'])
                                    ) {
                                        $buttonInlineStyles .= 'border-radius: ' .
                                            (isset($buttonBorderRadius['top']) ? (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) : '0px') . ' ' .
                                            (isset($buttonBorderRadius['right']) ? (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) : '0px') . ' ' .
                                            (isset($buttonBorderRadius['bottom']) ? (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) : '0px') . ' ' .
                                            (isset($buttonBorderRadius['left']) ? (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) : '0px') . '; ';
                                    }

                                    // Padding
                                    if (
                                        isset($buttonPaddingNew['top']) || 
                                        isset($buttonPaddingNew['right']) || 
                                        isset($buttonPaddingNew['bottom']) || 
                                        isset($buttonPaddingNew['left'])
                                    ) {
                                        $buttonInlineStyles .= 'padding: ' .
                                            (isset($buttonPaddingNew['top']) ? (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) : '0px') . ' ' .
                                            (isset($buttonPaddingNew['right']) ? (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) : '0px') . ' ' .
                                            (isset($buttonPaddingNew['bottom']) ? (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) : '0px') . ' ' .
                                            (isset($buttonPaddingNew['left']) ? (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) : '0px') . '; ';
                                    } 

                                    // Hover styles
                                    $buttonHoverInlineStyles = '';
                                    $buttonResetStyles = '';

                                    if (!empty($buttonHoverTextColor)) {
                                        $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                                        $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                                    }
                                    if (!empty($buttonHoverBorderColor)) {
                                        $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                                        $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                                    }
                                    if (!empty($buttonHoverBackgroundColor)) {
                                        $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                                        $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                                    }

                                    // Button anchor tag
                                    $output .= '<a class="fpg-btn read-more ' . esc_attr($buttonStyle8) . '" href="' . esc_url(get_permalink()) . '" ' . $targetAttr . ' style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                                    if (!empty($buttonHoverInlineStyles)) {
                                        $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                                    }

                                    if (!empty($buttonResetStyles)) {
                                        $output .= ' onmouseout="' . $buttonResetStyles . '"';
                                    }

                                    $output .= '>';

                                    // Icon handling
                                    $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                                    $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                                    $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                                    if ($iconPosition === 'left' && $showButtonIcon) {
                                        $output .= $leftIcon . ' ';
                                    }

                                    $output .= esc_html($readMoreLabel);

                                    if ($iconPosition === 'right' && $showButtonIcon) {
                                        $output .= ' ' . $rightIcon;
                                    }

                                    $output .= '</a></div>';
                                }
                                // End Button

                            $output .= '</div>';

                            // Thumbnail
                            if ($rightThumbnailSize && $showThumbnail) {
                                $output .= '<div class="fpg-thumb" style="';

                                // MARGIN
                                if (
                                    isset($thumbnailMargin['top']) ||
                                    isset($thumbnailMargin['right']) ||
                                    isset($thumbnailMargin['bottom']) ||
                                    isset($thumbnailMargin['left'])
                                ) {
                                    $output .= 'margin: ' .
                                        (isset($thumbnailMargin['top']) ? (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) : '0px') . ' ' .
                                        (isset($thumbnailMargin['right']) ? (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) : '0px') . ' ' .
                                        (isset($thumbnailMargin['bottom']) ? (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) : '0px') . ' ' .
                                        (isset($thumbnailMargin['left']) ? (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) : '0px') . '; ';
                                }

                                // PADDING
                                if (
                                    isset($thumbnailPadding['top']) ||
                                    isset($thumbnailPadding['right']) ||
                                    isset($thumbnailPadding['bottom']) ||
                                    isset($thumbnailPadding['left'])
                                ) {
                                    $output .= 'padding: ' .
                                        (isset($thumbnailPadding['top']) ? (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) : '0px') . ' ' .
                                        (isset($thumbnailPadding['right']) ? (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) : '0px') . ' ' .
                                        (isset($thumbnailPadding['bottom']) ? (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) : '0px') . ' ' .
                                        (isset($thumbnailPadding['left']) ? (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) : '0px') . '; ';
                                }

                                // BORDER RADIUS
                                if (
                                    isset($thumbnailBorderRadius['top']) ||
                                    isset($thumbnailBorderRadius['right']) ||
                                    isset($thumbnailBorderRadius['bottom']) ||
                                    isset($thumbnailBorderRadius['left'])
                                ) {
                                    $output .= 'border-radius: ' .
                                        (isset($thumbnailBorderRadius['top']) ? (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) : '0px') . ' ' .
                                        (isset($thumbnailBorderRadius['right']) ? (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) : '0px') . ' ' .
                                        (isset($thumbnailBorderRadius['bottom']) ? (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) : '0px') . ' ' .
                                        (isset($thumbnailBorderRadius['left']) ? (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) : '0px') . '; ';
                                }

                                $output .= '">';

                                if ($thumbnailLink) {
                                    $output .= '<a href="' . esc_url($permalink) . '"' . $targetAttr . '>';
                                    $output .= $rightThumbnailSize;
                                    $output .= '</a>';
                                } else {
                                    $output .= $rightThumbnailSize;
                                }
                                $output .= '</div>';
                            }              
                            $output .= '</div>'; // .fancy-post-item
                        $output .= '</div>'; // Close left column
                        $output .= '<div class="col-lg-6">'; // Open right column
                    }

                    // Post 3+  Right side uniform layout
                    elseif ($post_count > 2) {
                        
                        $output .= '<div class="fpg-blog-layout-27-list-item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . ' ' . $postLinkType . '" style="';
                            // MARGIN    
                            if (isset($itemMargin['top']) || isset($itemMargin['right']) || isset($itemMargin['bottom']) || isset($itemMargin['left'])) {
                                $output .= 'margin: ' .
                                    (isset($itemMargin['top']) ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' .
                                    (isset($itemMargin['right']) ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' .
                                    (isset($itemMargin['bottom']) ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' .
                                    (isset($itemMargin['left']) ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; ';
                            }

                            // PADDING
                            if (isset($itemPadding['top']) || isset($itemPadding['right']) || isset($itemPadding['bottom']) || isset($itemPadding['left'])) {
                                $output .= 'padding: ' .
                                    (isset($itemPadding['top']) ? (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) : '0px') . ' ' .
                                    (isset($itemPadding['right']) ? (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) : '0px') . ' ' .
                                    (isset($itemPadding['bottom']) ? (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) : '0px') . ' ' .
                                    (isset($itemPadding['left']) ? (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) : '0px') . '; ';
                            }

                            // BORDER RADIUS
                            if (isset($itemBorderRadius['top']) || isset($itemBorderRadius['right']) || isset($itemBorderRadius['bottom']) || isset($itemBorderRadius['left'])) {
                                $output .= 'border-radius: ' .
                                    (isset($itemBorderRadius['top']) ? (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) : '0px') . ' ' .
                                    (isset($itemBorderRadius['right']) ? (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) : '0px') . ' ' .
                                    (isset($itemBorderRadius['bottom']) ? (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) : '0px') . ' ' .
                                    (isset($itemBorderRadius['left']) ? (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) : '0px') . '; ';
                            }

                            // BORDER WIDTH
                            if (isset($itemBorderWidth['top']) || isset($itemBorderWidth['right']) || isset($itemBorderWidth['bottom']) || isset($itemBorderWidth['left'])) {
                                $output .= 'border-width: ' .
                                    (isset($itemBorderWidth['top']) ? (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) : '0px') . ' ' .
                                    (isset($itemBorderWidth['right']) ? (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) : '0px') . ' ' .
                                    (isset($itemBorderWidth['bottom']) ? (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) : '0px') . ' ' .
                                    (isset($itemBorderWidth['left']) ? (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) : '0px') . '; ';
                            }

                            // Border Style & Color
                            if (!empty($itemBorderType)) {
                                $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                            }
                            if (!empty($itemBorderColor)) {
                                $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                            }

                            // Background Color
                            if (!empty($itemBackgroundColor)) {
                                $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                            }

                            // Box Shadow
                            if (
                                isset($itemBoxShadow['left']) ||  // horizontal offset
                                isset($itemBoxShadow['top']) ||  // vertical offset
                                isset($itemBoxShadow['right']) ||  // blur radius
                                isset($itemBoxShadow['bottom']) ||  // spread radius
                                isset($itemBoxShadowColor)
                            ) {
                                $output .= 'box-shadow: ' .
                                    (isset($itemBoxShadow['left']) ? (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) : '0px') . ' ' .
                                    (isset($itemBoxShadow['top']) ? (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) : '0px') . ' ' .
                                    (isset($itemBoxShadow['right']) ? (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) : '0px') . ' ' .
                                    (isset($itemBoxShadow['bottom']) ? (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) : '0px') . ' ' .
                                    (!empty($itemBoxShadowColor) ? esc_attr($itemBoxShadowColor) : 'rgba(0,0,0,0.1)') . '; ';
                            }

                        $output .= '">';
                            
                            $output .= '<div class="fpg-date" style="';

                                // MARGIN
                                if (
                                    isset($metaMarginNew['top']) || isset($metaMarginNew['right']) ||
                                    isset($metaMarginNew['bottom']) || isset($metaMarginNew['left'])
                                ) {
                                    $output .= 'margin: ' .
                                        (isset($metaMarginNew['top']) ? (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) : '0px') . ' ' .
                                        (isset($metaMarginNew['right']) ? (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) : '0px') . ' ' .
                                        (isset($metaMarginNew['bottom']) ? (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) : '0px') . ' ' .
                                        (isset($metaMarginNew['left']) ? (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) : '0px') . '; ';
                                }

                                // PADDING
                                if (
                                    isset($metaPadding['top']) || isset($metaPadding['right']) ||
                                    isset($metaPadding['bottom']) || isset($metaPadding['left'])
                                ) {
                                    $output .= 'padding: ' .
                                        (isset($metaPadding['top']) ? (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) : '0px') . ' ' .
                                        (isset($metaPadding['right']) ? (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) : '0px') . ' ' .
                                        (isset($metaPadding['bottom']) ? (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) : '0px') . ' ' .
                                        (isset($metaPadding['left']) ? (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) : '0px') . '; ';
                                }

                                // Background
                                if (!empty($metaBgColor)) {
                                    $output .= 'background-color: ' . esc_attr($metaBgColor) . '; ';
                                }

                                $output .= '">';

                                // Prepare inline styles for .date and .title
                                $innerStyle = '';
                                if (!empty($metaTextColor)) {
                                    $innerStyle .= 'color: ' . esc_attr($metaTextColor) . '; ';
                                }
                                if (!empty($metaFontSize)) {
                                    $innerStyle .= 'font-size: ' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $output .= '<span class="date" style="' . esc_attr($innerStyle) . '">' . get_the_date('M') . '</span>'; // Month
                                $output .= '<h3 class="title" style="' . esc_attr($innerStyle) . '">' . get_the_date('d') . '</h3>';     // Day

                                $output .= '</div>';

                            // MAIN Content
                            $output .= '<div class="fpg-content" style="';
                                // MARGIN
                                if (
                                    isset($contentitemMarginNew['top']) ||
                                    isset($contentitemMarginNew['right']) ||
                                    isset($contentitemMarginNew['bottom']) ||
                                    isset($contentitemMarginNew['left'])
                                ) {
                                    $output .= 'margin: ' .
                                        (isset($contentitemMarginNew['top']) ? (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) : '0px') . ' ' .
                                        (isset($contentitemMarginNew['right']) ? (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) : '0px') . ' ' .
                                        (isset($contentitemMarginNew['bottom']) ? (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) : '0px') . ' ' .
                                        (isset($contentitemMarginNew['left']) ? (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) : '0px') . '; ';
                                }

                                // PADDING
                                if (
                                    isset($contentitemPaddingNew['top']) ||
                                    isset($contentitemPaddingNew['right']) ||
                                    isset($contentitemPaddingNew['bottom']) ||
                                    isset($contentitemPaddingNew['left'])
                                ) {
                                    $output .= 'padding: ' .
                                        (isset($contentitemPaddingNew['top']) ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' .
                                        (isset($contentitemPaddingNew['right']) ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' .
                                        (isset($contentitemPaddingNew['bottom']) ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' .
                                        (isset($contentitemPaddingNew['left']) ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; ';
                                }

                                // BORDER WIDTH
                                if (
                                    isset($contentBorderWidth['top']) ||
                                    isset($contentBorderWidth['right']) ||
                                    isset($contentBorderWidth['bottom']) ||
                                    isset($contentBorderWidth['left'])
                                ) {
                                    $output .= 'border-width: ' .
                                        (isset($contentBorderWidth['top']) ? (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) : '0px') . ' ' .
                                        (isset($contentBorderWidth['right']) ? (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) : '0px') . ' ' .
                                        (isset($contentBorderWidth['bottom']) ? (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) : '0px') . ' ' .
                                        (isset($contentBorderWidth['left']) ? (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) : '0px') . '; ';
                                }
                                // BORDER radius
                                    if (
                                        isset($contentitemRadius['top']) ||
                                        isset($contentitemRadius['right']) ||
                                        isset($contentitemRadius['bottom']) ||
                                        isset($contentitemRadius['left'])
                                    ) {
                                        $output .= 'border-radius: ' .
                                            (isset($contentitemRadius['top']) ? (is_numeric($contentitemRadius['top']) ? $contentitemRadius['top'] . 'px' : esc_attr($contentitemRadius['top'])) : '0px') . ' ' .
                                            (isset($contentitemRadius['right']) ? (is_numeric($contentitemRadius['right']) ? $contentitemRadius['right'] . 'px' : esc_attr($contentitemRadius['right'])) : '0px') . ' ' .
                                            (isset($contentitemRadius['bottom']) ? (is_numeric($contentitemRadius['bottom']) ? $contentitemRadius['bottom'] . 'px' : esc_attr($contentitemRadius['bottom'])) : '0px') . ' ' .
                                            (isset($contentitemRadius['left']) ? (is_numeric($contentitemRadius['left']) ? $contentitemRadius['left'] . 'px' : esc_attr($contentitemRadius['left'])) : '0px') . '; ';
                                    }
                                // Border Style
                                if (!empty($contentNormalBorderType)) {
                                    $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                                }
                                // Background Color
                                if (!empty($contentBgColor)) {
                                    $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                                }
                                // Border Color
                                if (!empty($contentBorderColor)) {
                                    $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                                }
                            $output .= '">';

                                // Meta Data
                                if ($showMetaData) {
                                    $output .= '<div class="fpg-meta-category align-' . $metaAlignment . '" style="';

                                    // Add text color and font size
                                    if (!empty($metaTextColor)) {
                                        $output .= 'color:' . esc_attr($metaTextColor) . '; ';
                                    }
                                    if (!empty($metaFontSize)) {
                                        $output .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $output .= '">'; // close opening div

                                    $meta_items = [];

                                    if ($showPostCategory) {
                                        $meta = ''; // reset meta for category output

                                        if ($showPostCategoryIcon && $showMetaIcon) {
                                            $meta .= '<i class="fas fa-folder" style="color:' . esc_attr($metaIconColor) . '; font-size:' . esc_attr($metaFontSize) . 'px;"></i> ';
                                        }

                                        // Get category names without links
                                        $categories_list = get_the_category($post_id);
                                        if (!empty($categories_list)) {
                                            $category_names = array();
                                            foreach ($categories_list as $category) {
                                                $category_names[] = esc_html($category->name);
                                            }
                                            $meta .= implode(', ', $category_names);
                                        }

                                        $meta_items[] = $meta;
                                    }

                                    // Join meta items with separator
                                    $output .= implode(
                                        '<span class="meta-separator" style="color:' . esc_attr($separatorColor) . '; font-size:' . esc_attr($metaFontSize) . 'px;">' . esc_html($metaSeperator) . '</span>',
                                        $meta_items
                                    );

                                    $output .= '</div>'; // Close fpg-meta-category
                                }

                                // End Meta Data

                                // title
                                if ($showPostTitle) {
                                    $titleStyles = '';

                                    // Order
                                    if (!empty($titleOrder)) {
                                        $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                                    }

                                    // Background color
                                    if (!empty($postTitleBgColor)) {
                                        $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                                    }

                                    // Margin
                                    if (isset($postTitleMargin['top']) || isset($postTitleMargin['right']) || isset($postTitleMargin['bottom']) || isset($postTitleMargin['left'])) {
                                        $titleStyles .= 'margin: ' .
                                            (isset($postTitleMargin['top']) ? (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) : '0px') . ' ' .
                                            (isset($postTitleMargin['right']) ? (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) : '0px') . ' ' .
                                            (isset($postTitleMargin['bottom']) ? (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) : '0px') . ' ' .
                                            (isset($postTitleMargin['left']) ? (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) : '0px') . '; ';
                                    }

                                    // Padding
                                    if (isset($postTitlePadding['top']) || isset($postTitlePadding['right']) || isset($postTitlePadding['bottom']) || isset($postTitlePadding['left'])) {
                                        $titleStyles .= 'padding: ' .
                                            (isset($postTitlePadding['top']) ? (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) : '0px') . ' ' .
                                            (isset($postTitlePadding['right']) ? (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) : '0px') . ' ' .
                                            (isset($postTitlePadding['bottom']) ? (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) : '0px') . ' ' .
                                            (isset($postTitlePadding['left']) ? (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) : '0px') . '; ';
                                    }

                                    // Determine if underline should be shown
                                    $showUnderline = $postLinkType === 'yeslink' && $titleHoverUnderLine === 'enable';

                                    // Class name
                                    $classNames = 'title align-' . esc_attr($postTitleAlignment);
                                    if ($showUnderline) {
                                        $classNames .= ' underline';
                                    }

                                    // Hover/Out events for nolink
                                    $onmouseover = '';
                                    $onmouseout  = '';

                                    if (!empty($postTitleHoverBgColor)) {
                                        $onmouseover .= 'this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';';
                                    }

                                    if (!empty($postTitleHoverColor)) {
                                        $onmouseover .= ' this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                                    }

                                    if (!empty($postTitleBgColor)) {
                                        $onmouseout .= 'this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';';
                                    } else {
                                        $onmouseout .= 'this.style.removeProperty(\'background-color\');';
                                    }

                                    if (!empty($postTitleColor)) {
                                        $onmouseout .= ' this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                                    } else {
                                        $onmouseout .= ' this.style.removeProperty(\'color\');';
                                    }

                                    // Opening title tag
                                    $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"'
                                        . (!empty($onmouseover) ? ' onmouseover="' . trim($onmouseover) . '"' : '')
                                        . (!empty($onmouseout)  ? ' onmouseout="'  . trim($onmouseout)  . '"' : '') . '>';

                                    if ($postLinkType === 'yeslink') {
                                        // Anchor styles
                                        $style = '';
                                        $hoverStyle = '';
                                        $mouseoutStyle = '';

                                        if (!empty($postTitleFontSize)) {
                                            $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                                        }

                                        if (!empty($postTitleLineHeight)) {
                                            $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                                        }

                                        if (!empty($postTitleLetterSpacing)) {
                                            $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                                        }

                                        if (!empty($postTitleFontWeight)) {
                                            $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                                        }

                                        if (!empty($postTitleColor)) {
                                            $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                            $mouseoutStyle .= 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                                        } else {
                                            $mouseoutStyle .= 'this.style.color=\'\';';
                                        }

                                        if (!empty($postTitleHoverColor)) {
                                            $hoverStyle .= 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                                        }

                                        if ($showUnderline && !empty($postTitleHoverColor)) {
                                            $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                                            $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                            $hoverStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                                        }

                                        if ($showUnderline && empty($postTitleColor ) && !empty($postTitleColor )) {
                                            $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                                            $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                            $mouseoutStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                                        } else {
                                           
                                            $mouseoutStyle .= ' this.style.removeProperty(\'background-position\');';
                                            $mouseoutStyle .= ' this.style.removeProperty(\'background-size\');';
                                        }

                                        $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '
                                            style="' . esc_attr(trim($style)) . '"'
                                            . (!empty($hoverStyle)   ? ' onmouseover="' . $hoverStyle . '"' : '')
                                            . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                            . esc_html($croppedTitle) . '</a>';
                                    } else {
                                        // No link  render span with inline styles
                                        $inlineStyle = '';
                                        if (!empty($postTitleFontSize)) {
                                            $inlineStyle .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                                        }
                                        if (!empty($postTitleLineHeight)) {
                                            $inlineStyle .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                                        }
                                        if (!empty($postTitleLetterSpacing)) {
                                            $inlineStyle .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                                        }
                                        if (!empty($postTitleFontWeight)) {
                                            $inlineStyle .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                                        }
                                        if (!empty($postTitleColor)) {
                                            $inlineStyle .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                        }

                                        $output .= '<span style="' . esc_attr(trim($inlineStyle)) . '">' . esc_html($croppedTitle) . '</span>';
                                    }

                                    $output .= '</' . esc_attr($titleTag) . '>';
                                }

                                $output .= '</div>';
                                
                                // Add any other post content here (title, meta, etc.)
                            $output .= '</div>'; // .fancy-post-item
                    }
                } else if ($listLayoutStyle === 'style2') {
                    if ($post_count === 1) {
                        $borderStyles = '.fpg-blog-layout-1 .blog-item .blog-content .blog-btn .read-more.fpg-border::before {';
                    
                        $borderStyles .= 'background: ' . (!empty($buttonHoverTextColor) ? esc_attr($buttonHoverTextColor) : '#332FFF') . ';';
                        
                        $borderStyles .= '}';
                        $output .= '<style>' . $borderStyles . '</style>';
                        // LEFT SIDE - Only the first post
                        $output .= '<div class="col-lg-6" style="';
                            if (!empty($itemGap)) {
                                $halfGap = is_numeric($itemGap) ? ($itemGap / 2) . 'px' : esc_attr($itemGap);
                                $output .= 'padding-left: ' . $halfGap . '; padding-right: ' . $halfGap . '; ';
                            }
                            $output .= '">';
                            $output .= '<div class="blog-item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . ' ' . $postLinkType . '" style="';
                                // MARGIN    
                                if (isset($itemMargin['top']) || isset($itemMargin['right']) || isset($itemMargin['bottom']) || isset($itemMargin['left'])) {
                                    $output .= 'margin: ' .
                                        (isset($itemMargin['top']) ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' .
                                        (isset($itemMargin['right']) ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' .
                                        (isset($itemMargin['bottom']) ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' .
                                        (isset($itemMargin['left']) ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; ';
                                }

                                // PADDING
                                if (isset($itemPadding['top']) || isset($itemPadding['right']) || isset($itemPadding['bottom']) || isset($itemPadding['left'])) {
                                    $output .= 'padding: ' .
                                        (isset($itemPadding['top']) ? (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) : '0px') . ' ' .
                                        (isset($itemPadding['right']) ? (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) : '0px') . ' ' .
                                        (isset($itemPadding['bottom']) ? (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) : '0px') . ' ' .
                                        (isset($itemPadding['left']) ? (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) : '0px') . '; ';
                                }

                                // BORDER RADIUS
                                if (isset($itemBorderRadius['top']) || isset($itemBorderRadius['right']) || isset($itemBorderRadius['bottom']) || isset($itemBorderRadius['left'])) {
                                    $output .= 'border-radius: ' .
                                        (isset($itemBorderRadius['top']) ? (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) : '0px') . ' ' .
                                        (isset($itemBorderRadius['right']) ? (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) : '0px') . ' ' .
                                        (isset($itemBorderRadius['bottom']) ? (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) : '0px') . ' ' .
                                        (isset($itemBorderRadius['left']) ? (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) : '0px') . '; ';
                                }

                                // BORDER WIDTH
                                if (isset($itemBorderWidth['top']) || isset($itemBorderWidth['right']) || isset($itemBorderWidth['bottom']) || isset($itemBorderWidth['left'])) {
                                    $output .= 'border-width: ' .
                                        (isset($itemBorderWidth['top']) ? (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) : '0px') . ' ' .
                                        (isset($itemBorderWidth['right']) ? (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) : '0px') . ' ' .
                                        (isset($itemBorderWidth['bottom']) ? (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) : '0px') . ' ' .
                                        (isset($itemBorderWidth['left']) ? (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) : '0px') . '; ';
                                }

                                // Border Style & Color
                                if (!empty($itemBorderType)) {
                                    $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                                }
                                if (!empty($itemBorderColor)) {
                                    $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                                }

                                // Background Color
                                if (!empty($itemBackgroundColor)) {
                                    $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                                }

                                // Box Shadow
                                if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                                    $output .= 'box-shadow: ' . 
                                        (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                                        (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                                        (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                                        (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                                        esc_attr($itemBoxShadowColor) . '; ';
                                }

                            $output .= '">';

                                // Thumbnail
                                if ($leftThumbnailSize && $showThumbnail) {
                                    $output .= '<div class="image-wrap" style="';

                                    // MARGIN
                                    if (
                                        isset($thumbnailMargin['top']) ||
                                        isset($thumbnailMargin['right']) ||
                                        isset($thumbnailMargin['bottom']) ||
                                        isset($thumbnailMargin['left'])
                                    ) {
                                        $output .= 'margin: ' .
                                            (isset($thumbnailMargin['top']) ? (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) : '0px') . ' ' .
                                            (isset($thumbnailMargin['right']) ? (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) : '0px') . ' ' .
                                            (isset($thumbnailMargin['bottom']) ? (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) : '0px') . ' ' .
                                            (isset($thumbnailMargin['left']) ? (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) : '0px') . '; ';
                                    }

                                    // PADDING
                                    if (
                                        isset($thumbnailPadding['top']) ||
                                        isset($thumbnailPadding['right']) ||
                                        isset($thumbnailPadding['bottom']) ||
                                        isset($thumbnailPadding['left'])
                                    ) {
                                        $output .= 'padding: ' .
                                            (isset($thumbnailPadding['top']) ? (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) : '0px') . ' ' .
                                            (isset($thumbnailPadding['right']) ? (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) : '0px') . ' ' .
                                            (isset($thumbnailPadding['bottom']) ? (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) : '0px') . ' ' .
                                            (isset($thumbnailPadding['left']) ? (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) : '0px') . '; ';
                                    }

                                    // BORDER RADIUS
                                    if (
                                        isset($thumbnailBorderRadius['top']) ||
                                        isset($thumbnailBorderRadius['right']) ||
                                        isset($thumbnailBorderRadius['bottom']) ||
                                        isset($thumbnailBorderRadius['left'])
                                    ) {
                                        $output .= 'border-radius: ' .
                                            (isset($thumbnailBorderRadius['top']) ? (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) : '0px') . ' ' .
                                            (isset($thumbnailBorderRadius['right']) ? (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) : '0px') . ' ' .
                                            (isset($thumbnailBorderRadius['bottom']) ? (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) : '0px') . ' ' .
                                            (isset($thumbnailBorderRadius['left']) ? (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) : '0px') . '; ';
                                    }

                                    $output .= '">';

                                    $output .= '<a href="' . esc_url($permalink) . '"' . $targetAttr . '>';
                                    $output .= $leftThumbnailSize . '</a>';
                                    
                                    $output .= '</div>';
                                }
                                // END Thumbnail
                                // MAIN Content
                                $output .= '<div class="blog-content" style="';
                                    // MARGIN
                                    if (
                                        isset($contentitemMarginNew['top']) ||
                                        isset($contentitemMarginNew['right']) ||
                                        isset($contentitemMarginNew['bottom']) ||
                                        isset($contentitemMarginNew['left'])
                                    ) {
                                        $output .= 'margin: ' .
                                            (isset($contentitemMarginNew['top']) ? (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) : '0px') . ' ' .
                                            (isset($contentitemMarginNew['right']) ? (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) : '0px') . ' ' .
                                            (isset($contentitemMarginNew['bottom']) ? (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) : '0px') . ' ' .
                                            (isset($contentitemMarginNew['left']) ? (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) : '0px') . '; ';
                                    }

                                    // PADDING
                                    if (
                                        isset($contentitemPaddingNew['top']) ||
                                        isset($contentitemPaddingNew['right']) ||
                                        isset($contentitemPaddingNew['bottom']) ||
                                        isset($contentitemPaddingNew['left'])
                                    ) {
                                        $output .= 'padding: ' .
                                            (isset($contentitemPaddingNew['top']) ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' .
                                            (isset($contentitemPaddingNew['right']) ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' .
                                            (isset($contentitemPaddingNew['bottom']) ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' .
                                            (isset($contentitemPaddingNew['left']) ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; ';
                                    }

                                    // BORDER WIDTH
                                    if (
                                        isset($contentBorderWidth['top']) ||
                                        isset($contentBorderWidth['right']) ||
                                        isset($contentBorderWidth['bottom']) ||
                                        isset($contentBorderWidth['left'])
                                    ) {
                                        $output .= 'border-width: ' .
                                            (isset($contentBorderWidth['top']) ? (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) : '0px') . ' ' .
                                            (isset($contentBorderWidth['right']) ? (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) : '0px') . ' ' .
                                            (isset($contentBorderWidth['bottom']) ? (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) : '0px') . ' ' .
                                            (isset($contentBorderWidth['left']) ? (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) : '0px') . '; ';
                                    }
                                    // BORDER radius
                                    if (
                                        isset($contentitemRadius['top']) ||
                                        isset($contentitemRadius['right']) ||
                                        isset($contentitemRadius['bottom']) ||
                                        isset($contentitemRadius['left'])
                                    ) {
                                        $output .= 'border-radius: ' .
                                            (isset($contentitemRadius['top']) ? (is_numeric($contentitemRadius['top']) ? $contentitemRadius['top'] . 'px' : esc_attr($contentitemRadius['top'])) : '0px') . ' ' .
                                            (isset($contentitemRadius['right']) ? (is_numeric($contentitemRadius['right']) ? $contentitemRadius['right'] . 'px' : esc_attr($contentitemRadius['right'])) : '0px') . ' ' .
                                            (isset($contentitemRadius['bottom']) ? (is_numeric($contentitemRadius['bottom']) ? $contentitemRadius['bottom'] . 'px' : esc_attr($contentitemRadius['bottom'])) : '0px') . ' ' .
                                            (isset($contentitemRadius['left']) ? (is_numeric($contentitemRadius['left']) ? $contentitemRadius['left'] . 'px' : esc_attr($contentitemRadius['left'])) : '0px') . '; ';
                                    }
                                    // Border Style
                                    if (!empty($contentNormalBorderType)) {
                                        $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                                    }
                                    // Background Color
                                    if (!empty($contentBgColor)) {
                                        $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                                    }
                                    // Border Color
                                    if (!empty($contentBorderColor)) {
                                        $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                                    }
                                $output .= '">';

                                // Meta Data
                                if ($showMetaData) {
                                    $output .= '<ul class="blog-meta align-' . $metaAlignment . ' " style="';  
                                        // MARGIN
                                        if (
                                            isset($metaMarginNew['top']) ||
                                            isset($metaMarginNew['right']) ||
                                            isset($metaMarginNew['bottom']) ||
                                            isset($metaMarginNew['left'])
                                        ) {
                                            $output .= 'margin: ' .
                                                (isset($metaMarginNew['top']) ? (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) : '0px') . ' ' .
                                                (isset($metaMarginNew['right']) ? (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) : '0px') . ' ' .
                                                (isset($metaMarginNew['bottom']) ? (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) : '0px') . ' ' .
                                                (isset($metaMarginNew['left']) ? (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) : '0px') . '; ';
                                        }

                                        // PADDING
                                        if (
                                            isset($metaPadding['top']) ||
                                            isset($metaPadding['right']) ||
                                            isset($metaPadding['bottom']) ||
                                            isset($metaPadding['left'])
                                        ) {
                                            $output .= 'padding: ' .
                                                (isset($metaPadding['top']) ? (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) : '0px') . ' ' .
                                                (isset($metaPadding['right']) ? (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) : '0px') . ' ' .
                                                (isset($metaPadding['bottom']) ? (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) : '0px') . ' ' .
                                                (isset($metaPadding['left']) ? (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) : '0px') . '; ';
                                        }  
                                        
                                        // Color
                                        if (!empty($metaTextColor)) {
                                            $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                                        }
                                        // Order
                                        if (!empty($metaOrder)) {
                                            $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                                        }
                                    $output .= '">';

                                    $meta_items = [];
                                    // Author
                                    if ($showPostAuthor) {
                                        $meta = '<li class="admin" style="';

                                        if (!empty($metaTextColor)) {
                                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '">';

                                        if ($showPostAuthorIcon && $showMetaIcon) {
                                            $meta .= '<i class="fas fa-user" style="';

                                            if (!empty($metaIconColor)) {
                                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                            }

                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '"></i> ';
                                        }

                                        $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                                        $meta_items[] = $meta;
                                    }
                                    // Date
                                    if ($showPostDate) {
                                        $meta = '<li class="meta-date" style="';

                                        // Color
                                        if (!empty($metaTextColor)) {
                                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                        }

                                        // Font size
                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '">';

                                        // Icon
                                        if ($showPostDateIcon && $showMetaIcon) {
                                            $meta .= '<i class="fas fa-calendar-alt" style="';

                                            if (!empty($metaIconColor)) {
                                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                            }

                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '"></i> ';
                                        }

                                        $meta .= esc_html($getdate) . '</li>';
                                        $meta_items[] = $meta;
                                    }
                                    
                                    // Category
                                    if ($showPostCategory) {
                                        $meta = '<li class="meta-categories" style="';

                                        if (!empty($metaTextColor)) {
                                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '">';

                                        if ($showPostCategoryIcon && $showMetaIcon) {
                                            $meta .= '<i class="fas fa-folder" style="';

                                            if (!empty($metaIconColor)) {
                                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                            }

                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '"></i> ';
                                        }

                                        // Get category names without links
                                        $categories_list = get_the_category($post_id);
                                        if (!empty($categories_list)) {
                                            $category_names = array();
                                            foreach ($categories_list as $category) {
                                                $category_names[] = esc_html($category->name);
                                            }
                                            $meta .= implode(', ', $category_names); // comma-separated plain text categories
                                        }

                                        $meta .= '</li>';
                                        $meta_items[] = $meta;
                                    }
                                    // Tags
                                    if ($showPostTags && !empty($tags)) {
                                        $meta = '<li class="meta-tags" style="';

                                        if (!empty($metaTextColor)) {
                                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '">';

                                        if ($showPostTagsIcon && $showMetaIcon) {
                                            $meta .= '<i class="fas fa-tags" style="';

                                            if (!empty($metaIconColor)) {
                                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                            }

                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '"></i> ';
                                        }

                                        $meta .= esc_html__('Tags:', 'fancy-post-grid') . ' ' . $tags . '</li>';
                                        $meta_items[] = $meta;
                                    }
                                    // Comment Count
                                    if ($showPostCommentsCount) {
                                        $meta = '<li class="meta-comment-count" style="';
                                        if (!empty($metaTextColor)) {
                                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                        }
                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '">';

                                        if ($showPostCommentsCountIcon && $showMetaIcon) {
                                            $meta .= '<i class="fas fa-comments" style="';
                                            if (!empty($metaIconColor)) {
                                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                            }
                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }
                                            $meta .= '"></i> ';
                                        }

                                        $meta .= esc_html($comments_count) . ' ' . esc_html__('Comments', 'fancy-post-grid') . '</li>';
                                        $meta_items[] = $meta;
                                    }
                                    // Now join meta items with the separator
                                    if (!empty($meta_items)) {
                                        $separator = '';

                                        if ($metaSeperator !== '') {
                                            $separator = '';
                                            if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                                $separatorStyle = '';
                                                if (!empty($separatorColor)) {
                                                    $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                                }
                                                if (!empty($metaFontSize)) {
                                                    $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                                }

                                                $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                                            }
                                        }

                                        $output .= implode($separator, $meta_items);
                                    }
                                    $output .= '</ul>'; // Close meta-data-list               
                                }
                                // End Meta Data

                                // title
                                if ($showPostTitle) {
                                    $titleStyles = '';

                                    // Order
                                    if (!empty($titleOrder)) {
                                        $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                                    }

                                    // Background color
                                    if (!empty($postTitleBgColor)) {
                                        $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                                    }

                                    // Margin
                                    if (isset($postTitleMargin['top']) || isset($postTitleMargin['right']) || isset($postTitleMargin['bottom']) || isset($postTitleMargin['left'])) {
                                        $titleStyles .= 'margin: ' .
                                            (isset($postTitleMargin['top']) ? (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) : '0px') . ' ' .
                                            (isset($postTitleMargin['right']) ? (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) : '0px') . ' ' .
                                            (isset($postTitleMargin['bottom']) ? (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) : '0px') . ' ' .
                                            (isset($postTitleMargin['left']) ? (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) : '0px') . '; ';
                                    }

                                    // Padding
                                    if (isset($postTitlePadding['top']) || isset($postTitlePadding['right']) || isset($postTitlePadding['bottom']) || isset($postTitlePadding['left'])) {
                                        $titleStyles .= 'padding: ' .
                                            (isset($postTitlePadding['top']) ? (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) : '0px') . ' ' .
                                            (isset($postTitlePadding['right']) ? (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) : '0px') . ' ' .
                                            (isset($postTitlePadding['bottom']) ? (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) : '0px') . ' ' .
                                            (isset($postTitlePadding['left']) ? (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) : '0px') . '; ';
                                    }

                                    // Determine if underline should be shown
                                    $showUnderline = $postLinkType === 'yeslink' && $titleHoverUnderLine === 'enable';

                                    // Class name
                                    $classNames = 'blog-title align-' . esc_attr($postTitleAlignment);
                                    if ($showUnderline) {
                                        $classNames .= ' underline';
                                    }

                                    // Hover/Out events for nolink
                                    $onmouseover = '';
                                    $onmouseout  = '';

                                    if (!empty($postTitleHoverBgColor)) {
                                        $onmouseover .= 'this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';';
                                    }

                                    if (!empty($postTitleHoverColor)) {
                                        $onmouseover .= ' this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                                    }

                                    if (!empty($postTitleBgColor)) {
                                        $onmouseout .= 'this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';';
                                    } else {
                                        $onmouseout .= 'this.style.removeProperty(\'background-color\');';
                                    }

                                    if (!empty($postTitleColor)) {
                                        $onmouseout .= ' this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                                    } else {
                                        $onmouseout .= ' this.style.removeProperty(\'color\');';
                                    }

                                    // Opening title tag
                                    $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"'
                                        . (!empty($onmouseover) ? ' onmouseover="' . trim($onmouseover) . '"' : '')
                                        . (!empty($onmouseout)  ? ' onmouseout="'  . trim($onmouseout)  . '"' : '') . '>';

                                    if ($postLinkType === 'yeslink') {
                                        // Anchor styles
                                        $style = '';
                                        $hoverStyle = '';
                                        $mouseoutStyle = '';

                                        if (!empty($postTitleFontSize)) {
                                            $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                                        }

                                        if (!empty($postTitleLineHeight)) {
                                            $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                                        }

                                        if (!empty($postTitleLetterSpacing)) {
                                            $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                                        }

                                        if (!empty($postTitleFontWeight)) {
                                            $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                                        }

                                        if (!empty($postTitleColor)) {
                                            $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                            $mouseoutStyle .= 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                                        } else {
                                            $mouseoutStyle .= 'this.style.color=\'\';';
                                        }

                                        if (!empty($postTitleHoverColor)) {
                                            $hoverStyle .= 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                                        }

                                        if ($showUnderline && !empty($postTitleHoverColor)) {
                                            $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                                            $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                            $hoverStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                                        }

                                        if ($showUnderline && empty($postTitleColor ) && !empty($postTitleColor )) {
                                            $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                                            $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                            $mouseoutStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                                        } else {
                                            
                                            $mouseoutStyle .= ' this.style.removeProperty(\'background-position\');';
                                            $mouseoutStyle .= ' this.style.removeProperty(\'background-size\');';
                                        }

                                        $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '
                                            style="' . esc_attr(trim($style)) . '"'
                                            . (!empty($hoverStyle)   ? ' onmouseover="' . $hoverStyle . '"' : '')
                                            . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                            . esc_html($croppedTitle) . '</a>';
                                    } else {
                                        // No link  render span with inline styles
                                        $inlineStyle = '';
                                        if (!empty($postTitleFontSize)) {
                                            $inlineStyle .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                                        }
                                        if (!empty($postTitleLineHeight)) {
                                            $inlineStyle .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                                        }
                                        if (!empty($postTitleLetterSpacing)) {
                                            $inlineStyle .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                                        }
                                        if (!empty($postTitleFontWeight)) {
                                            $inlineStyle .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                                        }
                                        if (!empty($postTitleColor)) {
                                            $inlineStyle .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                        }

                                        $output .= '<span style="' . esc_attr(trim($inlineStyle)) . '">' . esc_html($croppedTitle) . '</span>';
                                    }

                                    $output .= '</' . esc_attr($titleTag) . '>';
                                }

                                // Excerpt
                                if ($showPostExcerpt) {
                                    $excerptStyles = '';

                                    // Order
                                    if (!empty($excerptOrder)) {
                                        $excerptStyles .= 'order: ' . esc_attr($excerptOrder) . '; ';
                                    }

                                    // Typography
                                    if (!empty($excerptFontSize)) {
                                        $excerptStyles .= 'font-size: ' . esc_attr($excerptFontSize) . 'px; ';
                                    }

                                    if (!empty($excerptLineHeight)) {
                                        $excerptStyles .= 'line-height: ' . esc_attr($excerptLineHeight) . '; ';
                                    }

                                    if (!empty($excerptLetterSpacing)) {
                                        $excerptStyles .= 'letter-spacing: ' . esc_attr($excerptLetterSpacing) . 'px; ';
                                    }

                                    if (!empty($excerptFontWeight)) {
                                        $excerptStyles .= 'font-weight: ' . esc_attr($excerptFontWeight) . '; ';
                                    }

                                    if (!empty($excerptColor)) {
                                        $excerptStyles .= 'color: ' . esc_attr($excerptColor) . '; ';
                                    }

                                    if (!empty($excerptBgColor)) {
                                        $excerptStyles .= 'background-color: ' . esc_attr($excerptBgColor) . '; ';
                                    }

                                    if (!empty($excerptBorderType)) {
                                        $excerptStyles .= 'border-style: ' . esc_attr($excerptBorderType) . '; ';
                                    }

                                    // Margin
                                    if (isset($excerptMargin['top']) || isset($excerptMargin['right']) || isset($excerptMargin['bottom']) || isset($excerptMargin['left'])) {
                                        $excerptStyles .= 'margin: ' .
                                            (isset($excerptMargin['top']) ? (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) : '0px') . ' ' .
                                            (isset($excerptMargin['right']) ? (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) : '0px') . ' ' .
                                            (isset($excerptMargin['bottom']) ? (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) : '0px') . ' ' .
                                            (isset($excerptMargin['left']) ? (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) : '0px') . '; ';
                                    }

                                    // Padding
                                    if (isset($excerptPadding['top']) || isset($excerptPadding['right']) || isset($excerptPadding['bottom']) || isset($excerptPadding['left'])) {
                                        $excerptStyles .= 'padding: ' .
                                            (isset($excerptPadding['top']) ? (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) : '0px') . ' ' .
                                            (isset($excerptPadding['right']) ? (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) : '0px') . ' ' .
                                            (isset($excerptPadding['bottom']) ? (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) : '0px') . ' ' .
                                            (isset($excerptPadding['left']) ? (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) : '0px') . '; ';
                                    }

                                    // Handle hover logic conditionally
                                    $hoverIn = '';
                                    $hoverOut = '';

                                    if (!empty($excerptHoverColor)) {
                                        $hoverIn .= 'this.style.color=\'' . esc_attr($excerptHoverColor) . '\';';
                                        $hoverOut .= 'this.style.color=\'' . esc_attr($excerptColor) . '\';';
                                    }

                                    if (!empty($excerptHoverBgColor)) {
                                        $hoverIn .= 'this.style.backgroundColor=\'' . esc_attr($excerptHoverBgColor) . '\';';
                                        $hoverOut .= 'this.style.backgroundColor=\'' . esc_attr($excerptBgColor) . '\';';
                                    }

                                    $output .= '<div class="desc' . ' align-' . esc_attr($excerptAlignment) . '" style="' . esc_attr(trim($excerptStyles)) . '"';

                                    if (!empty($hoverIn) || !empty($hoverOut)) {
                                        $output .= ' onmouseover="' . esc_attr($hoverIn) . '"';
                                        $output .= ' onmouseout="' . esc_attr($hoverOut) . '"';
                                    }

                                    $output .= '>';
                                    $output .= '<p>' . esc_html($excerpt) . '</p>';
                                    $output .= '</div>';
                                }
                                // End Excerpt

                                // Button Output                
                                if ($showReadMoreButton) {
                                    // Button wrapper styles
                                    $buttonWrapperStyle = '';

                                    if (
                                        isset($buttonMarginNew['top']) || 
                                        isset($buttonMarginNew['right']) || 
                                        isset($buttonMarginNew['bottom']) || 
                                        isset($buttonMarginNew['left'])
                                    ) {
                                        $buttonWrapperStyle .= 'margin: ' .
                                            (isset($buttonMarginNew['top']) ? (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) : '0px') . ' ' .
                                            (isset($buttonMarginNew['right']) ? (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) : '0px') . ' ' .
                                            (isset($buttonMarginNew['bottom']) ? (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) : '0px') . ' ' .
                                            (isset($buttonMarginNew['left']) ? (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) : '0px') . '; ';
                                    }

                                    // Order
                                    if (!empty($buttonOrder)) {
                                        $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                                    }

                                    $output .= '<div class="blog-btn align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';

                                    // Button inline styles
                                    $buttonInlineStyles = '';

                                    if (!empty($buttonTextColor)) {
                                        $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                                    }
                                    if (!empty($buttonBackgroundColor)) {
                                        $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                                    }
                                    if (!empty($buttonFontSize)) {
                                        $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                                    }
                                    if (!empty($buttonFontWeight)) {
                                        $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                                    }
                                    if (!empty($buttonBorderColor)) {
                                        $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                                    }
                                    if (!empty($buttonBorderType)) {
                                        $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                                    }

                                    // Border Width
                                    if (
                                        isset($buttonBorderWidth['top']) || 
                                        isset($buttonBorderWidth['right']) || 
                                        isset($buttonBorderWidth['bottom']) || 
                                        isset($buttonBorderWidth['left'])
                                    ) {
                                        $buttonInlineStyles .= 'border-width: ' .
                                            (isset($buttonBorderWidth['top']) ? (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) : '0px') . ' ' .
                                            (isset($buttonBorderWidth['right']) ? (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) : '0px') . ' ' .
                                            (isset($buttonBorderWidth['bottom']) ? (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) : '0px') . ' ' .
                                            (isset($buttonBorderWidth['left']) ? (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) : '0px') . '; ';
                                    }

                                    // Border Radius
                                    if (
                                        isset($buttonBorderRadius['top']) || 
                                        isset($buttonBorderRadius['right']) || 
                                        isset($buttonBorderRadius['bottom']) || 
                                        isset($buttonBorderRadius['left'])
                                    ) {
                                        $buttonInlineStyles .= 'border-radius: ' .
                                            (isset($buttonBorderRadius['top']) ? (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) : '0px') . ' ' .
                                            (isset($buttonBorderRadius['right']) ? (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) : '0px') . ' ' .
                                            (isset($buttonBorderRadius['bottom']) ? (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) : '0px') . ' ' .
                                            (isset($buttonBorderRadius['left']) ? (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) : '0px') . '; ';
                                    }

                                    // Padding
                                    if (
                                        isset($buttonPaddingNew['top']) || 
                                        isset($buttonPaddingNew['right']) || 
                                        isset($buttonPaddingNew['bottom']) || 
                                        isset($buttonPaddingNew['left'])
                                    ) {
                                        $buttonInlineStyles .= 'padding: ' .
                                            (isset($buttonPaddingNew['top']) ? (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) : '0px') . ' ' .
                                            (isset($buttonPaddingNew['right']) ? (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) : '0px') . ' ' .
                                            (isset($buttonPaddingNew['bottom']) ? (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) : '0px') . ' ' .
                                            (isset($buttonPaddingNew['left']) ? (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) : '0px') . '; ';
                                    } 

                                    // Hover styles
                                    $buttonHoverInlineStyles = '';
                                    $buttonResetStyles = '';

                                    if (!empty($buttonHoverTextColor)) {
                                        $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                                        $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                                    }
                                    if (!empty($buttonHoverBorderColor)) {
                                        $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                                        $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                                    }
                                    if (!empty($buttonHoverBackgroundColor)) {
                                        $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                                        $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                                    }

                                    // Button anchor tag
                                    $output .= '<a class="fpg-link read-more ' . esc_attr($buttonStyle2) . '" href="' . esc_url(get_permalink()) . '" ' . $targetAttr . ' style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                                    if (!empty($buttonHoverInlineStyles)) {
                                        $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                                    }

                                    if (!empty($buttonResetStyles)) {
                                        $output .= ' onmouseout="' . $buttonResetStyles . '"';
                                    }

                                    $output .= '>';

                                    // Icon handling
                                    $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                                    $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                                    $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                                    if ($iconPosition === 'left' && $showButtonIcon) {
                                        $output .= $leftIcon . ' ';
                                    }

                                    $output .= esc_html($readMoreLabel);

                                    if ($iconPosition === 'right' && $showButtonIcon) {
                                        $output .= ' ' . $rightIcon;
                                    }

                                    $output .= '</a></div>';
                                }
                                // End Button

                                $output .= '</div>';
                                // Add any other post content here (title, meta, etc.)
                            $output .= '</div>'; // .fancy-post-item
                        $output .= '</div>'; // .col-lg-6

                        // START RIGHT SIDE WRAPPER for remaining posts
                        $output .= '<div class="col-lg-6" style="';
                        if (!empty($itemGap)) {
                            $halfGap = is_numeric($itemGap) ? ($itemGap / 2) . 'px' : esc_attr($itemGap);
                            $output .= 'padding-left: ' . $halfGap . '; padding-right: ' . $halfGap . '; ';
                        }
                        $output .= '">';
                        $output .= '<div class="blog-horizontal">';
                    } else {
                        // RIGHT SIDE - All other posts
                        $output .= '<div class="blog-meta mb-30" style="';
                            // MARGIN    
                            if (isset($itemMargin['top']) || isset($itemMargin['right']) || isset($itemMargin['bottom']) || isset($itemMargin['left'])) {
                                $output .= 'margin: ' .
                                    (isset($itemMargin['top']) ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' .
                                    (isset($itemMargin['right']) ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' .
                                    (isset($itemMargin['bottom']) ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' .
                                    (isset($itemMargin['left']) ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; ';
                            }

                            // PADDING
                            if (isset($itemPadding['top']) || isset($itemPadding['right']) || isset($itemPadding['bottom']) || isset($itemPadding['left'])) {
                                $output .= 'padding: ' .
                                    (isset($itemPadding['top']) ? (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) : '0px') . ' ' .
                                    (isset($itemPadding['right']) ? (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) : '0px') . ' ' .
                                    (isset($itemPadding['bottom']) ? (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) : '0px') . ' ' .
                                    (isset($itemPadding['left']) ? (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) : '0px') . '; ';
                            }

                            // BORDER RADIUS
                            if (isset($itemBorderRadius['top']) || isset($itemBorderRadius['right']) || isset($itemBorderRadius['bottom']) || isset($itemBorderRadius['left'])) {
                                $output .= 'border-radius: ' .
                                    (isset($itemBorderRadius['top']) ? (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) : '0px') . ' ' .
                                    (isset($itemBorderRadius['right']) ? (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) : '0px') . ' ' .
                                    (isset($itemBorderRadius['bottom']) ? (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) : '0px') . ' ' .
                                    (isset($itemBorderRadius['left']) ? (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) : '0px') . '; ';
                            }

                            // BORDER WIDTH
                            if (isset($itemBorderWidth['top']) || isset($itemBorderWidth['right']) || isset($itemBorderWidth['bottom']) || isset($itemBorderWidth['left'])) {
                                $output .= 'border-width: ' .
                                    (isset($itemBorderWidth['top']) ? (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) : '0px') . ' ' .
                                    (isset($itemBorderWidth['right']) ? (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) : '0px') . ' ' .
                                    (isset($itemBorderWidth['bottom']) ? (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) : '0px') . ' ' .
                                    (isset($itemBorderWidth['left']) ? (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) : '0px') . '; ';
                            }

                            // Border Style & Color
                            if (!empty($itemBorderType)) {
                                $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                            }
                            if (!empty($itemBorderColor)) {
                                $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                            }

                            // Background Color
                            if (!empty($itemBackgroundColor)) {
                                $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                            }

                            // Box Shadow
                            if (
                                isset($itemBoxShadow['left']) ||  // horizontal offset
                                isset($itemBoxShadow['top']) ||  // vertical offset
                                isset($itemBoxShadow['right']) ||  // blur radius
                                isset($itemBoxShadow['bottom']) ||  // spread radius
                                isset($itemBoxShadowColor)
                            ) {
                                $output .= 'box-shadow: ' .
                                    (isset($itemBoxShadow['left']) ? (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) : '0px') . ' ' .
                                    (isset($itemBoxShadow['top']) ? (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) : '0px') . ' ' .
                                    (isset($itemBoxShadow['right']) ? (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) : '0px') . ' ' .
                                    (isset($itemBoxShadow['bottom']) ? (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) : '0px') . ' ' .
                                    (!empty($itemBoxShadowColor) ? esc_attr($itemBoxShadowColor) : 'rgba(0,0,0,0.1)') . '; ';
                            }

                        $output .= '">';
                            $output .= '<div class="blog-item-wrap align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '">';
                                // Thumbnail
                                if ($rightThumbnailSize && $showThumbnail) {
                                    $output .= '<div class="image-wrap" style="';

                                    // MARGIN
                                    if (
                                        isset($thumbnailMargin['top']) ||
                                        isset($thumbnailMargin['right']) ||
                                        isset($thumbnailMargin['bottom']) ||
                                        isset($thumbnailMargin['left'])
                                    ) {
                                        $output .= 'margin: ' .
                                            (isset($thumbnailMargin['top']) ? (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) : '0px') . ' ' .
                                            (isset($thumbnailMargin['right']) ? (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) : '0px') . ' ' .
                                            (isset($thumbnailMargin['bottom']) ? (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) : '0px') . ' ' .
                                            (isset($thumbnailMargin['left']) ? (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) : '0px') . '; ';
                                    }

                                    // PADDING
                                    if (
                                        isset($thumbnailPadding['top']) ||
                                        isset($thumbnailPadding['right']) ||
                                        isset($thumbnailPadding['bottom']) ||
                                        isset($thumbnailPadding['left'])
                                    ) {
                                        $output .= 'padding: ' .
                                            (isset($thumbnailPadding['top']) ? (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) : '0px') . ' ' .
                                            (isset($thumbnailPadding['right']) ? (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) : '0px') . ' ' .
                                            (isset($thumbnailPadding['bottom']) ? (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) : '0px') . ' ' .
                                            (isset($thumbnailPadding['left']) ? (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) : '0px') . '; ';
                                    }

                                    // BORDER RADIUS
                                    if (
                                        isset($thumbnailBorderRadius['top']) ||
                                        isset($thumbnailBorderRadius['right']) ||
                                        isset($thumbnailBorderRadius['bottom']) ||
                                        isset($thumbnailBorderRadius['left'])
                                    ) {
                                        $output .= 'border-radius: ' .
                                            (isset($thumbnailBorderRadius['top']) ? (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) : '0px') . ' ' .
                                            (isset($thumbnailBorderRadius['right']) ? (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) : '0px') . ' ' .
                                            (isset($thumbnailBorderRadius['bottom']) ? (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) : '0px') . ' ' .
                                            (isset($thumbnailBorderRadius['left']) ? (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) : '0px') . '; ';
                                    }
                                    $output .= '">';

                                    // Anchor with optional border-radius and overflow
                                    $output .= '<a href="' . esc_url($permalink) . '"' . $targetAttr . '>';
                                    
                                    $output .= $rightThumbnailSize . '</a>';
                                    
                                    $output .= '</div>';
                                }
                                // END Thumbnail

                                // MAIN Content
                                $output .= '<div class="blog-content" style="';
                                    // MARGIN
                                    if (
                                        isset($contentitemMarginNew['top']) ||
                                        isset($contentitemMarginNew['right']) ||
                                        isset($contentitemMarginNew['bottom']) ||
                                        isset($contentitemMarginNew['left'])
                                    ) {
                                        $output .= 'margin: ' .
                                            (isset($contentitemMarginNew['top']) ? (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) : '0px') . ' ' .
                                            (isset($contentitemMarginNew['right']) ? (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) : '0px') . ' ' .
                                            (isset($contentitemMarginNew['bottom']) ? (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) : '0px') . ' ' .
                                            (isset($contentitemMarginNew['left']) ? (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) : '0px') . '; ';
                                    }

                                    // PADDING
                                    if (
                                        isset($contentitemPaddingNew['top']) ||
                                        isset($contentitemPaddingNew['right']) ||
                                        isset($contentitemPaddingNew['bottom']) ||
                                        isset($contentitemPaddingNew['left'])
                                    ) {
                                        $output .= 'padding: ' .
                                            (isset($contentitemPaddingNew['top']) ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' .
                                            (isset($contentitemPaddingNew['right']) ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' .
                                            (isset($contentitemPaddingNew['bottom']) ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' .
                                            (isset($contentitemPaddingNew['left']) ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; ';
                                    }

                                    // BORDER WIDTH
                                    if (
                                        isset($contentBorderWidth['top']) ||
                                        isset($contentBorderWidth['right']) ||
                                        isset($contentBorderWidth['bottom']) ||
                                        isset($contentBorderWidth['left'])
                                    ) {
                                        $output .= 'border-width: ' .
                                            (isset($contentBorderWidth['top']) ? (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) : '0px') . ' ' .
                                            (isset($contentBorderWidth['right']) ? (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) : '0px') . ' ' .
                                            (isset($contentBorderWidth['bottom']) ? (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) : '0px') . ' ' .
                                            (isset($contentBorderWidth['left']) ? (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) : '0px') . '; ';
                                    }
                                    // BORDER radius
                                    if (
                                        isset($contentitemRadius['top']) ||
                                        isset($contentitemRadius['right']) ||
                                        isset($contentitemRadius['bottom']) ||
                                        isset($contentitemRadius['left'])
                                    ) {
                                        $output .= 'border-radius: ' .
                                            (isset($contentitemRadius['top']) ? (is_numeric($contentitemRadius['top']) ? $contentitemRadius['top'] . 'px' : esc_attr($contentitemRadius['top'])) : '0px') . ' ' .
                                            (isset($contentitemRadius['right']) ? (is_numeric($contentitemRadius['right']) ? $contentitemRadius['right'] . 'px' : esc_attr($contentitemRadius['right'])) : '0px') . ' ' .
                                            (isset($contentitemRadius['bottom']) ? (is_numeric($contentitemRadius['bottom']) ? $contentitemRadius['bottom'] . 'px' : esc_attr($contentitemRadius['bottom'])) : '0px') . ' ' .
                                            (isset($contentitemRadius['left']) ? (is_numeric($contentitemRadius['left']) ? $contentitemRadius['left'] . 'px' : esc_attr($contentitemRadius['left'])) : '0px') . '; ';
                                    }
                                    // Border Style
                                    if (!empty($contentNormalBorderType)) {
                                        $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                                    }
                                    // Background Color
                                    if (!empty($contentBgColor)) {
                                        $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                                    }
                                    // Border Color
                                    if (!empty($contentBorderColor)) {
                                        $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                                    }
                                $output .= '">';

                                // Meta Data
                                if ($showMetaData) {
                                    $output .= '<ul class="blog-meta align-' . $metaAlignment . ' " style="';  
                                        // MARGIN
                                        if (
                                            isset($metaMarginNew['top']) ||
                                            isset($metaMarginNew['right']) ||
                                            isset($metaMarginNew['bottom']) ||
                                            isset($metaMarginNew['left'])
                                        ) {
                                            $output .= 'margin: ' .
                                                (isset($metaMarginNew['top']) ? (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) : '0px') . ' ' .
                                                (isset($metaMarginNew['right']) ? (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) : '0px') . ' ' .
                                                (isset($metaMarginNew['bottom']) ? (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) : '0px') . ' ' .
                                                (isset($metaMarginNew['left']) ? (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) : '0px') . '; ';
                                        }

                                        // PADDING
                                        if (
                                            isset($metaPadding['top']) ||
                                            isset($metaPadding['right']) ||
                                            isset($metaPadding['bottom']) ||
                                            isset($metaPadding['left'])
                                        ) {
                                            $output .= 'padding: ' .
                                                (isset($metaPadding['top']) ? (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) : '0px') . ' ' .
                                                (isset($metaPadding['right']) ? (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) : '0px') . ' ' .
                                                (isset($metaPadding['bottom']) ? (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) : '0px') . ' ' .
                                                (isset($metaPadding['left']) ? (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) : '0px') . '; ';
                                        }  
                                        
                                        // Color
                                        if (!empty($metaTextColor)) {
                                            $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                                        }
                                        // Order
                                        if (!empty($metaOrder)) {
                                            $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                                        }
                                    $output .= '">';

                                    $meta_items = [];
                                    // Author
                                    if ($showPostAuthor) {
                                        $meta = '<li class="admin" style="';

                                        if (!empty($metaTextColor)) {
                                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '">';

                                        if ($showPostAuthorIcon && $showMetaIcon) {
                                            $meta .= '<i class="fas fa-user" style="';

                                            if (!empty($metaIconColor)) {
                                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                            }

                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '"></i> ';
                                        }

                                        $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                                        $meta_items[] = $meta;
                                    }
                                    
                                    // Date
                                    if ($showPostDate) {
                                        $meta = '<li class="meta-date" style="';

                                        // Color
                                        if (!empty($metaTextColor)) {
                                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                        }

                                        // Font size
                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '">';

                                        // Icon
                                        if ($showPostDateIcon && $showMetaIcon) {
                                            $meta .= '<i class="fas fa-calendar-alt" style="';

                                            if (!empty($metaIconColor)) {
                                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                            }

                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '"></i> ';
                                        }

                                        $meta .= esc_html($getdate) . '</li>';
                                        $meta_items[] = $meta;
                                    }
                                    
                                    
                                    // Now join meta items with the separator
                                    if (!empty($meta_items)) {
                                        $separator = '';

                                        if ($metaSeperator !== '') {
                                            $separator = '';
                                            if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                                $separatorStyle = '';
                                                if (!empty($separatorColor)) {
                                                    $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                                }
                                                if (!empty($metaFontSize)) {
                                                    $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                                }

                                                $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                                            }
                                        }

                                        $output .= implode($separator, $meta_items);
                                    }
                                    $output .= '</ul>'; // Close meta-data-list               
                                }
                                // End Meta Data

                                // title
                                if ($showPostTitle) {
                                    $titleStyles = '';

                                    // Order
                                    if (!empty($titleOrder)) {
                                        $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                                    }

                                    // Background color
                                    if (!empty($postTitleBgColor)) {
                                        $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                                    }

                                    // Margin
                                    if (isset($postTitleMargin['top']) || isset($postTitleMargin['right']) || isset($postTitleMargin['bottom']) || isset($postTitleMargin['left'])) {
                                        $titleStyles .= 'margin: ' .
                                            (isset($postTitleMargin['top']) ? (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) : '0px') . ' ' .
                                            (isset($postTitleMargin['right']) ? (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) : '0px') . ' ' .
                                            (isset($postTitleMargin['bottom']) ? (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) : '0px') . ' ' .
                                            (isset($postTitleMargin['left']) ? (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) : '0px') . '; ';
                                    }

                                    // Padding
                                    if (isset($postTitlePadding['top']) || isset($postTitlePadding['right']) || isset($postTitlePadding['bottom']) || isset($postTitlePadding['left'])) {
                                        $titleStyles .= 'padding: ' .
                                            (isset($postTitlePadding['top']) ? (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) : '0px') . ' ' .
                                            (isset($postTitlePadding['right']) ? (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) : '0px') . ' ' .
                                            (isset($postTitlePadding['bottom']) ? (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) : '0px') . ' ' .
                                            (isset($postTitlePadding['left']) ? (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) : '0px') . '; ';
                                    }

                                    // Determine if underline should be shown
                                    $showUnderline = $postLinkType === 'yeslink' && $titleHoverUnderLine === 'enable';

                                    // Class name
                                    $classNames = 'blog-title align-' . esc_attr($postTitleAlignment);
                                    if ($showUnderline) {
                                        $classNames .= ' underline';
                                    }

                                    // Hover/Out events for nolink
                                    $onmouseover = '';
                                    $onmouseout  = '';

                                    if (!empty($postTitleHoverBgColor)) {
                                        $onmouseover .= 'this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';';
                                    }

                                    if (!empty($postTitleHoverColor)) {
                                        $onmouseover .= ' this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                                    }

                                    if (!empty($postTitleBgColor)) {
                                        $onmouseout .= 'this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';';
                                    } else {
                                        $onmouseout .= 'this.style.removeProperty(\'background-color\');';
                                    }

                                    if (!empty($postTitleColor)) {
                                        $onmouseout .= ' this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                                    } else {
                                        $onmouseout .= ' this.style.removeProperty(\'color\');';
                                    }

                                    // Opening title tag
                                    $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"'
                                        . (!empty($onmouseover) ? ' onmouseover="' . trim($onmouseover) . '"' : '')
                                        . (!empty($onmouseout)  ? ' onmouseout="'  . trim($onmouseout)  . '"' : '') . '>';

                                    if ($postLinkType === 'yeslink') {
                                        // Anchor styles
                                        $style = '';
                                        $hoverStyle = '';
                                        $mouseoutStyle = '';

                                        if (!empty($postTitleFontSize)) {
                                            $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                                        }

                                        if (!empty($postTitleLineHeight)) {
                                            $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                                        }

                                        if (!empty($postTitleLetterSpacing)) {
                                            $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                                        }

                                        if (!empty($postTitleFontWeight)) {
                                            $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                                        }

                                        if (!empty($postTitleColor)) {
                                            $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                            $mouseoutStyle .= 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                                        } else {
                                            $mouseoutStyle .= 'this.style.color=\'\';';
                                        }

                                        if (!empty($postTitleHoverColor)) {
                                            $hoverStyle .= 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                                        }

                                        if ($showUnderline && !empty($postTitleHoverColor)) {
                                            $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                                            $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                            $hoverStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                                        }

                                        if ($showUnderline && empty($postTitleColor ) && !empty($postTitleColor )) {
                                            $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                                            $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                            $mouseoutStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                                        } else {
                                            
                                            $mouseoutStyle .= ' this.style.removeProperty(\'background-position\');';
                                            $mouseoutStyle .= ' this.style.removeProperty(\'background-size\');';
                                        }

                                        $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '
                                            style="' . esc_attr(trim($style)) . '"'
                                            . (!empty($hoverStyle)   ? ' onmouseover="' . $hoverStyle . '"' : '')
                                            . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                            . esc_html($croppedTitle) . '</a>';
                                    } else {
                                        // No link  render span with inline styles
                                        $inlineStyle = '';
                                        if (!empty($postTitleFontSize)) {
                                            $inlineStyle .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                                        }
                                        if (!empty($postTitleLineHeight)) {
                                            $inlineStyle .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                                        }
                                        if (!empty($postTitleLetterSpacing)) {
                                            $inlineStyle .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                                        }
                                        if (!empty($postTitleFontWeight)) {
                                            $inlineStyle .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                                        }
                                        if (!empty($postTitleColor)) {
                                            $inlineStyle .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                        }

                                        $output .= '<span style="' . esc_attr(trim($inlineStyle)) . '">' . esc_html($croppedTitle) . '</span>';
                                    }

                                    $output .= '</' . esc_attr($titleTag) . '>';
                                }

                                $output .= '</div>';
                                // Add any other post content here (title, meta, etc.)
                            $output .= '</div>'; // blog-item-wrap 
                            $output .= '</div>'; // .fancy-post-item
                            // DO NOT close .col-lg-7 here, it should be closed after the loop ends
                    }

                } else if ($listLayoutStyle === 'style3') {
                    if ($post_count === 1) {
                        $borderStyles = '.fpg-blog-layout-17-item .fpg-content a.fpg-btn.fpg-border::before {';
                    
                        $borderStyles .= 'background: ' . (!empty($buttonHoverTextColor) ? esc_attr($buttonHoverTextColor) : '#332FFF') . ';';
                        
                        $borderStyles .= '}';
                        $output .= '<style>' . $borderStyles . '</style>';
                        // LEFT SIDE - Only the first post
                        $output .= '<div class="col-lg-6" style="';
                            if (!empty($itemGap)) {
                                $halfGap = is_numeric($itemGap) ? ($itemGap / 2) . 'px' : esc_attr($itemGap);
                                $output .= 'padding-left: ' . $halfGap . '; padding-right: ' . $halfGap . '; ';
                            }
                        $output .= '">';
                            $output .= '<div class="fpg-blog-layout-17-item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . ' ' . $postLinkType . '" style="';

                                // MARGIN    
                                if (isset($itemMargin['top']) || isset($itemMargin['right']) || isset($itemMargin['bottom']) || isset($itemMargin['left'])) {
                                    $output .= 'margin: ' .
                                        (isset($itemMargin['top']) ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' .
                                        (isset($itemMargin['right']) ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' .
                                        (isset($itemMargin['bottom']) ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' .
                                        (isset($itemMargin['left']) ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; ';
                                }

                                // PADDING
                                if (isset($itemPadding['top']) || isset($itemPadding['right']) || isset($itemPadding['bottom']) || isset($itemPadding['left'])) {
                                    $output .= 'padding: ' .
                                        (isset($itemPadding['top']) ? (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) : '0px') . ' ' .
                                        (isset($itemPadding['right']) ? (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) : '0px') . ' ' .
                                        (isset($itemPadding['bottom']) ? (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) : '0px') . ' ' .
                                        (isset($itemPadding['left']) ? (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) : '0px') . '; ';
                                }

                                // BORDER RADIUS
                                if (isset($itemBorderRadius['top']) || isset($itemBorderRadius['right']) || isset($itemBorderRadius['bottom']) || isset($itemBorderRadius['left'])) {
                                    $output .= 'border-radius: ' .
                                        (isset($itemBorderRadius['top']) ? (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) : '0px') . ' ' .
                                        (isset($itemBorderRadius['right']) ? (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) : '0px') . ' ' .
                                        (isset($itemBorderRadius['bottom']) ? (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) : '0px') . ' ' .
                                        (isset($itemBorderRadius['left']) ? (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) : '0px') . '; ';
                                }

                                // BORDER WIDTH
                                if (isset($itemBorderWidth['top']) || isset($itemBorderWidth['right']) || isset($itemBorderWidth['bottom']) || isset($itemBorderWidth['left'])) {
                                    $output .= 'border-width: ' .
                                        (isset($itemBorderWidth['top']) ? (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) : '0px') . ' ' .
                                        (isset($itemBorderWidth['right']) ? (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) : '0px') . ' ' .
                                        (isset($itemBorderWidth['bottom']) ? (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) : '0px') . ' ' .
                                        (isset($itemBorderWidth['left']) ? (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) : '0px') . '; ';
                                } 

                                // Border Style & Color
                                if (!empty($itemBorderType)) {
                                    $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                                }
                                if (!empty($itemBorderColor)) {
                                    $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                                }

                                // Background Color
                                if (!empty($itemBackgroundColor)) {
                                    $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                                }

                                // Box Shadow
                                if (
                                    isset($itemBoxShadow['left']) ||  // horizontal offset
                                    isset($itemBoxShadow['top']) ||  // vertical offset
                                    isset($itemBoxShadow['right']) ||  // blur radius
                                    isset($itemBoxShadow['bottom']) ||  // spread radius
                                    isset($itemBoxShadowColor)
                                ) {
                                    $output .= 'box-shadow: ' .
                                        (isset($itemBoxShadow['left']) ? (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) : '0px') . ' ' .
                                        (isset($itemBoxShadow['top']) ? (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) : '0px') . ' ' .
                                        (isset($itemBoxShadow['right']) ? (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) : '0px') . ' ' .
                                        (isset($itemBoxShadow['bottom']) ? (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) : '0px') . ' ' .
                                        (!empty($itemBoxShadowColor) ? esc_attr($itemBoxShadowColor) : 'rgba(0,0,0,0.1)') . '; ';
                                }

                            $output .= '">';

                                // Thumbnail
                                if ($leftThumbnailSize && $showThumbnail) {
                                    $output .= '<div class="fpg-thumb" style="';

                                    // MARGIN
                                    if (
                                        isset($thumbnailMargin['top']) ||
                                        isset($thumbnailMargin['right']) ||
                                        isset($thumbnailMargin['bottom']) ||
                                        isset($thumbnailMargin['left'])
                                    ) {
                                        $output .= 'margin: ' .
                                            (isset($thumbnailMargin['top']) ? (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) : '0px') . ' ' .
                                            (isset($thumbnailMargin['right']) ? (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) : '0px') . ' ' .
                                            (isset($thumbnailMargin['bottom']) ? (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) : '0px') . ' ' .
                                            (isset($thumbnailMargin['left']) ? (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) : '0px') . '; ';
                                    }

                                    // PADDING
                                    if (
                                        isset($thumbnailPadding['top']) ||
                                        isset($thumbnailPadding['right']) ||
                                        isset($thumbnailPadding['bottom']) ||
                                        isset($thumbnailPadding['left'])
                                    ) {
                                        $output .= 'padding: ' .
                                            (isset($thumbnailPadding['top']) ? (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) : '0px') . ' ' .
                                            (isset($thumbnailPadding['right']) ? (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) : '0px') . ' ' .
                                            (isset($thumbnailPadding['bottom']) ? (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) : '0px') . ' ' .
                                            (isset($thumbnailPadding['left']) ? (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) : '0px') . '; ';
                                    }

                                    // BORDER RADIUS
                                    if (
                                        isset($thumbnailBorderRadius['top']) ||
                                        isset($thumbnailBorderRadius['right']) ||
                                        isset($thumbnailBorderRadius['bottom']) ||
                                        isset($thumbnailBorderRadius['left'])
                                    ) {
                                        $output .= 'border-radius: ' .
                                            (isset($thumbnailBorderRadius['top']) ? (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) : '0px') . ' ' .
                                            (isset($thumbnailBorderRadius['right']) ? (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) : '0px') . ' ' .
                                            (isset($thumbnailBorderRadius['bottom']) ? (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) : '0px') . ' ' .
                                            (isset($thumbnailBorderRadius['left']) ? (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) : '0px') . '; ';
                                    }

                                    $output .= '">';

                                    if ($thumbnailLink) {
                                        $output .= '<a href="' . esc_url($permalink) . '"' . $targetAttr . '>';
                                        $output .= $leftThumbnailSize;
                                        $output .= '</a>';
                                    } else {
                                        $output .= $leftThumbnailSize;
                                    }
                                    
                                    $output .= '</div>';
                                }

                                // END Thumbnail
                                // MAIN Content
                                $output .= '<div class="fpg-content" style="';
                                    // MARGIN
                                    if (
                                        isset($contentitemMarginNew['top']) ||
                                        isset($contentitemMarginNew['right']) ||
                                        isset($contentitemMarginNew['bottom']) ||
                                        isset($contentitemMarginNew['left'])
                                    ) {
                                        $output .= 'margin: ' .
                                            (isset($contentitemMarginNew['top']) ? (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) : '0px') . ' ' .
                                            (isset($contentitemMarginNew['right']) ? (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) : '0px') . ' ' .
                                            (isset($contentitemMarginNew['bottom']) ? (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) : '0px') . ' ' .
                                            (isset($contentitemMarginNew['left']) ? (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) : '0px') . '; ';
                                    }

                                    // PADDING
                                    if (
                                        isset($contentitemPaddingNew['top']) ||
                                        isset($contentitemPaddingNew['right']) ||
                                        isset($contentitemPaddingNew['bottom']) ||
                                        isset($contentitemPaddingNew['left'])
                                    ) {
                                        $output .= 'padding: ' .
                                            (isset($contentitemPaddingNew['top']) ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' .
                                            (isset($contentitemPaddingNew['right']) ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' .
                                            (isset($contentitemPaddingNew['bottom']) ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' .
                                            (isset($contentitemPaddingNew['left']) ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; ';
                                    }

                                    // BORDER WIDTH
                                    if (
                                        isset($contentBorderWidth['top']) ||
                                        isset($contentBorderWidth['right']) ||
                                        isset($contentBorderWidth['bottom']) ||
                                        isset($contentBorderWidth['left'])
                                    ) {
                                        $output .= 'border-width: ' .
                                            (isset($contentBorderWidth['top']) ? (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) : '0px') . ' ' .
                                            (isset($contentBorderWidth['right']) ? (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) : '0px') . ' ' .
                                            (isset($contentBorderWidth['bottom']) ? (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) : '0px') . ' ' .
                                            (isset($contentBorderWidth['left']) ? (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) : '0px') . '; ';
                                    }
                                    // BORDER radius
                                    if (
                                        isset($contentitemRadius['top']) ||
                                        isset($contentitemRadius['right']) ||
                                        isset($contentitemRadius['bottom']) ||
                                        isset($contentitemRadius['left'])
                                    ) {
                                        $output .= 'border-radius: ' .
                                            (isset($contentitemRadius['top']) ? (is_numeric($contentitemRadius['top']) ? $contentitemRadius['top'] . 'px' : esc_attr($contentitemRadius['top'])) : '0px') . ' ' .
                                            (isset($contentitemRadius['right']) ? (is_numeric($contentitemRadius['right']) ? $contentitemRadius['right'] . 'px' : esc_attr($contentitemRadius['right'])) : '0px') . ' ' .
                                            (isset($contentitemRadius['bottom']) ? (is_numeric($contentitemRadius['bottom']) ? $contentitemRadius['bottom'] . 'px' : esc_attr($contentitemRadius['bottom'])) : '0px') . ' ' .
                                            (isset($contentitemRadius['left']) ? (is_numeric($contentitemRadius['left']) ? $contentitemRadius['left'] . 'px' : esc_attr($contentitemRadius['left'])) : '0px') . '; ';
                                    }
                                    // Border Style
                                    if (!empty($contentNormalBorderType)) {
                                        $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                                    }
                                    // Background Color
                                    if (!empty($contentBgColor)) {
                                        $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                                    }
                                    // Border Color
                                    if (!empty($contentBorderColor)) {
                                        $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                                    }
                                $output .= '">';

                                // Meta Data
                                if ($showMetaData) {
                                    $output .= '<div class="fpg-meta" style="';  
                                        // Order
                                        if (!empty($metaOrder)) {
                                            $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                                        }
                                    
                                    $output .= '">';      
                                    $output .= '<ul class="blog-meta align-' . $metaAlignment . ' " style="';  
                                        // MARGIN
                                        if (
                                            isset($metaMarginNew['top']) ||
                                            isset($metaMarginNew['right']) ||
                                            isset($metaMarginNew['bottom']) ||
                                            isset($metaMarginNew['left'])
                                        ) {
                                            $output .= 'margin: ' .
                                                (isset($metaMarginNew['top']) ? (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) : '0px') . ' ' .
                                                (isset($metaMarginNew['right']) ? (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) : '0px') . ' ' .
                                                (isset($metaMarginNew['bottom']) ? (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) : '0px') . ' ' .
                                                (isset($metaMarginNew['left']) ? (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) : '0px') . '; ';
                                        }

                                        // PADDING
                                        if (
                                            isset($metaPadding['top']) ||
                                            isset($metaPadding['right']) ||
                                            isset($metaPadding['bottom']) ||
                                            isset($metaPadding['left'])
                                        ) {
                                            $output .= 'padding: ' .
                                                (isset($metaPadding['top']) ? (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) : '0px') . ' ' .
                                                (isset($metaPadding['right']) ? (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) : '0px') . ' ' .
                                                (isset($metaPadding['bottom']) ? (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) : '0px') . ' ' .
                                                (isset($metaPadding['left']) ? (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) : '0px') . '; ';
                                        }   
                                        
                                        // Color
                                        if (!empty($metaTextColor)) {
                                            $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                                        }
                                    $output .= '">';

                                    $meta_items = [];

                                    // Date
                                    if ($showPostDate) {
                                        $meta = '<li class="meta-date" style="';

                                        // Color
                                        if (!empty($metaTextColor)) {
                                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                        }

                                        // Font size
                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '">';

                                        // Icon
                                        if ($showPostDateIcon && $showMetaIcon) {
                                            $meta .= '<i class="fas fa-calendar-alt" style="';

                                            if (!empty($metaIconColor)) {
                                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                            }

                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '"></i> ';
                                        }

                                        $meta .= esc_html($getdate) . '</li>';
                                        $meta_items[] = $meta;
                                    }
                                    // Author
                                    if ($showPostAuthor) {
                                        $meta = '<li class="meta-author" style="';

                                        if (!empty($metaTextColor)) {
                                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '">';

                                        if ($showPostAuthorIcon && $showMetaIcon) {
                                            $meta .= '<i class="fas fa-user" style="';

                                            if (!empty($metaIconColor)) {
                                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                            }

                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '"></i> ';
                                        }

                                        $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                                        $meta_items[] = $meta;
                                    }
                                    // Category
                                    if ($showPostCategory) {
                                        $meta = '<li class="meta-categories" style="';

                                        if (!empty($metaTextColor)) {
                                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '">';

                                        if ($showPostCategoryIcon && $showMetaIcon) {
                                            $meta .= '<i class="fas fa-folder" style="';

                                            if (!empty($metaIconColor)) {
                                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                            }

                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '"></i> ';
                                        }

                                        // Get category names without links
                                        $categories_list = get_the_category($post_id);
                                        if (!empty($categories_list)) {
                                            $category_names = array();
                                            foreach ($categories_list as $category) {
                                                $category_names[] = esc_html($category->name);
                                            }
                                            $meta .= implode(', ', $category_names); // comma-separated plain text categories
                                        }

                                        $meta .= '</li>';
                                        $meta_items[] = $meta;
                                    }
                                    // Tags
                                    if ($showPostTags && !empty($tags)) {
                                        $meta = '<li class="meta-tags" style="';

                                        if (!empty($metaTextColor)) {
                                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '">';

                                        if ($showPostTagsIcon && $showMetaIcon) {
                                            $meta .= '<i class="fas fa-tags" style="';

                                            if (!empty($metaIconColor)) {
                                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                            }

                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '"></i> ';
                                        }

                                        $meta .= esc_html__('Tags:', 'fancy-post-grid') . ' ' . $tags . '</li>';
                                        $meta_items[] = $meta;
                                    }
                                    // Comment Count
                                    if ($showPostCommentsCount) {
                                        $meta = '<li class="meta-comment-count" style="';
                                        if (!empty($metaTextColor)) {
                                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                        }
                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '">';

                                        if ($showPostCommentsCountIcon && $showMetaIcon) {
                                            $meta .= '<i class="fas fa-comments" style="';
                                            if (!empty($metaIconColor)) {
                                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                            }
                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }
                                            $meta .= '"></i> ';
                                        }

                                        $meta .= esc_html($comments_count) . ' ' . esc_html__('Comments', 'fancy-post-grid') . '</li>';
                                        $meta_items[] = $meta;
                                    }

                                    // Now join meta items with the separator
                                    $output .= implode('<span class="meta-separator" style="color:' . esc_attr($metaIconColor) . '; font-size:' . esc_attr($metaFontSize) . 'px;">' . esc_html($metaSeperator) . '</span>', $meta_items);

                                    $output .= '</ul>'; // Close meta-data-list
                                    $output .= '</div>'; // Close meta-data-list
                                    
                                }
                                // End Meta Data

                                // title
                                if ($showPostTitle) {
                                    $titleStyles = '';

                                    // Order
                                    if (!empty($titleOrder)) {
                                        $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                                    }

                                    // Background color
                                    if (!empty($postTitleBgColor)) {
                                        $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                                    }

                                    // Margin
                                    if (isset($postTitleMargin['top']) || isset($postTitleMargin['right']) || isset($postTitleMargin['bottom']) || isset($postTitleMargin['left'])) {
                                        $titleStyles .= 'margin: ' .
                                            (isset($postTitleMargin['top']) ? (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) : '0px') . ' ' .
                                            (isset($postTitleMargin['right']) ? (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) : '0px') . ' ' .
                                            (isset($postTitleMargin['bottom']) ? (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) : '0px') . ' ' .
                                            (isset($postTitleMargin['left']) ? (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) : '0px') . '; ';
                                    }

                                    // Padding
                                    if (isset($postTitlePadding['top']) || isset($postTitlePadding['right']) || isset($postTitlePadding['bottom']) || isset($postTitlePadding['left'])) {
                                        $titleStyles .= 'padding: ' .
                                            (isset($postTitlePadding['top']) ? (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) : '0px') . ' ' .
                                            (isset($postTitlePadding['right']) ? (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) : '0px') . ' ' .
                                            (isset($postTitlePadding['bottom']) ? (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) : '0px') . ' ' .
                                            (isset($postTitlePadding['left']) ? (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) : '0px') . '; ';
                                    }

                                    // Determine if underline should be shown
                                    $showUnderline = $postLinkType === 'yeslink' && $titleHoverUnderLine === 'enable';

                                    // Class name
                                    $classNames = 'blog-title align-' . esc_attr($postTitleAlignment);
                                    if ($showUnderline) {
                                        $classNames .= ' underline';
                                    }

                                    // Hover/Out events for nolink
                                    $onmouseover = '';
                                    $onmouseout  = '';

                                    if (!empty($postTitleHoverBgColor)) {
                                        $onmouseover .= 'this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';';
                                    }

                                    if (!empty($postTitleHoverColor)) {
                                        $onmouseover .= ' this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                                    }

                                    if (!empty($postTitleBgColor)) {
                                        $onmouseout .= 'this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';';
                                    } else {
                                        $onmouseout .= 'this.style.removeProperty(\'background-color\');';
                                    }

                                    if (!empty($postTitleColor)) {
                                        $onmouseout .= ' this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                                    } else {
                                        $onmouseout .= ' this.style.removeProperty(\'color\');';
                                    }

                                    // Opening title tag
                                    $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"'
                                        . (!empty($onmouseover) ? ' onmouseover="' . trim($onmouseover) . '"' : '')
                                        . (!empty($onmouseout)  ? ' onmouseout="'  . trim($onmouseout)  . '"' : '') . '>';

                                    if ($postLinkType === 'yeslink') {
                                        // Anchor styles
                                        $style = '';
                                        $hoverStyle = '';
                                        $mouseoutStyle = '';

                                        if (!empty($postTitleFontSize)) {
                                            $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                                        }

                                        if (!empty($postTitleLineHeight)) {
                                            $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                                        }

                                        if (!empty($postTitleLetterSpacing)) {
                                            $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                                        }

                                        if (!empty($postTitleFontWeight)) {
                                            $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                                        }

                                        if (!empty($postTitleColor)) {
                                            $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                            $mouseoutStyle .= 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                                        } else {
                                            $mouseoutStyle .= 'this.style.color=\'\';';
                                        }

                                        if (!empty($postTitleHoverColor)) {
                                            $hoverStyle .= 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                                        }

                                        if ($showUnderline && !empty($postTitleHoverColor)) {
                                            $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                                            $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                            $hoverStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                                        }

                                        if ($showUnderline && empty($postTitleColor ) && !empty($postTitleColor )) {
                                            $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                                            $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                            $mouseoutStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                                        } else {
                                            
                                            $mouseoutStyle .= ' this.style.removeProperty(\'background-position\');';
                                            $mouseoutStyle .= ' this.style.removeProperty(\'background-size\');';
                                        }

                                        $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '
                                            style="' . esc_attr(trim($style)) . '"'
                                            . (!empty($hoverStyle)   ? ' onmouseover="' . $hoverStyle . '"' : '')
                                            . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                            . esc_html($croppedTitle) . '</a>';
                                    } else {
                                        // No link  render span with inline styles
                                        $inlineStyle = '';
                                        if (!empty($postTitleFontSize)) {
                                            $inlineStyle .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                                        }
                                        if (!empty($postTitleLineHeight)) {
                                            $inlineStyle .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                                        }
                                        if (!empty($postTitleLetterSpacing)) {
                                            $inlineStyle .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                                        }
                                        if (!empty($postTitleFontWeight)) {
                                            $inlineStyle .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                                        }
                                        if (!empty($postTitleColor)) {
                                            $inlineStyle .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                        }

                                        $output .= '<span style="' . esc_attr(trim($inlineStyle)) . '">' . esc_html($croppedTitle) . '</span>';
                                    }

                                    $output .= '</' . esc_attr($titleTag) . '>';
                                }

                                // Button Output                
                                if ($showReadMoreButton) {
                                    // Button wrapper styles
                                    $buttonWrapperStyle = '';

                                    if (
                                        isset($buttonMarginNew['top']) || 
                                        isset($buttonMarginNew['right']) || 
                                        isset($buttonMarginNew['bottom']) || 
                                        isset($buttonMarginNew['left'])
                                    ) {
                                        $buttonWrapperStyle .= 'margin: ' .
                                            (isset($buttonMarginNew['top']) ? (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) : '0px') . ' ' .
                                            (isset($buttonMarginNew['right']) ? (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) : '0px') . ' ' .
                                            (isset($buttonMarginNew['bottom']) ? (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) : '0px') . ' ' .
                                            (isset($buttonMarginNew['left']) ? (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) : '0px') . '; ';
                                    }

                                    // Order
                                    if (!empty($buttonOrder)) {
                                        $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                                    }

                                    $output .= '<div class="fpg-blog-btn align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';

                                    // Button inline styles
                                    $buttonInlineStyles = '';

                                    if (!empty($buttonTextColor)) {
                                        $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                                    }
                                    if (!empty($buttonBackgroundColor)) {
                                        $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                                    }
                                    if (!empty($buttonFontSize)) {
                                        $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                                    }
                                    if (!empty($buttonFontWeight)) {
                                        $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                                    }
                                    if (!empty($buttonBorderColor)) {
                                        $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                                    }
                                    if (!empty($buttonBorderType)) {
                                        $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                                    }

                                    // Border Width
                                    if (
                                        isset($buttonBorderWidth['top']) || 
                                        isset($buttonBorderWidth['right']) || 
                                        isset($buttonBorderWidth['bottom']) || 
                                        isset($buttonBorderWidth['left'])
                                    ) {
                                        $buttonInlineStyles .= 'border-width: ' .
                                            (isset($buttonBorderWidth['top']) ? (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) : '0px') . ' ' .
                                            (isset($buttonBorderWidth['right']) ? (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) : '0px') . ' ' .
                                            (isset($buttonBorderWidth['bottom']) ? (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) : '0px') . ' ' .
                                            (isset($buttonBorderWidth['left']) ? (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) : '0px') . '; ';
                                    }

                                    // Border Radius
                                    if (
                                        isset($buttonBorderRadius['top']) || 
                                        isset($buttonBorderRadius['right']) || 
                                        isset($buttonBorderRadius['bottom']) || 
                                        isset($buttonBorderRadius['left'])
                                    ) {
                                        $buttonInlineStyles .= 'border-radius: ' .
                                            (isset($buttonBorderRadius['top']) ? (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) : '0px') . ' ' .
                                            (isset($buttonBorderRadius['right']) ? (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) : '0px') . ' ' .
                                            (isset($buttonBorderRadius['bottom']) ? (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) : '0px') . ' ' .
                                            (isset($buttonBorderRadius['left']) ? (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) : '0px') . '; ';
                                    }

                                    // Padding
                                    if (
                                        isset($buttonPaddingNew['top']) || 
                                        isset($buttonPaddingNew['right']) || 
                                        isset($buttonPaddingNew['bottom']) || 
                                        isset($buttonPaddingNew['left'])
                                    ) {
                                        $buttonInlineStyles .= 'padding: ' .
                                            (isset($buttonPaddingNew['top']) ? (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) : '0px') . ' ' .
                                            (isset($buttonPaddingNew['right']) ? (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) : '0px') . ' ' .
                                            (isset($buttonPaddingNew['bottom']) ? (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) : '0px') . ' ' .
                                            (isset($buttonPaddingNew['left']) ? (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) : '0px') . '; ';
                                    } 

                                    // Hover styles
                                    $buttonHoverInlineStyles = '';
                                    $buttonResetStyles = '';

                                    if (!empty($buttonHoverTextColor)) {
                                        $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                                        $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                                    }
                                    if (!empty($buttonHoverBorderColor)) {
                                        $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                                        $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                                    }
                                    if (!empty($buttonHoverBackgroundColor)) {
                                        $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                                        $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                                    }

                                    // Button anchor tag
                                    $output .= '<a class="fpg-btn read-more ' . esc_attr($buttonStyle3) . '" href="' . esc_url(get_permalink()) . '" ' . $targetAttr . ' style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                                    if (!empty($buttonHoverInlineStyles)) {
                                        $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                                    }

                                    if (!empty($buttonResetStyles)) {
                                        $output .= ' onmouseout="' . $buttonResetStyles . '"';
                                    }

                                    $output .= '>';

                                    // Icon handling
                                    $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                                    $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                                    $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                                    if ($iconPosition === 'left' && $showButtonIcon) {
                                        $output .= $leftIcon . ' ';
                                    }

                                    $output .= esc_html($readMoreLabel);

                                    if ($iconPosition === 'right' && $showButtonIcon) {
                                        $output .= ' ' . $rightIcon;
                                    }

                                    $output .= '</a></div>';
                                }
                                // End Button

                                $output .= '</div>';
                                // Add any other post content here (title, meta, etc.)
                            $output .= '</div>'; // .fancy-post-item
                        $output .= '</div>'; // .col-lg-6

                        // START RIGHT SIDE WRAPPER for remaining posts
                        $output .= '<div class="col-lg-6" style="';
                        if (!empty($itemGap)) {
                            $halfGap = is_numeric($itemGap) ? ($itemGap / 2) . 'px' : esc_attr($itemGap);
                            $output .= 'padding-left: ' . $halfGap . '; padding-right: ' . $halfGap . '; ';
                        }
                        $output .= '">';
                        
                    } else {

                        // RIGHT SIDE - All other posts
                        $output .= '<div class="fpg-blog-layout-17-item fpg-blog-layout-17-item-list align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '' . $postLinkType . '" style="';
                            // MARGIN    
                            if (isset($itemMargin['top']) || isset($itemMargin['right']) || isset($itemMargin['bottom']) || isset($itemMargin['left'])) {
                                $output .= 'margin: ' .
                                    (isset($itemMargin['top']) ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' .
                                    (isset($itemMargin['right']) ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' .
                                    (isset($itemMargin['bottom']) ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' .
                                    (isset($itemMargin['left']) ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; ';
                            }

                            // PADDING
                            if (isset($itemPadding['top']) || isset($itemPadding['right']) || isset($itemPadding['bottom']) || isset($itemPadding['left'])) {
                                $output .= 'padding: ' .
                                    (isset($itemPadding['top']) ? (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) : '0px') . ' ' .
                                    (isset($itemPadding['right']) ? (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) : '0px') . ' ' .
                                    (isset($itemPadding['bottom']) ? (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) : '0px') . ' ' .
                                    (isset($itemPadding['left']) ? (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) : '0px') . '; ';
                            }

                            // BORDER RADIUS
                            if (isset($itemBorderRadius['top']) || isset($itemBorderRadius['right']) || isset($itemBorderRadius['bottom']) || isset($itemBorderRadius['left'])) {
                                $output .= 'border-radius: ' .
                                    (isset($itemBorderRadius['top']) ? (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) : '0px') . ' ' .
                                    (isset($itemBorderRadius['right']) ? (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) : '0px') . ' ' .
                                    (isset($itemBorderRadius['bottom']) ? (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) : '0px') . ' ' .
                                    (isset($itemBorderRadius['left']) ? (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) : '0px') . '; ';
                            }

                            // BORDER WIDTH
                            if (isset($itemBorderWidth['top']) || isset($itemBorderWidth['right']) || isset($itemBorderWidth['bottom']) || isset($itemBorderWidth['left'])) {
                                $output .= 'border-width: ' .
                                    (isset($itemBorderWidth['top']) ? (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) : '0px') . ' ' .
                                    (isset($itemBorderWidth['right']) ? (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) : '0px') . ' ' .
                                    (isset($itemBorderWidth['bottom']) ? (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) : '0px') . ' ' .
                                    (isset($itemBorderWidth['left']) ? (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) : '0px') . '; ';
                            }
                            // Border Style & Color
                            if (!empty($itemBorderType)) {
                                $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                            }
                            if (!empty($itemBorderColor)) {
                                $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                            }

                            // Background Color
                            if (!empty($itemBackgroundColor)) {
                                $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                            }

                            // Box Shadow
                            if (
                                isset($itemBoxShadow['left']) ||  // horizontal offset
                                isset($itemBoxShadow['top']) ||  // vertical offset
                                isset($itemBoxShadow['right']) ||  // blur radius
                                isset($itemBoxShadow['bottom']) ||  // spread radius
                                isset($itemBoxShadowColor)
                            ) {
                                $output .= 'box-shadow: ' .
                                    (isset($itemBoxShadow['left']) ? (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) : '0px') . ' ' .
                                    (isset($itemBoxShadow['top']) ? (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) : '0px') . ' ' .
                                    (isset($itemBoxShadow['right']) ? (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) : '0px') . ' ' .
                                    (isset($itemBoxShadow['bottom']) ? (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) : '0px') . ' ' .
                                    (!empty($itemBoxShadowColor) ? esc_attr($itemBoxShadowColor) : 'rgba(0,0,0,0.1)') . '; ';
                            }

                        $output .= '">';
                                
                                // Thumbnail
                                if ($rightThumbnailSize && $showThumbnail) {
                                    $output .= '<div class="fpg-thumb" style="';

                                    // MARGIN
                                    if (
                                        isset($thumbnailMargin['top']) ||
                                        isset($thumbnailMargin['right']) ||
                                        isset($thumbnailMargin['bottom']) ||
                                        isset($thumbnailMargin['left'])
                                    ) {
                                        $output .= 'margin: ' .
                                            (isset($thumbnailMargin['top']) ? (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) : '0px') . ' ' .
                                            (isset($thumbnailMargin['right']) ? (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) : '0px') . ' ' .
                                            (isset($thumbnailMargin['bottom']) ? (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) : '0px') . ' ' .
                                            (isset($thumbnailMargin['left']) ? (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) : '0px') . '; ';
                                    }

                                    // PADDING
                                    if (
                                        isset($thumbnailPadding['top']) ||
                                        isset($thumbnailPadding['right']) ||
                                        isset($thumbnailPadding['bottom']) ||
                                        isset($thumbnailPadding['left'])
                                    ) {
                                        $output .= 'padding: ' .
                                            (isset($thumbnailPadding['top']) ? (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) : '0px') . ' ' .
                                            (isset($thumbnailPadding['right']) ? (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) : '0px') . ' ' .
                                            (isset($thumbnailPadding['bottom']) ? (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) : '0px') . ' ' .
                                            (isset($thumbnailPadding['left']) ? (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) : '0px') . '; ';
                                    }

                                    // BORDER RADIUS
                                    if (
                                        isset($thumbnailBorderRadius['top']) ||
                                        isset($thumbnailBorderRadius['right']) ||
                                        isset($thumbnailBorderRadius['bottom']) ||
                                        isset($thumbnailBorderRadius['left'])
                                    ) {
                                        $output .= 'border-radius: ' .
                                            (isset($thumbnailBorderRadius['top']) ? (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) : '0px') . ' ' .
                                            (isset($thumbnailBorderRadius['right']) ? (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) : '0px') . ' ' .
                                            (isset($thumbnailBorderRadius['bottom']) ? (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) : '0px') . ' ' .
                                            (isset($thumbnailBorderRadius['left']) ? (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) : '0px') . '; ';
                                    }

                                    $output .= '">';

                                    // Anchor with optional border-radius and overflow
                                    if ($thumbnailLink) {
                                        $output .= '<a href="' . esc_url($permalink) . '"' . $targetAttr . '>';
                                        $output .= $rightThumbnailSize;
                                        $output .= '</a>';
                                    } else {
                                        $output .= $rightThumbnailSize;
                                    }
                                    
                                    $output .= '</div>';
                                }
                                // END Thumbnail

                                // MAIN Content
                                $output .= '<div class="fpg-content" style="';
                                    // MARGIN
                                    if (
                                        isset($contentitemMarginNew['top']) ||
                                        isset($contentitemMarginNew['right']) ||
                                        isset($contentitemMarginNew['bottom']) ||
                                        isset($contentitemMarginNew['left'])
                                    ) {
                                        $output .= 'margin: ' .
                                            (isset($contentitemMarginNew['top']) ? (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) : '0px') . ' ' .
                                            (isset($contentitemMarginNew['right']) ? (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) : '0px') . ' ' .
                                            (isset($contentitemMarginNew['bottom']) ? (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) : '0px') . ' ' .
                                            (isset($contentitemMarginNew['left']) ? (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) : '0px') . '; ';
                                    }

                                    // PADDING
                                    if (
                                        isset($contentitemPaddingNew['top']) ||
                                        isset($contentitemPaddingNew['right']) ||
                                        isset($contentitemPaddingNew['bottom']) ||
                                        isset($contentitemPaddingNew['left'])
                                    ) {
                                        $output .= 'padding: ' .
                                            (isset($contentitemPaddingNew['top']) ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' .
                                            (isset($contentitemPaddingNew['right']) ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' .
                                            (isset($contentitemPaddingNew['bottom']) ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' .
                                            (isset($contentitemPaddingNew['left']) ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; ';
                                    }

                                    // BORDER WIDTH
                                    if (
                                        isset($contentBorderWidth['top']) ||
                                        isset($contentBorderWidth['right']) ||
                                        isset($contentBorderWidth['bottom']) ||
                                        isset($contentBorderWidth['left'])
                                    ) {
                                        $output .= 'border-width: ' .
                                            (isset($contentBorderWidth['top']) ? (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) : '0px') . ' ' .
                                            (isset($contentBorderWidth['right']) ? (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) : '0px') . ' ' .
                                            (isset($contentBorderWidth['bottom']) ? (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) : '0px') . ' ' .
                                            (isset($contentBorderWidth['left']) ? (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) : '0px') . '; ';
                                    }
                                    // BORDER radius
                                    if (
                                        isset($contentitemRadius['top']) ||
                                        isset($contentitemRadius['right']) ||
                                        isset($contentitemRadius['bottom']) ||
                                        isset($contentitemRadius['left'])
                                    ) {
                                        $output .= 'border-radius: ' .
                                            (isset($contentitemRadius['top']) ? (is_numeric($contentitemRadius['top']) ? $contentitemRadius['top'] . 'px' : esc_attr($contentitemRadius['top'])) : '0px') . ' ' .
                                            (isset($contentitemRadius['right']) ? (is_numeric($contentitemRadius['right']) ? $contentitemRadius['right'] . 'px' : esc_attr($contentitemRadius['right'])) : '0px') . ' ' .
                                            (isset($contentitemRadius['bottom']) ? (is_numeric($contentitemRadius['bottom']) ? $contentitemRadius['bottom'] . 'px' : esc_attr($contentitemRadius['bottom'])) : '0px') . ' ' .
                                            (isset($contentitemRadius['left']) ? (is_numeric($contentitemRadius['left']) ? $contentitemRadius['left'] . 'px' : esc_attr($contentitemRadius['left'])) : '0px') . '; ';
                                    }
                                    // Border Style
                                    if (!empty($contentNormalBorderType)) {
                                        $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                                    }
                                    // Background Color
                                    if (!empty($contentBgColor)) {
                                        $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                                    }
                                    // Border Color
                                    if (!empty($contentBorderColor)) {
                                        $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                                    }
                                $output .= '">';

                                // Meta Data
                                if ($showMetaData) {
                                    $output .= '<div class="fpg-meta" " style="';    
                                        // Order
                                        if (!empty($metaOrder)) {
                                            $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                                        } 
                                    
                                    $output .= '">';   
                                    $output .= '<ul class="blog-meta align-' . $metaAlignment . ' " style="';  
                                        // MARGIN
                                        if (
                                            isset($metaMarginNew['top']) ||
                                            isset($metaMarginNew['right']) ||
                                            isset($metaMarginNew['bottom']) ||
                                            isset($metaMarginNew['left'])
                                        ) {
                                            $output .= 'margin: ' .
                                                (isset($metaMarginNew['top']) ? (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) : '0px') . ' ' .
                                                (isset($metaMarginNew['right']) ? (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) : '0px') . ' ' .
                                                (isset($metaMarginNew['bottom']) ? (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) : '0px') . ' ' .
                                                (isset($metaMarginNew['left']) ? (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) : '0px') . '; ';
                                        }

                                        // PADDING
                                        if (
                                            isset($metaPadding['top']) ||
                                            isset($metaPadding['right']) ||
                                            isset($metaPadding['bottom']) ||
                                            isset($metaPadding['left'])
                                        ) {
                                            $output .= 'padding: ' .
                                                (isset($metaPadding['top']) ? (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) : '0px') . ' ' .
                                                (isset($metaPadding['right']) ? (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) : '0px') . ' ' .
                                                (isset($metaPadding['bottom']) ? (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) : '0px') . ' ' .
                                                (isset($metaPadding['left']) ? (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) : '0px') . '; ';
                                        }  
                                        
                                        // Color
                                        if (!empty($metaTextColor)) {
                                            $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                                        }
                                    $output .= '">';

                                    $meta_items = [];

                                    // Date
                                    if ($showPostDate) {
                                        $meta = '<li class="meta-date" style="';

                                        // Color
                                        if (!empty($metaTextColor)) {
                                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                        }

                                        // Font size
                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '">';

                                        // Icon
                                        if ($showPostDateIcon && $showMetaIcon) {
                                            $meta .= '<i class="fas fa-calendar-alt" style="';

                                            if (!empty($metaIconColor)) {
                                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                            }

                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '"></i> ';
                                        }

                                        $meta .= esc_html($getdate) . '</li>';
                                        $meta_items[] = $meta;
                                    }
                                    // Author
                                    if ($showPostAuthor) {
                                        $meta = '<li class="meta-author" style="';

                                        if (!empty($metaTextColor)) {
                                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '">';

                                        if ($showPostAuthorIcon && $showMetaIcon) {
                                            $meta .= '<i class="fas fa-user" style="';

                                            if (!empty($metaIconColor)) {
                                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                            }

                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '"></i> ';
                                        }

                                        $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                                        $meta_items[] = $meta;
                                    }
                                    // Now join meta items with the separator
                                    $output .= implode('<span class="meta-separator" style="color:' . esc_attr($metaIconColor) . '; font-size:' . esc_attr($metaFontSize) . 'px;">' . esc_html($metaSeperator) . '</span>', $meta_items);

                                    $output .= '</ul>'; // Close meta-data-list
                                    $output .= '</div>'; // Close meta-data-list
                                    
                                }
                                // End Meta Data

                                // title
                                if ($showPostTitle) {
                                    $titleStyles = '';

                                    // Order
                                    if (!empty($titleOrder)) {
                                        $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                                    }

                                    // Background color
                                    if (!empty($postTitleBgColor)) {
                                        $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                                    }

                                    // Margin
                                    if (isset($postTitleMargin['top']) || isset($postTitleMargin['right']) || isset($postTitleMargin['bottom']) || isset($postTitleMargin['left'])) {
                                        $titleStyles .= 'margin: ' .
                                            (isset($postTitleMargin['top']) ? (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) : '0px') . ' ' .
                                            (isset($postTitleMargin['right']) ? (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) : '0px') . ' ' .
                                            (isset($postTitleMargin['bottom']) ? (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) : '0px') . ' ' .
                                            (isset($postTitleMargin['left']) ? (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) : '0px') . '; ';
                                    }

                                    // Padding
                                    if (isset($postTitlePadding['top']) || isset($postTitlePadding['right']) || isset($postTitlePadding['bottom']) || isset($postTitlePadding['left'])) {
                                        $titleStyles .= 'padding: ' .
                                            (isset($postTitlePadding['top']) ? (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) : '0px') . ' ' .
                                            (isset($postTitlePadding['right']) ? (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) : '0px') . ' ' .
                                            (isset($postTitlePadding['bottom']) ? (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) : '0px') . ' ' .
                                            (isset($postTitlePadding['left']) ? (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) : '0px') . '; ';
                                    }

                                    // Determine if underline should be shown
                                    $showUnderline = $postLinkType === 'yeslink' && $titleHoverUnderLine === 'enable';

                                    // Class name
                                    $classNames = 'title align-' . esc_attr($postTitleAlignment);
                                    if ($showUnderline) {
                                        $classNames .= ' underline';
                                    }

                                    // Hover/Out events for nolink
                                    $onmouseover = '';
                                    $onmouseout  = '';

                                    if (!empty($postTitleHoverBgColor)) {
                                        $onmouseover .= 'this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';';
                                    }

                                    if (!empty($postTitleHoverColor)) {
                                        $onmouseover .= ' this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                                    }

                                    if (!empty($postTitleBgColor)) {
                                        $onmouseout .= 'this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';';
                                    } else {
                                        $onmouseout .= 'this.style.removeProperty(\'background-color\');';
                                    }

                                    if (!empty($postTitleColor)) {
                                        $onmouseout .= ' this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                                    } else {
                                        $onmouseout .= ' this.style.removeProperty(\'color\');';
                                    }

                                    // Opening title tag
                                    $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"'
                                        . (!empty($onmouseover) ? ' onmouseover="' . trim($onmouseover) . '"' : '')
                                        . (!empty($onmouseout)  ? ' onmouseout="'  . trim($onmouseout)  . '"' : '') . '>';

                                    if ($postLinkType === 'yeslink') {
                                        // Anchor styles
                                        $style = '';
                                        $hoverStyle = '';
                                        $mouseoutStyle = '';

                                        if (!empty($postTitleFontSize)) {
                                            $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                                        }

                                        if (!empty($postTitleLineHeight)) {
                                            $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                                        }

                                        if (!empty($postTitleLetterSpacing)) {
                                            $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                                        }

                                        if (!empty($postTitleFontWeight)) {
                                            $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                                        }

                                        if (!empty($postTitleColor)) {
                                            $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                            $mouseoutStyle .= 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                                        } else {
                                            $mouseoutStyle .= 'this.style.color=\'\';';
                                        }

                                        if (!empty($postTitleHoverColor)) {
                                            $hoverStyle .= 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                                        }

                                        if ($showUnderline && !empty($postTitleHoverColor)) {
                                            $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                                            $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                            $hoverStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                                        }

                                        if ($showUnderline && empty($postTitleColor ) && !empty($postTitleColor )) {
                                            $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                                            $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                            $mouseoutStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                                        } else {
                                            
                                            $mouseoutStyle .= ' this.style.removeProperty(\'background-position\');';
                                            $mouseoutStyle .= ' this.style.removeProperty(\'background-size\');';
                                        }

                                        $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '
                                            style="' . esc_attr(trim($style)) . '"'
                                            . (!empty($hoverStyle)   ? ' onmouseover="' . $hoverStyle . '"' : '')
                                            . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                            . esc_html($croppedTitle) . '</a>';
                                    } else {
                                        // No link  render span with inline styles
                                        $inlineStyle = '';
                                        if (!empty($postTitleFontSize)) {
                                            $inlineStyle .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                                        }
                                        if (!empty($postTitleLineHeight)) {
                                            $inlineStyle .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                                        }
                                        if (!empty($postTitleLetterSpacing)) {
                                            $inlineStyle .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                                        }
                                        if (!empty($postTitleFontWeight)) {
                                            $inlineStyle .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                                        }
                                        if (!empty($postTitleColor)) {
                                            $inlineStyle .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                        }

                                        $output .= '<span style="' . esc_attr(trim($inlineStyle)) . '">' . esc_html($croppedTitle) . '</span>';
                                    }

                                    $output .= '</' . esc_attr($titleTag) . '>';
                                }

                                // Excerpt
                                if ($showPostExcerpt) {
                                    $excerptStyles = '';

                                    // Order
                                    if (!empty($excerptOrder)) {
                                        $excerptStyles .= 'order: ' . esc_attr($excerptOrder) . '; ';
                                    }

                                    // Typography
                                    if (!empty($excerptFontSize)) {
                                        $excerptStyles .= 'font-size: ' . esc_attr($excerptFontSize) . 'px; ';
                                    }

                                    if (!empty($excerptLineHeight)) {
                                        $excerptStyles .= 'line-height: ' . esc_attr($excerptLineHeight) . '; ';
                                    }

                                    if (!empty($excerptLetterSpacing)) {
                                        $excerptStyles .= 'letter-spacing: ' . esc_attr($excerptLetterSpacing) . 'px; ';
                                    }

                                    if (!empty($excerptFontWeight)) {
                                        $excerptStyles .= 'font-weight: ' . esc_attr($excerptFontWeight) . '; ';
                                    }

                                    if (!empty($excerptColor)) {
                                        $excerptStyles .= 'color: ' . esc_attr($excerptColor) . '; ';
                                    }

                                    if (!empty($excerptBgColor)) {
                                        $excerptStyles .= 'background-color: ' . esc_attr($excerptBgColor) . '; ';
                                    }

                                    if (!empty($excerptBorderType)) {
                                        $excerptStyles .= 'border-style: ' . esc_attr($excerptBorderType) . '; ';
                                    }

                                    // Margin
                                    if (isset($excerptMargin['top']) || isset($excerptMargin['right']) || isset($excerptMargin['bottom']) || isset($excerptMargin['left'])) {
                                        $excerptStyles .= 'margin: ' .
                                            (isset($excerptMargin['top']) ? (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) : '0px') . ' ' .
                                            (isset($excerptMargin['right']) ? (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) : '0px') . ' ' .
                                            (isset($excerptMargin['bottom']) ? (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) : '0px') . ' ' .
                                            (isset($excerptMargin['left']) ? (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) : '0px') . '; ';
                                    }

                                    // Padding
                                    if (isset($excerptPadding['top']) || isset($excerptPadding['right']) || isset($excerptPadding['bottom']) || isset($excerptPadding['left'])) {
                                        $excerptStyles .= 'padding: ' .
                                            (isset($excerptPadding['top']) ? (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) : '0px') . ' ' .
                                            (isset($excerptPadding['right']) ? (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) : '0px') . ' ' .
                                            (isset($excerptPadding['bottom']) ? (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) : '0px') . ' ' .
                                            (isset($excerptPadding['left']) ? (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) : '0px') . '; ';
                                    }

                                    // Handle hover logic conditionally
                                    $hoverIn = '';
                                    $hoverOut = '';

                                    if (!empty($excerptHoverColor)) {
                                        $hoverIn .= 'this.style.color=\'' . esc_attr($excerptHoverColor) . '\';';
                                        $hoverOut .= 'this.style.color=\'' . esc_attr($excerptColor) . '\';';
                                    }

                                    if (!empty($excerptHoverBgColor)) {
                                        $hoverIn .= 'this.style.backgroundColor=\'' . esc_attr($excerptHoverBgColor) . '\';';
                                        $hoverOut .= 'this.style.backgroundColor=\'' . esc_attr($excerptBgColor) . '\';';
                                    }

                                    $output .= '<div class="fpg-excerpt' . ' align-' . esc_attr($excerptAlignment) . '" style="' . esc_attr(trim($excerptStyles)) . '"';

                                    if (!empty($hoverIn) || !empty($hoverOut)) {
                                        $output .= ' onmouseover="' . esc_attr($hoverIn) . '"';
                                        $output .= ' onmouseout="' . esc_attr($hoverOut) . '"';
                                    }

                                    $output .= '>';
                                    $output .= '<p>' . esc_html($excerpt) . '</p>';
                                    $output .= '</div>';
                                }
                                // End Excerpt

                                // Button Output                
                                if ($showReadMoreButton) {
                                    // Button wrapper styles
                                    $buttonWrapperStyle = '';

                                    if (
                                        isset($buttonMarginNew['top']) || 
                                        isset($buttonMarginNew['right']) || 
                                        isset($buttonMarginNew['bottom']) || 
                                        isset($buttonMarginNew['left'])
                                    ) {
                                        $buttonWrapperStyle .= 'margin: ' .
                                            (isset($buttonMarginNew['top']) ? (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) : '0px') . ' ' .
                                            (isset($buttonMarginNew['right']) ? (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) : '0px') . ' ' .
                                            (isset($buttonMarginNew['bottom']) ? (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) : '0px') . ' ' .
                                            (isset($buttonMarginNew['left']) ? (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) : '0px') . '; ';
                                    }

                                    // Order
                                    if (!empty($buttonOrder)) {
                                        $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                                    }
                                   
                                    $output .= '<div class="fpg-blog-btn align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';

                                    // Button inline styles
                                    $buttonInlineStyles = '';

                                    if (!empty($buttonTextColor)) {
                                        $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                                    }
                                    if (!empty($buttonBackgroundColor)) {
                                        $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                                    }
                                    if (!empty($buttonFontSize)) {
                                        $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                                    }
                                    if (!empty($buttonFontWeight)) {
                                        $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                                    }
                                    if (!empty($buttonBorderColor)) {
                                        $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                                    }
                                    if (!empty($buttonBorderType)) {
                                        $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                                    }

                                    // Border Width
                                    if (
                                        isset($buttonBorderWidth['top']) || 
                                        isset($buttonBorderWidth['right']) || 
                                        isset($buttonBorderWidth['bottom']) || 
                                        isset($buttonBorderWidth['left'])
                                    ) {
                                        $buttonInlineStyles .= 'border-width: ' .
                                            (isset($buttonBorderWidth['top']) ? (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) : '0px') . ' ' .
                                            (isset($buttonBorderWidth['right']) ? (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) : '0px') . ' ' .
                                            (isset($buttonBorderWidth['bottom']) ? (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) : '0px') . ' ' .
                                            (isset($buttonBorderWidth['left']) ? (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) : '0px') . '; ';
                                    }

                                    // Border Radius
                                    if (
                                        isset($buttonBorderRadius['top']) || 
                                        isset($buttonBorderRadius['right']) || 
                                        isset($buttonBorderRadius['bottom']) || 
                                        isset($buttonBorderRadius['left'])
                                    ) {
                                        $buttonInlineStyles .= 'border-radius: ' .
                                            (isset($buttonBorderRadius['top']) ? (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) : '0px') . ' ' .
                                            (isset($buttonBorderRadius['right']) ? (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) : '0px') . ' ' .
                                            (isset($buttonBorderRadius['bottom']) ? (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) : '0px') . ' ' .
                                            (isset($buttonBorderRadius['left']) ? (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) : '0px') . '; ';
                                    }

                                    // Padding
                                    if (
                                        isset($buttonPaddingNew['top']) || 
                                        isset($buttonPaddingNew['right']) || 
                                        isset($buttonPaddingNew['bottom']) || 
                                        isset($buttonPaddingNew['left'])
                                    ) {
                                        $buttonInlineStyles .= 'padding: ' .
                                            (isset($buttonPaddingNew['top']) ? (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) : '0px') . ' ' .
                                            (isset($buttonPaddingNew['right']) ? (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) : '0px') . ' ' .
                                            (isset($buttonPaddingNew['bottom']) ? (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) : '0px') . ' ' .
                                            (isset($buttonPaddingNew['left']) ? (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) : '0px') . '; ';
                                    } 

                                    // Hover styles
                                    $buttonHoverInlineStyles = '';
                                    $buttonResetStyles = '';

                                    if (!empty($buttonHoverTextColor)) {
                                        $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                                        $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                                    }
                                    if (!empty($buttonHoverBorderColor)) {
                                        $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                                        $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                                    }
                                    if (!empty($buttonHoverBackgroundColor)) {
                                        $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                                        $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                                    }

                                    // Button anchor tag
                                    $output .= '<a class="fpg-btn read-more ' . esc_attr($buttonStyle3) . '" href="' . esc_url(get_permalink()) . '" ' . $targetAttr . ' style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                                    if (!empty($buttonHoverInlineStyles)) {
                                        $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                                    }

                                    if (!empty($buttonResetStyles)) {
                                        $output .= ' onmouseout="' . $buttonResetStyles . '"';
                                    }

                                    $output .= '>';

                                    // Icon handling
                                    $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                                    $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                                    $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                                    if ($iconPosition === 'left' && $showButtonIcon) {
                                        $output .= $leftIcon . ' ';
                                    }

                                    $output .= esc_html($readMoreLabel);

                                    if ($iconPosition === 'right' && $showButtonIcon) {
                                        $output .= ' ' . $rightIcon;
                                    }

                                    $output .= '</a></div>';
                                }
                                // End Button

                                // Add any other post content here (title, meta, etc.)
                            $output .= '</div>'; // blog-item-wrap 
                            $output .= '</div>'; // .fancy-post-item
                            
                            
                        // DO NOT close .col-lg-7 here, it should be closed after the loop ends
                    }
                } else if ($listLayoutStyle === 'style1') {
                    if ($post_count === 1) {
                        $borderStyles = '.fpg-blog-layout-8 .fpg-blog__content .btn-wrapper .fpg-link.fpg-border::before {';
                    
                        $borderStyles .= 'background: ' . (!empty($buttonHoverTextColor) ? esc_attr($buttonHoverTextColor) : '#332FFF') . ';';
                        
                        $borderStyles .= '}';
                        $output .= '<style>' . $borderStyles . '</style>';
                        // LEFT SIDE - Only the first post
                        $output .= '<div class="col-lg-5" style="';
                                    if (!empty($itemGap)) {
                                        $halfGap = is_numeric($itemGap) ? ($itemGap / 2) . 'px' : esc_attr($itemGap);
                                        $output .= 'padding-left: ' . $halfGap . '; padding-right: ' . $halfGap . '; ';
                                    }
                                    $output .= '">';
                            $output .= '<div class="fpg-blog__left-blog align-' . $itemBoxAlignment . ' ' . $hoverAnimation . ' ' . $postLinkType . '" style="';
                                // MARGIN    
                                if (isset($itemMargin['top']) || isset($itemMargin['right']) || isset($itemMargin['bottom']) || isset($itemMargin['left'])) {
                                    $output .= 'margin: ' .
                                        (isset($itemMargin['top']) ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' .
                                        (isset($itemMargin['right']) ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' .
                                        (isset($itemMargin['bottom']) ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' .
                                        (isset($itemMargin['left']) ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; ';
                                }

                                // PADDING
                                if (isset($itemPadding['top']) || isset($itemPadding['right']) || isset($itemPadding['bottom']) || isset($itemPadding['left'])) {
                                    $output .= 'padding: ' .
                                        (isset($itemPadding['top']) ? (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) : '0px') . ' ' .
                                        (isset($itemPadding['right']) ? (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) : '0px') . ' ' .
                                        (isset($itemPadding['bottom']) ? (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) : '0px') . ' ' .
                                        (isset($itemPadding['left']) ? (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) : '0px') . '; ';
                                }

                                // BORDER RADIUS
                                if (isset($itemBorderRadius['top']) || isset($itemBorderRadius['right']) || isset($itemBorderRadius['bottom']) || isset($itemBorderRadius['left'])) {
                                    $output .= 'border-radius: ' .
                                        (isset($itemBorderRadius['top']) ? (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) : '0px') . ' ' .
                                        (isset($itemBorderRadius['right']) ? (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) : '0px') . ' ' .
                                        (isset($itemBorderRadius['bottom']) ? (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) : '0px') . ' ' .
                                        (isset($itemBorderRadius['left']) ? (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) : '0px') . '; ';
                                }

                                // BORDER WIDTH
                                if (isset($itemBorderWidth['top']) || isset($itemBorderWidth['right']) || isset($itemBorderWidth['bottom']) || isset($itemBorderWidth['left'])) {
                                    $output .= 'border-width: ' .
                                        (isset($itemBorderWidth['top']) ? (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) : '0px') . ' ' .
                                        (isset($itemBorderWidth['right']) ? (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) : '0px') . ' ' .
                                        (isset($itemBorderWidth['bottom']) ? (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) : '0px') . ' ' .
                                        (isset($itemBorderWidth['left']) ? (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) : '0px') . '; ';
                                }

                                // Border Style & Color
                                if (!empty($itemBorderType)) {
                                    $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                                }
                                if (!empty($itemBorderColor)) {
                                    $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                                }

                                // Background Color
                                if (!empty($itemBackgroundColor)) {
                                    $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                                }

                                // Box Shadow
                                if (
                                    isset($itemBoxShadow['left']) ||  // horizontal offset
                                    isset($itemBoxShadow['top']) ||  // vertical offset
                                    isset($itemBoxShadow['right']) ||  // blur radius
                                    isset($itemBoxShadow['bottom']) ||  // spread radius
                                    isset($itemBoxShadowColor)
                                ) {
                                    $output .= 'box-shadow: ' .
                                        (isset($itemBoxShadow['left']) ? (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) : '0px') . ' ' .
                                        (isset($itemBoxShadow['top']) ? (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) : '0px') . ' ' .
                                        (isset($itemBoxShadow['right']) ? (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) : '0px') . ' ' .
                                        (isset($itemBoxShadow['bottom']) ? (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) : '0px') . ' ' .
                                        (!empty($itemBoxShadowColor) ? esc_attr($itemBoxShadowColor) : 'rgba(0,0,0,0.1)') . '; ';
                                }

                            $output .= '">';

                                // Thumbnail
                                if ($leftThumbnailSize && $showThumbnail) {
                                    $output .= '<div class="fpg-blog__thumb" style="';

                                    // MARGIN
                                    if (
                                        isset($thumbnailMargin['top']) ||
                                        isset($thumbnailMargin['right']) ||
                                        isset($thumbnailMargin['bottom']) ||
                                        isset($thumbnailMargin['left'])
                                    ) {
                                        $output .= 'margin: ' .
                                            (isset($thumbnailMargin['top']) ? (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) : '0px') . ' ' .
                                            (isset($thumbnailMargin['right']) ? (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) : '0px') . ' ' .
                                            (isset($thumbnailMargin['bottom']) ? (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) : '0px') . ' ' .
                                            (isset($thumbnailMargin['left']) ? (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) : '0px') . '; ';
                                    }

                                    // PADDING
                                    if (
                                        isset($thumbnailPadding['top']) ||
                                        isset($thumbnailPadding['right']) ||
                                        isset($thumbnailPadding['bottom']) ||
                                        isset($thumbnailPadding['left'])
                                    ) {
                                        $output .= 'padding: ' .
                                            (isset($thumbnailPadding['top']) ? (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) : '0px') . ' ' .
                                            (isset($thumbnailPadding['right']) ? (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) : '0px') . ' ' .
                                            (isset($thumbnailPadding['bottom']) ? (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) : '0px') . ' ' .
                                            (isset($thumbnailPadding['left']) ? (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) : '0px') . '; ';
                                    }

                                    // BORDER RADIUS
                                    if (
                                        isset($thumbnailBorderRadius['top']) ||
                                        isset($thumbnailBorderRadius['right']) ||
                                        isset($thumbnailBorderRadius['bottom']) ||
                                        isset($thumbnailBorderRadius['left'])
                                    ) {
                                        $output .= 'border-radius: ' .
                                            (isset($thumbnailBorderRadius['top']) ? (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) : '0px') . ' ' .
                                            (isset($thumbnailBorderRadius['right']) ? (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) : '0px') . ' ' .
                                            (isset($thumbnailBorderRadius['bottom']) ? (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) : '0px') . ' ' .
                                            (isset($thumbnailBorderRadius['left']) ? (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) : '0px') . '; ';
                                    }

                                    $output .= '">';

                                    if ($thumbnailLink) {
                                        $output .= '<a href="' . esc_url($permalink) . '"' . $targetAttr . '>';
                                        $output .= $leftThumbnailSize;
                                        $output .= '</a>';
                                    } else {
                                        $output .= $leftThumbnailSize;
                                    }
                                    if ($showPostCategory) {
                                            
                                        $output .= '<div class="fpg-category" style="color:' . esc_attr($metaTextColor) . ';background:' . esc_attr($metaBgColor) . ';font-size:' . esc_attr($metaFontSize) . 'px;">';

                                            if ($showPostCategoryIcon && $showMetaIcon) {
                                                $output .= '<i class="ri-folder-line" style="color:' . esc_attr($metaIconColor) . '; font-size:' . esc_attr($metaFontSize) . 'px;"></i> ';
                                            }

                                            // Get category names without links
                                            $categories_list = get_the_category($post_id);
                                            if (!empty($categories_list)) {
                                                $category_names = array();
                                                foreach ($categories_list as $category) {
                                                    $category_names[] = esc_html($category->name);
                                                }
                                                $output .= implode(', ', $category_names); // comma-separated plain text categories
                                            }
                                        $output .= '</div>';
                                    }
                                    $output .= '</div>';
                                }
                                // END Thumbnail
                                // MAIN Content
                                $output .= '<div class="fpg-blog__content" style="';
                                    // MARGIN
                                    if (
                                        isset($contentitemMarginNew['top']) ||
                                        isset($contentitemMarginNew['right']) ||
                                        isset($contentitemMarginNew['bottom']) ||
                                        isset($contentitemMarginNew['left'])
                                    ) {
                                        $output .= 'margin: ' .
                                            (isset($contentitemMarginNew['top']) ? (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) : '0px') . ' ' .
                                            (isset($contentitemMarginNew['right']) ? (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) : '0px') . ' ' .
                                            (isset($contentitemMarginNew['bottom']) ? (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) : '0px') . ' ' .
                                            (isset($contentitemMarginNew['left']) ? (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) : '0px') . '; ';
                                    }

                                    // PADDING
                                    if (
                                        isset($contentitemPaddingNew['top']) ||
                                        isset($contentitemPaddingNew['right']) ||
                                        isset($contentitemPaddingNew['bottom']) ||
                                        isset($contentitemPaddingNew['left'])
                                    ) {
                                        $output .= 'padding: ' .
                                            (isset($contentitemPaddingNew['top']) ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' .
                                            (isset($contentitemPaddingNew['right']) ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' .
                                            (isset($contentitemPaddingNew['bottom']) ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' .
                                            (isset($contentitemPaddingNew['left']) ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; ';
                                    }

                                    // BORDER WIDTH
                                    if (
                                        isset($contentBorderWidth['top']) ||
                                        isset($contentBorderWidth['right']) ||
                                        isset($contentBorderWidth['bottom']) ||
                                        isset($contentBorderWidth['left'])
                                    ) {
                                        $output .= 'border-width: ' .
                                            (isset($contentBorderWidth['top']) ? (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) : '0px') . ' ' .
                                            (isset($contentBorderWidth['right']) ? (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) : '0px') . ' ' .
                                            (isset($contentBorderWidth['bottom']) ? (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) : '0px') . ' ' .
                                            (isset($contentBorderWidth['left']) ? (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) : '0px') . '; ';
                                    }
                                    // BORDER radius
                                    if (
                                        isset($contentitemRadius['top']) ||
                                        isset($contentitemRadius['right']) ||
                                        isset($contentitemRadius['bottom']) ||
                                        isset($contentitemRadius['left'])
                                    ) {
                                        $output .= 'border-radius: ' .
                                            (isset($contentitemRadius['top']) ? (is_numeric($contentitemRadius['top']) ? $contentitemRadius['top'] . 'px' : esc_attr($contentitemRadius['top'])) : '0px') . ' ' .
                                            (isset($contentitemRadius['right']) ? (is_numeric($contentitemRadius['right']) ? $contentitemRadius['right'] . 'px' : esc_attr($contentitemRadius['right'])) : '0px') . ' ' .
                                            (isset($contentitemRadius['bottom']) ? (is_numeric($contentitemRadius['bottom']) ? $contentitemRadius['bottom'] . 'px' : esc_attr($contentitemRadius['bottom'])) : '0px') . ' ' .
                                            (isset($contentitemRadius['left']) ? (is_numeric($contentitemRadius['left']) ? $contentitemRadius['left'] . 'px' : esc_attr($contentitemRadius['left'])) : '0px') . '; ';
                                    }
                                    // Border Style
                                    if (!empty($contentNormalBorderType)) {
                                        $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                                    }
                                    // Background Color
                                    if (!empty($contentBgColor)) {
                                        $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                                    }
                                    // Border Color
                                    if (!empty($contentBorderColor)) {
                                        $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                                    }
                                $output .= '">';

                                // Meta Data
                                if ($showMetaData) {
                                    $output .= '<ul class="meta-data-list align-' . $metaAlignment . ' " style="';  
                                        // MARGIN
                                        if (
                                            isset($metaMarginNew['top']) ||
                                            isset($metaMarginNew['right']) ||
                                            isset($metaMarginNew['bottom']) ||
                                            isset($metaMarginNew['left'])
                                        ) {
                                            $output .= 'margin: ' .
                                                (isset($metaMarginNew['top']) ? (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) : '0px') . ' ' .
                                                (isset($metaMarginNew['right']) ? (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) : '0px') . ' ' .
                                                (isset($metaMarginNew['bottom']) ? (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) : '0px') . ' ' .
                                                (isset($metaMarginNew['left']) ? (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) : '0px') . '; ';
                                        }

                                        // PADDING
                                        if (
                                            isset($metaPadding['top']) ||
                                            isset($metaPadding['right']) ||
                                            isset($metaPadding['bottom']) ||
                                            isset($metaPadding['left'])
                                        ) {
                                            $output .= 'padding: ' .
                                                (isset($metaPadding['top']) ? (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) : '0px') . ' ' .
                                                (isset($metaPadding['right']) ? (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) : '0px') . ' ' .
                                                (isset($metaPadding['bottom']) ? (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) : '0px') . ' ' .
                                                (isset($metaPadding['left']) ? (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) : '0px') . '; ';
                                        }  
                                        
                                        // Color
                                        if (!empty($metaTextColor)) {
                                            $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                                        }
                                        // Order
                                        if (!empty($metaOrder)) {
                                            $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                                        }
                                    $output .= '">';

                                    $meta_items = [];

                                    
                                    // Author
                                    if ($showPostAuthor) {
                                        $meta = '<li class="meta-author" style="';

                                        if (!empty($metaTextColor)) {
                                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '">';

                                        if ($showPostAuthorIcon && $showMetaIcon) {
                                            $meta .= '<i class="fas fa-user" style="';

                                            if (!empty($metaIconColor)) {
                                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                            }

                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '"></i> ';
                                        }

                                        $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                                        $meta_items[] = $meta;
                                    }
                                    // Date
                                    if ($showPostDate) {
                                        $meta = '<li class="meta-date" style="';

                                        // Color
                                        if (!empty($metaTextColor)) {
                                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                        }

                                        // Font size
                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '">';

                                        // Icon
                                        if ($showPostDateIcon && $showMetaIcon) {
                                            $meta .= '<i class="fas fa-calendar-alt" style="';

                                            if (!empty($metaIconColor)) {
                                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                            }

                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '"></i> ';
                                        }

                                        $meta .= esc_html($getdate) . '</li>';
                                        $meta_items[] = $meta;
                                    }
                                    // Tags
                                    if ($showPostTags && !empty($tags)) {
                                        $meta = '<li class="meta-tags" style="';

                                        if (!empty($metaTextColor)) {
                                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '">';

                                        if ($showPostTagsIcon && $showMetaIcon) {
                                            $meta .= '<i class="fas fa-tags" style="';

                                            if (!empty($metaIconColor)) {
                                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                            }

                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '"></i> ';
                                        }

                                        $meta .= esc_html__('Tags:', 'fancy-post-grid') . ' ' . $tags . '</li>';
                                        $meta_items[] = $meta;
                                    }
                                    // Comment Count
                                    if ($showPostCommentsCount) {
                                        $meta = '<li class="meta-comment-count" style="';
                                        if (!empty($metaTextColor)) {
                                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                        }
                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '">';

                                        if ($showPostCommentsCountIcon && $showMetaIcon) {
                                            $meta .= '<i class="fas fa-comments" style="';
                                            if (!empty($metaIconColor)) {
                                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                            }
                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }
                                            $meta .= '"></i> ';
                                        }

                                        $meta .= esc_html($comments_count) . ' ' . esc_html__('Comments', 'fancy-post-grid') . '</li>';
                                        $meta_items[] = $meta;
                                    }
                                    // Now join meta items with the separator
                                    if (!empty($meta_items)) {
                                        $separator = '';

                                        if ($metaSeperator !== '') {
                                            $separator = '';
                                            if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                                $separatorStyle = '';
                                                if (!empty($separatorColor)) {
                                                    $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                                }
                                                if (!empty($metaFontSize)) {
                                                    $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                                }

                                                $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                                            }
                                        }

                                        $output .= implode($separator, $meta_items);
                                    }
                                    $output .= '</ul>'; // Close meta-data-list               
                                }
                                // End Meta Data

                                // title
                                if ($showPostTitle) {
                                    $titleStyles = '';

                                    // Order
                                    if (!empty($titleOrder)) {
                                        $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                                    }

                                    // Background color
                                    if (!empty($postTitleBgColor)) {
                                        $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                                    }

                                    // Margin
                                    if (isset($postTitleMargin['top']) || isset($postTitleMargin['right']) || isset($postTitleMargin['bottom']) || isset($postTitleMargin['left'])) {
                                        $titleStyles .= 'margin: ' .
                                            (isset($postTitleMargin['top']) ? (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) : '0px') . ' ' .
                                            (isset($postTitleMargin['right']) ? (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) : '0px') . ' ' .
                                            (isset($postTitleMargin['bottom']) ? (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) : '0px') . ' ' .
                                            (isset($postTitleMargin['left']) ? (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) : '0px') . '; ';
                                    }

                                    // Padding
                                    if (isset($postTitlePadding['top']) || isset($postTitlePadding['right']) || isset($postTitlePadding['bottom']) || isset($postTitlePadding['left'])) {
                                        $titleStyles .= 'padding: ' .
                                            (isset($postTitlePadding['top']) ? (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) : '0px') . ' ' .
                                            (isset($postTitlePadding['right']) ? (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) : '0px') . ' ' .
                                            (isset($postTitlePadding['bottom']) ? (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) : '0px') . ' ' .
                                            (isset($postTitlePadding['left']) ? (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) : '0px') . '; ';
                                    }

                                    // Determine if underline should be shown
                                    $showUnderline = $postLinkType === 'yeslink' && $titleHoverUnderLine === 'enable';

                                    // Class name
                                    $classNames = 'title align-' . esc_attr($postTitleAlignment);
                                    if ($showUnderline) {
                                        $classNames .= ' underline';
                                    }

                                    // Hover/Out events for nolink
                                    $onmouseover = '';
                                    $onmouseout  = '';

                                    if (!empty($postTitleHoverBgColor)) {
                                        $onmouseover .= 'this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';';
                                    }

                                    if (!empty($postTitleHoverColor)) {
                                        $onmouseover .= ' this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                                    }

                                    if (!empty($postTitleBgColor)) {
                                        $onmouseout .= 'this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';';
                                    } else {
                                        $onmouseout .= 'this.style.removeProperty(\'background-color\');';
                                    }

                                    if (!empty($postTitleColor)) {
                                        $onmouseout .= ' this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                                    } else {
                                        $onmouseout .= ' this.style.removeProperty(\'color\');';
                                    }

                                    // Opening title tag
                                    $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"'
                                        . (!empty($onmouseover) ? ' onmouseover="' . trim($onmouseover) . '"' : '')
                                        . (!empty($onmouseout)  ? ' onmouseout="'  . trim($onmouseout)  . '"' : '') . '>';

                                    if ($postLinkType === 'yeslink') {
                                        // Anchor styles
                                        $style = '';
                                        $hoverStyle = '';
                                        $mouseoutStyle = '';

                                        if (!empty($postTitleFontSize)) {
                                            $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                                        }

                                        if (!empty($postTitleLineHeight)) {
                                            $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                                        }

                                        if (!empty($postTitleLetterSpacing)) {
                                            $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                                        }

                                        if (!empty($postTitleFontWeight)) {
                                            $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                                        }

                                        if (!empty($postTitleColor)) {
                                            $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                            $mouseoutStyle .= 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                                        } else {
                                            $mouseoutStyle .= 'this.style.color=\'\';';
                                        }

                                        if (!empty($postTitleHoverColor)) {
                                            $hoverStyle .= 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                                        }

                                        if ($showUnderline && !empty($postTitleHoverColor)) {
                                            $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                                            $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                            $hoverStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                                        }

                                        if ($showUnderline && empty($postTitleColor ) && !empty($postTitleColor )) {
                                            $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                                            $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                            $mouseoutStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                                        } else {
                                            
                                            $mouseoutStyle .= ' this.style.removeProperty(\'background-position\');';
                                            $mouseoutStyle .= ' this.style.removeProperty(\'background-size\');';
                                        }

                                        $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '
                                            style="' . esc_attr(trim($style)) . '"'
                                            . (!empty($hoverStyle)   ? ' onmouseover="' . $hoverStyle . '"' : '')
                                            . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                            . esc_html($croppedTitle) . '</a>';
                                    } else {
                                        // No link  render span with inline styles
                                        $inlineStyle = '';
                                        if (!empty($postTitleFontSize)) {
                                            $inlineStyle .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                                        }
                                        if (!empty($postTitleLineHeight)) {
                                            $inlineStyle .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                                        }
                                        if (!empty($postTitleLetterSpacing)) {
                                            $inlineStyle .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                                        }
                                        if (!empty($postTitleFontWeight)) {
                                            $inlineStyle .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                                        }
                                        if (!empty($postTitleColor)) {
                                            $inlineStyle .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                        }

                                        $output .= '<span style="' . esc_attr(trim($inlineStyle)) . '">' . esc_html($croppedTitle) . '</span>';
                                    }

                                    $output .= '</' . esc_attr($titleTag) . '>';
                                }
                                // Excerpt
                                if ($showPostExcerpt) {

                                    $excerptStylesS = '';

                                    // Order
                                    if (!empty($excerptOrder)) {
                                        $excerptStylesS .= 'order: ' . esc_attr($excerptOrder) . '; ';
                                    }

                                    // Margin
                                    if (isset($excerptMargin['top']) || isset($excerptMargin['right']) || isset($excerptMargin['bottom']) || isset($excerptMargin['left'])) {
                                        $excerptStylesS .= 'margin: ' .
                                            (isset($excerptMargin['top']) ? (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) : '0px') . ' ' .
                                            (isset($excerptMargin['right']) ? (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) : '0px') . ' ' .
                                            (isset($excerptMargin['bottom']) ? (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) : '0px') . ' ' .
                                            (isset($excerptMargin['left']) ? (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) : '0px') . '; ';
                                    }

                                    // Padding
                                    if (isset($excerptPadding['top']) || isset($excerptPadding['right']) || isset($excerptPadding['bottom']) || isset($excerptPadding['left'])) {
                                        $excerptStylesS .= 'padding: ' .
                                            (isset($excerptPadding['top']) ? (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) : '0px') . ' ' .
                                            (isset($excerptPadding['right']) ? (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) : '0px') . ' ' .
                                            (isset($excerptPadding['bottom']) ? (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) : '0px') . ' ' .
                                            (isset($excerptPadding['left']) ? (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) : '0px') . '; ';
                                    }

                                    // Background color for div
                                    if (!empty($excerptBgColor)) {
                                        $excerptStylesS .= 'background-color: ' . esc_attr($excerptBgColor) . '; ';
                                    }

                                    // Hover for div (background)
                                    $divHoverIn = '';
                                    $divHoverOut = '';

                                    if (!empty($excerptHoverBgColor)) {
                                        $divHoverIn .= 'this.style.backgroundColor=\'' . esc_attr($excerptHoverBgColor) . '\';';
                                        $divHoverOut .= 'this.style.backgroundColor=\'' . esc_attr($excerptBgColor) . '\';';
                                    }

                                    // Start div wrapper with styles and hover
                                    $output .= '<div class="fpg-excerpt align-' . esc_attr($excerptAlignment) . '" style="' . esc_attr(trim($excerptStylesS)) . '"';

                                    if (!empty($divHoverIn)) {
                                        $output .= ' onmouseover="' . esc_attr($divHoverIn) . '"';
                                    }

                                    if (!empty($divHoverOut)) {
                                        $output .= ' onmouseout="' . esc_attr($divHoverOut) . '"';
                                    }

                                    $output .= '>';

                                    // Begin <p> with text styles
                                    $output .= '<p';

                                    $excerptStyles = '';

                                    if (!empty($excerptFontSize)) {
                                        $excerptStyles .= 'font-size: ' . esc_attr($excerptFontSize) . 'px; ';
                                    }

                                    if (!empty($excerptLineHeight)) {
                                        $excerptStyles .= 'line-height: ' . esc_attr($excerptLineHeight) . '; ';
                                    }

                                    if (!empty($excerptLetterSpacing)) {
                                        $excerptStyles .= 'letter-spacing: ' . esc_attr($excerptLetterSpacing) . 'px; ';
                                    }

                                    if (!empty($excerptFontWeight)) {
                                        $excerptStyles .= 'font-weight: ' . esc_attr($excerptFontWeight) . '; ';
                                    }

                                    if (!empty($excerptColor)) {
                                        $excerptStyles .= 'color: ' . esc_attr($excerptColor) . '; ';
                                    }

                                    if (!empty($excerptBorderType)) {
                                        $excerptStyles .= 'border-style: ' . esc_attr($excerptBorderType) . '; ';
                                    }

                                    // Text hover (on <p>)
                                    $hoverIn = '';
                                    $hoverOut = '';

                                    if (!empty($excerptHoverColor)) {
                                        $hoverIn .= 'this.style.color=\'' . esc_attr($excerptHoverColor) . '\';';
                                        $hoverOut .= 'this.style.color=\'' . esc_attr($excerptColor) . '\';';
                                    }

                                    // Apply styles and hover to <p>
                                    if (!empty($excerptStyles)) {
                                        $output .= ' style="' . esc_attr(trim($excerptStyles)) . '"';
                                    }

                                    if (!empty($hoverIn)) {
                                        $output .= ' onmouseover="' . esc_attr($hoverIn) . '"';
                                    }

                                    if (!empty($hoverOut)) {
                                        $output .= ' onmouseout="' . esc_attr($hoverOut) . '"';
                                    }

                                    $output .= '>';
                                    $output .= esc_html($excerpt);
                                    $output .= '</p>';

                                    // Close div
                                    $output .= '</div>';
                                }
                                // End Excerpt

                                // Button Output                
                                if ($showReadMoreButton) {
                                    // Button wrapper styles
                                    $buttonWrapperStyle = '';

                                    if (
                                        isset($buttonMarginNew['top']) || 
                                        isset($buttonMarginNew['right']) || 
                                        isset($buttonMarginNew['bottom']) || 
                                        isset($buttonMarginNew['left'])
                                    ) {
                                        $buttonWrapperStyle .= 'margin: ' .
                                            (isset($buttonMarginNew['top']) ? (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) : '0px') . ' ' .
                                            (isset($buttonMarginNew['right']) ? (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) : '0px') . ' ' .
                                            (isset($buttonMarginNew['bottom']) ? (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) : '0px') . ' ' .
                                            (isset($buttonMarginNew['left']) ? (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) : '0px') . '; ';
                                    }

                                    // Order
                                    if (!empty($buttonOrder)) {
                                        $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                                    }
      
                                    $output .= '<div class="btn-wrapper align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';

                                    // Button inline styles
                                    $buttonInlineStyles = '';

                                    if (!empty($buttonTextColor)) {
                                        $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                                    }
                                    if (!empty($buttonBackgroundColor)) {
                                        $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                                    }
                                    if (!empty($buttonFontSize)) {
                                        $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                                    }
                                    if (!empty($buttonFontWeight)) {
                                        $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                                    }
                                    if (!empty($buttonBorderColor)) {
                                        $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                                    }
                                    if (!empty($buttonBorderType)) {
                                        $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                                    }

                                    // Border Width
                                    if (
                                        isset($buttonBorderWidth['top']) || 
                                        isset($buttonBorderWidth['right']) || 
                                        isset($buttonBorderWidth['bottom']) || 
                                        isset($buttonBorderWidth['left'])
                                    ) {
                                        $buttonInlineStyles .= 'border-width: ' .
                                            (isset($buttonBorderWidth['top']) ? (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) : '0px') . ' ' .
                                            (isset($buttonBorderWidth['right']) ? (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) : '0px') . ' ' .
                                            (isset($buttonBorderWidth['bottom']) ? (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) : '0px') . ' ' .
                                            (isset($buttonBorderWidth['left']) ? (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) : '0px') . '; ';
                                    }

                                    // Border Radius
                                    if (
                                        isset($buttonBorderRadius['top']) || 
                                        isset($buttonBorderRadius['right']) || 
                                        isset($buttonBorderRadius['bottom']) || 
                                        isset($buttonBorderRadius['left'])
                                    ) {
                                        $buttonInlineStyles .= 'border-radius: ' .
                                            (isset($buttonBorderRadius['top']) ? (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) : '0px') . ' ' .
                                            (isset($buttonBorderRadius['right']) ? (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) : '0px') . ' ' .
                                            (isset($buttonBorderRadius['bottom']) ? (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) : '0px') . ' ' .
                                            (isset($buttonBorderRadius['left']) ? (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) : '0px') . '; ';
                                    }

                                    // Padding
                                    if (
                                        isset($buttonPaddingNew['top']) || 
                                        isset($buttonPaddingNew['right']) || 
                                        isset($buttonPaddingNew['bottom']) || 
                                        isset($buttonPaddingNew['left'])
                                    ) {
                                        $buttonInlineStyles .= 'padding: ' .
                                            (isset($buttonPaddingNew['top']) ? (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) : '0px') . ' ' .
                                            (isset($buttonPaddingNew['right']) ? (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) : '0px') . ' ' .
                                            (isset($buttonPaddingNew['bottom']) ? (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) : '0px') . ' ' .
                                            (isset($buttonPaddingNew['left']) ? (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) : '0px') . '; ';
                                    } 

                                    // Hover styles
                                    $buttonHoverInlineStyles = '';
                                    $buttonResetStyles = '';

                                    if (!empty($buttonHoverTextColor)) {
                                        $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                                        $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                                    }
                                    if (!empty($buttonHoverBorderColor)) {
                                        $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                                        $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                                    }
                                    if (!empty($buttonHoverBackgroundColor)) {
                                        $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                                        $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                                    }

                                    // Button anchor tag
                                    $output .= '<a class="fpg-link read-more ' . esc_attr($buttonStyle1) . '" href="' . esc_url(get_permalink()) . '" ' . $targetAttr . ' style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                                    if (!empty($buttonHoverInlineStyles)) {
                                        $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                                    }

                                    if (!empty($buttonResetStyles)) {
                                        $output .= ' onmouseout="' . $buttonResetStyles . '"';
                                    }

                                    $output .= '>';

                                    // Icon handling
                                    $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                                    $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                                    $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                                    if ($iconPosition === 'left' && $showButtonIcon) {
                                        $output .= $leftIcon . ' ';
                                    }

                                    $output .= esc_html($readMoreLabel);

                                    if ($iconPosition === 'right' && $showButtonIcon) {
                                        $output .= ' ' . $rightIcon;
                                    }

                                    $output .= '</a></div>';
                                }
                                // End Button

                                $output .= '</div>';
                                // Add any other post content here (title, meta, etc.)
                            $output .= '</div>'; // .fancy-post-item
                        $output .= '</div>'; // .col-lg-5

                        // START RIGHT SIDE WRAPPER for remaining posts
                        $output .= '<div class="col-lg-7" style="';
                            if (!empty($itemGap)) {
                                $halfGap = is_numeric($itemGap) ? ($itemGap / 2) . 'px' : esc_attr($itemGap);
                                $output .= 'padding-left: ' . $halfGap . '; padding-right: ' . $halfGap . '; ';
                            }
                        $output .= '">';
                    } else {
                        // RIGHT SIDE - All other posts
                        $output .= '<div class="fpg-blog__left-blog right-blog fancy-post-item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . ' ' . $postLinkType . '" style="';
                            // MARGIN    
                            if (isset($itemMargin['top']) || isset($itemMargin['right']) || isset($itemMargin['bottom']) || isset($itemMargin['left'])) {
                                $output .= 'margin: ' .
                                    (isset($itemMargin['top']) ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' .
                                    (isset($itemMargin['right']) ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' .
                                    (isset($itemMargin['bottom']) ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' .
                                    (isset($itemMargin['left']) ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; ';
                            }

                            // PADDING
                            if (isset($itemPadding['top']) || isset($itemPadding['right']) || isset($itemPadding['bottom']) || isset($itemPadding['left'])) {
                                $output .= 'padding: ' .
                                    (isset($itemPadding['top']) ? (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) : '0px') . ' ' .
                                    (isset($itemPadding['right']) ? (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) : '0px') . ' ' .
                                    (isset($itemPadding['bottom']) ? (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) : '0px') . ' ' .
                                    (isset($itemPadding['left']) ? (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) : '0px') . '; ';
                            }

                            // BORDER RADIUS
                            if (isset($itemBorderRadius['top']) || isset($itemBorderRadius['right']) || isset($itemBorderRadius['bottom']) || isset($itemBorderRadius['left'])) {
                                $output .= 'border-radius: ' .
                                    (isset($itemBorderRadius['top']) ? (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) : '0px') . ' ' .
                                    (isset($itemBorderRadius['right']) ? (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) : '0px') . ' ' .
                                    (isset($itemBorderRadius['bottom']) ? (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) : '0px') . ' ' .
                                    (isset($itemBorderRadius['left']) ? (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) : '0px') . '; ';
                            }

                            // BORDER WIDTH
                            if (isset($itemBorderWidth['top']) || isset($itemBorderWidth['right']) || isset($itemBorderWidth['bottom']) || isset($itemBorderWidth['left'])) {
                                $output .= 'border-width: ' .
                                    (isset($itemBorderWidth['top']) ? (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) : '0px') . ' ' .
                                    (isset($itemBorderWidth['right']) ? (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) : '0px') . ' ' .
                                    (isset($itemBorderWidth['bottom']) ? (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) : '0px') . ' ' .
                                    (isset($itemBorderWidth['left']) ? (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) : '0px') . '; ';
                            }

                            // Border Style & Color
                            if (!empty($itemBorderType)) {
                                $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                            }
                            if (!empty($itemBorderColor)) {
                                $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                            }

                            // Background Color
                            if (!empty($itemBackgroundColor)) {
                                $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                            }

                            // Box Shadow
                            if (
                                isset($itemBoxShadow['left']) ||  // horizontal offset
                                isset($itemBoxShadow['top']) ||  // vertical offset
                                isset($itemBoxShadow['right']) ||  // blur radius
                                isset($itemBoxShadow['bottom']) ||  // spread radius
                                isset($itemBoxShadowColor)
                            ) {
                                $output .= 'box-shadow: ' .
                                    (isset($itemBoxShadow['left']) ? (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) : '0px') . ' ' .
                                    (isset($itemBoxShadow['top']) ? (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) : '0px') . ' ' .
                                    (isset($itemBoxShadow['right']) ? (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) : '0px') . ' ' .
                                    (isset($itemBoxShadow['bottom']) ? (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) : '0px') . ' ' .
                                    (!empty($itemBoxShadowColor) ? esc_attr($itemBoxShadowColor) : 'rgba(0,0,0,0.1)') . '; ';
                            }

                        $output .= '">';
                            // Thumbnail
                            if ($rightThumbnailSize && $showThumbnail) {
                                $output .= '<div class="fpg-blog__thumb" style="';

                                // MARGIN
                                if (
                                    isset($thumbnailMargin['top']) ||
                                    isset($thumbnailMargin['right']) ||
                                    isset($thumbnailMargin['bottom']) ||
                                    isset($thumbnailMargin['left'])
                                ) {
                                    $output .= 'margin: ' .
                                        (isset($thumbnailMargin['top']) ? (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) : '0px') . ' ' .
                                        (isset($thumbnailMargin['right']) ? (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) : '0px') . ' ' .
                                        (isset($thumbnailMargin['bottom']) ? (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) : '0px') . ' ' .
                                        (isset($thumbnailMargin['left']) ? (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) : '0px') . '; ';
                                }

                                // PADDING
                                if (
                                    isset($thumbnailPadding['top']) ||
                                    isset($thumbnailPadding['right']) ||
                                    isset($thumbnailPadding['bottom']) ||
                                    isset($thumbnailPadding['left'])
                                ) {
                                    $output .= 'padding: ' .
                                        (isset($thumbnailPadding['top']) ? (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) : '0px') . ' ' .
                                        (isset($thumbnailPadding['right']) ? (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) : '0px') . ' ' .
                                        (isset($thumbnailPadding['bottom']) ? (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) : '0px') . ' ' .
                                        (isset($thumbnailPadding['left']) ? (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) : '0px') . '; ';
                                }

                                // BORDER RADIUS
                                if (
                                    isset($thumbnailBorderRadius['top']) ||
                                    isset($thumbnailBorderRadius['right']) ||
                                    isset($thumbnailBorderRadius['bottom']) ||
                                    isset($thumbnailBorderRadius['left'])
                                ) {
                                    $output .= 'border-radius: ' .
                                        (isset($thumbnailBorderRadius['top']) ? (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) : '0px') . ' ' .
                                        (isset($thumbnailBorderRadius['right']) ? (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) : '0px') . ' ' .
                                        (isset($thumbnailBorderRadius['bottom']) ? (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) : '0px') . ' ' .
                                        (isset($thumbnailBorderRadius['left']) ? (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) : '0px') . '; ';
                                }

                                $output .= '">';

                                // Anchor with optional border-radius and overflow
                                if ($thumbnailLink) {
                                    $output .= '<a href="' . esc_url($permalink) . '"' . $targetAttr . '>';
                                    $output .= $rightThumbnailSize;
                                    $output .= '</a>';
                                } else {
                                    $output .= $rightThumbnailSize;
                                }
                                if ($showPostCategory) {
                                        
                                    $output .= '<div class="fpg-category" style="background:' . esc_attr($metaBgColor) . ';color:' . esc_attr($metaTextColor) . ';font-size:' . esc_attr($metaFontSize) . 'px;">';
                                        if ($showPostCategoryIcon && $showMetaIcon) {
                                            $output .= '<i class="ri-folder-line" style="color:' . esc_attr($metaIconColor) . '; font-size:' . esc_attr($metaFontSize) . 'px;"></i> ';
                                        }

                                        // Get category names without links
                                        $categories_list = get_the_category($post_id);
                                        if (!empty($categories_list)) {
                                            $category_names = array();
                                            foreach ($categories_list as $category) {
                                                $category_names[] = esc_html($category->name);
                                            }
                                            $output .= implode(', ', $category_names); // comma-separated plain text categories
                                        }
                                    $output .= '</div>';
                                }
                                $output .= '</div>';
                            }
                            // END Thumbnail
                            // MAIN Content
                            $output .= '<div class="fpg-blog__content" style="';
                                // MARGIN
                                if (
                                    isset($contentitemMarginNew['top']) ||
                                    isset($contentitemMarginNew['right']) ||
                                    isset($contentitemMarginNew['bottom']) ||
                                    isset($contentitemMarginNew['left'])
                                ) {
                                    $output .= 'margin: ' .
                                        (isset($contentitemMarginNew['top']) ? (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) : '0px') . ' ' .
                                        (isset($contentitemMarginNew['right']) ? (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) : '0px') . ' ' .
                                        (isset($contentitemMarginNew['bottom']) ? (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) : '0px') . ' ' .
                                        (isset($contentitemMarginNew['left']) ? (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) : '0px') . '; ';
                                }

                                // PADDING
                                if (
                                    isset($contentitemPaddingNew['top']) ||
                                    isset($contentitemPaddingNew['right']) ||
                                    isset($contentitemPaddingNew['bottom']) ||
                                    isset($contentitemPaddingNew['left'])
                                ) {
                                    $output .= 'padding: ' .
                                        (isset($contentitemPaddingNew['top']) ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' .
                                        (isset($contentitemPaddingNew['right']) ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' .
                                        (isset($contentitemPaddingNew['bottom']) ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' .
                                        (isset($contentitemPaddingNew['left']) ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; ';
                                }

                                // BORDER WIDTH
                                if (
                                    isset($contentBorderWidth['top']) ||
                                    isset($contentBorderWidth['right']) ||
                                    isset($contentBorderWidth['bottom']) ||
                                    isset($contentBorderWidth['left'])
                                ) {
                                    $output .= 'border-width: ' .
                                        (isset($contentBorderWidth['top']) ? (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) : '0px') . ' ' .
                                        (isset($contentBorderWidth['right']) ? (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) : '0px') . ' ' .
                                        (isset($contentBorderWidth['bottom']) ? (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) : '0px') . ' ' .
                                        (isset($contentBorderWidth['left']) ? (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) : '0px') . '; ';
                                }
                                // BORDER radius
                                if (
                                    isset($contentitemRadius['top']) ||
                                    isset($contentitemRadius['right']) ||
                                    isset($contentitemRadius['bottom']) ||
                                    isset($contentitemRadius['left'])
                                ) {
                                    $output .= 'border-radius: ' .
                                        (isset($contentitemRadius['top']) ? (is_numeric($contentitemRadius['top']) ? $contentitemRadius['top'] . 'px' : esc_attr($contentitemRadius['top'])) : '0px') . ' ' .
                                        (isset($contentitemRadius['right']) ? (is_numeric($contentitemRadius['right']) ? $contentitemRadius['right'] . 'px' : esc_attr($contentitemRadius['right'])) : '0px') . ' ' .
                                        (isset($contentitemRadius['bottom']) ? (is_numeric($contentitemRadius['bottom']) ? $contentitemRadius['bottom'] . 'px' : esc_attr($contentitemRadius['bottom'])) : '0px') . ' ' .
                                        (isset($contentitemRadius['left']) ? (is_numeric($contentitemRadius['left']) ? $contentitemRadius['left'] . 'px' : esc_attr($contentitemRadius['left'])) : '0px') . '; ';
                                }
                                // Border Style
                                if (!empty($contentNormalBorderType)) {
                                    $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                                }
                                // Background Color
                                if (!empty($contentBgColor)) {
                                    $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                                }
                                // Border Color
                                if (!empty($contentBorderColor)) {
                                    $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                                }
                            $output .= '">';

                            // Meta Data
                            if ($showMetaData) {
                                $output .= '<ul class="meta-data-list align-' . $metaAlignment . ' " style="';  
                                    // MARGIN
                                    if (
                                        isset($metaMarginNew['top']) ||
                                        isset($metaMarginNew['right']) ||
                                        isset($metaMarginNew['bottom']) ||
                                        isset($metaMarginNew['left'])
                                    ) {
                                        $output .= 'margin: ' .
                                            (isset($metaMarginNew['top']) ? (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) : '0px') . ' ' .
                                            (isset($metaMarginNew['right']) ? (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) : '0px') . ' ' .
                                            (isset($metaMarginNew['bottom']) ? (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) : '0px') . ' ' .
                                            (isset($metaMarginNew['left']) ? (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) : '0px') . '; ';
                                    }

                                    // PADDING
                                    if (
                                        isset($metaPadding['top']) ||
                                        isset($metaPadding['right']) ||
                                        isset($metaPadding['bottom']) ||
                                        isset($metaPadding['left'])
                                    ) {
                                        $output .= 'padding: ' .
                                            (isset($metaPadding['top']) ? (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) : '0px') . ' ' .
                                            (isset($metaPadding['right']) ? (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) : '0px') . ' ' .
                                            (isset($metaPadding['bottom']) ? (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) : '0px') . ' ' .
                                            (isset($metaPadding['left']) ? (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) : '0px') . '; ';
                                    }  
                                    
                                    // Color
                                    if (!empty($metaTextColor)) {
                                        $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                                    }
                                    // Order
                                    if (!empty($metaOrder)) {
                                        $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                                    }
                                $output .= '">';

                                $meta_items = [];
                                // Author
                                if ($showPostAuthor) {
                                    $meta = '<li class="meta-author" style="';

                                    if (!empty($metaTextColor)) {
                                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                    }

                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '">';

                                    if ($showPostAuthorIcon && $showMetaIcon) {
                                        $meta .= '<i class="fas fa-user" style="';

                                        if (!empty($metaIconColor)) {
                                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '"></i> ';
                                    }

                                    $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                                    $meta_items[] = $meta;
                                }
                                // Date
                                if ($showPostDate) {
                                    $meta = '<li class="meta-date" style="';

                                    // Color
                                    if (!empty($metaTextColor)) {
                                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                    }

                                    // Font size
                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '">';

                                    // Icon
                                    if ($showPostDateIcon && $showMetaIcon) {
                                        $meta .= '<i class="fas fa-calendar-alt" style="';

                                        if (!empty($metaIconColor)) {
                                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '"></i> ';
                                    }

                                    $meta .= esc_html($getdate) . '</li>';
                                    $meta_items[] = $meta;
                                }
                                
                                
                                // Tags
                                if ($showPostTags && !empty($tags)) {
                                    $meta = '<li class="meta-tags" style="';

                                    if (!empty($metaTextColor)) {
                                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                    }

                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '">';

                                    if ($showPostTagsIcon && $showMetaIcon) {
                                        $meta .= '<i class="fas fa-tags" style="';

                                        if (!empty($metaIconColor)) {
                                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '"></i> ';
                                    }

                                    $meta .= esc_html__('Tags:', 'fancy-post-grid') . ' ' . $tags . '</li>';
                                    $meta_items[] = $meta;
                                }
                                // Comment Count
                                if ($showPostCommentsCount) {
                                    $meta = '<li class="meta-comment-count" style="';
                                    if (!empty($metaTextColor)) {
                                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                    }
                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '">';

                                    if ($showPostCommentsCountIcon && $showMetaIcon) {
                                        $meta .= '<i class="fas fa-comments" style="';
                                        if (!empty($metaIconColor)) {
                                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                        }
                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }
                                        $meta .= '"></i> ';
                                    }

                                    $meta .= esc_html($comments_count) . ' ' . esc_html__('Comments', 'fancy-post-grid') . '</li>';
                                    $meta_items[] = $meta;
                                }
                                // Now join meta items with the separator
                                if (!empty($meta_items)) {
                                    $separator = '';

                                    if ($metaSeperator !== '') {
                                        $separator = '';
                                        if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                            $separatorStyle = '';
                                            if (!empty($separatorColor)) {
                                                $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                            }
                                            if (!empty($metaFontSize)) {
                                                $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                                        }
                                    }

                                    $output .= implode($separator, $meta_items);
                                }
                                $output .= '</ul>'; // Close meta-data-list               
                            }
                            // End Meta Data

                            // title
                            if ($showPostTitle) {
                                $titleStyles = '';

                                // Order
                                if (!empty($titleOrder)) {
                                    $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                                }

                                // Background color
                                if (!empty($postTitleBgColor)) {
                                    $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                                }

                                // Margin
                                if (isset($postTitleMargin['top']) || isset($postTitleMargin['right']) || isset($postTitleMargin['bottom']) || isset($postTitleMargin['left'])) {
                                    $titleStyles .= 'margin: ' .
                                        (isset($postTitleMargin['top']) ? (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) : '0px') . ' ' .
                                        (isset($postTitleMargin['right']) ? (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) : '0px') . ' ' .
                                        (isset($postTitleMargin['bottom']) ? (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) : '0px') . ' ' .
                                        (isset($postTitleMargin['left']) ? (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) : '0px') . '; ';
                                }

                                // Padding
                                if (isset($postTitlePadding['top']) || isset($postTitlePadding['right']) || isset($postTitlePadding['bottom']) || isset($postTitlePadding['left'])) {
                                    $titleStyles .= 'padding: ' .
                                        (isset($postTitlePadding['top']) ? (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) : '0px') . ' ' .
                                        (isset($postTitlePadding['right']) ? (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) : '0px') . ' ' .
                                        (isset($postTitlePadding['bottom']) ? (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) : '0px') . ' ' .
                                        (isset($postTitlePadding['left']) ? (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) : '0px') . '; ';
                                }

                                // Determine if underline should be shown
                                $showUnderline = $postLinkType === 'yeslink' && $titleHoverUnderLine === 'enable';

                                // Class name
                                $classNames = 'title align-' . esc_attr($postTitleAlignment);
                                if ($showUnderline) {
                                    $classNames .= ' underline';
                                }

                                // Hover/Out events for nolink
                                $onmouseover = '';
                                $onmouseout  = '';

                                if (!empty($postTitleHoverBgColor)) {
                                    $onmouseover .= 'this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';';
                                }

                                if (!empty($postTitleHoverColor)) {
                                    $onmouseover .= ' this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                                }

                                if (!empty($postTitleBgColor)) {
                                    $onmouseout .= 'this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';';
                                } else {
                                    $onmouseout .= 'this.style.removeProperty(\'background-color\');';
                                }

                                if (!empty($postTitleColor)) {
                                    $onmouseout .= ' this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                                } else {
                                    $onmouseout .= ' this.style.removeProperty(\'color\');';
                                }

                                // Opening title tag
                                $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"'
                                    . (!empty($onmouseover) ? ' onmouseover="' . trim($onmouseover) . '"' : '')
                                    . (!empty($onmouseout)  ? ' onmouseout="'  . trim($onmouseout)  . '"' : '') . '>';

                                if ($postLinkType === 'yeslink') {
                                    // Anchor styles
                                    $style = '';
                                    $hoverStyle = '';
                                    $mouseoutStyle = '';

                                    if (!empty($postTitleFontSize)) {
                                        $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                                    }

                                    if (!empty($postTitleLineHeight)) {
                                        $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                                    }

                                    if (!empty($postTitleLetterSpacing)) {
                                        $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                                    }

                                    if (!empty($postTitleFontWeight)) {
                                        $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                                    }

                                    if (!empty($postTitleColor)) {
                                        $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                        $mouseoutStyle .= 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                                    } else {
                                        $mouseoutStyle .= 'this.style.color=\'\';';
                                    }

                                    if (!empty($postTitleHoverColor)) {
                                        $hoverStyle .= 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                                    }

                                    if ($showUnderline && !empty($postTitleHoverColor)) {
                                        $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                                        $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                        $hoverStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                                    }

                                    if ($showUnderline && empty($postTitleColor ) && !empty($postTitleColor )) {
                                        $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                                        $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                                        $mouseoutStyle .= ' this.style.backgroundSize=\'100% 2px\';';
                                    } else {
                                        
                                        $mouseoutStyle .= ' this.style.removeProperty(\'background-position\');';
                                        $mouseoutStyle .= ' this.style.removeProperty(\'background-size\');';
                                    }

                                    $output .= '<a href="' . esc_url($permalink) . '" ' . $targetAttr . '
                                        style="' . esc_attr(trim($style)) . '"'
                                        . (!empty($hoverStyle)   ? ' onmouseover="' . $hoverStyle . '"' : '')
                                        . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                        . esc_html($croppedTitle) . '</a>';
                                } else {
                                    // No link  render span with inline styles
                                    $inlineStyle = '';
                                    if (!empty($postTitleFontSize)) {
                                        $inlineStyle .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                                    }
                                    if (!empty($postTitleLineHeight)) {
                                        $inlineStyle .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                                    }
                                    if (!empty($postTitleLetterSpacing)) {
                                        $inlineStyle .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                                    }
                                    if (!empty($postTitleFontWeight)) {
                                        $inlineStyle .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                                    }
                                    if (!empty($postTitleColor)) {
                                        $inlineStyle .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                    }

                                    $output .= '<span style="' . esc_attr(trim($inlineStyle)) . '">' . esc_html($croppedTitle) . '</span>';
                                }

                                $output .= '</' . esc_attr($titleTag) . '>';
                            }

                            // Button Output                
                            if ($showReadMoreButton) {
                                // Button wrapper styles
                                $buttonWrapperStyle = '';

                                if (
                                    isset($buttonMarginNew['top']) || 
                                    isset($buttonMarginNew['right']) || 
                                    isset($buttonMarginNew['bottom']) || 
                                    isset($buttonMarginNew['left'])
                                ) {
                                    $buttonWrapperStyle .= 'margin: ' .
                                        (isset($buttonMarginNew['top']) ? (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) : '0px') . ' ' .
                                        (isset($buttonMarginNew['right']) ? (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) : '0px') . ' ' .
                                        (isset($buttonMarginNew['bottom']) ? (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) : '0px') . ' ' .
                                        (isset($buttonMarginNew['left']) ? (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) : '0px') . '; ';
                                }

                                // Order
                                if (!empty($buttonOrder)) {
                                    $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                                }

                               
                                $output .= '<div class="btn-wrapper align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';


                                // Button inline styles
                                $buttonInlineStyles = '';

                                if (!empty($buttonTextColor)) {
                                    $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                                }
                                if (!empty($buttonBackgroundColor)) {
                                    $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                                }
                                if (!empty($buttonFontSize)) {
                                    $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                                }
                                if (!empty($buttonFontWeight)) {
                                    $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                                }
                                if (!empty($buttonBorderColor)) {
                                    $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                                }
                                if (!empty($buttonBorderType)) {
                                    $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                                }

                                // Border Width
                                if (
                                    isset($buttonBorderWidth['top']) || 
                                    isset($buttonBorderWidth['right']) || 
                                    isset($buttonBorderWidth['bottom']) || 
                                    isset($buttonBorderWidth['left'])
                                ) {
                                    $buttonInlineStyles .= 'border-width: ' .
                                        (isset($buttonBorderWidth['top']) ? (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) : '0px') . ' ' .
                                        (isset($buttonBorderWidth['right']) ? (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) : '0px') . ' ' .
                                        (isset($buttonBorderWidth['bottom']) ? (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) : '0px') . ' ' .
                                        (isset($buttonBorderWidth['left']) ? (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) : '0px') . '; ';
                                }

                                // Border Radius
                                if (
                                    isset($buttonBorderRadius['top']) || 
                                    isset($buttonBorderRadius['right']) || 
                                    isset($buttonBorderRadius['bottom']) || 
                                    isset($buttonBorderRadius['left'])
                                ) {
                                    $buttonInlineStyles .= 'border-radius: ' .
                                        (isset($buttonBorderRadius['top']) ? (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) : '0px') . ' ' .
                                        (isset($buttonBorderRadius['right']) ? (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) : '0px') . ' ' .
                                        (isset($buttonBorderRadius['bottom']) ? (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) : '0px') . ' ' .
                                        (isset($buttonBorderRadius['left']) ? (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) : '0px') . '; ';
                                }

                                // Padding
                                if (
                                    isset($buttonPaddingNew['top']) || 
                                    isset($buttonPaddingNew['right']) || 
                                    isset($buttonPaddingNew['bottom']) || 
                                    isset($buttonPaddingNew['left'])
                                ) {
                                    $buttonInlineStyles .= 'padding: ' .
                                        (isset($buttonPaddingNew['top']) ? (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) : '0px') . ' ' .
                                        (isset($buttonPaddingNew['right']) ? (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) : '0px') . ' ' .
                                        (isset($buttonPaddingNew['bottom']) ? (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) : '0px') . ' ' .
                                        (isset($buttonPaddingNew['left']) ? (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) : '0px') . '; ';
                                } 

                                // Hover styles
                                $buttonHoverInlineStyles = '';
                                $buttonResetStyles = '';

                                if (!empty($buttonHoverTextColor)) {
                                    $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                                    $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                                }
                                if (!empty($buttonHoverBorderColor)) {
                                    $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                                    $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                                }
                                if (!empty($buttonHoverBackgroundColor)) {
                                    $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                                    $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                                }

                                // Button anchor tag
                                $output .= '<a class="fpg-link read-more ' . esc_attr($buttonStyle1) . '" href="' . esc_url(get_permalink()) . '" ' . $targetAttr . ' style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                                if (!empty($buttonHoverInlineStyles)) {
                                    $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                                }

                                if (!empty($buttonResetStyles)) {
                                    $output .= ' onmouseout="' . $buttonResetStyles . '"';
                                }

                                $output .= '>';

                                // Icon handling
                                $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                                $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                                $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                                if ($iconPosition === 'left' && $showButtonIcon) {
                                    $output .= $leftIcon . ' ';
                                }

                                $output .= esc_html($readMoreLabel);

                                if ($iconPosition === 'right' && $showButtonIcon) {
                                    $output .= ' ' . $rightIcon;
                                }

                                $output .= '</a></div>';
                            }
                            // End Button

                            $output .= '</div>';
                            
                            // Add any other post content here (title, meta, etc.)
                        $output .= '</div>'; // .fancy-post-item
                        // DO NOT close .col-lg-7 here, it should be closed after the loop ends
                    }
                }

            }
            if ($listLayoutStyle === 'style1' && $post_count >= $postLimit) {
                $output .= '</div>'; // Close .col-lg-7
                
            }else if ($listLayoutStyle === 'style2' && $post_count >= $postLimit) {
                $output .= '</div>'; 
                $output .= '</div>'; 
                
            }else if ($listLayoutStyle === 'style3' && $post_count >= $postLimit) {
                $output .= '</div>'; 
            }
            
            $output .= '</div>'; 
            $output .= '</div>'; 
            
        wp_reset_postdata();

        return $output;
    }

}